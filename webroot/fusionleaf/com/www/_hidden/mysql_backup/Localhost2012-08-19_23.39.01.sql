-- MySQL dump 10.13  Distrib 5.5.25, for Win32 (x86)
--
-- Host: localhost    Database: localhost
-- ------------------------------------------------------
-- Server version	5.5.25

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `access_group`
--

DROP TABLE IF EXISTS `access_group`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `access_group` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT 'Self-explanatory',
  `name` char(100) NOT NULL COMMENT 'Name of the access group',
  `description` char(100) NOT NULL COMMENT 'Description of the access group',
  `modified` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Modified date of the group name',
  `modifier` int(10) unsigned NOT NULL COMMENT 'User that modified the group name',
  `created` datetime NOT NULL COMMENT 'Creation date of the group name',
  `creator` int(10) unsigned NOT NULL COMMENT 'User that created the group name',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=18 DEFAULT CHARSET=latin1 COMMENT='Groups to which users can be members';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `access_group`
--

LOCK TABLES `access_group` WRITE;
/*!40000 ALTER TABLE `access_group` DISABLE KEYS */;
INSERT INTO `access_group` VALUES (1,'Administrators','Users with full access to the website.','2012-02-27 23:15:27',1,'2012-02-27 18:09:48',1),(2,'Authenticated','Users with read access after login.','2012-02-27 23:16:53',1,'2012-02-27 18:16:53',1),(3,'Anonymous','Guests with read access before login.','2012-02-27 23:18:17',1,'2012-02-27 18:18:17',1);
/*!40000 ALTER TABLE `access_group` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `access_list`
--

DROP TABLE IF EXISTS `access_list`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `access_list` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT 'Self-explanatory',
  `method_id` int(10) unsigned NOT NULL COMMENT 'Linked to cms_method.id',
  `group_id` int(10) unsigned NOT NULL COMMENT 'Linked to access_group.id',
  `modified` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Modified date of the group assignment',
  `modifier` int(10) unsigned NOT NULL COMMENT 'User that modified the group assignment',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=131 DEFAULT CHARSET=latin1 COMMENT='Users assigned to groups';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `access_list`
--

LOCK TABLES `access_list` WRITE;
/*!40000 ALTER TABLE `access_list` DISABLE KEYS */;
INSERT INTO `access_list` VALUES (53,103,3,'2012-03-01 00:59:11',1),(61,212,2,'2012-04-17 16:40:19',1),(130,191,2,'2012-08-04 06:49:23',1),(63,214,3,'2012-04-19 05:56:23',1),(93,274,3,'2012-05-18 05:15:46',1),(111,228,3,'2012-05-25 07:42:13',1),(112,228,2,'2012-05-25 07:42:43',1),(115,292,3,'2012-05-26 04:02:37',1),(116,323,3,'2012-06-19 09:52:24',1),(121,328,3,'2012-07-09 21:52:32',1),(125,341,3,'2012-08-02 23:30:19',1),(126,103,2,'2012-08-02 23:31:43',1);
/*!40000 ALTER TABLE `access_list` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `access_membership`
--

DROP TABLE IF EXISTS `access_membership`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `access_membership` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT 'Self-explanatory',
  `user_id` int(10) unsigned NOT NULL COMMENT 'Linked to access_user.id',
  `group_id` int(10) unsigned NOT NULL COMMENT 'Linked to access_group.id',
  `modified` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Modified date of the group assignment',
  `modifier` int(10) unsigned NOT NULL COMMENT 'User that modified the group assignment',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=78 DEFAULT CHARSET=latin1 COMMENT='Users assigned to groups';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `access_membership`
--

LOCK TABLES `access_membership` WRITE;
/*!40000 ALTER TABLE `access_membership` DISABLE KEYS */;
INSERT INTO `access_membership` VALUES (6,1,1,'2012-02-29 00:03:59',1),(73,11,1,'0000-00-00 00:00:00',2012);
/*!40000 ALTER TABLE `access_membership` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `access_menu`
--

DROP TABLE IF EXISTS `access_menu`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `access_menu` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT 'Self-explanatory',
  `group_id` int(10) NOT NULL COMMENT 'Group that can access the menu',
  `menu_id` int(10) unsigned NOT NULL COMMENT 'Menu of granted access',
  `modified` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Date of last modification',
  `modifier` int(10) NOT NULL COMMENT 'Modifier of the menu',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=43 DEFAULT CHARSET=latin1 COMMENT='Users with access to login';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `access_menu`
--

LOCK TABLES `access_menu` WRITE;
/*!40000 ALTER TABLE `access_menu` DISABLE KEYS */;
INSERT INTO `access_menu` VALUES (33,2,4,'2012-05-25 01:51:12',1),(32,3,11,'2012-05-24 04:21:03',1),(31,3,10,'2012-05-23 07:56:57',1),(30,2,10,'2012-05-23 07:55:33',1),(34,3,17,'2012-08-02 22:50:51',1),(42,2,17,'2012-08-04 15:34:24',1),(41,3,19,'2012-08-04 15:29:17',1);
/*!40000 ALTER TABLE `access_menu` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `access_user`
--

DROP TABLE IF EXISTS `access_user`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `access_user` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT 'Self-explanatory',
  `username` char(100) NOT NULL COMMENT 'Unique name for the user',
  `password` char(32) NOT NULL COMMENT 'MD5 hash of the password',
  `email` char(200) NOT NULL COMMENT 'Complete email address for the user',
  `first_login` datetime NOT NULL COMMENT 'Date and time the user was created',
  `last_login` datetime NOT NULL COMMENT 'Last time the user logged in',
  `total_login` int(10) unsigned NOT NULL COMMENT 'Number of times the user logged in',
  `modified` datetime NOT NULL COMMENT 'Modified date of the user',
  `modifier` int(10) unsigned NOT NULL COMMENT 'User that modified the user',
  `created` datetime NOT NULL COMMENT 'Creation date of the user',
  `creator` int(10) unsigned NOT NULL COMMENT 'User that created the user',
  PRIMARY KEY (`id`),
  UNIQUE KEY `username` (`username`)
) ENGINE=MyISAM AUTO_INCREMENT=13 DEFAULT CHARSET=latin1 COMMENT='Users with access to login';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `access_user`
--

LOCK TABLES `access_user` WRITE;
/*!40000 ALTER TABLE `access_user` DISABLE KEYS */;
INSERT INTO `access_user` VALUES (1,'leafybug','b4c11185cea375860cd24a62299d54d6','Enter in your email','2012-02-28 22:10:09','2012-08-19 22:13:06',548,'2012-08-04 13:39:06',1,'2012-02-27 18:02:36',1);
/*!40000 ALTER TABLE `access_user` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `dyn_demo`
--

DROP TABLE IF EXISTS `dyn_demo`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `dyn_demo` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT 'Self-explanatory',
  `content` varchar(5000) NOT NULL COMMENT 'HTML array',
  `parent` char(32) NOT NULL COMMENT 'Element nested under',
  `my_id` char(32) NOT NULL COMMENT 'HTML attribute data-unique',
  `position` float NOT NULL COMMENT 'order of the item',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=193 DEFAULT CHARSET=latin1 COMMENT='Users with access to login';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `dyn_demo`
--

LOCK TABLES `dyn_demo` WRITE;
/*!40000 ALTER TABLE `dyn_demo` DISABLE KEYS */;
INSERT INTO `dyn_demo` VALUES (187,'{\"tag\":\"div\",\"class\":\"span2 well\"}','11be67e88af0a90138792d8f744a83f6','0a308804be31b59e580fdd5f68d488b7',1),(186,'{\"tag\":\"div\",\"class\":\"span10 well\"}','11be67e88af0a90138792d8f744a83f6','a6aa8e414e57421232392edc8c4081ab',0),(185,'{\"tag\":\"div\",\"class\":\"row-fluid\"}','root','11be67e88af0a90138792d8f744a83f6',0),(184,'{\"tag\":\"div\",\"class\":\"span10 well\"}','51fbce8220b542f8ea51d40f981befe3','dd9f0228cc7a203f697ff9ec988c2553',1),(183,'{\"tag\":\"div\",\"class\":\"span2 well\"}','51fbce8220b542f8ea51d40f981befe3','585d271a4fa6c3715e06b304253f0ef2',0),(182,'{\"tag\":\"div\",\"class\":\"row-fluid\"}','root','51fbce8220b542f8ea51d40f981befe3',4),(181,'{\"tag\":\"div\",\"class\":\"span8 well\"}','d499f2fdeff0f03960fc28c290df8938','3ca23546e90b7211fd2606924ca14940',1),(180,'{\"tag\":\"div\",\"class\":\"span4 well\"}','d499f2fdeff0f03960fc28c290df8938','bf068d83665a08876b8f26c9bbf6f44e',0),(179,'{\"tag\":\"div\",\"class\":\"row-fluid\"}','root','d499f2fdeff0f03960fc28c290df8938',3),(178,'{\"tag\":\"div\",\"class\":\"span6 well\"}','a476fef435d251ba405dcf3ef59b4e65','7ed73313f835ac6d16af3f13d60a1b10',1),(177,'{\"tag\":\"div\",\"class\":\"span6 well\"}','a476fef435d251ba405dcf3ef59b4e65','4d38d3b56678fa0f174838c7fce7cccb',0),(176,'{\"tag\":\"div\",\"class\":\"row-fluid\"}','root','a476fef435d251ba405dcf3ef59b4e65',2),(175,'{\"tag\":\"div\",\"class\":\"span4 well\"}','cb8ddaf4ef3c4b691551af30dbc20afa','a98fed7adb049bca6035814d801e410a',1),(174,'{\"tag\":\"div\",\"class\":\"span8 well\"}','cb8ddaf4ef3c4b691551af30dbc20afa','fe74f0863268d58533d3eef4ec3fdb49',0),(173,'{\"tag\":\"div\",\"class\":\"row-fluid\"}','root','cb8ddaf4ef3c4b691551af30dbc20afa',1);
/*!40000 ALTER TABLE `dyn_demo` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `dyn_template`
--

DROP TABLE IF EXISTS `dyn_template`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `dyn_template` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT 'Self-explanatory',
  `content` varchar(5000) NOT NULL COMMENT 'HTML array',
  `parent` char(32) NOT NULL COMMENT 'Element nested under',
  `my_id` char(32) NOT NULL COMMENT 'HTML attribute data-unique',
  `position` float NOT NULL COMMENT 'order of the item',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1 COMMENT='Users with access to login';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `dyn_template`
--

LOCK TABLES `dyn_template` WRITE;
/*!40000 ALTER TABLE `dyn_template` DISABLE KEYS */;
/*!40000 ALTER TABLE `dyn_template` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `log_change`
--

DROP TABLE IF EXISTS `log_change`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `log_change` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT 'Self-explanatory',
  `userid` int(10) unsigned NOT NULL COMMENT 'ID of the user making the change',
  `change_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Current time when the event occurred',
  `change_title` varchar(100) NOT NULL COMMENT 'Title of type of message that was output',
  `change_details` text NOT NULL COMMENT 'Details of the change',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=106 DEFAULT CHARSET=latin1 COMMENT='Users with access to login';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `log_change`
--

LOCK TABLES `log_change` WRITE;
/*!40000 ALTER TABLE `log_change` DISABLE KEYS */;
/*!40000 ALTER TABLE `log_change` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `log_error`
--

DROP TABLE IF EXISTS `log_error`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `log_error` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT 'Self-explanatory',
  `userid` char(100) NOT NULL COMMENT 'ID for the user',
  `error_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Last time the user logged in',
  `error_details` text NOT NULL COMMENT 'Full error details',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=2453 DEFAULT CHARSET=latin1 COMMENT='All CMS errors';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `log_error`
--

LOCK TABLES `log_error` WRITE;
/*!40000 ALTER TABLE `log_error` DISABLE KEYS */;
/*!40000 ALTER TABLE `log_error` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `log_mysql`
--

DROP TABLE IF EXISTS `log_mysql`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `log_mysql` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT 'Self-explanatory',
  `userid` int(10) unsigned NOT NULL COMMENT 'User who made the SQL change',
  `change_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Current time when the event occurred',
  `mysql_query` text NOT NULL COMMENT 'Query passed',
  `mysql_params` text COMMENT 'Query parameters passed',
  `mysql_result` text COMMENT 'Return value of the query',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 COMMENT='Users with access to login';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `log_mysql`
--

LOCK TABLES `log_mysql` WRITE;
/*!40000 ALTER TABLE `log_mysql` DISABLE KEYS */;
/*!40000 ALTER TABLE `log_mysql` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `php_index`
--

DROP TABLE IF EXISTS `php_index`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `php_index` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT 'Self-explanatory',
  `group_id` int(10) unsigned NOT NULL COMMENT 'Group ID for the index page',
  `page_id` int(10) unsigned NOT NULL COMMENT 'Page ID for the index home page',
  `modified` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Date of last modification',
  `modifier` int(10) unsigned NOT NULL COMMENT 'User who made the SQL change',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=latin1 COMMENT='Users with access to login';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `php_index`
--

LOCK TABLES `php_index` WRITE;
/*!40000 ALTER TABLE `php_index` DISABLE KEYS */;
INSERT INTO `php_index` VALUES (1,1,285,'2012-08-13 22:31:39',1),(2,2,158,'2012-07-09 19:23:04',1),(3,3,157,'2012-05-22 07:01:53',1);
/*!40000 ALTER TABLE `php_index` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `php_menu`
--

DROP TABLE IF EXISTS `php_menu`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `php_menu` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT 'Self-explanatory',
  `label` varchar(100) NOT NULL COMMENT 'Text to display',
  `url` varchar(200) NOT NULL COMMENT 'Page to redirect',
  `parent` int(10) unsigned NOT NULL COMMENT 'Parent ID (if not a parent itself)',
  `position` float DEFAULT NULL COMMENT 'Order of item',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=20 DEFAULT CHARSET=latin1 COMMENT='Users with access to login';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `php_menu`
--

LOCK TABLES `php_menu` WRITE;
/*!40000 ALTER TABLE `php_menu` DISABLE KEYS */;
INSERT INTO `php_menu` VALUES (14,'FusionLeaf Studio','page_flstudio',11,1),(12,'Screenshots','page_screenshots',11,2),(4,'Options','',0,1),(5,'Change Password','access_change_pass',4,0),(6,'Logout','access_login&logout',4,1),(11,'Progress','',0,2),(10,'Changelog','page_changelog',11,0),(17,'Help','',0,3),(18,'Planters Guide','page_guide_planters',17,0),(19,'Login','access_login',0,0);
/*!40000 ALTER TABLE `php_menu` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `php_methods`
--

DROP TABLE IF EXISTS `php_methods`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `php_methods` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(50) NOT NULL,
  `method` mediumtext NOT NULL,
  `modified` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `modifier` int(11) NOT NULL,
  `type` int(2) NOT NULL,
  `post` text NOT NULL,
  `title` varchar(70) DEFAULT '' COMMENT 'HTML title',
  `keyword` varchar(500) DEFAULT '' COMMENT 'HTML keywords',
  `description` varchar(160) DEFAULT '' COMMENT 'HTML description',
  UNIQUE KEY `id` (`id`),
  UNIQUE KEY `name` (`name`)
) ENGINE=MyISAM AUTO_INCREMENT=364 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `php_methods`
--

LOCK TABLES `php_methods` WRITE;
/*!40000 ALTER TABLE `php_methods` DISABLE KEYS */;
INSERT INTO `php_methods` VALUES (28,'cms_preload_session','$domain = strtolower(SITE_DOMAIN);\r\n//ini_set(\'session.cookie_domain\', \'.\'.$domain);\r\nini_set(\'session.cookie_domain\', (strpos($_SERVER[\'HTTP_HOST\'],\'.\') !== false) ? \'.\'.$domain : \'\');\r\n\r\n//include_once \'inc/securimage/securimage.php\';\r\n\r\n// Start the session so variables can be passed between all the pages\r\nsession_start();\r\n\r\n// Set the default timezone\r\n//date_default_timezone_set(\'GMT\');\r\n//date_timezone_set($date, timezone_open(\'US/Eastern\'));\r\ndate_default_timezone_set(\'UTC\');\r\n\r\n// Register the shutdown function to handle fatal errors\r\nregister_shutdown_function(\'shutdownFunction\');\r\n\r\nset_error_handler(\'cms_error_handler\');\r\n\r\n// Prevent session hijacking\r\nfunction validate_session()\r\n{\r\n	// If the user agent is not available, use a dummy value\r\n	$user_agent = \'Not specified\';\r\n	if (isset($_SERVER[\'HTTP_USER_AGENT\'])) $user_agent = $_SERVER[\'HTTP_USER_AGENT\'];\r\n\r\n	// Ensure the first time the session is random\r\n	if (!isset($_SESSION[\'PREV_ACTIVITY\']) || !isset($_SESSION[\'PREV_REMOTEADDR\']) || !isset($_SESSION[\'PREV_USERAGENT\']))\r\n	{\r\n		session_destroy();\r\n		session_start();\r\n        session_regenerate_id(true);	\r\n	}\r\n	// Ensure the session doesn\'t stay alive too long (3 hours)\r\n	else if (time() - $_SESSION[\'PREV_ACTIVITY\'] > (60*60*3))\r\n	{\r\n		session_destroy();\r\n		session_start();\r\n        session_regenerate_id(true);\r\n	}\r\n	// Ensure the session can\'t be used by a different computer\r\n	else if (md5($_SERVER[\'REMOTE_ADDR\']) != $_SESSION[\'PREV_REMOTEADDR\'] || md5($user_agent) != $_SESSION[\'PREV_USERAGENT\'])\r\n	{\r\n		session_destroy();\r\n		session_start();\r\n        session_regenerate_id(true);\r\n	}\r\n	\r\n	$_SESSION[\'PREV_ACTIVITY\'] = time();\r\n	$_SESSION[\'PREV_USERAGENT\'] = md5($user_agent);\r\n	$_SESSION[\'PREV_REMOTEADDR\'] = md5($_SERVER[\'REMOTE_ADDR\']);\r\n	$_SESSION[\'USERAGENT\'] = $user_agent;\r\n	$_SESSION[\'REMOTEADDR\'] = $_SERVER[\'REMOTE_ADDR\'];\r\n}\r\nvalidate_session();','2012-08-12 17:33:21',2,1,'','','',''),(31,'cms_preload_define','// Grab the domain\r\n$arr = explode(\'.\',RECORDED_DOMAIN);\r\nif (count($arr)==3) define(\"SITE_DOMAIN\", $arr[1].\'.\'.$arr[2]);\r\nelse define(\"SITE_DOMAIN\", RECORDED_DOMAIN);\r\nif (!defined(\"SITE_TITLE\")) define(\"SITE_TITLE\",RECORDED_DOMAIN);\r\ndefine(\"SITE_FULL\",\'http://\'.RECORDED_DOMAIN);\r\n\r\n// Site description should go here\r\ndefine(\"SITE_TAG\",\'\');\r\n\r\n// Site keywords should go here\r\ndefine(\"SITE_KEYWORDS\",\'\');\r\n\r\n// Google Analytics should go here\r\n$analytics = <<< OUTPUT\r\n	<script type=\"text/javascript\">\r\n	</script>\r\nOUTPUT;\r\n\r\nif (RECORDED_DOMAIN==strtolower(\'localhost\')) $analytics=\'\';\r\ndefine(\"GOOGLE_ANALYTICS\",$analytics);\r\n\r\n// Twitter information should go here (grab from dev.twitter.com)\r\ndefine(\"TWITTER_NAME\", \'\');\r\ndefine(\"TWITTER_CONSUMER_KEY\", \'\');\r\ndefine(\"TWITTER_CONSUMER_SECRET\", \'\');\r\ndefine(\"TWITTER_ACCESS_TOKEN\", \'\');\r\ndefine(\"TWITTER_ACCESS_SECRET\", \'\');','2012-08-04 14:39:21',2,1,'','','',''),(62,'hlp_html_output','// ************************** HTML Helpers **************************\r\nfunction h2($text)\r\n{\r\n	return \"<h2>$text</h2>\";\r\n}	\r\n\r\nfunction p($text)\r\n{\r\n	return \"<p>$text</p>\";\r\n}\r\n\r\nfunction a($text,$url)\r\n{\r\n	return \"<a href=\\\"index.php?$url\\\">$text</a>\";\r\n}\r\n\r\nfunction ahome($text)\r\n{\r\n	return \"<a href=\\\"index.php\\\">$text</a>\";\r\n}\r\n\r\nfunction br()\r\n{\r\n	return \"<br />\".NEWLINE;\r\n}\r\n\r\nfunction img($text,$url,$visible=true,$padding=\'0px\')\r\n{\r\n	//$arr = getimagesize(str_replace(\"\\\\\",\'/\',$url));\r\n	//$width = $arr[0];\r\n	//return \"<img src=\\\"$url\\\" alt=\\\"$text\\\" title=\\\"$text\\\" width=\\\"$width\\\" />\";\r\n	if (!$visible) $vis = \'visibility: hidden;\';\r\n	else $vis = \'\';\r\n	return \"<img src=\\\"$url\\\" alt=\\\"$text\\\" title=\\\"$text\\\" style=\\\"max-width: 100%; $vis padding:$padding; \\\" />\";\r\n	//return \"<img src=\\\"$url\\\" alt=\\\"$text\\\" title=\\\"$text\\\" />\";\r\n}\r\n\r\nfunction img_special($text,$url,$visible=true,$padding=\'0px\',$onclick=\'\')\r\n{\r\n	//$arr = getimagesize(str_replace(\"\\\\\",\'/\',$url));\r\n	//$width = $arr[0];\r\n	//return \"<img src=\\\"$url\\\" alt=\\\"$text\\\" title=\\\"$text\\\" width=\\\"$width\\\" />\";\r\n	if (!$visible) $vis = \'visibility: hidden;\';\r\n	else $vis = \'\';\r\n	return \"<img src=\\\"$url\\\" alt=\\\"$text\\\" title=\\\"$text\\\" onclick=\\\"$onclick\\\" style=\\\"max-width: 100%; $vis padding:$padding; \\\" />\";\r\n	//return \"<img src=\\\"$url\\\" alt=\\\"$text\\\" title=\\\"$text\\\" />\";\r\n}\r\n\r\nfunction cb($arr)\r\n{\r\n	$item = \'\';\r\n	foreach ($arr as $cb)\r\n	{\r\n		if (isset($cb[3]) && $cb[3]==true) $checked = \'checked=\"checked\"\';\r\n		else $checked = \'\';\r\n		$item .= \'<input type=\"checkbox\" name=\"\'.$cb[0].\'[]\" value=\"\'.$cb[1].\'\" \'.$checked.\' /> \'.$cb[2].br();\r\n	}\r\n\r\n	return $item;\r\n}\r\n\r\nfunction drop_menu_bootstrap($arr, $full_menu=false)\r\n{\r\n	$menu = \'\';\r\n\r\n	// Start the menu\r\n	if ($full_menu) $menu .= \'<ul class=\"nav\">\';\r\n	\r\n	// Loop through each of the parent menu items\r\n	foreach ($arr as $row)\r\n	{\r\n		// If the menu item IS clickable\r\n		if ($row[1]) $menu .= \'<li><a href=\"\'.$row[1].\'\">\'.$row[0].\'</a>\';\r\n	\r\n		// Else the menu item is NOT clickable\r\n		else $menu .= \'<li class=\"dropdown\"><a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\">\'.$row[0].\'<b class=\"caret\"></b></a>\';\r\n	\r\n		// If the menu has a child array\r\n		if (isset($row[2]) && is_array($row[2]))\r\n		{\r\n			if (count($row[2])>0)\r\n			{\r\n				$menu .= \'<ul class=\"dropdown-menu\">\';\r\n				foreach ($row[2] as $child)\r\n				{\r\n					if ($child[1]) $menu .= \'<li><a href=\"\'.$child[1].\'\">\'.$child[0].\'</a></li>\';\r\n					else $menu .= \'<li><p style=\"font-weight: normal; text-align: left; border-top: 1px silver solid;\">\'.$child[0].\'</p></li>\';\r\n	\r\n				}\r\n				$menu .= \'</ul>\';\r\n			}\r\n		}\r\n		$menu .= \'</li>\';\r\n	}\r\n	\r\n	if ($full_menu) $menu .= \'</ul>\';\r\n	\r\n	return $menu;\r\n}\r\n\r\n\r\nfunction load_menu($group)\r\n{\r\n	$qry = \"SELECT php_menu.id,php_menu.label,php_menu.url FROM php_menu\r\n	INNER JOIN access_menu WHERE access_menu.menu_id = php_menu.id AND \r\n	access_menu.group_id=? AND php_menu.parent=? ORDER BY php_menu.position\";\r\n	\r\n	$params = array($group, 0);\r\n	$result = query($qry, $params);\r\n	\r\n	$new_menu = array();\r\n	foreach($result as $row)\r\n	{\r\n		$qry = \"SELECT id,label,url FROM php_menu WHERE parent=? ORDER BY position\";\r\n		$params = array($row[\'id\']);\r\n		$result2 = query($qry, $params);\r\n		$children = array();\r\n		foreach($result2 as $row2)\r\n		{\r\n			array_push($children, array($row2[\'label\'],$row2[\'url\']));\r\n		}\r\n		$parent_url = false;\r\n		if (strlen($row[\'url\'])>0) $parent_url = $row[\'url\'];\r\n		$parent = array($row[\'label\'],$parent_url,$children);\r\n		array_push($new_menu, $parent);\r\n	}\r\n	$menu = drop_menu_bootstrap($new_menu);\r\n	\r\n	return $menu;\r\n}','2012-08-04 15:33:24',2,1,'','','',''),(125,'hlp_db_method_control','// ************************** Method Control Queries **************************\r\nfunction db_method_add($name, $method, $type=0, $post=\'\')\r\n{\r\n	$qry = \"INSERT INTO php_methods (name,method,type,modified,modifier,post) VALUES(?,?,?,CURRENT_TIMESTAMP,2,?)\";\r\n	$params = array($name, $method, $type, $post);\r\n	query_execute($qry, $params);\r\n}\r\n\r\nfunction db_method_update($name, $method, $type=0, $oldname=\'NOTHING__NOTHING\', $post=\'\', $title=\'\', $keyword=\'\', $description=\'\')\r\n{\r\n	$qry = \"SELECT id FROM php_methods WHERE name=? LIMIT 1\";\r\n	$params = array($oldname);\r\n	$result = query($qry, $params);\r\n\r\n	if (count($result)==1)\r\n	{\r\n		$qry = \"UPDATE php_methods SET name=?, method=?, type=?, modified=CURRENT_TIMESTAMP, modifier=2, post=?, title=?, keyword=?, description=? WHERE name=? LIMIT 1\";\r\n		$params = array($name, $method, $type, $post, $title, $keyword, $description, $oldname);\r\n		query_execute($qry, $params);\r\n	}\r\n	else\r\n	{\r\n		$qry = \"UPDATE php_methods SET name=?, method=?, type=?, modified=CURRENT_TIMESTAMP, modifier=2, post=?, title=?, keyword=?, description=? WHERE name=? LIMIT 1\";\r\n		$params = array($name, $method, $type, $post, $title, $keyword, $description, $name);\r\n		query_execute($qry, $params);\r\n	}\r\n}\r\n\r\nfunction db_method_trash($name)\r\n{\r\n	$qry = \"INSERT INTO php_trash SELECT * FROM php_methods WHERE name=? AND modifier!=1 LIMIT 1\";\r\n	$params = array($name);\r\n	query_execute($qry, $params);\r\n\r\n	$qry = \"DELETE FROM php_methods WHERE name=? AND modifier!=1 LIMIT 1\";\r\n	$params = array($name);\r\n	query_execute($qry, $params);\r\n}\r\n\r\nfunction db_method_untrash($name)\r\n{\r\n	$qry = \"INSERT INTO php_methods SELECT * FROM php_trash WHERE name=? LIMIT 1\";\r\n	$params = array($name);\r\n	query_execute($qry, $params);\r\n\r\n	$qry = \"DELETE FROM php_trash WHERE name=? LIMIT 1\";\r\n	$params = array($name);\r\n	query_execute($qry, $params);\r\n}\r\n\r\nfunction db_method_delete($name)\r\n{\r\n	$qry = \"DELETE FROM php_trash WHERE name=? LIMIT 1\";\r\n	$params = array($name);\r\n	query_execute($qry, $params);\r\n}\r\n\r\nfunction db_method_type($name)\r\n{\r\n	$qry = \"SELECT type FROM php_methods WHERE name=? LIMIT 1\";\r\n	$params = array($name);\r\n	$result = query($qry, $params);\r\n	\r\n	if (count($result)==1) return $result[0][\'type\'];\r\n	else return false;\r\n}\r\n\r\nfunction db_method_list()\r\n{\r\n	$qry = \"SELECT id,name,type,modified,title,keyword,description FROM php_methods ORDER BY name\";\r\n	$params = array();\r\n	return query($qry, $params);\r\n}\r\n\r\nfunction db_method_list_trash()\r\n{\r\n	$qry = \"SELECT name,id FROM php_trash ORDER BY name\";\r\n	$params = array();\r\n	return query($qry, $params);\r\n}','2012-08-10 22:29:06',2,1,'','','',''),(123,'script_javascript','// Generic Form\r\nfunction validateForm()\r\n{	\r\n    var tbs = document.getElementsByTagName(\"input\");\r\n    for (var i = 0 ; i < tbs.length ; i++)\r\n    {\r\n	var opt1 = tbs[i].getAttribute(\"name\");\r\n	var opt2 = tbs[i].getAttribute(\"type\");\r\n        if (opt1.indexOf(\"_optional\") == -1 && opt2.toLowerCase() != \"hidden\" && opt1.indexOf(\"search\") != 0)\r\n        {\r\n            if (tbs[i].value==null || tbs[i].value==\"\")\r\n            {\r\n            	alert(\"Please fill out all the fields: \"+ opt1);\r\n		return false;\r\n            }\r\n        }\r\n    }\r\n    \r\n    tbs = document.getElementsByTagName(\"textarea\");\r\n    for (var i = 0 ; i < tbs.length ; i++)\r\n    {\r\n		if (tbs[i].value==null || tbs[i].value==\"\")\r\n		{\r\n			alert(\"Please fill out all the textareas: \" + tbs[i].id);\r\n			return false;\r\n		}\r\n    }\r\n}\r\n\r\n\r\n// Edit Method\r\nfunction indentSelection(myField, myValue)\r\n{\r\n    //MOZILLA/NETSCAPE support\r\n    if (myField.selectionStart || myField.selectionStart == \'0\')\r\n    {\r\n        var startPos = myField.selectionStart;\r\n        var endPos = myField.selectionEnd;\r\n\r\n	// If nothing is selected, just add a tab\r\n	if (endPos-startPos==\'0\')\r\n	{\r\n	        var startPos = myField.selectionStart;\r\n	        var endPos = myField.selectionEnd;\r\n	        myField.value = myField.value.substring(0, startPos)\r\n	        + myValue\r\n	        + myField.value.substring(endPos, myField.value.length);\r\n\r\n	        myField.setSelectionRange(endPos+1, endPos+1);\r\n	}\r\n	// Else there is a text selection\r\n	else\r\n	{\r\n		var startValue = myField.value.substring(0, startPos);\r\n		var oldValue = myField.value.substring(startPos, endPos);\r\n		var newValue = myValue + myField.value.substring(startPos, endPos).replace(/\\n/g, \'\\n\' + myValue);\r\n		var endValue = myField.value.substring(endPos, myField.value.length);\r\n\r\n		myField.value = startValue + newValue + endValue;\r\n		myField.setSelectionRange(startPos, endPos+(newValue.length-oldValue.length));\r\n	}\r\n    }\r\n}\r\n\r\nfunction outdentSelection(myField, myValue)\r\n{\r\n    //MOZILLA/NETSCAPE support\r\n    if (myField.selectionStart || myField.selectionStart == \'0\')\r\n    {\r\n        var startPos = myField.selectionStart;\r\n        var endPos = myField.selectionEnd;\r\n\r\n	// If nothing is selected, just remove the previous tab\r\n	if (endPos-startPos==\'0\')\r\n	{\r\n		if (myField.value.substring(startPos-1,startPos)!= \"	\") return;\r\n		var startValue = myField.value.substring(0, startPos-1);\r\n		var endValue = myField.value.substring(endPos, myField.value.length);\r\n\r\n		myField.value = startValue + endValue;\r\n		myField.setSelectionRange(startPos-1, startPos-1);\r\n	}\r\n	// Else there is a text selection\r\n	else	\r\n	{\r\n		var startValue = myField.value.substring(0, startPos);\r\n		var oldValue = myField.value.substring(startPos, endPos);\r\n		var newValue = myField.value.substring(startPos+1, endPos).replace(/\\n	/g, \'\\n\');\r\n		var endValue = myField.value.substring(endPos, myField.value.length);\r\n\r\n		if (myField.value.substring(startPos,startPos+1)!= \"	\") return;\r\n\r\n		myField.value = startValue + newValue + endValue;\r\n		myField.setSelectionRange(startPos, endPos+(newValue.length-oldValue.length));\r\n	}\r\n    }\r\n}\r\n\r\nfunction validateEditMethodForm()\r\n{	\r\n    var tbs = document.getElementsByTagName(\"input\");\r\n    for (var i = 0 ; i < tbs.length ; i++)\r\n    {\r\n	var opt1 = tbs[i].getAttribute(\"name\");\r\n	var opt2 = tbs[i].getAttribute(\"type\");\r\n        if (opt1.indexOf(\"_optional\") == -1 && opt2.toLowerCase() != \"hidden\" && opt1.indexOf(\"search\") != 0)\r\n        {\r\n            if (tbs[i].value==null || tbs[i].value==\"\")\r\n            {\r\n            	alert(\"Please fill out all the fields\");\r\n		return false;\r\n            }\r\n        }\r\n    }\r\n    \r\n    tbs = document.getElementsByTagName(\"textarea\");\r\n    for (var i = 0 ; i < tbs.length ; i++)\r\n    {\r\n		if (tbs[i].id == \"methodjsedit\" || tbs[i].id == \"methodpostedit\"\r\n		|| tbs[i].id == \"methodjseditorg\" || tbs[i].id == \"methodposteditorg\")\r\n		{\r\n			//alert(\"Please fill out all the textareas2: \" + tbs[i].id);\r\n		}\r\n		else if (tbs[i].value==null || tbs[i].value==\"\")\r\n		{\r\n			alert(\"Please fill out all the textareas: \" + tbs[i].id);\r\n			return false;\r\n		}\r\n    }\r\n	\r\n	var radio_choice = false;\r\n	for (counter = 0; counter < document.forms[\'editfrm\'].methodtypeedit.length; counter++) if (document.forms[\'editfrm\'].methodtypeedit[counter].checked) radio_choice = true; \r\n	if (!radio_choice)\r\n	{\r\n		alert(\"Please select a box\");\r\n		return false;\r\n	}\r\n	return true;\r\n}\r\n\r\n// Login Form\r\nfunction validateLoginForm()\r\n{\r\n	var x=document.forms[0][\"user\"].value\r\n	if (x==null || x==\"\" || x.length < 1)\r\n  	{\r\n		alert(\"Please enter in a username\");\r\n		return false;\r\n	}\r\n	\r\n	var x=document.forms[0][\"pass\"].value\r\n	if (x==null || x==\"\" || x.length < 1)\r\n  	{\r\n		alert(\"Please enter in a password\");\r\n		return false;\r\n	}\r\n}\r\n\r\n// Login Create Form\r\nfunction validateLoginCreateForm()\r\n{\r\n	var x=document.forms[0][\"user\"].value\r\n	if (x==null || x==\"\" || x.length < 1)\r\n  	{\r\n		alert(\"Please enter in a username\");\r\n		return false;\r\n	}\r\n	\r\n	var x=document.forms[0][\"pass\"].value\r\n	if (x==null || x==\"\" || x.length < 1)\r\n  	{\r\n		alert(\"Please enter in a password\");\r\n		return false;\r\n	}\r\n	\r\n	var x=document.forms[0][\"access\"].value\r\n	if (x==null || x==\"\" || x.length < 1)\r\n  	{\r\n		alert(\"Please enter in an access level\");\r\n		return false;\r\n	}\r\n	\r\n	var x=document.forms[0][\"email\"].value\r\n	if (x==null || x==\"\" || x.length < 1)\r\n  	{\r\n		alert(\"Please enter in an email\");\r\n		return false;\r\n	}\r\n}\r\n\r\nfunction receiveSyntaxCheck(passVal)\r\n{\r\n//alert(\"it works\");\r\n	var xmlhttp;\r\n	if (window.XMLHttpRequest)\r\n	{// code for IE7+, Firefox, Chrome, Opera, Safari\r\n		xmlhttp=new XMLHttpRequest();\r\n	}\r\n	else\r\n	{// code for IE6, IE5\r\n		xmlhttp=new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n	}\r\n	\r\n	if (xmlhttp==null)\r\n	{\r\n		alert (\"Your browser does not support XMLHTTP!\");\r\n		return;\r\n	}\r\n	\r\n	xmlhttp.onreadystatechange=function()\r\n	{		\r\n		if (xmlhttp.readyState==4 && xmlhttp.status==200)\r\n		{\r\n\r\n			if (xmlhttp.responseText.indexOf(\'success\') && xmlhttp.responseText.length>0)\r\n			{\r\nalert(xmlhttp.responseText);\r\n\r\n\r\n				if (xmlhttp.responseText.length==2 && xmlhttp.responseText.charCodeAt(0)==13 && xmlhttp.responseText.charCodeAt(1)==10)\r\n				{\r\n					// BAD\r\n					//alert(\"bad\");\r\n					//window.setTimeout(receiveChat,5000);\r\n					//var p = document.createElement(\'p\');\r\n					//p.innerHTML = xmlhttp.responseText;\r\n					//document.getElementById(\"chatwindow\").appendChild(p);\r\n				}\r\n				else\r\n				{\r\n					//var rt = xmlhttp.responseText;\r\n					//var at_loc = rt.lastIndexOf(\'at\');\r\n					//var rt_end = rt.length;\r\n					//var ts = rt.substring(at_loc+3,rt_end-6);\r\n\r\n					//var p = document.createElement(\'p\');\r\n					//p.innerHTML = xmlhttp.responseText.substring(0, at_loc-1);\r\n					//document.getElementById(\"lastCheck\").value = ts;\r\n\r\n					//document.getElementById(\"chatwindow\").appendChild(p);\r\n					//bottomScroll();\r\n					//setTimeout(updateChat(), 5000);\r\n					//window.setTimeout(receiveChat,5000);\r\n				}\r\n			}\r\n			else\r\n			{\r\n				alert(\"No output\");\r\n			}\r\n		}\r\n	}\r\n	//var pass = \"index.php?ajax_syntax_check&receive=\"+escape(document.getElementById(\"sendUser\").value)+\"&t=\" + Math.random() + \"&ts=\" + escape(document.getElementById(\"lastCheck\").value);\r\n//var pass = \"index.php?ajax_syntax_check&txtcode=\"+escape(passVal)+\"&t=\" + Math.random();\r\n	\r\n	//xmlhttp.open(\"POST\",pass,true);\r\n\r\n\r\nvar params = \"txtcode=\"+escape(passVal);\r\nxmlhttp.open(\"POST\",\"index.php?toolkit_edit_method&syntax\",true);\r\nxmlhttp.setRequestHeader(\"Content-type\",\"application/x-www-form-urlencoded\");\r\nxmlhttp.setRequestHeader(\"Content-length\", params.length);\r\nxmlhttp.setRequestHeader(\"Connection\", \"close\");\r\n	//xmlhttp.send(null);\r\n//xmlhttp.send(\"txtcode=\"+escape(passVal));\r\nxmlhttp.send(params);\r\n}','2012-08-04 06:16:22',2,3,'','','',''),(150,'cms_preload_error','/* 	************************** Error Handlers **************************\r\n * \r\n * cms_er ror_handler() 	- must set set_er ror_handler(\"cms_er ror_handler\") in the index.php to set the PHP error handler\r\n * cms_sh ow_error() 	- called by appearance/footer which will display a DIV if an error occurs\r\n * gather_er ror_info()	- called by cms_er ror_handler AND any other method (like DB) if I control the error catching\r\n * print_array()		- prints an array so it is easy to read\r\n * \r\n * restore_er ror_handler();					- set back to the default error handler if my error messages are not helping\r\n * set_er ror_handler(\"cms_er ror_handler\");	- set the default error handler to my function\r\n */\r\nfunction shutdownFunction()\r\n{\r\n	$error = error_get_last();\r\n\r\n	// Ignore errors is only to prevent PHP Syntax Check from showing up as a real error\r\n\r\n	if ($error!=NULL && !isset($_SESSION[\'ignore_errors\']))\r\n	{\r\n		$handle = false;\r\n		switch ($error[\'type\'])\r\n		{\r\n			case 1:\r\n			    	$handle = true;\r\n				break;\r\n			case 4:\r\n			    	$handle = true;\r\n				break;\r\n			case 16:\r\n			    	$handle = true;\r\n				break;\r\n			case 32:\r\n			    	$handle = true;\r\n				break;\r\n			case 64:\r\n			    	$handle = true;\r\n				break;\r\n			case 128:\r\n			    	$handle = true;\r\n				break;\r\n			case 2048:\r\n			    	$handle = true;\r\n				break;\r\n			default:\r\n			    	//$handle = false;\r\n				break;\r\n		}\r\n		if ($handle) cms_error_handler($error[\'type\'], $error[\'message\'], $error[\'file\'], $error[\'line\']);\r\n	}\r\n	else\r\n	{\r\n		// A successful pageload will clear up the error loop variable\r\n		if (isset($_SESSION[\'error_loop\'])) unset($_SESSION[\'error_loop\']);\r\n\r\n	    	// I tried this and it throws a lot of errors msgs\r\n	    	//sendText(\'shutdownFunction\', \'Found error code: \'.$error[\'type\'].$error[\'message\']);\r\n	}\r\n\r\n	// Errors are only ignored when using the PHP Syntax Check in the Code Editor\r\n	if (isset($_SESSION[\'ignore_errors\'])) unset($_SESSION[\'ignore_errors\']);\r\n\r\n	// Wait until the page is not being redirect to show the error message\r\n	if (function_exists(\'cms_show_error\') && !isset($_SESSION[\'wait\'])) echo cms_show_error();\r\n\r\n	// Unset the wait variable so the User Message and Error Message (if applicable) will display on the next page load\r\n	if (isset($_SESSION[\'wait\'])) unset($_SESSION[\'wait\']);\r\n} \r\n\r\nfunction cms_error_handler($errno, $errstr, $errfile, $errline)\r\n{\r\n	// If this error code is not included in error_reporting (anything with a @ at the beginning is ignored)\r\n	/*if (!(error_reporting() & $errno))\r\n	{\r\n		//die(error_reporting().\',\'.$errno);\r\n		// No error message\r\n		//return;\r\n	}*/\r\n\r\n	if (error_reporting()===0) { return; }\r\n\r\n	$lasterror = array();\r\n	$lasterror[\'message\'] = $errstr;\r\n	$lasterror[\'type\'] = $errno;\r\n	$lasterror[\'file\'] = $errfile;\r\n	$lasterror[\'line\'] = $errline;\r\n\r\n	$es1 = htmlentities($errstr, ENT_QUOTES, \"UTF-8\");\r\n	$es2 = htmlentities($errfile, ENT_QUOTES, \"UTF-8\");\r\n	$lasterror = new ErrorException($es1, $errno, 0, $es2, $errline);\r\n	\r\n	//echo $errstr;\r\n	//echo \"<br /><br />\";\r\n	\r\n	// Suppress the output, save to a variable (must trace from here)\r\n	// Source: http://stackoverflow.com/questions/171318/how-do-i-capture-php-output-into-a-variable\r\n	/*ob_start();\r\n	debug_print_backtrace();\r\n	$trace = ob_get_contents();\r\n	ob_end_clean();*/\r\n	$trace = \'\'; // The above code was causing a memory error because everything was being stored, backtrace is not necessary\r\n	\r\n	gather_error_info($lasterror, false, $trace, false);\r\n	\r\n	// Get the last error in PHP\r\n	//$lasterror = error_get_last();\r\n	\r\n	// For the error to be thrown\r\n	//throw new ErrorException($lasterror[\'message\'], $lasterror[\'type\'], 0, addslashes($lasterror[\'file\']), $lasterror[\'line\']);\r\n	return false;\r\n}\r\n\r\nfunction cms_show_error()\r\n{\r\n	$errormsg = \'\';\r\n	\r\n	if (isset($_SESSION[\'error\']))\r\n	{\r\n		$qry = \"INSERT INTO log_error (userid,error_time,error_details) VALUES (1,CURRENT_TIMESTAMP,?)\";\r\n		$params = array($_SESSION[\'error\']);\r\n		$result = query_execute($qry, $params);\r\n	\r\n		$etime = $_SESSION[\'error\'];\r\n		unset($_SESSION[\'error\']);\r\n		if (isset($_SESSION[\'errortop\'])) unset($_SESSION[\'errortop\']);\r\n	\r\n		$errormsg = \'\';\r\n		if (isGroupMember(1))\r\n		{\r\n	\r\n			$errormsg = <<< OUTPUT\r\n	\r\n<!--User Popup-->\r\n	<div id=\'PopUpError\'>\r\n\r\n	<h2 style=\"border: none;\">Error Message</h2>	\r\n	<p>{$etime}</p> \r\n		<div style=\'text-align: right;\'>\r\n			<a onmouseover=\'this.style.cursor=\"pointer\" \' onfocus=\'this.blur();\' onclick=\"document.getElementById(\'PopUpError\').style.display = \'none\' \" >\r\n				<p type=\"psulink\">Close</p>\r\n			</a>\r\n		</div>\r\n	</div>\r\n<!--User Popup-->\r\n\r\nOUTPUT;\r\n		}\r\n	}\r\n	return $errormsg;\r\n}\r\n	\r\nfunction gather_error_info($e, $sql, $trace, $show_user_output=false)\r\n{\r\n	// Set all the error information to a session variable called error		\r\n	// Only show safe information that won\'t harm the server\r\n	$slim = true;\r\n				\r\n	$errorout = \'\';\r\n\r\n	// Only output the previous error message heading\r\n	if (isset($_SESSION[\'errortop\'])) $errorout .= $_SESSION[\'errortop\'];\r\n	\r\n	$eredirect = false;\r\n\r\n	if ($sql)\r\n	{\r\n		// Show the basic error message\r\n		$errorout .= \"<b><u>Database Error</u></b>\";\r\n		$errorout .= \"<br />\";\r\n		\r\n		$errorout .= $e->getMessage();\r\n	}\r\n	else\r\n	{\r\n		// Show the basic error message\r\n		$errorout .= \"<b><u>Website Error</u></b>\";\r\n		$errorout .= \"<br />\";\r\n		\r\n		$econstant = \'\';\r\n		$edscription = \'\';\r\n\r\n		switch ($e->getCode())\r\n		{\r\n			case 1:\r\n				$econstant = \"FATAL\";\r\n				$edescription = \"Fatal run-time error. Execution of the script is halted.\";\r\n				$eredirect = true;\r\n				break;\r\n			case 2:\r\n				$econstant = \"WARNING\";\r\n				$edescription = \"Non-fatal run-time error. Execution of the script is not halted.\";\r\n				break;\r\n			case 4:\r\n				$econstant = \"PARSE\";\r\n				$edescription = \"Compile-time parse errors. Parse errors should only be generated by the parser.\";\r\n				break;\r\n			case 8:\r\n				$econstant = \"NOTICE\";\r\n				$edescription = \"Run-time notice. The script found something that might be an error, but could also happen when running a script normally.\";\r\n				break;\r\n			case 16:\r\n				$econstant = \"CORE_ERROR\";\r\n				$edescription = \"Fatal errors that occur during PHP\'s initial startup.\";\r\n				$eredirect = true;\r\n				break;\r\n			case 32:\r\n				$econstant = \"CORE_WARNING\";\r\n				$edescription = \"Warnings (non-fatal errors) that occur during PHP\'s initial startup.\";\r\n				break;\r\n			case 64:\r\n				$econstant = \"COMPILE_ERROR\";\r\n				$edescription = \"Fatal compile-time errors.\";\r\n				$eredirect = true;\r\n				break;\r\n			case 128:\r\n				$econstant = \"COMPILE_WARNING\";\r\n				$edescription = \"Compile-time warnings (non-fatal errors).\";\r\n				break;\r\n			case 256:\r\n				$econstant = \"USER_ERROR\";\r\n				$edescription = \"Fatal user-generated error. This is like an E_ERROR set by the programmer using the PHP function trigger_error().\";\r\n				$eredirect = true;\r\n				break;\r\n			case 512:\r\n				$econstant = \"USER_WARNING\";\r\n				$edescription = \"Non-fatal user-generated warning. This is like an E_WARNING set by the programmer using the PHP function trigger_error().\";\r\n				break;\r\n			case 1024:\r\n				$econstant = \"USER_NOTICE\";\r\n				$edescription = \"User-generated notice. This is like an E_NOTICE set by the programmer using the PHP function trigger_error().\";\r\n				break;\r\n			case 2048:\r\n				$econstant = \"STRICT\";\r\n				$edescription = \"Suggested changes to code which will ensure the best interoperability and forward compatibility of your code..\";\r\n				break;\r\n			case 4096:\r\n				$econstant = \"RECOVERABLE_ERROR\";\r\n				$edescription = \"Catchable fatal error. This is like an E_ERROR but can be caught by a user defined handle (see also set_err or_handler()).\";\r\n				break;\r\n			case 8191:\r\n				$econstant = \"DEPRECATED\";\r\n				$edescription = \"Run-time notices. Warnings about code that will not work in future versions.\";\r\n				break;\r\n			case 16384:\r\n				$econstant = \"USER_DEPRECATED\";\r\n				$edescription = \"User-generated warning message.\";\r\n				break;\r\n			case 32767:\r\n				$econstant = \"ALL\";\r\n				$edescription = \"All errors and warnings, as supported, except of level E_STRICT prior to PHP 5.4.0.\";\r\n				break;\r\n			default:\r\n				$econstant = \"ERROR\";\r\n				$edescription = \"Problem with code.\";\r\n		}\r\n		\r\n		//$errorout .= print_array($e);\r\n		$errorout .= \"<b>\".$econstant.\":</b> \".$e->getMessage();\r\n		$errorout .= \"<br />\";\r\n		$errorout .= \'<b>\'.$e->getFile().\'</b> on line <b>\'.$e->getLine().\'</b>\';\r\n		//$errorout .= \"<br />\";\r\n		//$errorout .= \'<b>Notice:</b> \'.$edescription;\r\n	}\r\n	\r\n	$errorout .= \"<br />\";\r\n	//$errorout .= \"<br />\";\r\n	\r\n	// Save the current error message (without all the crap below)\r\n	$_SESSION[\'errortop\'] = $errorout;\r\n	\r\n	// Show every step to get to the error message\r\n	//$errorout .= \"<b><u>Backtrace</u></b>\";\r\n	//$errorout .= \"<br />\";\r\n	//$errorout .= addslashes($trace);\r\n	$errorout .= htmlentities($trace, ENT_QUOTES, \"UTF-8\");\r\n\r\n	//$errorout .= \"<pre>\";\r\n	//$errorout .= debug_backtrace();\r\n	//$errorout .= \"</pre>\";\r\n	\r\n	//$errorout .= array_walk(debug_backtrace(),create_function(\'$a,$b\',\'print \"{$a[\\\'function\\\']}()(\".basename($a[\\\'file\\\']).\":{$a[\\\'line\\\']}); \";\'));\r\n	//$errorout .= array_walk( debug_backtrace(), create_function( \'$a,$b\', \'print \"<br /><b>\". basename( $a[\\\'file\\\'] ). \"</b> &nbsp; <font color=\\\"red\\\">{$a[\\\'line\\\']}</font> &nbsp; <font color=\\\"green\\\">{$a[\\\'function\\\']} ()</font> &nbsp; -- \". dirname( $a[\\\'file\\\'] ). \"/\";\' ) );\r\n	//$errorout .= print_array(debug_backtrace());\r\n	//$errorout .= \"<br />\";\r\n	\r\n	// Save the current error message (without all the crap below)\r\n	//$_SESSION[\'errortop\'] = htmlentities($errorout, ENT_QUOTES, \"UTF-8\");\r\n	$_SESSION[\'errortop\'] = $errorout;\r\n	\r\n	//$errorout .= \"<br />\";\r\n	\r\n	//$errorout .= \"<b><u>Additional Information</u></b>\";\r\n	//$errorout .= \"<br />\";\r\n	$errorout .= \'<h4>Additional Information</h4>\';\r\n	\r\n	// Only uncomment this when testing with CMDline\r\n	//echo $trace;\r\n	\r\n	if (isset($_SERVER[\'REMOTE_ADDR\']))\r\n	{\r\n		$user_agent = \'Not specified\';\r\n		if (isset($_SERVER[\'HTTP_USER_AGENT\'])) $user_agent = $_SERVER[\'HTTP_USER_AGENT\'];\r\n\r\n		$errorout .= \"<b>Remote Address:</b> \".$_SERVER[\'REMOTE_ADDR\'];$errorout .= \"<br />\";\r\n		$errorout .= \"<b>Browser:</b> \".$user_agent;$errorout .= \"<br />\";\r\n		\r\n		if (isset($_SERVER[\'HTTP_REFERER\'])) $errorout .= \"<b>Previous Page:</b> \".$_SERVER[\'HTTP_REFERER\'];$errorout .= \"<br />\";\r\n		\r\n		$errorout .= \"<b>Query:</b> \".$_SERVER[\'QUERY_STRING\'];$errorout .= \"<br />\";\r\n		$errorout .= \"<b>Method:</b> \".$_SERVER[\'REQUEST_METHOD\'];$errorout .= \"<br />\";\r\n		$errorout .= \"<b>PHP File:</b> \".$_SERVER[\'PHP_SELF\'];$errorout .= \"<br />\";\r\n		$errorout .= \"<b>PHP Script:</b> \".$_SERVER[\'SCRIPT_NAME\'];$errorout .= \"<br />\";\r\n		$errorout .= \"<b>URI:</b> \".$_SERVER[\'REQUEST_URI\'];$errorout .= \"<br />\";\r\n		$errorout .= \"<b>Protocol:</b> \".$_SERVER[\'SERVER_PROTOCOL\'];$errorout .= \"<br />\";\r\n		$errorout .= \"<br />\";\r\n		\r\n		// These didn\'t output anything for me\r\n		/*$errorout .= $php_errormsg;\r\n		$errorout .= $HTTP_RAW_POST_DATA;\r\n		$errorout .= $http_response_header;\r\n		$errorout .= $argc;\r\n		$errorout .= $argv;*/\r\n	}\r\n	\r\n	if (!empty($_SESSION))\r\n	{\r\n		$errorout .= \"<b><u>Session</u></b>\";\r\n		ob_start();\r\n		$errorout .= print_array(print_array_better($_SESSION));\r\n		$errorout .= ob_get_contents();\r\n		ob_end_clean();\r\n		$errorout .= \"<br />\";\r\n	}\r\n\r\n	if (!empty($_POST))\r\n	{\r\n		$errorout .= \"<b><u>Post</u></b>\";\r\n		ob_start();\r\n		$errorout .= print_array($_POST);\r\n		$errorout .= ob_get_contents();\r\n		ob_end_clean();\r\n		$errorout .= \"<br />\";\r\n	}\r\n	\r\n	if (!empty($_GET))\r\n	{\r\n		$errorout .= \"<b><u>Get</u></b>\";\r\n		ob_start();\r\n		$errorout .= print_array($_GET);\r\n		$errorout .= ob_get_contents();\r\n		ob_end_clean();\r\n		$errorout .= \"<br />\";\r\n	}\r\n	\r\n	if (!$slim)\r\n	{\r\n		if (!empty($_ENV))\r\n		{\r\n			$errorout .= \"<b><u>Environment</u></b>\";\r\n			ob_start();\r\n			print_array($_ENV);\r\n			$errorout .= ob_get_contents();\r\n			ob_end_clean();\r\n			$errorout .= \"<br />\";\r\n		}\r\n		\r\n		if (!empty($_COOKIE))\r\n		{\r\n			$errorout .= \"<b><u>Cookie</u></b>\";\r\n			ob_start();\r\n			print_array($_COOKIE);\r\n			$errorout .= ob_get_contents();\r\n			ob_end_clean();\r\n			$errorout .= \"<br />\";\r\n		}\r\n		\r\n		if (!empty($_REQUEST))\r\n		{\r\n			$errorout .= \"<b><u>Request</u></b>\";\r\n			ob_start();\r\n			print_array($_REQUEST);\r\n			$errorout .= ob_get_contents();\r\n			ob_end_clean();\r\n			$errorout .= \"<br />\";\r\n		}\r\n		\r\n		if (!empty($_SERVER))\r\n		{\r\n			$errorout .= \"<b><u>Server</u></b>\";\r\n			ob_start();\r\n			print_array($_SERVER);\r\n			$errorout .= ob_get_contents();\r\n			ob_end_clean();\r\n			$errorout .= \"<br />\";\r\n		}\r\n	}\r\n	\r\n	// Remove the characters that javascript doesn\'t like\r\n	$errorout = str_replace(\"\'\",\"\", $errorout);\r\n	$errorout = str_replace(\"\\\"\",\"\", $errorout);\r\n	$errorout = str_replace(\"\\n\",\"<br />\", $errorout);\r\n	\r\n	$cdate = date_create();\r\n	date_timezone_set($cdate, timezone_open(\'US/Eastern\'));\r\n	$cdate2 = date_format($cdate, \'M d, Y \\a\\t h:i A\');\r\n	\r\n	// Save the good information for the server\r\n	$_SESSION[\'error\'] = $errorout.\"<br /><b>Generated:</b> $cdate2<br /><br />\";\r\n	\r\n	file_put_contents(CMS_ERROR_PHP, $_SESSION[\'error\'].\'<hr><br />\', FILE_APPEND);\r\n\r\n	// If there is a fatal error, redirect immediately\r\n	if ($eredirect)\r\n	{\r\n		// If there are 2 fatal errors in a row, redirect to a page_not_found\r\n		if (isset($_SESSION[\'error_loop\']) && $_SESSION[\'error_loop\']>2) { header(\"location: /page_not_found&loop\"); exit; }\r\n\r\n		if (isset($_SESSION[\'error_loop\'])) $_SESSION[\'error_loop\'] += 1;\r\n		else $_SESSION[\'error_loop\'] = 1;\r\n\r\n		header(\"location: index.php\");\r\n		exit;\r\n	}\r\n\r\n	//msg_user(\"You found a bug!\",\"Calling in the bug squisher now. Please try again later.\");\r\n}\r\n\r\n/* ************************* Array Handlers ************************** */\r\n\r\nfunction print_array_better($ar)\r\n{\r\n	$new = $ar;\r\n	if (isset($new[\'error\'])) unset($new[\'error\']);\r\n	if (isset($new[\'errortop\'])) unset($new[\'errortop\']);\r\n	return $new;\r\n}\r\n\r\nfunction print_array($out)\r\n{\r\n	// Output the array in a pretty format\r\n	$output = \'<pre>\';\r\n	ob_start();\r\n	print_r($out);\r\n	$output .= htmlentities(ob_get_contents(), ENT_QUOTES, \"UTF-8\");\r\n	ob_end_clean();	\r\n	$output .= \"</pre>\";\r\n	return $output;\r\n}\r\n\r\n// Function to enable clean logging of MySQL change queries\r\nfunction print_array_mysql($out)\r\n{\r\n	// Output the array in a database safe format\r\n	$output = \'\';\r\n	ob_start();\r\n	print_r($out);\r\n	$output .= ob_get_contents();\r\n	ob_end_clean();\r\n	return $output;\r\n}','2012-06-27 00:17:08',2,1,'','','',''),(82,'html_head','$title_page = \'NO TITLE\';\r\n\r\nif (!isset($title) || strlen($title)==0)  $title_page = \'NO TITLE\';\r\nelse if (SITE_TITLE!=$title) $title_page = $title;\r\n\r\n$title = SITE_TITLE;\r\n\r\nif (!isset($keyword) || strlen($keyword)==0) $keyword = SITE_KEYWORDS;\r\nelse if (SITE_KEYWORDS!=$keyword)$keyword = SITE_KEYWORDS.\',\'.$keyword;\r\n\r\nif (!isset($description) || strlen($description)==0) $description = SITE_TAG;\r\n\r\n$update_css = \'?\'.filemtime(\'style/style.css\');\r\n$update_js = \'?\'.filemtime(\'js/javascript.js\');\r\n$update_bootstrap = \'?\'.filemtime(\'inc/bootstrap/css/bootstrap.min.css\');\r\n\r\n$menu_loc = SETTING_NAV_MENU_LOCATION;\r\nif ($menu_loc==\'top\')\r\n{\r\n$pad_top = 60;\r\n$pad_bottom = 40;\r\n}\r\nelse\r\n{\r\n$pad_top = 0;\r\n$pad_bottom = 100;\r\n}\r\n\r\n$html_output2 = <<< OUTPUT\r\n\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\r\n<meta name=\"keywords\" content=\"{$keyword}\" />\r\n<meta name=\"description\" content=\"{$description}\" />\r\n<title>{$title}</title>\r\n<link rel=\"shortcut icon\" href=\"{$constant[\'SITE_FULL\']}/img/logo/favicon.ico\" type=\"image/x-icon\" />\r\n<link rel=\"stylesheet\" type=\"text/css\" media=\"screen\" href=\"/style/style.css{$update_css}\" />\r\n<link rel=\"index\" title=\"{$title}\" href=\"{$constant[\'SITE_FULL\']}\" />\r\n\r\n<script type=\"text/javascript\" src=\"/js/javascript.js{$update_js}\"></script>\r\n<script type=\"text/javascript\" src=\"/js/jquery.js\"></script>\r\n<script type=\"text/javascript\" src=\"/inc/jquery/jquery-ui.min.js\"></script>\r\n\r\n<meta property=\"og:title\" content=\"{$title}\" />\r\n<meta property=\"og:type\" content=\"website\" />\r\n<meta property=\"og:url\" content=\"{$constant[\'SITE_FULL\']}\" />\r\n<meta property=\"og:image\" content=\"{$constant[\'SITE_FULL\']}/img/logo/icon128.png\" />\r\n<meta property=\"og:locale\" content=\"en_US\" />\r\n    \r\n<!-- Update your html tag to include the itemscope and itemtype attributes -->\r\n\r\n<!-- Add the following three tags inside head -->\r\n<meta itemprop=\"name\" content=\"{$title}\" />\r\n<meta itemprop=\"description\" content=\"{$description}\" />\r\n<meta itemprop=\"image\" content=\"{$constant[\'SITE_FULL\']}/img/logo/icon128.png\" />\r\n\r\n<!-- Google Analytics -->\r\n{$constant[\'GOOGLE_ANALYTICS\']}\r\n<!-- Google Analytics -->\r\n\r\n<script src=\"/inc/jquery-linedtextarea/jquery-linedtextarea.js\"></script>\r\n<link href=\"/inc/jquery-linedtextarea/jquery-linedtextarea.css\" type=\"text/css\" rel=\"stylesheet\" />\r\n\r\n<!-- Bootstrap, from Twitter -->\r\n	<!-- Le styles -->\r\n	<link href=\"/inc/bootstrap/css/bootstrap.min.css{$update_bootstrap}\" rel=\"stylesheet\" class=\"simpleswitch\">\r\n	<style>\r\n	body {\r\n        	padding-top: {$pad_top}px; /* 60px to make the container go all the way to the bottom of the topbar */\r\n		padding-bottom: {$pad_bottom}px;\r\n	}\r\n	.sidebar-nav {\r\n	padding: 9px 0;\r\n	}\r\n\r\n	textarea {\r\n		font-family: Menlo, Monaco, Consolas, \"Courier New\", monospace;\r\n	}\r\n\r\n	/* Place the popover on top of the nav bar since the titles are very close */\r\n	.popover { z-index: 1031; }\r\n\r\n	</style>\r\n	<link href=\"/inc/bootstrap/css/bootstrap-responsive.css\" rel=\"stylesheet\">\r\n\r\n	<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->\r\n	<!--[if lt IE 9]>\r\n		<script src=\"http://html5shim.googlecode.com/svn/trunk/html5.js\"></script>\r\n	<![endif]-->\r\n\r\n	<!-- Le fav and touch icons -->\r\n	<!--\r\n	<link rel=\"shortcut icon\" href=\"/inc/bootstrap/ico/favicon.ico\">\r\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"144x144\" href=\"/inc/bootstrap/ico/apple-touch-icon-144-precomposed.png\">\r\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"114x114\" href=\"/inc/bootstrap/ico/apple-touch-icon-114-precomposed.png\">\r\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"72x72\" href=\"/inc/bootstrap/ico/apple-touch-icon-72-precomposed.png\">\r\n	<link rel=\"apple-touch-icon-precomposed\" href=\"/inc/bootstrap/ico/apple-touch-icon-57-precomposed.png\">\r\n	-->\r\n<!-- Bootstrap, from Twitter -->\r\n\r\n<link href=\"/inc/google-code-prettify/prettify.css\" type=\"text/css\" rel=\"stylesheet\" />\r\n<script type=\"text/javascript\" src=\"/inc/google-code-prettify/prettify.js\"></script>\r\n<style>\r\nol.linenums {\r\n	margin: 0 0 0 40px;\r\n}\r\nli.L0,li.L1,li.L2,li.L3,li.L5,li.L6,li.L7,li.L8{list-style-type:inherit;}\r\nimg { vertical-align: text-top; }\r\n</style>\r\n\r\n<!--[if lt IE 7]><div style=\"clear: both; padding:15px;\">You are using an outdated version of Internet Explorer so this website will display incorrectly. Please consider switching to <a href=\"http://www.google.com/chrome\">Google Chrome</a> for a faster and more secure web surfing experience.</div><![endif]-->\r\n\r\nOUTPUT;\r\n\r\n// Need this for the heredoc','2012-07-19 16:02:52',2,1,'','','',''),(83,'style_default','// Maybe declare this global so everyone can use it?\r\n$constant = get_defined_constants();\r\n\r\nif (!function_exists(\'get_bool\'))\r\n{\r\n	// Returns the boolean value of a string\r\n	function get_bool($v)\r\n	{\r\n		if (strlen($v)==5) return false;\r\n		else return true;\r\n	}\r\n}\r\n\r\n$theme_version = (int)SETTING_THEME;\r\n//$enable_sha2dows = get_bool(SETTING_SHA2DOWS);\r\n\r\n/* Light Theme */\r\nif ($theme_version==1 || $theme_version==2) $background_image=\'\';\r\n/* Green Theme */\r\nelse if ($theme_version==3) $background_image = \'background-image:url(\"/img/background/green.png\");\';\r\n/* Dark Theme */\r\nelse if ($theme_version==4) $background_image = \'background-image:url(\"/img/background/field.jpg\");\';\r\n\r\n/* ***************************** Notes and Sources ***************************** */\r\n// class 	= .template\r\n// id		= #template\r\n\r\n// Best place for color matching, web safe colors\r\n// http://www.colorhexa.com/669966\r\n\r\n// Best place to find the real name of colors\r\n// http://www.webdevelopersnotes.com/design/list_of_HTML_color_names.php3\r\n\r\n// Source: http://forums.digitalpoint.com/showthread.php?t=82168 -> Deathshadow\r\n// Use overflow:hidden on a container DIV that contains floats, it prevents the background from covering the text of the content DIVs (see .comment-div)','2012-06-17 05:04:06',2,1,'','','',''),(85,'style_html','/* ****************************************************************************************************************************************\r\n* Global Styles\r\n* div clearing\r\n**************************************************************************************************************************************** */\r\n/* Ensure the DIV completely encompasses the contained content */\r\n.clear		{ clear: both; }\r\n\r\n/* ****************************************************************************************************************************************\r\n* Custom Styles\r\n* Headings, forms, columns (public page), popups, spans (footer and video gallery)\r\n**************************************************************************************************************************************** */\r\n.public	img		{ margin-top: 10px; margin-bottom: 10px; border: dashed 1px silver; }\r\n\r\n#PopUpError	{ overflow: scroll; position: fixed; right: 20px; bottom: 20px; border: 1px solid silver;\r\n			padding: 10px; background-color: white; text-align: justify; width: 500px; height: 300px; }\r\n#PopUpError h2	{ color: black; }\r\n#PopUpError p	{ color: black; }\r\np[type=\"psulink\"] { text-decoration:underline; }\r\n#PopUpNotice	{  position: fixed; right: 20px; bottom: 0px; }\r\n\r\n.three_col	{ -moz-column-count:3; -webkit-column-count:3; column-count:3; }\r\n.two_col	{ -moz-column-count:2; -webkit-column-count:2; column-count:2; }\r\n\r\n.basic_div a	{ text-align: center; text-decoration: none; border: solid 1px silver;\r\n	padding: 10px; font-size: 14px; display: inline-block; margin: 5px; }\r\n\r\n/* ****************************************************************************************************************************************\r\n* Main Styles\r\n* body, containers\r\n**************************************************************************************************************************************** */\r\nbody		{ font: 11px \"proxima-nova-1\",\"proxima-nova-2\",\"Helvetica Neue\",\"Arial\",sans-serif; {$background_image} background-attachment: fixed; }\r\n#content	{ text-align: center; top: 0px; width: 100%; height: 100%;  padding: 10px 0px 10px 0px; position: relative; }\r\n#content_in_0	{ text-align: {$constant[\'SETTING_PAGE_TITLE\']}; padding-bottom: 10px; }\r\n.container	{ text-align: left; }\r\n.container-fluid	{ text-align: left; }','2012-06-21 17:58:58',2,0,'','','',''),(92,'toolkit_control','if (isset($_GET[\'trash\']) && strlen($_GET[\'trash\'])>0)\r\n{\r\n	db_method_trash($_GET[\'trash\']);\r\n	msg_user(\"Trash\",\"Method \".$_GET[\'trash\'].\" moved to the trash!\");\r\n}\r\nelse if (isset($_GET[\'untrash\']) && strlen($_GET[\'untrash\'])>0)\r\n{\r\n	db_method_untrash($_GET[\'untrash\']);\r\n	msg_user(\"Restored from Trash\",\"Method \".$_GET[\'untrash\'].\" restored from the trash!\");\r\n}\r\nelse if (isset($_GET[\'delete\']) && strlen($_GET[\'delete\'])>0 && isset($_GET[\'id\']))\r\n{\r\n	db_method_delete($_GET[\'delete\']);\r\n\r\n	// Delete the method from the access list\r\n	$qry = \"DELETE FROM access_list WHERE method_id=?\";\r\n	$params = array($_GET[\'id\']);\r\n	query_execute($qry, $params);\r\n\r\n	msg_user(\"Deleted from Database\",\"Method \".$_GET[\'delete\'].\" permanently deleted!\");\r\n}\r\nelse if (isset($_GET[\'preview\']) && strlen($_GET[\'preview\'])>0)\r\n{\r\n	$output .= \'<pre class=\"prettyprint linenums\">\';\r\n	\r\n	if (isset($_GET[\'preview_trash\'])) $table = \"php_trash\";\r\n	else  $table = \"php_methods\";\r\n	\r\n	$output .= htmlentities(method_retrieve($_GET[\'preview\'],false,$table));\r\n	$output .= \"</pre>\";\r\n}\r\nelse msg_user(\"Toolkit Control\",\"No valid arguments passed.\");','2012-08-10 22:29:06',2,1,'','Page View','',''),(165,'toolkit_index','if (isset($_GET[\'empty_trash\']))\r\n{\r\n	$output .= <<< OUTPUT\r\n	\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n<p class=\"help-block\">All pages in the trash will be removed permanently.</p>\r\n<button type=\"submit\" name=\"submit\" class=\"btn\" title=\"Click once to empty\">Empty Trash</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n\r\nOUTPUT;\r\n}\r\n\r\n// Show the index page\r\n$index = \'index.php&path=\'.CMS_ROOT;\r\n$define = \'define.php&path=\'.CMS_PHP_SCRIPT;\r\n$sitemap = \'sitemap.xml&path=\'.CMS_ROOT;\r\n$robots = \'robots.txt&path=\'.CMS_ROOT;\r\n$indexinc = \'indexinc.php&path=\'.CMS_HIDDEN;\r\n\r\n/*\r\n$output .= i(\'div\',\'btn-group\',\r\n	a2(\'btn dropdown-toggle\',\'Index\'\r\n	.i(\'span\',\'caret\'),\'#\',\'dropdown\')\r\n	.i(\'ul\',\'dropdown-menu\',\r\n		i(\'li\',\'\',a2(\'\',img(\'Preview\',\'/img/silk/page_white_magnify.png\').\' Preview\',\'toolkit_file_manager&file_view=\'.$index))\r\n		.i(\'li\',\'\',a2(\'\', img(\'Edit\',\'/img/silk/page_white_edit.png\').\' Edit\',\'toolkit_file_manager&file_view=\'.$define))\r\n	)\r\n);\r\n\r\n$output .= i(\'div\',\'btn-group\',\r\n	a2(\'btn dropdown-toggle\',\'Index\'\r\n		.i(\'span\',\'caret\'),\'#\',\'dropdown\')\r\n	.i(\'ul\',\'dropdown-menu\',\r\n	i(\'li\',\'\',a2(\'\',\'Preview\',\'toolkit_file_manager&file_view=\'.$index))\r\n	.i(\'li\',\'\',a2(\'\',\'Edit\',\'toolkit_file_manager&file_view=\'.$define))\r\n\r\n)); */\r\n\r\n$arr = array();\r\narray_push($arr,array($index,\'index.php\',false));\r\narray_push($arr,array($define,\'define.php\',false));\r\narray_push($arr,array($indexinc,\'indexinc.php\',\'<li><a href=\"/recache\">\'.img(\'Recache All Files\',\'/img/silk/vector.png\').\' Recache</a></li>\'));\r\narray_push($arr,array($sitemap,\'sitemap.xml\',\'<li><a href=\"/toolkit_update_sitemap\">\'.img(\'Recreate Sitemap\',\'/img/silk/chart_organisation.png\').\' Recreate</a></li>\'));\r\narray_push($arr,array($robots,\'robots.txt\',false));\r\n\r\n$output .= \'<h3>External Files (\'.count($arr).\'):</h3>\';\r\n\r\n$output .= \'<div class=\"btn-toolbar well\">\';\r\n\r\n$img1 = img(\'Preview\',\'/img/silk/page_white_magnify.png\');\r\n$img2 = img(\'Edit\',\'/img/silk/page_white_edit.png\');\r\n\r\nforeach($arr as $row)\r\n{\r\n$output .= <<< OUTPUT\r\n	<div class=\"btn-group\">\r\n	<a class=\"btn dropdown-toggle\" data-toggle=\"dropdown\" href=\"#\">{$row[1]}<span class=\"caret\"></span></a>\r\n	<ul class=\"dropdown-menu\">\r\n		<li><a href=\"index.php?toolkit_file_manager&file_view={$row[0]}\">{$img1} Preview</a></li>\r\n		<li><a href=\"index.php?toolkit_file_manager&file_edit={$row[0]}\">{$img2} Edit</a></li>\r\nOUTPUT;\r\n	if ($row[2]) $output .= $row[2];\r\n	$output .= \'</ul></div>\';\r\n}\r\n$output .= \'</div>\';\r\n\r\n// Show all the methods not in the Trash\r\n$arr = db_method_list();\r\n\r\n$count_critical = 0;\r\n$count_normal = 0;\r\n$count_toolkit = 0;\r\n\r\n$output_critical = \'\';\r\n$output_normal = \'\';\r\n$output_toolkit = \'\';\r\n\r\nforeach($arr as $element)\r\n{\r\n	$name = $element[\'name\'];\r\n\r\n	$output_current = \'<div class=\"btn-group\">\';\r\n\r\n	if (strpos($name,\'cms_\')===0\r\n	|| strpos($name,\'hlp_\')===0\r\n	|| strpos($name,\'db_\')===0\r\n	|| strpos($name,\'html_\')===0\r\n	|| strpos($name,\'div_\')===0\r\n	|| strpos($name,\'script_\')===0\r\n	|| strpos($name,\'style_\')===0)\r\n	{\r\n	$output_current .= \'<a class=\"btn btn-danger dropdown-toggle\" data-toggle=\"dropdown\" href=\"#\">\'.$name.\'<span class=\"caret\"></span></a><ul class=\"dropdown-menu\">\';\r\n	// Output the method name, edit, delete\r\n	$output_current .= \'<li>\'.a(img(\'Preview\',\'/img/silk/page_white_magnify.png\').\' Preview\', \'toolkit_control&preview=\'.$element[\'name\']).\'</li>\';\r\n	$output_current .= \'<li>\'.a(img(\'Edit\',\'/img/silk/page_white_edit.png\').\' Edit\', \'toolkit_edit_method=\'.$element[\'name\']).\'</li>\';\r\n\r\n		$count_critical+=1;\r\n		$output_critical .= $output_current.\'</ul></div>\'.NEWLINE.\'<div class=\"clear\"></div>\';//.\" \".$name.br();\r\n	}\r\n	else\r\n	{\r\n		if (strpos($element[\'name\'],\'toolkit_\')===0)\r\n		{\r\n			$output_current .= \'<a class=\"btn btn-info\" href=\"\'.$name.\'\">\'.$name.\'</a><a class=\"btn btn-info dropdown-toggle\" data-toggle=\"dropdown\" href=\"#\"><span class=\"caret\"></span></a><ul class=\"dropdown-menu\">\';\r\n			// Output the method name, edit, delete\r\n			$output_current .= \'<li>\'.a(img(\'Preview\',\'/img/silk/page_white_magnify.png\').\' Preview\', \'toolkit_control&preview=\'.$element[\'name\']).\'</li>\';\r\n			$output_current .= \'<li>\'.a(img(\'Edit\',\'/img/silk/page_white_edit.png\').\' Edit\', \'toolkit_edit_method=\'.$element[\'name\']).\'</li>\';\r\n	\r\n			// Output the ability to edit with the HTML editor\r\n			//if ($element[\'type\']==0)$output_current .= \'<li>\'.a(img(\'Edit with HTML Editor\',\'/img/silk/page_white_code.png\').\' Edit in HTML Editor\', \'toolkit_html_editor=\'.$element[\'name\'].\'&type=\'.$element[\'type\'].\'&title=\'.$element[\'title\'].\'&keyword=\'.$element[\'keyword\'].\'&description=\'.$element[\'description\']).\'</li>\';\r\n			//else $output_current .= \' <span style=\"width: 16px; display: inline-block;\"></span> \';\r\n	\r\n			// Trash icon\r\n			$output_current .=\'<li>\'.a(img(\'Trash\',\'/img/silk/page_white_database.png\').\' Trash\', \'toolkit_control&trash=\'.$element[\'name\']).\'</li>\';\r\n			$output_current .= \'</ul></div>\';\r\n\r\n			$output_toolkit .= $output_current.NEWLINE.\'<div class=\"clear\"></div>\';//.\" \".$name.br();\r\n			$count_toolkit+=1;\r\n		}\r\n		else\r\n		{\r\n			$output_current .= \'<a class=\"btn btn-success\" href=\"\'.$name.\'\">\'.$name.\'</a><a class=\"btn btn-success dropdown-toggle\" data-toggle=\"dropdown\" href=\"#\"><span class=\"caret\"></span></a><ul class=\"dropdown-menu\">\';\r\n			// Output the method name, edit, delete\r\n			$output_current .= \'<li>\'.a(img(\'Preview\',\'/img/silk/page_white_magnify.png\').\' Preview\', \'toolkit_control&preview=\'.$element[\'name\']).\'</li>\';\r\n			$output_current .= \'<li>\'.a(img(\'Edit\',\'/img/silk/page_white_edit.png\').\' Edit\', \'toolkit_edit_method=\'.$element[\'name\']).\'</li>\';\r\n	\r\n			// Output the ability to edit with the HTML editor\r\n			//if ($element[\'type\']==0)$output_current .= \'<li>\'.a(img(\'Edit with HTML Editor\',\'/img/silk/page_white_code.png\').\' Edit in HTML Editor\', \'toolkit_html_editor=\'.$element[\'name\'].\'&type=\'.$element[\'type\'].\'&title=\'.$element[\'title\'].\'&keyword=\'.$element[\'keyword\'].\'&description=\'.$element[\'description\']).\'</li>\';\r\n			//else $output_current .= \' <span style=\"width: 16px; display: inline-block;\"></span> \';\r\n	\r\n			// Trash icon\r\n			$output_current .=\'<li>\'.a(img(\'Trash\',\'/img/silk/page_white_database.png\').\' Trash\', \'toolkit_control&trash=\'.$element[\'name\']).\'</li>\';\r\n			$output_current .= \'</ul></div>\';\r\n\r\n			$output_normal .= $output_current.NEWLINE.\'<div class=\"clear\"></div>\';//.\" \".$name.br();\r\n			$count_normal+=1;\r\n		}\r\n	}\r\n}\r\n\r\n$output .= \'<div class=\"clear\"></div><h3>Core Pages (\'.$count_critical.\'):</h3>\';\r\n$output .= \'<div class=\"btn-toolbar\">\';\r\n$arr = explode(NEWLINE,$output_critical);\r\narray_pop($arr);\r\n$num_per_column = ceil($count_critical/3);\r\nfor($i=0;$i<count($arr);$i+=$j)\r\n{\r\n	$output .= \'<div class=\"span4 well\">\';\r\n	for($j=0;$j<$num_per_column;$j++)\r\n	{\r\n		$num = $j+$i;\r\n		if (isset($arr[$num])) $output .= $arr[$num];\r\n	}\r\n	$output .= \'</div>\';\r\n}\r\n$output .= \'</div>\';\r\n\r\n$output .= \'<div class=\"clear\"></div><h3>Toolkit Pages (\'.$count_toolkit.\'):</h3>\';\r\n$output .= \'<div class=\"btn-toolbar\">\';\r\n$arr = explode(NEWLINE,$output_toolkit);\r\narray_pop($arr);\r\n$num_per_column = ceil($count_toolkit/3);\r\nfor($i=0;$i<count($arr);$i+=$j)\r\n{\r\n	$output .= \'<div class=\"span4 well\">\';\r\n	for($j=0;$j<$num_per_column;$j++)\r\n	{\r\n		$num = $j+$i;\r\n		if (isset($arr[$num])) $output .= $arr[$num];\r\n	}\r\n	$output .= \'</div>\';\r\n}\r\n$output .= \'</div>\';\r\n\r\n$output .= \'<div class=\"clear\"></div><h3>Additional Pages (\'.$count_normal.\'):</h3>\';\r\n$output .= \'<div class=\"btn-toolbar\">\';\r\n$arr = explode(NEWLINE,$output_normal);\r\narray_pop($arr);\r\n$num_per_column = ceil($count_normal/3);\r\nfor($i=0;$i<count($arr);$i+=$j)\r\n{\r\n	$output .= \'<div class=\"span4 well\">\';\r\n	for($j=0;$j<$num_per_column;$j++)\r\n	{\r\n		$num = $j+$i;\r\n		if (isset($arr[$num])) $output .= $arr[$num];\r\n	}\r\n	$output .= \'</div>\';\r\n}\r\n$output .= \'</div>\';\r\n\r\n// Show all the methods in the Trash\r\n$arr = db_method_list_trash();\r\n\r\nif (!empty($arr))\r\n{\r\n	$output .= \'<div class=\"clear\"></div><h3>Trash (\'.count($arr).\'):</h3>\';\r\n	\r\n	$output .= \'<div class=\"btn-toolbar well\">\';\r\n$img1 = img(\'Preview\',\'/img/silk/page_white_magnify.png\');\r\n$img2 = img(\'Reuse\',\'/img/silk/page_white_get.png\');\r\n$img3 = img(\'Delete\',\'/img/silk/page_white_delete.png\');\r\n$img4 = img(\'Empty All Trash\',\'/img/silk/page_white_delete.png\');\r\n	foreach($arr as $row)\r\n	{\r\n	$output .= <<< OUTPUT\r\n		<div class=\"btn-group\">\r\n		<a class=\"btn btn-warning dropdown-toggle\" data-toggle=\"dropdown\" href=\"#\">{$row[\'name\']}<span class=\"caret\"></span></a>\r\n		<ul class=\"dropdown-menu\">\r\n			<li><a href=\"index.php?toolkit_control&preview={$row[\'name\']}&preview_trash\">{$img1} Preview</a></li>\r\n			<li><a href=\"index.php?toolkit_control&untrash={$row[\'name\']}\">{$img2} Reuse</a></li>\r\n			<li><a href=\"index.php?toolkit_control&delete={$row[\'name\']}&id={$row[\'id\']}\">{$img3} Delete</a></li>\r\n			<li><a href=\"index.php?toolkit_index&empty_trash\">{$img4} Empty All Trash</a></li>\r\nOUTPUT;\r\n		$output .= \'</ul></div>\';\r\n	}\r\n	$output .= \'</div>\';\r\n}','2012-07-22 02:03:25',2,1,'if (isset($_GET[\'empty_trash\']))\r\n{\r\n	$qry = \"DELETE FROM php_trash\";\r\n	$params = array();\r\n	$success = query_execute($qry, $params);\r\n	if ($success) msg_user(\'Trash\',\'Trash empty successfully\');\r\n	else msg_user(\'Trash\',\'Trash empty failed\');\r\n}','Web Toolkit','',''),(159,'toolkit_add_method','if (isset($_GET[\'html\']))\r\n{\r\n	// Create a new method and then open the edit HTML form\r\n	$method_name = \'Page_name_goes_here\'.rand();\r\n	db_method_add($method_name,\'Design your webpage here!\', 0);\r\n	header(\"Location: index.php?toolkit_html_editor=\".$method_name.\'&type=0&title=Page Title&keyword=keywords,go,here&description=Description goes here\');\r\n}\r\nelse\r\n{\r\n	// Create a new method and then open the edit form\r\n	$method_name = \'z_PageNameHere_\'.rand();\r\n	db_method_add($method_name,\'\', 0);\r\n	header(\"Location: index.php?toolkit_edit_method=\".$method_name);\r\n}','2012-07-17 03:37:09',2,1,'','','',''),(103,'access_login','if (isset($_GET[\'logout\']))\r\n{\r\n	// Prevent multiple logouts\r\n	if (!isset($_SESSION[\'id\']))\r\n	{\r\n		msg_user(\"Goodbye\",\"You already logged out.\");\r\n		return;\r\n	}\r\n	\r\n	unset($_SESSION);\r\n	session_destroy();\r\n	session_start();\r\n	msg_user(\"Goodbye\",\"You successfully logged out.\");\r\n}\r\nelse\r\n{\r\n	// Prevent multiple logins\r\n	if (isset($_SESSION[\'id\']))\r\n	{\r\n		msg_user(\"Welcome\",\"You already logged in.\");\r\n		return;\r\n	}\r\n	else\r\n	{\r\n	\r\n\r\n	$qry = \"SELECT locked FROM visitor_info WHERE ip=? LIMIT 1\";\r\n	$params = array($_SERVER[\'REMOTE_ADDR\']);\r\n	$result = query($qry, $params);\r\n\r\n	if ($result && $result[0][\'locked\']==1) die(\'Too many login attempts. Your IP address was logged: \'.$_SERVER[\'REMOTE_ADDR\']);\r\n\r\n	$output .= <<< OUTPUT\r\n\r\n<div class=\"row-fluid\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateLoginForm()\" method=\"post\" action=\"index.php?access_login\">\r\n<label>Username:</label><input class=\"span12\" type=\"text\" id=\"user\" name=\"user\" value=\"\" placeholder=\"\"/>\r\n<label>Password:</label><input class=\"span12\" type=\"password\" id=\"pass\" name=\"pass\" value=\"\" placeholder=\"case sensitive\"/>\r\n<p class=\"help-block\">Unauthorized access is prohibited. All logon attempts are tracked.</p>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to login\">Login</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n\r\n<script>document.getElementById(\"user\").focus();</script>\r\n\r\nOUTPUT;\r\n	\r\n	}\r\n}','2012-06-17 18:34:31',2,1,'if (!isset($_POST[\'user\']) || !isset($_POST[\'pass\'])) die(\'Bad HACKER!\');\r\n\r\n$qry = \"SELECT id,username,email,total_login FROM access_user WHERE username=? AND password=? LIMIT 1\";\r\n$params = array(secure_username($_POST[\'user\']),secure_password($_POST[\'user\'],$_POST[\'pass\']));\r\n$result = query($qry, $params);\r\n\r\nif (count($result)==1)\r\n{\r\n	session_regenerate_id(true);\r\n	$userid = $result[0][\'id\'];\r\n	//$last_login = date(\'c\',time());\r\n\r\n	//$_SESSION[\'access_level\'] = $result[0][\'access_level\'];\r\n	//$_SESSION[\'started\'] = $result[0][\'last_login\'];\r\n	$_SESSION[\'email\'] = $result[0][\'email\'];\r\n	$_SESSION[\'username\'] = $result[0][\'username\'];\r\n	$_SESSION[\'id\'] = $result[0][\'id\'];\r\n\r\n	if ($result[0][\'total_login\']==0)\r\n	{\r\n		$first = \',first_login=CURRENT_TIMESTAMP\';\r\n	}else $first = \'\';\r\n\r\n	$qry = \"UPDATE access_user SET last_login=CURRENT_TIMESTAMP, total_login=total_login+1 $first WHERE id=? LIMIT 1\";\r\n	$params = array($_SESSION[\'id\']);\r\n	query_execute($qry, $params);\r\n\r\nif (isset($_SERVER[\'HTTP_REFERER\'])) $page = \'<a href=\"\'.$_SERVER[\'HTTP_REFERER\'].\'\">Continue to desired page</a>\';\r\nelse $page = \'\';\r\n\r\n	if (isset($_SESSION[\'attempts\'])) unset($_SESSION[\'attempts\']);\r\n\r\n	$qry = \"DELETE FROM visitor_info WHERE ip=? LIMIT 1\";\r\n	$params = array($_SERVER[\'REMOTE_ADDR\']);\r\n	query_execute($qry, $params);\r\n\r\n	msg_user(\"Welcome\",\"You successfully logged in! \".$page);\r\n}\r\nelse\r\n{\r\n	if (isset($_SESSION[\'attempts\'])) $_SESSION[\'attempts\']+=1;\r\n	else $_SESSION[\'attempts\']=1;\r\n\r\n	$qry = \"SELECT attempts FROM visitor_info WHERE ip=? LIMIT 1\";\r\n	$params = array($_SERVER[\'REMOTE_ADDR\']);\r\n	$result = query($qry, $params);\r\n\r\n	if ($result)\r\n	{\r\n		$qry = \"UPDATE visitor_info SET attempts=attempts+1, locked=? WHERE ip=? LIMIT 1\";\r\n		$params = array(($result[0][\'attempts\']>4 ? 1 : 0),$_SERVER[\'REMOTE_ADDR\']);\r\n		query_execute($qry, $params);\r\n	}\r\n	else\r\n	{\r\n		$qry = \"INSERT INTO visitor_info (ip,attempts,locked) VALUES(?,?,?)\";\r\n		$params = array($_SERVER[\'REMOTE_ADDR\'],1,0);\r\n		query_execute($qry, $params);\r\n	}\r\n\r\n	msg_user(\"Login Failed\",\"Username and password invalid! Attempt: \".$_SESSION[\'attempts\'],\"index.php?access_login\");\r\n}','Login','',''),(138,'toolkit_error_log','$qry = \"SELECT error_details,error_time,id FROM log_error ORDER BY id DESC\";\r\n$params = array();\r\n$result = query($qry, $params);\r\n\r\n$return=\'\';\r\n\r\nforeach($result as $row)\r\n{\r\n	// Output the id and name from SQL\r\n	$id = $row[\'id\'];\r\n	\r\n	$frm = <<< OUTPUT\r\n	<div class=\"row-fluid\">\r\n	<form class=\"well\" method=\"post\">\r\n	<input type=\"hidden\" id=\"delete\" name=\"delete\" value=\"{$id}\"/>\r\n	<button type=\"submit\" class=\"btn\" title=\"Click once to delete the error\">Delete</button><br /><br />\r\n	{$row[\'error_details\']}\r\n	</form>\r\n	</div>\r\n\r\nOUTPUT;\r\n\r\n	$return.=$frm;\r\n}\r\n\r\n$output .= \"<p>Total Number of Errors: \".count($result).\"</p>\";\r\n\r\n$output .= <<< OUTPUT\r\n	<div class=\"row-fluid\">\r\n	<form class=\"well\" method=\"post\">\r\n	<input type=\"hidden\" id=\"deleteall\" name=\"deleteall\" value=\"all\"/>\r\n	<button type=\"submit\" class=\"btn\" title=\"Click once to delete all errors\">Delete All</button>\r\n	</form>\r\n	</div>\r\nOUTPUT;\r\n\r\n$output .= $return;','2012-06-12 04:03:30',2,1,'if (!isset($_POST[\'delete\']) && !isset($_POST[\'deleteall\'])) die(\'Bad HACKER!\');\r\n\r\nif (isset($_POST[\'delete\']))\r\n{\r\n$qry = \"DELETE FROM log_error WHERE id=?\";\r\n$params = array($_POST[\'delete\']);\r\n$result = query_execute($qry, $params);\r\n\r\nmsg_user(\"Log\",\"Error entry deleted!\",\"index.php?toolkit_error_log\");\r\n}\r\n\r\nif (isset($_POST[\'deleteall\']))\r\n{\r\n$qry = \"DELETE FROM log_error\";\r\n$params = array();\r\n$result = query_execute($qry, $params);\r\n\r\nmsg_user(\"Error Log Cleared\",\"All the errors cleared successfully\");\r\n}','Error Log','',''),(107,'misc_notepad','Save any notes here','2012-08-04 06:14:45',2,0,'','','',''),(108,'toolkit_database','if (isset($_GET[\'backup\']))\r\n{\r\n\r\n$size = database_size();\r\n$location = CMS_HIDDEN.DIR_SEP.\"mysql_backup\";\r\n$email = BACKUP_EMAIL;\r\n\r\nif (!IS_WIN_OS) $email_line = \'<br /><b>Email database to:</b> \'.$email.\' <a href=\"/toolkit_site_settings\"><i class=\"icon-pencil\"></i></a>\';\r\nelse $email_line = \'\';\r\n\r\n$output .= <<< OUTPUT\r\n\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" method=\"post\">\r\n<p class=\"help-block\"><b>Backup database to folder:</b> mysql_backup\r\n{$email_line}\r\n<br /><b>Current size:</b> {$size}</p>\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" name=\"backup\" class=\"btn\" title=\"Click once to backup the database\">Backup</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n\r\nOUTPUT;\r\n\r\n}\r\nelse if (isset($_GET[\'restore\']))\r\n{\r\n\r\n	// Get a list of all the backup files\r\n	$files = glob(CMS_HIDDEN.DIR_SEP.\"mysql_backup\".DIR_SEP.\"*.sql\");\r\n\r\n	if (count($files)<1)\r\n	{\r\n		$output .= \'No backup files found.\';\r\n		return;\r\n	}\r\n	// Get the newest file (at the bottom)\r\n	$r = basename($files[count($files)-1]);\r\n\r\n$output .= <<< OUTPUT\r\n\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" method=\"post\">\r\n<p class=\"help-block\"><b>Database will be restored to the latest backup:</b>\r\n</br />{$r}</p>\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" name=\"restore\" class=\"btn\" title=\"Click once to restore the latest database\">Restore</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n\r\nOUTPUT;\r\n\r\n}\r\nelse msg_user(\"Database\",\"Invalid variables passed.\");','2012-08-05 08:05:14',2,1,'function create_zip($files = array(),$destination = \'\',$overwrite = false)\r\n{\r\n\r\n	// If the destination already exists, return false\r\n	if(file_exists($destination) && !$overwrite) return false;\r\n	\r\n	// Add each real file to another array\r\n	$valid_files = array();\r\n	if(is_array($files))\r\n	{\r\n		foreach($files as $file) { if(is_file($file)) $valid_files[] = $file; }\r\n	}\r\n	\r\n	if(count($valid_files)>0)\r\n	{\r\n		// Create the zip\r\n		$zip = new ZipArchive();\r\n		\r\n		// Check permissions\r\n		if($zip->open($destination,$overwrite ? ZIPARCHIVE::OVERWRITE : ZIPARCHIVE::CREATE) !== true) return false;\r\n		\r\n		foreach($valid_files as $file) $zip->addFile($file,str_replace(CMS_ROOT.DIR_SEP,\'\',$file));\r\n		//echo \'The zip archive contains \',$zip->numFiles,\' files with a status of \',$zip->status;\r\n		    \r\n		// Close the zip\r\n		$zip->close();\r\n		    \r\n		// Ensure the file exists\r\n		return file_exists($destination);\r\n	}\r\n	else return false;\r\n}\r\n\r\nif (isset($_GET[\'backup\']))\r\n{\r\n	// Set the date and the file name\r\n	date_default_timezone_set(\'US/Eastern\');\r\n	$d = date(\"Y-m-d_H.i.s\");\r\n	\r\n	// Backup the database\r\n	if (IS_WIN_OS)\r\n	{\r\n		$f = CMS_HIDDEN.DIR_SEP.\"mysql_backup\".DIR_SEP.ucfirst(DB_DATABASE).\"$d.sql\";\r\n		exec(\"\\\"\".MYSQL_BIN.DIR_SEP.\"mysqldump.exe\\\" --user \".DB_WRITE_USERNAME.\" --password=\".DB_WRITE_PASSWORD.\" \".DB_DATABASE.\" > \\\"$f\\\"\");\r\n	}\r\n	else\r\n	{\r\n		$f = CMS_HIDDEN.DIR_SEP.\"mysql_backup\".DIR_SEP.ucfirst(DB_DATABASE).\"$d.sql\";\r\n		exec(\"\\\"mysqldump\\\" --user \".DB_WRITE_USERNAME.\" --password=\".DB_WRITE_PASSWORD.\" \".DB_DATABASE.\" > \\\"$f\\\"\");\r\n	}\r\n	\r\n	// If the file exists, show the user a message\r\n	if (is_file($f))\r\n	{\r\n		$files_arr = array();\r\n		$files_arr[] = $f;\r\n		$files_arr[] = \'index.php\';\r\n		$files_arr[] = CMS_SCRIPT_DEFINE;\r\n		$files_arr[] = CMS_SCRIPT_SETUP;\r\n		$files_arr[] = \'/etc/nginx/conf.d/default.conf\';\r\n		$files_arr[] = \'/etc/php5/cgi/php.ini\';\r\n		$zip = \"FLS$d.zip\";\r\n		create_zip($files_arr, $zip, false);\r\n\r\n		$s = round(filesize($f)/1024,2);\r\n		if (!IS_WIN_OS)\r\n		{\r\n			send_mail(BACKUP_EMAIL,basename($zip),\'Backed Up\',$zip);\r\n			unlink($zip);\r\n			//send_mail(BACKUP_EMAIL,basename(\"index$d.php\"),\'Backed Up\',\'index.php\');\r\n		}\r\n		msg_user(\"Backup\",\"Backup completed successfully: $s KB <br />Path: \".a($f,\'toolkit_file_manager&path=\'.dirname($f)));\r\n	}\r\n	else msg_user(\"Backup\",\"Backup failed!\");\r\n}\r\nelse if (isset($_GET[\'restore\']))\r\n{\r\n	// Get a list of all the backup files\r\n	$files = glob(CMS_HIDDEN.DIR_SEP.\"mysql_backup\".DIR_SEP.\"*.sql\");\r\n\r\n	// Get the newest file (at the bottom)\r\n	$r = $files[count($files)-1];\r\n\r\n	// Set the location for a temp file\r\n	$t = CMS_HIDDEN.DIR_SEP.\"mysql_backup\".DIR_SEP.\'temp.sqlt\';\r\n\r\n	// Restore the database\r\n	if (IS_WIN_OS)\r\n	{\r\n		exec(\"\\\"\".MYSQL_BIN.DIR_SEP.\"mysql.exe\\\" --user \".DB_WRITE_USERNAME.\" --password=\".DB_WRITE_PASSWORD.\" \".DB_DATABASE.\" < \\\"$r\\\"\");\r\n		// Create a temp backup to compare to the restore\r\n		exec(\"\\\"\".MYSQL_BIN.DIR_SEP.\"mysqldump.exe\\\" --user \".DB_WRITE_USERNAME.\" --password=\".DB_WRITE_PASSWORD.\" \".DB_DATABASE.\" > \\\"$t\\\"\");\r\n	}\r\n	else\r\n	{	\r\n		exec(\"\\\"mysql\\\" --user \".DB_WRITE_USERNAME.\" --password=\".DB_WRITE_PASSWORD.\" \".DB_DATABASE.\" < \\\"$r\\\"\");\r\n		// Create a temp backup to compare to the restore\r\n		exec(\"\\\"mysqldump\\\" --user \".DB_WRITE_USERNAME.\" --password=\".DB_WRITE_PASSWORD.\" \".DB_DATABASE.\" > \\\"$t\\\"\");\r\n	}\r\n	\r\n	// Only for testing to see if the newest file is at the bottom of the array\r\n	//echo print_array($files);\r\n	\r\n	// If the original backup and temp backup match, the restore was successful\r\n	if (filesize($t) == filesize($r))\r\n	{\r\n		$s = round(filesize($r)/1024,2);\r\n		\r\n		msg_user(\"Restore\",\"Restore completed successfully: $s KB <br />Path: $r\",\'index.php?recache\');\r\n	}\r\n	else msg_user(\"Restore\",\"Restore failed! A new table may not be included in the latest backup. Please \".a(\'recache\',\'recache\').\" manually.\");\r\n\r\n	// Delete the temp file when done\r\n	if (file_exists($t)) unlink($t);\r\n}','Database Backup and Restore','',''),(223,'toolkit_query','function build_select($val_selected)\r\n{\r\n$select_arr = array();\r\narray_push($select_arr, array(\"TINYINT\",\"1 Byte; -128 to 127(SIGNED) or 0 to 255(UNSIGNED)\",\"tinyint\"));\r\narray_push($select_arr, array(\"SMALLINT\",\"2 Bytes; -32768 to 32767(SIGNED) or 0 to 65535(UNSIGNED)\",\"smallint\"));\r\narray_push($select_arr, array(\"MEDIUMINT\",\"3 Bytes; -8388608 to 8388607(SIGNED) or 0 to 16777215(UNSIGNED)\",\"mediumint\"));\r\narray_push($select_arr, array(\"INT\",\"Same as integer; 4 Bytes; -2147483648 to 2147483647(SIGNED) or 0 to 4294967295(UNSIGNED)\",\"int\"));\r\narray_push($select_arr, array(\"BIGINT\",\"8 Bytes; -9223372036854775808 to 9223372036854775807(SIGNED) or 0 to 18446744073709551615(UNSIGNED)\",\"bigint\"));\r\n		\r\narray_push($select_arr, array(\"DECIMAL\",\"Same as numeric/dec/fixed; Length allowed; Default is (10,0); First number is total number of digits, second number is number of digits after the decimal point\",\"decimal\"));\r\n		\r\narray_push($select_arr, array(\"FLOAT\",\"Same as double precision; 4 Bytes if specified from 0 to 23, 8 Bytes if specified from 24 to 53; Use FLOAT with no limit as best practice\",\"float\"));\r\narray_push($select_arr, array(\"DOUBLE\",\"Same as double precision/real; 8 Bytes; Use DOUBLE with no limit as best practice\",\"double\"));\r\n		\r\narray_push($select_arr, array(\"BIT\",\"Default is 1; Can be 1 to 64\",\"bit\"));\r\n		\r\narray_push($select_arr, array(\"DATE\",\"Stores as YYYY-MM-DD\",\"date\"));\r\narray_push($select_arr, array(\"DATETIME\",\"Stores as YYYY-MM-DD HH:MM:SS\",\"datetime\"));\r\narray_push($select_arr, array(\"TIMESTAMP\",\"Automatically updates on row change; Stores as YYYY-MM-DD HH:MM:SS UTC; Range from 1970-01-01 00:00:01 UTC to 2038-01-19 03:14:07 UTC; Relies on TimeZone \",\"timestamp\"));\r\n		\r\narray_push($select_arr, array(\"TIME\",\"Stores as HH:MM:SS; Range from -838:59:59 to 838:59:59; Must be less than 35 days\",\"time\"));\r\narray_push($select_arr, array(\"YEAR\",\"Default is 4; Stores as YYYY or YY; Specified as either YEAR(4) or YEAR(2)\",\"year\"));\r\n		\r\narray_push($select_arr, array(\"CHAR\",\"Specified as 0 to 255; Removes trailing spaces; Better for MD5s and very short strings\",\"char\"));\r\narray_push($select_arr, array(\"VARCHAR\",\"Specified as 0 to 65535; Better for storing different lengths\",\"varchar\"));\r\n		\r\narray_push($select_arr, array(\"BINARY\",\"Stores in binary unlike CHAR; Specified as 0 to 255; Removes trailing spaces; Better for MD5s and very short binary strings\",\"binary\"));\r\narray_push($select_arr, array(\"VARBINARY\",\"Stores in binary unlike VARCHAR; Specified as 0 to 65535; Better for storing different lengths\",\"varbinary\"));\r\n		\r\narray_push($select_arr, array(\"TINYBLOB\",\"Stored as binary string (byte string); Stores up to 255 bytes; Basically a VARBINARY that can be very large\",\"tinyblob\"));\r\narray_push($select_arr, array(\"BLOB\",\"Stored as binary string (byte string); Stores up to 64KB; Basically a VARBINARY that can be very large; Must specify a length\",\"blob\"));\r\narray_push($select_arr, array(\"MEDIUMBLOB\",\"Stored as binary string (byte string); Stores up to 16MB; Basically a VARBINARY that can be very large\",\"mediumblob\"));\r\narray_push($select_arr, array(\"LONGBLOB\",\"Stored as binary string (byte string); Stores up to 4GB; Basically a VARBINARY that can be very large\",\"longblob\"));\r\n		\r\narray_push($select_arr, array(\"TINYTEXT\",\"Stored as nonbinary string (character string); Stores up to 255 bytes; Basically a VARCHAR that can be very large\",\"tinytext\"));\r\narray_push($select_arr, array(\"TEXT\",\"Stored as nonbinary string (character string); Stores up to 64KB; Basically a VARCHAR that can be very large; Must specify a length\",\"text\"));\r\narray_push($select_arr, array(\"MEDIUMTEXT\",\"Stored as nonbinary string (character string); Stores up to 16MB; Basically a VARCHAR that can be very large\",\"mediumtext\"));\r\narray_push($select_arr, array(\"LONGTEXT\",\"Stored as nonbinary string (character string); Stores up to 4GB; Basically a VARCHAR that can be very large\",\"longtext\"));\r\n\r\n$return = \'\';\r\n\r\n//return print_array($select_arr);\r\n\r\nforeach ($select_arr as $row)\r\n{\r\n	if ($row[2]==$val_selected) $s = \'selected=\"selected\"\';\r\n	else $s = \'\';\r\n	$return .= \'<option \'.$s.\' value=\"\'.$row[0].\'\" title=\"\'.$row[1].\'\">\'.$row[2].\'</option>\'.NEWLINE;\r\n}\r\n\r\nreturn $return;\r\n\r\n}\r\n\r\nfunction qry_tester()\r\n{global $output;\r\n\r\nif (isset($_GET[\'db_qry\']) && strlen($_GET[\'db_qry\'])>0) $qry = $_GET[\'db_qry\'];\r\nelse $qry = \'SELECT id FROM access_user\';\r\n\r\n		$output .= <<< OUTPUT\r\n		\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n		<h3>Query Tester</h3>\r\n		<label>Query:</label><input class=\"span12\" type=\"text\" id=\"qry\" name=\"qry\" value=\"{$qry}\" />\r\n<div class=\"clear\"></div>\r\n		<button class=\"btn\" type=\"submit1\" name=\"submit1\" title=\"Click once to run a view query\">View Results</button>\r\n		<button class=\"btn\" type=\"submit2\" name=\"submit2\" title=\"Click once to run an update query\">Make Change</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n		\r\n		<script>document.getElementById(\"qry\").focus();</script>\r\n\r\nOUTPUT;\r\n}\r\n\r\nfunction col_info($col, $is_key=false)\r\n{\r\n	$tbl = $_GET[\"tbl\"];\r\n\r\n	if (strstr($tbl,\' \')!==false) $qry = \"SHOW FULL COLUMNS FROM `$tbl` WHERE Field=\'$col\'\";\r\n	else $qry = \"SHOW FULL COLUMNS FROM $tbl WHERE Field=\'$col\'\";\r\n	\r\n	$params = array();\r\n	$result = query($qry, $params);\r\n\r\n	$form = \'\';\r\n\r\n	foreach($result as $row)\r\n	{\r\n		if ($row[\'Key\']==\"PRI\") $key = img(\'Primary Key\',\'/img/silk/key.png\');\r\n		else if ($row[\'Key\']==\"UNI\") $key = img(\'Unique\',\'/img/silk/text_underline.png\');\r\n		else $key = \'\';\r\n\r\n		if ($is_key) return \' \'.$key;\r\n\r\n		if (strlen($row[\'Extra\'])>0) $extra = \', \'.$row[\'Extra\'];\r\n		else $extra = \'\';\r\n\r\n		if ($row[\'Null\']==\"NO\") $null = \', NULL not allowed\';\r\n		else $null = \'\';\r\n\r\n		if (strlen($row[\'Default\'])>0) $default = \', Default: \'.htmlentities($row[\'Default\'], ENT_QUOTES, \"UTF-8\");\r\n		else $default =\'\';\r\n\r\n		if (strlen($row[\'Comment\'])>0) $comment = NEWLINE.\'Comment: \'.htmlentities($row[\'Comment\'], ENT_QUOTES, \"UTF-8\");\r\n		else $comment = \'\';\r\n\r\n		if (strlen($row[\'Collation\'])>0) $collation = NEWLINE.\'Collation: \'.htmlentities($row[\'Collation\'], ENT_QUOTES, \"UTF-8\");\r\n		else $collation = \'\';\r\n\r\n		//$form .= \'<p>\'.$row[\'Field\'].\': \'.$key.\' \'.$row[\'Type\'].$null.$extra.\'</p><input type=\"text\" id=\"\'.$row[\'Field\'].\'\" name=\"\'.$row[\'Field\'].\'\" value=\"\'.$default.\'\" />\';\r\n		$form .= $row[\'Type\'].$null.$extra.$default.$collation.$comment;\r\n		//$form .= br().br();\r\n	}\r\n\r\n	return $form;\r\n}\r\n\r\nfunction is_auto_increment($col)\r\n{\r\n	$tbl = $_GET[\"tbl\"];\r\n\r\n	if (strstr($tbl,\' \')!==false) $qry = \"SHOW COLUMNS FROM `$tbl` WHERE Field=\'$col\'\";\r\n	else $qry = \"SHOW COLUMNS FROM $tbl WHERE Field=\'$col\'\";\r\n\r\n	$result = query($qry, array());\r\n\r\n	foreach($result as $row)\r\n	{\r\n		if (strpos($row[\'Extra\'], \'auto_increment\')!==false) return true;\r\n		else return false;\r\n	}\r\n}\r\n\r\nfunction tbl_info($tbl, $format=false)\r\n{\r\n\r\n	if (strstr($tbl,\'.\')!==false)\r\n	{\r\n		$arr = explode(\'.\',$tbl);\r\n		$qry = \"SHOW TABLE STATUS FROM \".$arr[0].\" LIKE \'\".$arr[1].\"\'\";\r\n	}\r\n	else $qry = \"SHOW TABLE STATUS LIKE \'$tbl\'\";\r\n\r\n	// Output the status/info for the table\r\n	//$qry = \"SHOW TABLE STATUS LIKE \'$tbl\'\";\r\n	$result = query($qry,array());\r\n	$return = \'\';\r\n	foreach ($result as $arr){\r\n	foreach ($arr as $key=>$val)\r\n	{\r\n		if ($format) $return .= \"<b>$key:</b> $val\".br();\r\n		else $return .= \"$key: $val\".NEWLINE;\r\n	}}\r\n	return $return;\r\n}\r\n\r\nfunction get_default_charset()\r\n{\r\n	// Output the status/info for the table\r\n	$qry = \"SHOW VARIABLES\";\r\n	$result = query($qry,array());\r\n	foreach ($result as $row)\r\n	{\r\n		if ($row[\'Variable_name\']==\'character_set_database\') return $row[\'Value\'];\r\n	}\r\n}\r\n\r\nfunction tbl_s()\r\n{global $output;\r\n//	$output .= \'<div style=\"text-align:center;\">\';\r\n	$output .= \'<table class=\"table table-striped table-condensed\" style=\"text-align:center;\">\';\r\n}\r\nfunction tbl_e()\r\n{global $output;\r\n//	$output .= \'</div>\';\r\n	$output .= \'</table>\';\r\n}\r\n\r\n$which_table_color = false;\r\n\r\nfunction tr_s()\r\n{global $output;\r\n	global $which_table_color;\r\n	// $output .= \'<div>\';\r\n	if (!$which_table_color) $output .= \'<tr>\';\r\n	else $output .= \'<tr>\';\r\n	$which_table_color = !$which_table_color;\r\n}\r\nfunction tr_e()\r\n{global $output;\r\n//	$output .= \'</div>\';\r\n	$output .= \'</tr>\';\r\n}\r\nfunction th($val)\r\n{global $output;\r\n//	$output .= \'<div>\'.$val.\'</div>\';\r\n	$output .= \'<th>\'.$val.\'</th>\';\r\n}\r\nfunction td($val,$width,$head=false,$icons=\'\')\r\n{global $output;\r\n\r\n$tbl = $_GET[\'tbl\'];\r\n\r\n$overflow = \"overflow: hidden;\";\r\n\r\n	if ($head)\r\n	{\r\n		$info = col_info($val);\r\n		$key = col_info($val, true);\r\n		//$icons = a(img(\'Delete Column\',\'/img/silk/table_column_delete.png\'),\'toolkit_query&tbl=\'.$tbl.\'&col_delete=\'.$val).\" \";\r\n		//$icons .= a(img(\'Edit Column\',\'/img/silk/table_edit.png\'),\'toolkit_query&tbl=\'.$tbl.\'&col_edit=\'.$val).\" \";\r\n\r\n		$children = array();\r\n		array_push($children, array(\'Edit Column\',\'index.php?toolkit_query&tbl=\'.$tbl.\'&col_edit=\'.$val));\r\n		array_push($children, array(\'Delete Column\',\'index.php?toolkit_query&tbl=\'.$tbl.\'&col_delete=\'.$val));\r\n		array_push($children, array(\'Move Left\',\'index.php?toolkit_query&tbl=\'.$tbl.\'&col_left=\'.$val));\r\n		array_push($children, array(\'Move Right\',\'index.php?toolkit_query&tbl=\'.$tbl.\'&col_right=\'.$val));\r\n		array_push($children, array($info,false));\r\n		\r\n$val = <<< OUTPUT\r\n<ul class=\"nav\" style=\"float: inherit; margin-bottom: inherit;\">\r\n	<li class=\"dropdown\" style=\"float: inherit;\">\r\n		<a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\" title=\"{$children[4][0]}\" \r\n		style=\"padding-left: 0px;\">{$val}{$key}<b class=\"caret\"></b></a>\r\n		<ul class=\"dropdown-menu\">\r\n			<li><a href=\"{$children[0][1]}\">{$children[0][0]}</a></li>\r\n			<li><a href=\"{$children[1][1]}\">{$children[1][0]}</a></li>\r\n			<li><a href=\"{$children[2][1]}\">{$children[2][0]}</a></li>\r\n			<li><a href=\"{$children[3][1]}\">{$children[3][0]}</a></li>\r\n		</ul>\r\n	</li>\r\n</ul>\r\nOUTPUT;\r\n		$overflow = \'\';\r\n\r\n	}\r\n	else\r\n	{\r\n		$info = \'\';\r\n		$key = \'\';\r\n\r\n		//$icons = \" \".a(img(\'Delete Row\',\'/img/silk/table_row_delete.png\'),\'toolkit_query&tbl=\'.$tbl.\'&row_delete=\'.$val).\" \";\r\n		//$icons .= a(img(\'Edit Row\',\'/img/silk/table_edit.png\'),\'toolkit_query&tbl=\'.$tbl.\'&row_edit=\'.$val).\" \";\r\n\r\n		if ($icons)\r\n		{\r\n			$children = array();\r\n			array_push($children, array(\'Edit Row\',\'index.php?toolkit_query&tbl=\'.$tbl.\'&row_edit=\'.$val));\r\n			array_push($children, array(\'Delete Row\',\'index.php?toolkit_query&tbl=\'.$tbl.\'&row_delete=\'.$val));\r\n			\r\n$val = <<< OUTPUT\r\n<ul class=\"nav\" style=\"float: inherit; margin-bottom: inherit;\">\r\n	<li class=\"dropdown\" style=\"float: inherit;\">\r\n		<a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\"  \r\n		style=\"padding-left: 0px;\">{$val}{$key}<b class=\"caret\"></b></a>\r\n		<ul class=\"dropdown-menu\">\r\n			<li><a href=\"{$children[0][1]}\">{$children[0][0]}</a></li>\r\n			<li><a href=\"{$children[1][1]}\">{$children[1][0]}</a></li>\r\n		</ul>\r\n	</li>\r\n</ul>\r\nOUTPUT;\r\n			$overflow = \'\';\r\n		}\r\n\r\n	}\r\n\r\n	//if ($icons!=\'\') $left=\'text-align: left;\';\r\n	//else $left = \'\';\r\n\r\n	//$output .= \'<div title=\"\'.$info.\'\" style=\"display: inline-block;padding: 2px 0px 2px 0px;border: 1px black solid; height: 15px; width:\'.$width.\'px; text-overflow: ellipsis; white-space: nowrap; overflow: hidden;\">\'.$icons.$val.$key.\'</div>\';\r\n	//$output .= \'<td style=\"\'.$overflow.\' max-width:\'.$width.\'px; width:\'.$width.\'px; text-overflow: ellipsis; white-space: nowrap;\">\'.$val.\'</td>\';\r\n$output .= \'<td style=\"\'.$overflow.\' max-width:\'.$width.\'px; text-overflow: ellipsis; white-space: nowrap;\">\'.$val.\'</td>\';\r\n}\r\n\r\n// *********************************************** Shows table contents ***********************************************\r\nif (isset($_GET[\'tbl\']))\r\n{\r\n	$tbl = $_GET[\'tbl\'];\r\n\r\n	if (strstr($tbl,\' \')!==false) $tbl_backtick_safe = \"`$tbl`\";\r\n	else $tbl_backtick_safe = $tbl;\r\n\r\n	$output .= a(\'Back to tables\',\'toolkit_query\').br().br();\r\n\r\n	$icons = a(img(\'Delete Table\',\'/img/silk/table_delete.png\'),\'toolkit_query&table_delete&tbl=\'.$tbl).\" \";\r\n	$icons .= a(img(\'Rename Table\',\'/img/silk/table_edit.png\'),\'toolkit_query&table_rename&tbl=\'.$tbl).\" \";\r\n	$icons .= a(img(\'Table Information\',\'/img/silk/table_lightning.png\'),\'toolkit_query&table_info&tbl=\'.$tbl).\" \";\r\n	$icons .= a(img(\'Query Tester\',\'/img/silk/database_gear.png\'),\'toolkit_query&tbl=\'.$tbl.\'&db_qry\').\" \";\r\n	$icons .= a(img(\'Add Column\',\'/img/silk/table_column_insert.png\'),\'toolkit_query&tbl=\'.$tbl.\'&col_add\').\" \";\r\n	$icons .= a(img(\'Add Row\',\'/img/silk/table_row_insert.png\'),\'toolkit_query&tbl=\'.$tbl.\'&row_add\').\" \";\r\n\r\n	$tbl_info = tbl_info($tbl);\r\n	$output .= \"<p title=\'$tbl_info\'><b>Current Table:</b> \".$tbl.\"</p>\".br();\r\n	$output .= $icons.br().br();\r\n\r\n	// *********************************************** Add a table column ***********************************************\r\n	if (isset($_GET[\'col_add\']) || isset($_GET[\'col_edit\']))\r\n	{\r\n\r\n\r\n		$unsigned = false;\r\n		$primary_key = false;\r\n		$unique = false;\r\n		$auto_increment = false;\r\n		$not_null = true;\r\n		$field = \'\';\r\n		$comment = \'\';\r\n		$default = \'\';\r\n		$default_checked = \'\';\r\n		$data_type = \'int\';\r\n		$data_limit = \'\';\r\n\r\n		$use_default_charset = true;\r\n		$default_charset = get_default_charset();\r\n		$charset_checked = \'\';\r\n\r\n		$opt1 = \'Add\';\r\n		$opt2 = \'add\';\r\n		$opt3 = \'Add\';\r\n\r\n		if (isset($_GET[\'col_edit\']))\r\n		{\r\n			$qry = \"SHOW FULL COLUMNS FROM $tbl_backtick_safe WHERE Field=?\";\r\n			\r\n			$params = array($_GET[\'col_edit\']);\r\n			$result = query($qry, $params);\r\n		\r\n			//$output .= print_array($result);\r\n		\r\n			if (strpos($result[0][\'Type\'], \'unsigned\')!==false) $unsigned = true;\r\n			if (strpos($result[0][\'Key\'], \'PRI\')!==false) $primary_key = true;\r\n			if (strpos($result[0][\'Key\'], \'UNI\')!==false) $unique = true;\r\n			if (strpos($result[0][\'Extra\'], \'auto_increment\')!==false) $auto_increment = true;\r\n			if (strpos($result[0][\'Null\'], \'YES\')!==false) $not_null = false;\r\n			$field = $result[0][\'Field\'];\r\n			$comment = $result[0][\'Comment\'];\r\n		\r\n			$default = $result[0][\'Default\'];\r\n			if (strlen($default)>0) $default_checked=\'checked=\"checked\"\';\r\n		\r\n			if (strpos($result[0][\'Type\'], \'(\')!==false)\r\n			{\r\n				$last = strpos($result[0][\'Type\'], \'(\');\r\n				$data_type=substr($result[0][\'Type\'],0,$last);\r\n				$last2 = strpos($result[0][\'Type\'], \')\');\r\n				// Did this funky with the +=1 because the PHP Syntax Check was throwing an error on it, looks better anyways\r\n				$data_limit=substr($result[0][\'Type\'],$last+=1,$last2-$last);\r\n			}\r\n			else $data_type=$result[0][\'Type\'];\r\n\r\n			if (strlen($result[0][\'Collation\'])>0)\r\n			{\r\n				$default_charset = $result[0][\'Collation\'];\r\n				$use_default_charset = false;\r\n				$charset_checked = \'checked=\"checked\"\';\r\n			}\r\n			$opt1 = \'Edit\';\r\n			$opt2 = \'update\';\r\n			$opt3 = \'Update\';\r\n		}\r\n\r\n		$arr = array();\r\n		array_push($arr, array(\"options\",\"UNSIGNED\",\"UNSIGNED - no negatives, only positives\",$unsigned));\r\n		array_push($arr, array(\"options\",\"PRIMARY KEY\",\"PRIMARY KEY - only 1 allowed per table\",$primary_key));\r\n		array_push($arr, array(\"options\",\"UNIQUE\",\"UNIQUE - same as PRIMARY KEY but with no limit per table\",$unique));\r\n		array_push($arr, array(\"options\",\"AUTO_INCREMENT\",\"AUTO_INCREMENT - automatically increases the number by 1\",$auto_increment));\r\n		array_push($arr, array(\"options\",\"NOT NULL\",\"NOT NULL - value cannot be NULL or EMPTY\",$not_null));\r\n		$checkbox = cb($arr);\r\n\r\n		// Get all the available character sets\r\n		$qry = \"SHOW CHARACTER SET\";\r\n		$result = query($qry,array());\r\n		$charset = \'\';\r\n		foreach ($result as $val)\r\n		{\r\n			$ch = \"CHARSET \".$val[\'Charset\'].\" COLLATE \".$val[\'Default collation\'];\r\n			\r\n			if ($use_default_charset)\r\n			{\r\n				if ($val[\'Charset\']==$default_charset) $selected = \'selected=\"selected\"\';\r\n				else $selected = \'\';\r\n			}\r\n			else\r\n			{\r\n				if ($val[\'Default collation\']==$default_charset) $selected = \'selected=\"selected\"\';\r\n				else $selected = \'\';\r\n			}\r\n\r\n			$charset .= \'<option \'.$selected.\' value=\"\'.$ch.\'\" title=\"\'.$ch.\'\">\'.$val[\'Description\'].\'</option>\'.NEWLINE;\r\n		}\r\n\r\n		$select_html = build_select($data_type);\r\n\r\n		$output .= <<< OUTPUT\r\n	\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n		<h3>{$opt1} Column</h3>\r\n		<label>Column name:</label><input class=\"span12\" type=\"text\" id=\"col_name\" name=\"col_name\" value=\"{$field}\" />\r\n		<input type=\"hidden\" id=\"old_col_name\" name=\"old_col_name\" value=\"{$field}\" />\r\n		<input type=\"hidden\" id=\"old_unique\" name=\"old_unique\" value=\"{$unique}\" />\r\n		<input type=\"hidden\" id=\"old_primary\" name=\"old_primary\" value=\"{$primary_key}\" />\r\n		<label>Column comment:</label><input class=\"span12\" type=\"text\" id=\"col_comment\" name=\"col_comment\" value=\"{$comment}\" />\r\n		<label>Options:</label>\r\n		{$checkbox}\r\n		\r\n		<br /><label class=\"checkbox inline\"><input {$charset_checked} type=\"checkbox\" name=\"char_set\" value=\"char_set\" /> Character Set: </label>\r\n		<select class=\"checkbox inline\" name=\"charset\">\r\n		{$charset}\r\n		</select><br /><br />\r\n\r\n		<label>Data Type:</label>\r\n		<select class=\"span4\" name=\"col_type\" style=\"display: inline-block;\">\r\n		{$select_html}\r\n		</select>\r\n\r\n		( <input class=\"inline\" type=\"text\" name=\"limit_optional\" id=\"limit_optional\" title=\"Length/Precision/Number of digits: if applicable, specify for the data type\" style=\"width:200px\" value=\"{$data_limit}\" /> )\r\n<br /><br />\r\n		<label class=\"checkbox inline\" for=\"default_optional\"><input {$default_checked} type=\"checkbox\" name=\"default\" value=\"default\" /> Default Value: </label>\r\n		<input class=\"checkbox inline\" type=\"text\" name=\"default_optional\" id=\"default_optional\" title=\"Default Value: if applicable, specify for the data type\" style=\"width:200px\" value=\"{$default}\" />\r\n<div class=\"clear\"></div><br />\r\n<button class=\"btn\" type=\"submit\" title=\"Click once to {$opt2} column\">{$opt3}</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n	\r\n		<script>document.getElementById(\"col_name\").focus();</script>\r\n	\r\nOUTPUT;\r\n\r\n		/// Add this stuff in\r\n		///http://dev.mysql.com/doc/refman/5.5/en/blob.html\r\n		///http://dev.mysql.com/doc/refman/5.5/en/storage-requirements.html\r\n	}\r\n	// *********************************************** Add or edit a table row ***********************************************\r\n	else if (isset($_GET[\'row_add\']) || isset($_GET[\'row_edit\']))\r\n	{\r\n		$tbl = $_GET[\'tbl\'];\r\n	\r\n		if (strstr($tbl,\' \')!==false) $tbl_backtick_safe = \"`$tbl`\";\r\n		else $tbl_backtick_safe = $tbl;\r\n\r\n		$qry = \"SHOW COLUMNS FROM $tbl_backtick_safe\";\r\n\r\n		$params = array();\r\n		$result = query($qry, $params);\r\n	\r\n		$form = \'\';\r\n\r\n		if (isset($_GET[\'row_edit\']))\r\n		{\r\n			$result = query(\"describe $tbl_backtick_safe\", array());\r\n			$cols=\'\';\r\n			// Loop through each column name\r\n			foreach($result as $row) { $cols.=\'`\'.$row[\'Field\'].\'`,\'; }\r\n			$cols= substr($cols,0,strlen($cols)-1);\r\n		\r\n			$edit_values = query(\"SELECT $cols FROM $tbl_backtick_safe WHERE id=?\", array($_GET[\'row_edit\']));\r\n		}\r\n\r\n	\r\n		foreach($result as $row)\r\n		{\r\n			if ($row[\'Key\']==\"PRI\") $key = img(\'Primary Key\',\'/img/silk/key.png\');\r\n			else if ($row[\'Key\']==\"UNI\") $key = img(\'Unique\',\'/img/silk/text_underline.png\');\r\n			else $key = \'\';\r\n\r\n			if (strlen($row[\'Extra\'])>0) $extra = \', \'.$row[\'Extra\'];\r\n			else $extra = \'\';\r\n\r\n			if ($row[\'Null\']==\"NO\") $null = \', NULL not allowed\';\r\n			else $null = \'\';\r\n\r\n			if ($row[\'Default\']==\'CURRENT_TIMESTAMP\') $default = htmlentities($row[\'Default\'], ENT_QUOTES, \"UTF-8\");\r\n			else if (isset($_GET[\'row_edit\'])) $default = htmlentities($edit_values[0][$row[\'Field\']], ENT_QUOTES, \"UTF-8\");\r\n			else $default = htmlentities($row[\'Default\'], ENT_QUOTES, \"UTF-8\");\r\n\r\n			if (is_auto_increment($row[\'Field\'])) continue;\r\n\r\n			$remove_space = str_replace(\" \",\"...SPACE...\",$row[\'Field\']);\r\n\r\n			if (strpos($row[\'Type\'], \'text\')!==false) $form .= \'<label>\'.$row[\'Field\'].\': \'.$key.\' \'.$row[\'Type\'].$null.$extra.\'</label><textarea class=\"span12\" id=\"\'.$remove_space.\'\" name=\"\'.$remove_space.\'\" />\'.$default.\'</textarea>\';\r\n			else $form .= \'<label>\'.$row[\'Field\'].\': \'.$key.\' \'.$row[\'Type\'].$null.$extra.\'</label><input class=\"span12\" type=\"text\" id=\"\'.$remove_space.\'\" name=\"\'.$remove_space.\'\" value=\"\'.$default.\'\" />\';\r\n			//$form .= br().br();\r\n		}\r\n\r\n		if (isset($_GET[\'row_edit\']))\r\n		{\r\n			$op1 = \"Edit\";\r\n			$op4 = \" \".$_GET[\'row_edit\'];\r\n			$op2 = \"edit\";\r\n			$op3 = \"Update\";\r\n		}\r\n		else\r\n		{\r\n			$op1 = \"Add\";\r\n			$op4 = \"\";\r\n			$op2 = \"add\";\r\n			$op3 = \"Add\";\r\n		}\r\n\r\n		$output .= <<< OUTPUT\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" method=\"post\">\r\n		<h3>{$op1} Row{$op4}</h3>\r\n		{$form}\r\n<div class=\"clear\"></div>\r\n		<button class=\"btn\" type=\"submit\" title=\"Click once to {$op2} a row\">{$op3}</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n\r\nOUTPUT;\r\n\r\n	}\r\n	// *********************************************** Show table info ***********************************************\r\n	else if (isset($_GET[\'table_info\']))\r\n	{\r\n		$output .= tbl_info($tbl, true);\r\n	}\r\n	// *********************************************** Delete a table ***********************************************\r\n	else if (isset($_GET[\'table_delete\']))\r\n	{\r\n	\r\n	if (isset($_GET[\'tbl\'])) $tbl = $_GET[\'tbl\'];\r\n	else $tbl = \'\';\r\n	\r\n	$output .= <<< OUTPUT\r\n	\r\n\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" action=\"index.php?toolkit_query&table_delete\" onsubmit=\"return validateForm()\" method=\"post\">\r\n	<h3>Delete Table</h3>\r\n	<label>Table name:</label><input class=\"span12\" type=\"text\" id=\"tbl_name\" name=\"tbl_name\" value=\"{$tbl}\" readonly=\"readonly\" />\r\n<div class=\"clear\"></div>\r\n		<button class=\"btn\" type=\"submit\" title=\"Click once to delete a table\">Delete</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n	\r\nOUTPUT;\r\n	}\r\n	// *********************************************** Rename a table ***********************************************\r\n	else if (isset($_GET[\'table_rename\']))\r\n	{\r\n	\r\n	if (isset($_GET[\'tbl\'])) $tbl = $_GET[\'tbl\'];\r\n	else $tbl = \'\';\r\n	\r\n	$output .= <<< OUTPUT\r\n	\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" action=\"index.php?toolkit_query&table_rename\" onsubmit=\"return validateForm()\" method=\"post\">\r\n	<h3>Rename Table</h3>\r\n	<label>Old table name:</label><input class=\"span12\" type=\"text\" id=\"tbl_name_old\" name=\"tbl_name_old\" value=\"{$tbl}\" />\r\n	<label>New table name:</label><input class=\"span12\" type=\"text\" id=\"tbl_name_new\" name=\"tbl_name_new\" value=\"{$tbl}\" />\r\n<div class=\"clear\"></div>\r\n		<button class=\"btn\" type=\"submit\" title=\"Click once to rename a table\">Rename</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n	\r\n	<script>document.getElementById(\"tbl_name_new\").focus();</script>\r\n	\r\nOUTPUT;\r\n	}\r\n	// *********************************************** Delete a row ***********************************************\r\n	else if (isset($_GET[\'row_delete\']))\r\n	{\r\n	\r\n	if (isset($_GET[\'tbl\'])) $tbl = $_GET[\'tbl\'];\r\n	else $tbl = \'\';\r\n	\r\n	$qry = \"DELETE FROM $tbl_backtick_safe WHERE id=\".$_GET[\'row_delete\'].\" LIMIT 1\";\r\n\r\n	$output .= <<< OUTPUT\r\n	\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n	<h3>Delete Row {$_GET[\'row_delete\']}</h3>\r\n	<label>Qry:</label><input class=\"span12\" type=\"text\" id=\"row_id\" name=\"row_id\" value=\"{$qry}\" />\r\n	<input type=\"hidden\" id=\"tbl\" name=\"tbl\" value=\"{$tbl}\" />\r\n<div class=\"clear\"></div>\r\n		<button class=\"btn\" type=\"submit\" title=\"Click once to delete the row\">Delete</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n	\r\nOUTPUT;\r\n\r\n\r\n	$result = query(\"describe $tbl_backtick_safe\", array());\r\n	$cols=\'\';\r\n	// Loop through each column name\r\n	foreach($result as $row) { $cols.=\'`\'.$row[\'Field\'].\'`,\'; }\r\n	$cols= substr($cols,0,strlen($cols)-1);\r\n	//$result = query(\"SELECT $cols FROM $tbl_backtick_safe\", array());\r\n\r\n	$output .= print_array(query(\"SELECT $cols FROM $tbl_backtick_safe WHERE id=?\", array($_GET[\'row_delete\'])));\r\n	}\r\n\r\n	// *********************************************** Delete a column ***********************************************\r\n	else if (isset($_GET[\'col_delete\']))\r\n	{\r\n	\r\n	if (isset($_GET[\'tbl\'])) $tbl = $_GET[\'tbl\'];\r\n	else $tbl = \'\';\r\n	\r\n	$qry = \"ALTER TABLE $tbl_backtick_safe DROP `\".$_GET[\'col_delete\'].\"`\";\r\n\r\n	$output .= <<< OUTPUT\r\n	\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n	<h3>Delete Column {$_GET[\'col_delete\']}</h3>\r\n	<label>Qry:</label><input class=\"span12\" type=\"text\" id=\"row_id\" name=\"row_id\" value=\"{$qry}\" />\r\n	<input type=\"hidden\" id=\"tbl\" name=\"tbl\" value=\"{$tbl}\" />\r\n<div class=\"clear\"></div>\r\n		<button class=\"btn\" type=\"submit\" title=\"Click once to delete the column\">Delete</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n	\r\nOUTPUT;\r\n\r\n\r\n	$result = query(\"describe $tbl_backtick_safe\", array());\r\n	$cols=\'\';\r\n	// Loop through each column name\r\n	foreach($result as $row) { $cols.=\'`\'.$row[\'Field\'].\'`,\'; }\r\n	$cols= substr($cols,0,strlen($cols)-1);\r\n	//$result = query(\"SELECT \".$cols.\" FROM $tbl_backtick_safe\", array());\r\n\r\n	//$output .= print_array(query(\"SELECT $cols FROM $tbl_backtick_safe WHERE id=?\", array($_GET[\'col_delete\'])));\r\n\r\n	$qry = \"SHOW FULL COLUMNS FROM $tbl_backtick_safe WHERE Field=?\";\r\n\r\n	$params = array($_GET[\'col_delete\']);\r\n	$output .= print_array(query($qry, $params));\r\n\r\n	//$output .= col_info($_GET[\'col_delete\']);\r\n\r\n	}\r\n	// *********************************************** Run query ***********************************************\r\n	else if (isset($_GET[\'db_qry\'])) qry_tester();\r\n	// *********************************************** Move column left ***********************************************\r\n	else if (isset($_GET[\'col_left\']) || isset($_GET[\'col_right\']))\r\n	{\r\n\r\n	$tbl = $_GET[\'tbl\'];\r\n\r\n	if (strstr($tbl,\' \')!==false) $tbl_backtick_safe = \"`$tbl`\";\r\n	else $tbl_backtick_safe = $tbl;\r\n\r\n	$qry = \"SHOW FULL COLUMNS FROM $tbl_backtick_safe WHERE Field=?\";\r\n\r\n	if (isset($_GET[\'col_left\'])) $params = array($_GET[\'col_left\']);\r\n	else if (isset($_GET[\'col_right\'])) $params = array($_GET[\'col_right\']);\r\n	$result = query($qry, $params);\r\n\r\n	$col_name = $result[0][\'Field\'];\r\n	$col_type = $result[0][\'Type\'];\r\n	$col_charset = \'\';//$result[0][\'Collation\'];\r\n	if ($result[0][\'Null\'] == \'NO\') $col_null = \'NOT NULL\';\r\n	else $col_null = \'\';\r\n	//if ($result[0][\'Key\']==\'PRI\') $col_key = \'\';//\'PRIMARY KEY\';\r\n	//else if (strlen($result[0][\'Key\'])>0) $col_key = \'UNIQUE\';\r\n	//else\r\n	$col_key = \'\';\r\n\r\n	if (strlen($result[0][\'Default\'])>0) $col_default = \"DEFAULT \'\".$result[0][\'Default\'].\"\'\";\r\n	else $col_default = \' \';\r\n\r\n	$col_extra = $result[0][\'Extra\'];\r\n	if (strlen($result[0][\'Comment\'])>0) $col_comment = \"COMMENT \'\".$result[0][\'Comment\'].\"\'\";\r\n	else $col_comment = \'\';\r\n\r\n	$qry = \"SHOW FULL COLUMNS FROM $tbl_backtick_safe\";\r\n	\r\n	$params = array();\r\n	$result = query($qry, $params);\r\n\r\n$after = $col_name;\r\n$current_col = 0;\r\nfor($i=0;$i<count($result);$i++)\r\n{\r\n	if ($result[$i][\'Field\']==$col_name)\r\n	{\r\n		$current_col = $i; break;\r\n	}\r\n}\r\nif (isset($_GET[\'col_left\']))\r\n{\r\nif ($i<=1) $after = \'FIRST\';\r\nelse $after = \"AFTER `\".$result[$current_col-2][\'Field\'].\"`\";\r\n} else\r\n{\r\n	if (isset($result[$current_col+1])) $after = \"AFTER `\".$result[$current_col+1][\'Field\'].\"`\";\r\n	else $after = \'\';//\"AFTER `\".$result[$current_col][\'Field\'].\"`\";\r\n}\r\n\r\n	//$qry = \"ALTER TABLE `z z` MODIFY COLUMN `z` char(1) AFTER `zz`\";\r\n	$qry = \"ALTER TABLE $tbl_backtick_safe MODIFY COLUMN `$col_name` $col_type $col_charset $col_null $col_key $col_default $col_extra $col_comment $after\";\r\n	$params = array();\r\n	$result = query_execute($qry, $params);\r\n\r\n	// Inform user of result\r\n	if ($result) msg_user(\'Column Move\',$col_name.\" was successfully moved!\",\'index.php?toolkit_query&tbl=\'.$tbl);\r\n	else msg_user(\'Column Move\',$col_name.\" was NOT successfully moved.\",\'index.php?toolkit_query&tbl=\'.$tbl);\r\n}\r\n\r\n	// *********************************************** Output the table ***********************************************\r\n	$output .= br();\r\n\r\n	tbl_s();\r\n\r\n	//$tbl = $_GET[\'tbl\'];\r\n	//if (strstr($tbl,\' \')!==false) $tbl_backtick_safe = \"`$tbl`\";\r\n	//else $tbl_backtick_safe = \"$tbl\";\r\n\r\n	$result = query(\"describe $tbl_backtick_safe\", array());\r\n\r\n	$cols=\'\';\r\n	$cols_arr = array();\r\n		tr_s();\r\n	// Loop through each column name\r\n	foreach($result as $row)\r\n	{\r\n		//th($row[\'Field\']);\r\n\r\n		td($row[\'Field\'],(880-(2*count($result)))/count($result),true);\r\n		$cols.=\'`\'.$row[\'Field\'].\'`,\';\r\n		$cols_arr[]=$row[\'Field\'];\r\n\r\n	}\r\n		tr_e();\r\n\r\n	$cols= substr($cols,0,strlen($cols)-1);\r\n\r\n	$result = query(\"SELECT $cols FROM $tbl_backtick_safe\", array());\r\n	\r\n	// Loop through each cell\r\n	foreach($result as $row)\r\n	{\r\n		tr_s();\r\n		foreach($cols_arr as $c)\r\n		{\r\n			$icons = \'\';\r\n			$val = $row[$c];\r\n			if (strlen($val)==0) $val = \"(empty)\";\r\n			else if (strtolower($c)==\'id\')\r\n			{\r\n//not using this right now\r\n				//$icons = \" \".a(img(\'Delete Row\',\'/img/silk/table_row_delete.png\'),\'toolkit_query&tbl=\'.$tbl.\'&row_delete=\'.$val).\" \";\r\n				//$icons .= a(img(\'Edit Row\',\'/img/silk/table_edit.png\'),\'toolkit_query&tbl=\'.$tbl.\'&row_edit=\'.$val).\" \";\r\n				//$val .= \' \'.$icons;\r\n			}\r\n			td(htmlentities($val, ENT_QUOTES, \"UTF-8\"),(880-(2*count($cols_arr)))/count($cols_arr),false,strtolower($c)==\'id\');\r\n		}\r\n		tr_e();\r\n	}\r\n	tbl_e();\r\n\r\n}\r\n// *********************************************** Shows table list ***********************************************\r\nelse\r\n{\r\n	$result = query(\"SELECT DATABASE()\", array());\r\n	foreach($result as $row) {$output .= \"<b>Current Database:</b> \".$row[\'DATABASE()\'].br(); }\r\n	$output .= \"<b>Size:</b> \".database_size();\r\n\r\n	$output .= br().br();\r\n\r\n	$icons = a(img(\'Create Table\',\'/img/silk/table_add.png\'),\'toolkit_query&table_create\').\" \";\r\n	$icons .= a(img(\'Database Information\',\'/img/silk/database_lightning.png\'),\'toolkit_query&db_info\').\" \";\r\n	$icons .= a(img(\'Query Tester\',\'/img/silk/database_gear.png\'),\'toolkit_query&db_qry\').\" \";\r\n	$output .= $icons.br().br();\r\n\r\n	// *********************************************** Show database information ***********************************************\r\n	if (isset($_GET[\'db_info\']))\r\n	{\r\n		$output .= a(\'Back to tables\',\'toolkit_query\').br().br();\r\n\r\n		// Output the status/info for the table\r\n		$qry = \"SHOW VARIABLES\";\r\n		$result = query($qry,array());\r\n		$return = \'\';\r\n		foreach ($result as $row)\r\n		{\r\n			$return .= \"<b>\".$row[\'Variable_name\'].\":</b> \".$row[\'Value\'].br();\r\n		}\r\n		$output .= \'<div class=\"three_col\">\'.$return.\'</div>\';\r\n		return;\r\n	}\r\n	// *********************************************** Create a table ***********************************************\r\n	else if (isset($_GET[\'table_create\']))\r\n	{\r\n	$output .= <<< OUTPUT\r\n	\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" action=\"index.php?toolkit_query&table_create\" onsubmit=\"return validateForm()\" method=\"post\">\r\n	<h3>Create Table</h3>\r\n	<label>Table name:</label><input class=\"span12\" type=\"text\" id=\"tbl_name\" name=\"tbl_name\" value=\"\" />\r\n<div class=\"clear\"></div>\r\n		<button class=\"btn\" type=\"submit\" title=\"Click once to create a table\">Create</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n	\r\n	<script>document.getElementById(\"tbl_name\").focus();</script>\r\n	\r\nOUTPUT;\r\n	}\r\n	// *********************************************** Run query ***********************************************\r\n	else if (isset($_GET[\'db_qry\'])) qry_tester();\r\n\r\n	// *********************************************** Output tables ***********************************************\r\n	//$output .= br();\r\n	$result = query(\"show tables from `\".DB_DATABASE.\"`\", array());\r\n	$output .= \'<b>Tables (\'.count($result).\'):</b>\'.br();\r\n	foreach($result as $row)\r\n	{\r\n		$tbl=$row[\'Tables_in_\'.DB_DATABASE];\r\n		$output .= a(img(\'Delete Table\',\'/img/silk/table_delete.png\'),\'toolkit_query&table_delete&tbl=\'.$tbl).\" \";\r\n		$output .= a(img(\'Rename Table\',\'/img/silk/table_edit.png\'),\'toolkit_query&table_rename&tbl=\'.$tbl).\" \";\r\n		$output .= a(img(\'Table Information\',\'/img/silk/table_lightning.png\'),\'toolkit_query&table_info&tbl=\'.$tbl).\" \";\r\n		$output .= a($tbl,\'toolkit_query&tbl=\'.$tbl).br();\r\n	}\r\n	if (constant_test(\'SETTING_DB_ADMIN\',\'enable\'))\r\n	{\r\n		$output .= br();\r\n		$result = query(\'SHOW DATABASES\', array());\r\n		$output .= \'<b>Databases (\'.count($result).\'):</b>\'.br();\r\n		foreach($result as $row)\r\n		{\r\n	\r\n			$output .= a(img(\'Delete Database\',\'/img/silk/table_delete.png\'),\'toolkit_query&db_qry=\'.urlencode(\'DROP DATABASE `\'.$row[\'Database\'].\'`\')).\" \";\r\n			//$output .= a(img(\'Rename Database\',\'/img/silk/table_edit.png\'),\'toolkit_query&table_rename&tbl=\'.$tbl).\" \";\r\n			//$output .= a(img(\'Database Information\',\'/img/silk/table_lightning.png\'),\'toolkit_query&table_info&tbl=\'.$tbl).\" \";\r\n			$output .= $row[\'Database\'].br();\r\n		}\r\n	\r\n		$output .= br();\r\n		$result = query(\'SELECT user,host,password FROM mysql.user\', array());\r\n		$output .= \'<b>User:Host:Password (\'.count($result).\'):</b>\'.br();\r\n		foreach($result as $row)\r\n		{\r\n			$qry=\'DELETE FROM mysql.user WHERE user=\\\'\'.$row[\'user\'].\'\\\' AND host=\\\'\'.$row[\'host\'].\'\\\'\';\r\n			$output .= a(img(\'Delete User\',\'/img/silk/table_delete.png\'),\'toolkit_query&db_qry=\'.urlencode($qry)).\" \";\r\n			if (strlen($row[\'user\'])==0) $output .= \'(blank)\';\r\n			else $output .= $row[\'user\'];\r\n			$output .= \':\'.$row[\'host\'].\':\';\r\n			if (strlen($row[\'password\'])>0) $output .= $row[\'password\'];\r\n			else $output .= \'(blank)\';\r\n			$output .= br();\r\n		}\r\n		$output .= br().\'<b>Note:</b> Disable SETTING_DB_ADMIN \'.quickSiteSetting().\' when finished\';\r\n	}\r\n	else\r\n	{\r\n		$output .= br().\'<b>Note:</b> Enable SETTING_DB_ADMIN \'.quickSiteSetting().\' to view all databases and users\';\r\n	}\r\n}','2012-08-20 03:28:17',2,1,'// Create a table\r\nif (isset($_GET[\'db_qry\']))\r\n{\r\n	if (isset($_GET[\'tbl\'])) $output .= a(\'Back to table\',\'toolkit_query&tbl=\'.$_GET[\'tbl\']).br().br();\r\n	else $output .= a(\'Back to tables\',\'toolkit_query\').br().br();\r\n	$output .= \"Query: \".$_POST[\'qry\'].br().br();\r\n\r\n	// Ensure double quotes show up in the textbox\r\n	$qry = htmlentities($_POST[\'qry\'], ENT_QUOTES, \"UTF-8\");\r\n\r\n$output .= <<< OUTPUT\r\n\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n<h3>Query Tester</h3>\r\n<label>Query:</label><input class=\"span12\" type=\"text\" id=\"qry\" name=\"qry\" value=\"{$qry}\" />\r\n<div class=\"clear\"></div>\r\n<button class=\"btn\" name=\"submit1\" title=\"Click once to run a view query\">View Results</button>\r\n<button class=\"btn\" name=\"submit2\" title=\"Click once to run an update query\">Make Change</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n\r\n<script>document.getElementById(\"qry\").focus();</script>\r\n\r\nOUTPUT;\r\n\r\n	if (isset($_POST[\'submit1\'])) $output .= print_array(query($_POST[\'qry\'], array()));\r\n	else $output .= print_array(query_execute($_POST[\'qry\'], array()));\r\n}\r\nelse if (isset($_GET[\'table_create\']))\r\n{\r\n	$msg_title = \'Table Creation\';\r\n	$var1 = \'tbl_name\';\r\n\r\n	// If all the variables are present\r\n	if (isset($_POST[$var1]))\r\n	{\r\n		$qry = \"SHOW TABLES LIKE \'\".$_POST[$var1].\"\'\";\r\n		$params = array();\r\n		$result = query($qry, $params);\r\n		if ($result)\r\n		{\r\n			msg_user($msg_title,$_POST[$var1].\" was NOT created successfully. The table already exists.\",\'index.php?toolkit_query\');\r\n			return;\r\n		}\r\n\r\n		$qry = \"CREATE TABLE IF NOT EXISTS `\".$_POST[$var1].\"` (id INT UNSIGNED PRIMARY KEY AUTO_INCREMENT COMMENT \'Self-explanatory\')COMMENT=\'Users with access to login\'\";\r\n		$params = array();\r\n		$result = query_execute($qry, $params);\r\n\r\n		$qry = \"SHOW TABLES LIKE \'\".$_POST[$var1].\"\'\";\r\n		$params = array();\r\n		$result = query($qry, $params);\r\n\r\n		// Inform user of result\r\n		if ($result) msg_user($msg_title,$_POST[$var1].\" was created successfully!\",\'index.php?toolkit_query\');\r\n		else msg_user($msg_title,$_POST[$var1].\" was NOT created successfully. You either don\'t have permission or the table already exists.\",\'index.php?toolkit_query\');\r\n\r\n	}else msg_user($msg_title,\"Something was missing...\",\'index.php?toolkit_query\');\r\n}\r\n// Delete a table\r\nelse if (isset($_GET[\'table_delete\']))\r\n{\r\n	$msg_title = \'Table Deletion\';\r\n	$var1 = \'tbl_name\';\r\n\r\n	// If all the variables are present\r\n	if (isset($_POST[$var1]))\r\n	{\r\n		$qry = \"SHOW TABLES LIKE \'\".$_POST[$var1].\"\'\";\r\n		$params = array();\r\n		$result = query($qry, $params);\r\n		if (!$result)\r\n		{\r\n			msg_user($msg_title,$_POST[$var1].\" was NOT deleted successfully. The table does not exist.\",\'index.php?toolkit_query\');\r\n			return;\r\n		}\r\n\r\n		$qry = \"DROP TABLE `\".$_POST[$var1].\"`\";\r\n		$params = array();\r\n		$result = query_execute($qry, $params);\r\n\r\n		$qry = \"SHOW TABLES LIKE \'\".$_POST[$var1].\"\'\";\r\n		$params = array();\r\n		$result = query($qry, $params);\r\n\r\n		// Inform user of result\r\n		if (!$result) msg_user($msg_title,$_POST[$var1].\" was deleted successfully!\",\'index.php?toolkit_query\');\r\n		else msg_user($msg_title,$_POST[$var1].\" was NOT deleted successfully. You either don\'t have permission or the table does not exist.\",\'index.php?toolkit_query\');\r\n\r\n	}else msg_user($msg_title,\"Something was missing...\",\'index.php?toolkit_query\');\r\n}\r\n// Rename a table\r\nelse if (isset($_GET[\'table_rename\']))\r\n{\r\n	$msg_title = \'Table Rename\';\r\n	$var1 = \'tbl_name_old\';\r\n	$var2 = \'tbl_name_new\';\r\n\r\n	// If all the variables are present\r\n	if (isset($_POST[$var2]))\r\n	{\r\n		$qry = \"SHOW TABLES LIKE \'\".$_POST[$var2].\"\'\";\r\n		$params = array();\r\n		$result = query($qry, $params);\r\n		if ($result)\r\n		{\r\n			msg_user($msg_title,$_POST[$var2].\" was NOT renamed successfully. The table already exists.\",\'index.php?toolkit_query\');\r\n			return;\r\n		}\r\n\r\n		$qry = \"RENAME TABLE `\".$_POST[$var1].\"` TO `\".$_POST[$var2].\"`\";\r\n		$params = array();\r\n		$result = query_execute($qry, $params);\r\n\r\n		$qry = \"SHOW TABLES LIKE \'\".$_POST[$var2].\"\'\";\r\n		$params = array();\r\n		$result = query($qry, $params);\r\n\r\n		// Inform user of result\r\n		if ($result) msg_user($msg_title,$_POST[$var1].\" was renamed successfully to \".$_POST[$var2].\"!\",\'index.php?toolkit_query\');\r\n		else msg_user($msg_title,$_POST[$var1].\" was NOT renamed successfully. You either don\'t have permission or the table already exists.\",\'index.php?toolkit_query\');\r\n\r\n	}else msg_user($msg_title,\"Something was missing...\",\'index.php?toolkit_query\');\r\n}\r\n// Add a column\r\nelse if (isset($_GET[\'col_add\']) || isset($_GET[\'col_edit\']))\r\n{\r\n\r\n	if (isset($_GET[\'col_edit\']))\r\n	{\r\n		$opt1 = \'Edited\';\r\n		$opt2 = \'updated\';\r\n	}\r\n	else\r\n	{\r\n		$opt1 = \'Addition\';\r\n		$opt2 = \'added\';\r\n	}\r\n\r\n	$new_unique = false;\r\n	$new_primary = false;\r\n\r\n	$msg_title = \'Column \'.$opt1;\r\n	$options = \'\';\r\n	if (isset($_POST[\'options\']))\r\n	{\r\n		foreach ($_POST[\'options\'] as $val)\r\n		{\r\n			if ($_POST[\'old_primary\']==\'1\' && $val==\'PRIMARY KEY\') {} // Dont reapply the primary key\r\n			else $options .= \" $val\";\r\n			if ($val==\'UNIQUE\') $new_unique = true;\r\n			else if ($val==\'PRIMARY KEY\') $new_primary = true;\r\n		}\r\n	}\r\n\r\n	if ($_POST[\'old_unique\']==\'1\' && $new_unique==false)  $drop_unique = true;\r\n	else $drop_unique = false;\r\n\r\n	if ($_POST[\'old_primary\']==\'1\' && $new_primary==false)  $drop_primary = true;\r\n	else $drop_primary = false;\r\n	\r\n	$tbl_name = $_GET[\"tbl\"];\r\n	$col_name = $_POST[\"col_name\"];\r\n	$col_type = $_POST[\"col_type\"];\r\n	if (isset($_POST[\"char_set\"])) $charset = $_POST[\'charset\'];\r\n	else $charset = \'\';\r\n\r\n	if (isset($_GET[\'col_add\']))\r\n	{\r\n		$qry = \"SHOW COLUMNS FROM `$tbl_name` WHERE Field=\'$col_name\'\";\r\n		$params = array();\r\n		$result = query($qry, $params);\r\n		if ($result)\r\n		{\r\n			msg_user($msg_title,$col_name.\" was NOT added successfully. The column already exists.\",\'index.php?toolkit_query&tbl=\'.$tbl_name);\r\n			return;\r\n		}\r\n	}\r\n\r\n	$col_comment = \"COMMENT \'\".$_POST[\"col_comment\"].\"\'\";\r\n	if (isset($_POST[\"limit_optional\"]) && strlen($_POST[\"limit_optional\"])>0) $limit = \'(\'.$_POST[\"limit_optional\"].\')\';\r\n	else $limit = \'\';\r\n\r\n	if (isset($_POST[\"default\"]))\r\n	{\r\n		if ($col_type == \'TIMESTAMP\') $default = \' \';\r\n		else $default = \" DEFAULT \'\".$_POST[\"default_optional\"].\"\' \";\r\n	}\r\n	else $default = \' \';\r\n	\r\n	if (isset($_GET[\'col_edit\']))\r\n	{\r\n		if ($_POST[\'old_unique\']==\'1\' && $_POST[\"old_col_name\"] != $col_name)\r\n		{\r\n			$qry = \"ALTER TABLE `$tbl_name` DROP INDEX `\".$_POST[\"old_col_name\"].\"`\";\r\n			$params = array();\r\n			query_execute($qry, $params);\r\n		}\r\n		else if ($drop_unique)\r\n		{\r\n			$qry = \"ALTER TABLE `$tbl_name` DROP INDEX `\".$_POST[\"old_col_name\"].\"`\";\r\n			$params = array();\r\n			query_execute($qry, $params);\r\n		}\r\n\r\n		if ($drop_primary)\r\n		{\r\n			$qry = \"ALTER TABLE `$tbl_name` DROP PRIMARY KEY\";\r\n			$params = array();\r\n			query_execute($qry, $params);\r\n		}\r\n\r\n		//$qry = \"ALTER TABLE `$tbl_name` ADD `$col_name` $col_type$limit $charset $options$default $col_comment\";\r\n		$qry = \"ALTER TABLE `$tbl_name` CHANGE `\".$_POST[\"old_col_name\"].\"` `$col_name` $col_type$limit $charset $options$default $col_comment\";\r\n		$params = array();\r\n		query_execute($qry, $params);\r\n		$opt1 = \'updated\';\r\n	}\r\n	else\r\n	{\r\n		$qry = \"ALTER TABLE `$tbl_name` ADD `$col_name` $col_type$limit $charset $options$default $col_comment\";\r\n		$params = array();\r\n		query_execute($qry, $params);\r\n	}\r\n\r\n	$qry = \"SHOW COLUMNS FROM `$tbl_name` WHERE Field=\'$col_name\'\";\r\n	$params = array();\r\n	$result = query_execute($qry, $params);\r\n\r\n	// Inform user of result\r\n	if ($result) msg_user($msg_title,$col_name.\" was $opt2 successfully to \".$tbl_name.\"!\",\'index.php?toolkit_query&tbl=\'.$tbl_name);\r\n	else msg_user($msg_title,$col_name.\" was NOT $opt2 successfully. You probably entered in an invalid value.\",\'index.php?toolkit_query&tbl=\'.$tbl_name);\r\n}\r\n// Add a column\r\nelse if (isset($_GET[\'row_add\']))\r\n{\r\n	$msg_title = \'Row Addition\';\r\n 	//$output .= print_array($_POST);\r\n\r\n	$tbl = $_GET[\'tbl\'];\r\n	$cols = \'\';\r\n	$vals_params = \'\';\r\n	$vals_array = array();\r\n	\r\n	foreach($_POST as $key=>$val)\r\n	{\r\n		if (strlen($key)>0 && strlen($val)>0)\r\n		{\r\n			$cols .= \",`\".str_replace(\"___SPACE___\",\" \",$key).\"`\";\r\n			if ($val==\'CURRENT_TIMESTAMP\')\r\n			{\r\n				$vals_params .= \",CURRENT_TIMESTAMP\";\r\n			}\r\n			else\r\n			{\r\n				$vals_params .= \",?\";\r\n				$vals_array[] = $val;\r\n			}\r\n		}\r\n	}\r\n	\r\n	$cols = substr($cols, 1);\r\n	$vals_params = substr($vals_params, 1);\r\n	\r\n	//$output .= $qry;\r\n\r\n	$qry = \"INSERT INTO `$tbl` ($cols) VALUES($vals_params)\";\r\n	$params = $vals_array;\r\n	$result = query_execute($qry, $params);\r\n\r\n	// Inform user of result\r\n	if ($result) msg_user($msg_title,\"Row was added successfully to \".$tbl.\"!\",\'index.php?toolkit_query&tbl=\'.$tbl.\"&row_add\");\r\n	else msg_user($msg_title,\"Row was NOT added successfully. You probably entered in an invalid value.\".NEWLINE.$qry,\'index.php?toolkit_query&tbl=\'.$tbl.\"&row_add\");\r\n}\r\n// Edit a column\r\nelse if (isset($_GET[\'row_edit\']))\r\n{\r\n	$msg_title = \'Row Edit\';\r\n 	//$output .= print_array($_POST);\r\n\r\n	$tbl = $_GET[\'tbl\'];\r\n	$cols = \'\';\r\n	$vals_params = \'\';\r\n	$vals_array = array();\r\n	\r\n	foreach($_POST as $key=>$val)\r\n	{\r\n		if (strlen($key)>0 && strlen($val)>0)\r\n		{\r\n			$cols = \",`\".str_replace(\"___SPACE___\",\" \",$key).\"`\";\r\n			if ($val==\'CURRENT_TIMESTAMP\')\r\n			{\r\n				$vals_params .= $cols.\"=CURRENT_TIMESTAMP\";\r\n			}\r\n			else\r\n			{\r\n				$vals_params .= $cols.\"=?\";\r\n				$vals_array[] = $val;\r\n			}\r\n\r\n		}\r\n	}\r\n\r\n	// Add the id\r\n	$vals_array[] = $_GET[\'row_edit\'];\r\n	\r\n	//$cols = substr($cols, 1);\r\n	$vals_params = substr($vals_params, 1);\r\n	\r\n	//$output .= $qry;\r\n\r\n	$qry = \"UPDATE `$tbl` SET $vals_params WHERE id=?\";\r\n	$params = $vals_array;\r\n	$result = query_execute($qry, $params);\r\n\r\n	// Inform user of result\r\n	if ($result) msg_user($msg_title,\"Row \".$_GET[\'row_edit\'].\" was edited successfully to \".$tbl.\"!\",\'index.php?toolkit_query&tbl=\'.$tbl.\"&row_edit=\".$_GET[\'row_edit\']);\r\n	else msg_user($msg_title,\"Row \".$_GET[\'row_edit\'].\" was NOT edited successfully. You probably entered in an invalid value.\",\'index.php?toolkit_query&tbl=\'.$tbl.\"&row_edit=\".$_GET[\'row_edit\']);\r\n}\r\n// Delete a row\r\nelse if (isset($_GET[\'row_delete\']))\r\n{\r\n	$msg_title = \'Row Deletion\';\r\n\r\n	$tbl = $_POST[\'tbl\'];\r\n	$qry = $_POST[\'row_id\'];\r\n\r\n	$result = query_execute($qry, array());\r\n\r\n	// Inform user of result\r\n	if ($result) msg_user($msg_title,\"Row \".$_GET[\'row_delete\'].\" was deleted successfully from \".$tbl.\"!\",\'index.php?toolkit_query&tbl=\'.$tbl);\r\n	else msg_user($msg_title,\"Row \".$_GET[\'row_delete\'].\" was NOT deleted successfully. You probably entered in an invalid query.\",\'index.php?toolkit_query&tbl=\'.$tbl);\r\n}\r\n// Delete a column\r\nelse if (isset($_GET[\'col_delete\']))\r\n{\r\n	$msg_title = \'Column Deletion\';\r\n\r\n	$tbl = $_POST[\'tbl\'];\r\n	$qry = $_POST[\'row_id\'];\r\n\r\n	$result = query(\'DESCRIBE `\'.$tbl.\'`\', array());\r\n	$count_before = count($result);\r\n\r\n	query_execute($qry, array());\r\n\r\n	$result = query(\'DESCRIBE `\'.$tbl.\'`\', array());\r\n	$count_after = count($result);\r\n\r\n	// Inform user of result\r\n	if ($count_after!=$count_before) msg_user($msg_title,\"Column \".$_GET[\'col_delete\'].\" was deleted successfully from \".$tbl.\"!\",\'index.php?toolkit_query&tbl=\'.$tbl);\r\n	else msg_user($msg_title,\"Column \".$_GET[\'col_delete\'].\" was NOT deleted successfully. You probably entered in an invalid query.\",\'index.php?toolkit_query&tbl=\'.$tbl);\r\n}\r\n\r\n\r\n// End','Database Manager','',''),(142,'script_jquery','/*! jQuery v1.7.2 jquery.com | jquery.org/license */\r\n(function(a,b){function cy(a){return f.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function cu(a){if(!cj[a]){var b=c.body,d=f(\"<\"+a+\">\").appendTo(b),e=d.css(\"display\");d.remove();if(e===\"none\"||e===\"\"){ck||(ck=c.createElement(\"iframe\"),ck.frameBorder=ck.width=ck.height=0),b.appendChild(ck);if(!cl||!ck.createElement)cl=(ck.contentWindow||ck.contentDocument).document,cl.write((f.support.boxModel?\"<!doctype html>\":\"\")+\"<html><body>\"),cl.close();d=cl.createElement(a),cl.body.appendChild(d),e=f.css(d,\"display\"),b.removeChild(ck)}cj[a]=e}return cj[a]}function ct(a,b){var c={};f.each(cp.concat.apply([],cp.slice(0,b)),function(){c[this]=a});return c}function cs(){cq=b}function cr(){setTimeout(cs,0);return cq=f.now()}function ci(){try{return new a.ActiveXObject(\"Microsoft.XMLHTTP\")}catch(b){}}function ch(){try{return new a.XMLHttpRequest}catch(b){}}function cb(a,c){a.dataFilter&&(c=a.dataFilter(c,a.dataType));var d=a.dataTypes,e={},g,h,i=d.length,j,k=d[0],l,m,n,o,p;for(g=1;g<i;g++){if(g===1)for(h in a.converters)typeof h==\"string\"&&(e[h.toLowerCase()]=a.converters[h]);l=k,k=d[g];if(k===\"*\")k=l;else if(l!==\"*\"&&l!==k){m=l+\" \"+k,n=e[m]||e[\"* \"+k];if(!n){p=b;for(o in e){j=o.split(\" \");if(j[0]===l||j[0]===\"*\"){p=e[j[1]+\" \"+k];if(p){o=e[o],o===!0?n=p:p===!0&&(n=o);break}}}}!n&&!p&&f.error(\"No conversion from \"+m.replace(\" \",\" to \")),n!==!0&&(c=n?n(c):p(o(c)))}}return c}function ca(a,c,d){var e=a.contents,f=a.dataTypes,g=a.responseFields,h,i,j,k;for(i in g)i in d&&(c[g[i]]=d[i]);while(f[0]===\"*\")f.shift(),h===b&&(h=a.mimeType||c.getResponseHeader(\"content-type\"));if(h)for(i in e)if(e[i]&&e[i].test(h)){f.unshift(i);break}if(f[0]in d)j=f[0];else{for(i in d){if(!f[0]||a.converters[i+\" \"+f[0]]){j=i;break}k||(k=i)}j=j||k}if(j){j!==f[0]&&f.unshift(j);return d[j]}}function b_(a,b,c,d){if(f.isArray(b))f.each(b,function(b,e){c||bD.test(a)?d(a,e):b_(a+\"[\"+(typeof e==\"object\"?b:\"\")+\"]\",e,c,d)});else if(!c&&f.type(b)===\"object\")for(var e in b)b_(a+\"[\"+e+\"]\",b[e],c,d);else d(a,b)}function b$(a,c){var d,e,g=f.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((g[d]?a:e||(e={}))[d]=c[d]);e&&f.extend(!0,a,e)}function bZ(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h=a[f],i=0,j=h?h.length:0,k=a===bS,l;for(;i<j&&(k||!l);i++)l=h[i](c,d,e),typeof l==\"string\"&&(!k||g[l]?l=b:(c.dataTypes.unshift(l),l=bZ(a,c,d,e,l,g)));(k||!l)&&!g[\"*\"]&&(l=bZ(a,c,d,e,\"*\",g));return l}function bY(a){return function(b,c){typeof b!=\"string\"&&(c=b,b=\"*\");if(f.isFunction(c)){var d=b.toLowerCase().split(bO),e=0,g=d.length,h,i,j;for(;e<g;e++)h=d[e],j=/^\\+/.test(h),j&&(h=h.substr(1)||\"*\"),i=a[h]=a[h]||[],i[j?\"unshift\":\"push\"](c)}}}function bB(a,b,c){var d=b===\"width\"?a.offsetWidth:a.offsetHeight,e=b===\"width\"?1:0,g=4;if(d>0){if(c!==\"border\")for(;e<g;e+=2)c||(d-=parseFloat(f.css(a,\"padding\"+bx[e]))||0),c===\"margin\"?d+=parseFloat(f.css(a,c+bx[e]))||0:d-=parseFloat(f.css(a,\"border\"+bx[e]+\"Width\"))||0;return d+\"px\"}d=by(a,b);if(d<0||d==null)d=a.style[b];if(bt.test(d))return d;d=parseFloat(d)||0;if(c)for(;e<g;e+=2)d+=parseFloat(f.css(a,\"padding\"+bx[e]))||0,c!==\"padding\"&&(d+=parseFloat(f.css(a,\"border\"+bx[e]+\"Width\"))||0),c===\"margin\"&&(d+=parseFloat(f.css(a,c+bx[e]))||0);return d+\"px\"}function bo(a){var b=c.createElement(\"div\");bh.appendChild(b),b.innerHTML=a.outerHTML;return b.firstChild}function bn(a){var b=(a.nodeName||\"\").toLowerCase();b===\"input\"?bm(a):b!==\"script\"&&typeof a.getElementsByTagName!=\"undefined\"&&f.grep(a.getElementsByTagName(\"input\"),bm)}function bm(a){if(a.type===\"checkbox\"||a.type===\"radio\")a.defaultChecked=a.checked}function bl(a){return typeof a.getElementsByTagName!=\"undefined\"?a.getElementsByTagName(\"*\"):typeof a.querySelectorAll!=\"undefined\"?a.querySelectorAll(\"*\"):[]}function bk(a,b){var c;b.nodeType===1&&(b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase(),c===\"object\"?b.outerHTML=a.outerHTML:c!==\"input\"||a.type!==\"checkbox\"&&a.type!==\"radio\"?c===\"option\"?b.selected=a.defaultSelected:c===\"input\"||c===\"textarea\"?b.defaultValue=a.defaultValue:c===\"script\"&&b.text!==a.text&&(b.text=a.text):(a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value&&(b.value=a.value)),b.removeAttribute(f.expando),b.removeAttribute(\"_submit_attached\"),b.removeAttribute(\"_change_attached\"))}function bj(a,b){if(b.nodeType===1&&!!f.hasData(a)){var c,d,e,g=f._data(a),h=f._data(b,g),i=g.events;if(i){delete h.handle,h.events={};for(c in i)for(d=0,e=i[c].length;d<e;d++)f.event.add(b,c,i[c][d])}h.data&&(h.data=f.extend({},h.data))}}function bi(a,b){return f.nodeName(a,\"table\")?a.getElementsByTagName(\"tbody\")[0]||a.appendChild(a.ownerDocument.createElement(\"tbody\")):a}function U(a){var b=V.split(\"|\"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}function T(a,b,c){b=b||0;if(f.isFunction(b))return f.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return f.grep(a,function(a,d){return a===b===c});if(typeof b==\"string\"){var d=f.grep(a,function(a){return a.nodeType===1});if(O.test(b))return f.filter(b,d,!c);b=f.filter(b,d)}return f.grep(a,function(a,d){return f.inArray(a,b)>=0===c})}function S(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function K(){return!0}function J(){return!1}function n(a,b,c){var d=b+\"defer\",e=b+\"queue\",g=b+\"mark\",h=f._data(a,d);h&&(c===\"queue\"||!f._data(a,e))&&(c===\"mark\"||!f._data(a,g))&&setTimeout(function(){!f._data(a,e)&&!f._data(a,g)&&(f.removeData(a,d,!0),h.fire())},0)}function m(a){for(var b in a){if(b===\"data\"&&f.isEmptyObject(a[b]))continue;if(b!==\"toJSON\")return!1}return!0}function l(a,c,d){if(d===b&&a.nodeType===1){var e=\"data-\"+c.replace(k,\"-$1\").toLowerCase();d=a.getAttribute(e);if(typeof d==\"string\"){try{d=d===\"true\"?!0:d===\"false\"?!1:d===\"null\"?null:f.isNumeric(d)?+d:j.test(d)?f.parseJSON(d):d}catch(g){}f.data(a,c,d)}else d=b}return d}function h(a){var b=g[a]={},c,d;a=a.split(/\\s+/);for(c=0,d=a.length;c<d;c++)b[a[c]]=!0;return b}var c=a.document,d=a.navigator,e=a.location,f=function(){function J(){if(!e.isReady){try{c.documentElement.doScroll(\"left\")}catch(a){setTimeout(J,1);return}e.ready()}}var e=function(a,b){return new e.fn.init(a,b,h)},f=a.jQuery,g=a.$,h,i=/^(?:[^#<]*(<[\\w\\W]+>)[^>]*$|#([\\w\\-]*)$)/,j=/\\S/,k=/^\\s+/,l=/\\s+$/,m=/^<(\\w+)\\s*\\/?>(?:<\\/\\1>)?$/,n=/^[\\],:{}\\s]*$/,o=/\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g,p=/\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g,q=/(?:^|:|,)(?:\\s*\\[)+/g,r=/(webkit)[ \\/]([\\w.]+)/,s=/(opera)(?:.*version)?[ \\/]([\\w.]+)/,t=/(msie) ([\\w.]+)/,u=/(mozilla)(?:.*? rv:([\\w.]+))?/,v=/-([a-z]|[0-9])/ig,w=/^-ms-/,x=function(a,b){return(b+\"\").toUpperCase()},y=d.userAgent,z,A,B,C=Object.prototype.toString,D=Object.prototype.hasOwnProperty,E=Array.prototype.push,F=Array.prototype.slice,G=String.prototype.trim,H=Array.prototype.indexOf,I={};e.fn=e.prototype={constructor:e,init:function(a,d,f){var g,h,j,k;if(!a)return this;if(a.nodeType){this.context=this[0]=a,this.length=1;return this}if(a===\"body\"&&!d&&c.body){this.context=c,this[0]=c.body,this.selector=a,this.length=1;return this}if(typeof a==\"string\"){a.charAt(0)!==\"<\"||a.charAt(a.length-1)!==\">\"||a.length<3?g=i.exec(a):g=[null,a,null];if(g&&(g[1]||!d)){if(g[1]){d=d instanceof e?d[0]:d,k=d?d.ownerDocument||d:c,j=m.exec(a),j?e.isPlainObject(d)?(a=[c.createElement(j[1])],e.fn.attr.call(a,d,!0)):a=[k.createElement(j[1])]:(j=e.buildFragment([g[1]],[k]),a=(j.cacheable?e.clone(j.fragment):j.fragment).childNodes);return e.merge(this,a)}h=c.getElementById(g[2]);if(h&&h.parentNode){if(h.id!==g[2])return f.find(a);this.length=1,this[0]=h}this.context=c,this.selector=a;return this}return!d||d.jquery?(d||f).find(a):this.constructor(d).find(a)}if(e.isFunction(a))return f.ready(a);a.selector!==b&&(this.selector=a.selector,this.context=a.context);return e.makeArray(a,this)},selector:\"\",jquery:\"1.7.2\",length:0,size:function(){return this.length},toArray:function(){return F.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=this.constructor();e.isArray(a)?E.apply(d,a):e.merge(d,a),d.prevObject=this,d.context=this.context,b===\"find\"?d.selector=this.selector+(this.selector?\" \":\"\")+c:b&&(d.selector=this.selector+\".\"+b+\"(\"+c+\")\");return d},each:function(a,b){return e.each(this,a,b)},ready:function(a){e.bindReady(),A.add(a);return this},eq:function(a){a=+a;return a===-1?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(F.apply(this,arguments),\"slice\",F.call(arguments).join(\",\"))},map:function(a){return this.pushStack(e.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:E,sort:[].sort,splice:[].splice},e.fn.init.prototype=e.fn,e.extend=e.fn.extend=function(){var a,c,d,f,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;typeof i==\"boolean\"&&(l=i,i=arguments[1]||{},j=2),typeof i!=\"object\"&&!e.isFunction(i)&&(i={}),k===j&&(i=this,--j);for(;j<k;j++)if((a=arguments[j])!=null)for(c in a){d=i[c],f=a[c];if(i===f)continue;l&&f&&(e.isPlainObject(f)||(g=e.isArray(f)))?(g?(g=!1,h=d&&e.isArray(d)?d:[]):h=d&&e.isPlainObject(d)?d:{},i[c]=e.extend(l,h,f)):f!==b&&(i[c]=f)}return i},e.extend({noConflict:function(b){a.$===e&&(a.$=g),b&&a.jQuery===e&&(a.jQuery=f);return e},isReady:!1,readyWait:1,holdReady:function(a){a?e.readyWait++:e.ready(!0)},ready:function(a){if(a===!0&&!--e.readyWait||a!==!0&&!e.isReady){if(!c.body)return setTimeout(e.ready,1);e.isReady=!0;if(a!==!0&&--e.readyWait>0)return;A.fireWith(c,[e]),e.fn.trigger&&e(c).trigger(\"ready\").off(\"ready\")}},bindReady:function(){if(!A){A=e.Callbacks(\"once memory\");if(c.readyState===\"complete\")return setTimeout(e.ready,1);if(c.addEventListener)c.addEventListener(\"DOMContentLoaded\",B,!1),a.addEventListener(\"load\",e.ready,!1);else if(c.attachEvent){c.attachEvent(\"onreadystatechange\",B),a.attachEvent(\"onload\",e.ready);var b=!1;try{b=a.frameElement==null}catch(d){}c.documentElement.doScroll&&b&&J()}}},isFunction:function(a){return e.type(a)===\"function\"},isArray:Array.isArray||function(a){return e.type(a)===\"array\"},isWindow:function(a){return a!=null&&a==a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return a==null?String(a):I[C.call(a)]||\"object\"},isPlainObject:function(a){if(!a||e.type(a)!==\"object\"||a.nodeType||e.isWindow(a))return!1;try{if(a.constructor&&!D.call(a,\"constructor\")&&!D.call(a.constructor.prototype,\"isPrototypeOf\"))return!1}catch(c){return!1}var d;for(d in a);return d===b||D.call(a,d)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw new Error(a)},parseJSON:function(b){if(typeof b!=\"string\"||!b)return null;b=e.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(n.test(b.replace(o,\"@\").replace(p,\"]\").replace(q,\"\")))return(new Function(\"return \"+b))();e.error(\"Invalid JSON: \"+b)},parseXML:function(c){if(typeof c!=\"string\"||!c)return null;var d,f;try{a.DOMParser?(f=new DOMParser,d=f.parseFromString(c,\"text/xml\")):(d=new ActiveXObject(\"Microsoft.XMLDOM\"),d.async=\"false\",d.loadXML(c))}catch(g){d=b}(!d||!d.documentElement||d.getElementsByTagName(\"parsererror\").length)&&e.error(\"Invalid XML: \"+c);return d},noop:function(){},globalEval:function(b){b&&j.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(w,\"ms-\").replace(v,x)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var f,g=0,h=a.length,i=h===b||e.isFunction(a);if(d){if(i){for(f in a)if(c.apply(a[f],d)===!1)break}else for(;g<h;)if(c.apply(a[g++],d)===!1)break}else if(i){for(f in a)if(c.call(a[f],f,a[f])===!1)break}else for(;g<h;)if(c.call(a[g],g,a[g++])===!1)break;return a},trim:G?function(a){return a==null?\"\":G.call(a)}:function(a){return a==null?\"\":(a+\"\").replace(k,\"\").replace(l,\"\")},makeArray:function(a,b){var c=b||[];if(a!=null){var d=e.type(a);a.length==null||d===\"string\"||d===\"function\"||d===\"regexp\"||e.isWindow(a)?E.call(c,a):e.merge(c,a)}return c},inArray:function(a,b,c){var d;if(b){if(H)return H.call(b,a,c);d=b.length,c=c?c<0?Math.max(0,d+c):c:0;for(;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=a.length,e=0;if(typeof c.length==\"number\")for(var f=c.length;e<f;e++)a[d++]=c[e];else while(c[e]!==b)a[d++]=c[e++];a.length=d;return a},grep:function(a,b,c){var d=[],e;c=!!c;for(var f=0,g=a.length;f<g;f++)e=!!b(a[f],f),c!==e&&d.push(a[f]);return d},map:function(a,c,d){var f,g,h=[],i=0,j=a.length,k=a instanceof e||j!==b&&typeof j==\"number\"&&(j>0&&a[0]&&a[j-1]||j===0||e.isArray(a));if(k)for(;i<j;i++)f=c(a[i],i,d),f!=null&&(h[h.length]=f);else for(g in a)f=c(a[g],g,d),f!=null&&(h[h.length]=f);return h.concat.apply([],h)},guid:1,proxy:function(a,c){if(typeof c==\"string\"){var d=a[c];c=a,a=d}if(!e.isFunction(a))return b;var f=F.call(arguments,2),g=function(){return a.apply(c,f.concat(F.call(arguments)))};g.guid=a.guid=a.guid||g.guid||e.guid++;return g},access:function(a,c,d,f,g,h,i){var j,k=d==null,l=0,m=a.length;if(d&&typeof d==\"object\"){for(l in d)e.access(a,c,l,d[l],1,h,f);g=1}else if(f!==b){j=i===b&&e.isFunction(f),k&&(j?(j=c,c=function(a,b,c){return j.call(e(a),c)}):(c.call(a,f),c=null));if(c)for(;l<m;l++)c(a[l],d,j?f.call(a[l],l,c(a[l],d)):f,i);g=1}return g?a:k?c.call(a):m?c(a[0],d):h},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();var b=r.exec(a)||s.exec(a)||t.exec(a)||a.indexOf(\"compatible\")<0&&u.exec(a)||[];return{browser:b[1]||\"\",version:b[2]||\"0\"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}e.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function(d,f){f&&f instanceof e&&!(f instanceof a)&&(f=a(f));return e.fn.init.call(this,d,f,b)},a.fn.init.prototype=a.fn;var b=a(c);return a},browser:{}}),e.each(\"Boolean Number String Function Array Date RegExp Object\".split(\" \"),function(a,b){I[\"[object \"+b+\"]\"]=b.toLowerCase()}),z=e.uaMatch(y),z.browser&&(e.browser[z.browser]=!0,e.browser.version=z.version),e.browser.webkit&&(e.browser.safari=!0),j.test(\" \")&&(k=/^[\\s\\xA0]+/,l=/[\\s\\xA0]+$/),h=e(c),c.addEventListener?B=function(){c.removeEventListener(\"DOMContentLoaded\",B,!1),e.ready()}:c.attachEvent&&(B=function(){c.readyState===\"complete\"&&(c.detachEvent(\"onreadystatechange\",B),e.ready())});return e}(),g={};f.Callbacks=function(a){a=a?g[a]||h(a):{};var c=[],d=[],e,i,j,k,l,m,n=function(b){var d,e,g,h,i;for(d=0,e=b.length;d<e;d++)g=b[d],h=f.type(g),h===\"array\"?n(g):h===\"function\"&&(!a.unique||!p.has(g))&&c.push(g)},o=function(b,f){f=f||[],e=!a.memory||[b,f],i=!0,j=!0,m=k||0,k=0,l=c.length;for(;c&&m<l;m++)if(c[m].apply(b,f)===!1&&a.stopOnFalse){e=!0;break}j=!1,c&&(a.once?e===!0?p.disable():c=[]:d&&d.length&&(e=d.shift(),p.fireWith(e[0],e[1])))},p={add:function(){if(c){var a=c.length;n(arguments),j?l=c.length:e&&e!==!0&&(k=a,o(e[0],e[1]))}return this},remove:function(){if(c){var b=arguments,d=0,e=b.length;for(;d<e;d++)for(var f=0;f<c.length;f++)if(b[d]===c[f]){j&&f<=l&&(l--,f<=m&&m--),c.splice(f--,1);if(a.unique)break}}return this},has:function(a){if(c){var b=0,d=c.length;for(;b<d;b++)if(a===c[b])return!0}return!1},empty:function(){c=[];return this},disable:function(){c=d=e=b;return this},disabled:function(){return!c},lock:function(){d=b,(!e||e===!0)&&p.disable();return this},locked:function(){return!d},fireWith:function(b,c){d&&(j?a.once||d.push([b,c]):(!a.once||!e)&&o(b,c));return this},fire:function(){p.fireWith(this,arguments);return this},fired:function(){return!!i}};return p};var i=[].slice;f.extend({Deferred:function(a){var b=f.Callbacks(\"once memory\"),c=f.Callbacks(\"once memory\"),d=f.Callbacks(\"memory\"),e=\"pending\",g={resolve:b,reject:c,notify:d},h={done:b.add,fail:c.add,progress:d.add,state:function(){return e},isResolved:b.fired,isRejected:c.fired,then:function(a,b,c){i.done(a).fail(b).progress(c);return this},always:function(){i.done.apply(i,arguments).fail.apply(i,arguments);return this},pipe:function(a,b,c){return f.Deferred(function(d){f.each({done:[a,\"resolve\"],fail:[b,\"reject\"],progress:[c,\"notify\"]},function(a,b){var c=b[0],e=b[1],g;f.isFunction(c)?i[a](function(){g=c.apply(this,arguments),g&&f.isFunction(g.promise)?g.promise().then(d.resolve,d.reject,d.notify):d[e+\"With\"](this===i?d:this,[g])}):i[a](d[e])})}).promise()},promise:function(a){if(a==null)a=h;else for(var b in h)a[b]=h[b];return a}},i=h.promise({}),j;for(j in g)i[j]=g[j].fire,i[j+\"With\"]=g[j].fireWith;i.done(function(){e=\"resolved\"},c.disable,d.lock).fail(function(){e=\"rejected\"},b.disable,d.lock),a&&a.call(i,i);return i},when:function(a){function m(a){return function(b){e[a]=arguments.length>1?i.call(arguments,0):b,j.notifyWith(k,e)}}function l(a){return function(c){b[a]=arguments.length>1?i.call(arguments,0):c,--g||j.resolveWith(j,b)}}var b=i.call(arguments,0),c=0,d=b.length,e=Array(d),g=d,h=d,j=d<=1&&a&&f.isFunction(a.promise)?a:f.Deferred(),k=j.promise();if(d>1){for(;c<d;c++)b[c]&&b[c].promise&&f.isFunction(b[c].promise)?b[c].promise().then(l(c),j.reject,m(c)):--g;g||j.resolveWith(j,b)}else j!==a&&j.resolveWith(j,d?[a]:[]);return k}}),f.support=function(){var b,d,e,g,h,i,j,k,l,m,n,o,p=c.createElement(\"div\"),q=c.documentElement;p.setAttribute(\"className\",\"t\"),p.innerHTML=\"   <link/><table></table><a href=\'/a\' style=\'top:1px;float:left;opacity:.55;\'>a</a><input type=\'checkbox\'/>\",d=p.getElementsByTagName(\"*\"),e=p.getElementsByTagName(\"a\")[0];if(!d||!d.length||!e)return{};g=c.createElement(\"select\"),h=g.appendChild(c.createElement(\"option\")),i=p.getElementsByTagName(\"input\")[0],b={leadingWhitespace:p.firstChild.nodeType===3,tbody:!p.getElementsByTagName(\"tbody\").length,htmlSerialize:!!p.getElementsByTagName(\"link\").length,style:/top/.test(e.getAttribute(\"style\")),hrefNormalized:e.getAttribute(\"href\")===\"/a\",opacity:/^0.55/.test(e.style.opacity),cssFloat:!!e.style.cssFloat,checkOn:i.value===\"on\",optSelected:h.selected,getSetAttribute:p.className!==\"t\",enctype:!!c.createElement(\"form\").enctype,html5Clone:c.createElement(\"nav\").cloneNode(!0).outerHTML!==\"<:nav></:nav>\",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,pixelMargin:!0},f.boxModel=b.boxModel=c.compatMode===\"CSS1Compat\",i.checked=!0,b.noCloneChecked=i.cloneNode(!0).checked,g.disabled=!0,b.optDisabled=!h.disabled;try{delete p.test}catch(r){b.deleteExpando=!1}!p.addEventListener&&p.attachEvent&&p.fireEvent&&(p.attachEvent(\"onclick\",function(){b.noCloneEvent=!1}),p.cloneNode(!0).fireEvent(\"onclick\")),i=c.createElement(\"input\"),i.value=\"t\",i.setAttribute(\"type\",\"radio\"),b.radioValue=i.value===\"t\",i.setAttribute(\"checked\",\"checked\"),i.setAttribute(\"name\",\"t\"),p.appendChild(i),j=c.createDocumentFragment(),j.appendChild(p.lastChild),b.checkClone=j.cloneNode(!0).cloneNode(!0).lastChild.checked,b.appendChecked=i.checked,j.removeChild(i),j.appendChild(p);if(p.attachEvent)for(n in{submit:1,change:1,focusin:1})m=\"on\"+n,o=m in p,o||(p.setAttribute(m,\"return;\"),o=typeof p[m]==\"function\"),b[n+\"Bubbles\"]=o;j.removeChild(p),j=g=h=p=i=null,f(function(){var d,e,g,h,i,j,l,m,n,q,r,s,t,u=c.getElementsByTagName(\"body\")[0];!u||(m=1,t=\"padding:0;margin:0;border:\",r=\"position:absolute;top:0;left:0;width:1px;height:1px;\",s=t+\"0;visibility:hidden;\",n=\"style=\'\"+r+t+\"5px solid #000;\",q=\"<div \"+n+\"display:block;\'><div style=\'\"+t+\"0;display:block;overflow:hidden;\'></div></div>\"+\"<table \"+n+\"\' cellpadding=\'0\' cellspacing=\'0\'>\"+\"<tr><td></td></tr></table>\",d=c.createElement(\"div\"),d.style.cssText=s+\"width:0;height:0;position:static;top:0;margin-top:\"+m+\"px\",u.insertBefore(d,u.firstChild),p=c.createElement(\"div\"),d.appendChild(p),p.innerHTML=\"<table><tr><td style=\'\"+t+\"0;display:none\'></td><td>t</td></tr></table>\",k=p.getElementsByTagName(\"td\"),o=k[0].offsetHeight===0,k[0].style.display=\"\",k[1].style.display=\"none\",b.reliableHiddenOffsets=o&&k[0].offsetHeight===0,a.getComputedStyle&&(p.innerHTML=\"\",l=c.createElement(\"div\"),l.style.width=\"0\",l.style.marginRight=\"0\",p.style.width=\"2px\",p.appendChild(l),b.reliableMarginRight=(parseInt((a.getComputedStyle(l,null)||{marginRight:0}).marginRight,10)||0)===0),typeof p.style.zoom!=\"undefined\"&&(p.innerHTML=\"\",p.style.width=p.style.padding=\"1px\",p.style.border=0,p.style.overflow=\"hidden\",p.style.display=\"inline\",p.style.zoom=1,b.inlineBlockNeedsLayout=p.offsetWidth===3,p.style.display=\"block\",p.style.overflow=\"visible\",p.innerHTML=\"<div style=\'width:5px;\'></div>\",b.shrinkWrapBlocks=p.offsetWidth!==3),p.style.cssText=r+s,p.innerHTML=q,e=p.firstChild,g=e.firstChild,i=e.nextSibling.firstChild.firstChild,j={doesNotAddBorder:g.offsetTop!==5,doesAddBorderForTableAndCells:i.offsetTop===5},g.style.position=\"fixed\",g.style.top=\"20px\",j.fixedPosition=g.offsetTop===20||g.offsetTop===15,g.style.position=g.style.top=\"\",e.style.overflow=\"hidden\",e.style.position=\"relative\",j.subtractsBorderForOverflowNotVisible=g.offsetTop===-5,j.doesNotIncludeMarginInBodyOffset=u.offsetTop!==m,a.getComputedStyle&&(p.style.marginTop=\"1%\",b.pixelMargin=(a.getComputedStyle(p,null)||{marginTop:0}).marginTop!==\"1%\"),typeof d.style.zoom!=\"undefined\"&&(d.style.zoom=1),u.removeChild(d),l=p=d=null,f.extend(b,j))});return b}();var j=/^(?:\\{.*\\}|\\[.*\\])$/,k=/([A-Z])/g;f.extend({cache:{},uuid:0,expando:\"jQuery\"+(f.fn.jquery+Math.random()).replace(/\\D/g,\"\"),noData:{embed:!0,object:\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\",applet:!0},hasData:function(a){a=a.nodeType?f.cache[a[f.expando]]:a[f.expando];return!!a&&!m(a)},data:function(a,c,d,e){if(!!f.acceptData(a)){var g,h,i,j=f.expando,k=typeof c==\"string\",l=a.nodeType,m=l?f.cache:a,n=l?a[j]:a[j]&&j,o=c===\"events\";if((!n||!m[n]||!o&&!e&&!m[n].data)&&k&&d===b)return;n||(l?a[j]=n=++f.uuid:n=j),m[n]||(m[n]={},l||(m[n].toJSON=f.noop));if(typeof c==\"object\"||typeof c==\"function\")e?m[n]=f.extend(m[n],c):m[n].data=f.extend(m[n].data,c);g=h=m[n],e||(h.data||(h.data={}),h=h.data),d!==b&&(h[f.camelCase(c)]=d);if(o&&!h[c])return g.events;k?(i=h[c],i==null&&(i=h[f.camelCase(c)])):i=h;return i}},removeData:function(a,b,c){if(!!f.acceptData(a)){var d,e,g,h=f.expando,i=a.nodeType,j=i?f.cache:a,k=i?a[h]:h;if(!j[k])return;if(b){d=c?j[k]:j[k].data;if(d){f.isArray(b)||(b in d?b=[b]:(b=f.camelCase(b),b in d?b=[b]:b=b.split(\" \")));for(e=0,g=b.length;e<g;e++)delete d[b[e]];if(!(c?m:f.isEmptyObject)(d))return}}if(!c){delete j[k].data;if(!m(j[k]))return}f.support.deleteExpando||!j.setInterval?delete j[k]:j[k]=null,i&&(f.support.deleteExpando?delete a[h]:a.removeAttribute?a.removeAttribute(h):a[h]=null)}},_data:function(a,b,c){return f.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=f.noData[a.nodeName.toLowerCase()];if(b)return b!==!0&&a.getAttribute(\"classid\")===b}return!0}}),f.fn.extend({data:function(a,c){var d,e,g,h,i,j=this[0],k=0,m=null;if(a===b){if(this.length){m=f.data(j);if(j.nodeType===1&&!f._data(j,\"parsedAttrs\")){g=j.attributes;for(i=g.length;k<i;k++)h=g[k].name,h.indexOf(\"data-\")===0&&(h=f.camelCase(h.substring(5)),l(j,h,m[h]));f._data(j,\"parsedAttrs\",!0)}}return m}if(typeof a==\"object\")return this.each(function(){f.data(this,a)});d=a.split(\".\",2),d[1]=d[1]?\".\"+d[1]:\"\",e=d[1]+\"!\";return f.access(this,function(c){if(c===b){m=this.triggerHandler(\"getData\"+e,[d[0]]),m===b&&j&&(m=f.data(j,a),m=l(j,a,m));return m===b&&d[1]?this.data(d[0]):m}d[1]=c,this.each(function(){var b=f(this);b.triggerHandler(\"setData\"+e,d),f.data(this,a,c),b.triggerHandler(\"changeData\"+e,d)})},null,c,arguments.length>1,null,!1)},removeData:function(a){return this.each(function(){f.removeData(this,a)})}}),f.extend({_mark:function(a,b){a&&(b=(b||\"fx\")+\"mark\",f._data(a,b,(f._data(a,b)||0)+1))},_unmark:function(a,b,c){a!==!0&&(c=b,b=a,a=!1);if(b){c=c||\"fx\";var d=c+\"mark\",e=a?0:(f._data(b,d)||1)-1;e?f._data(b,d,e):(f.removeData(b,d,!0),n(b,c,\"mark\"))}},queue:function(a,b,c){var d;if(a){b=(b||\"fx\")+\"queue\",d=f._data(a,b),c&&(!d||f.isArray(c)?d=f._data(a,b,f.makeArray(c)):d.push(c));return d||[]}},dequeue:function(a,b){b=b||\"fx\";var c=f.queue(a,b),d=c.shift(),e={};d===\"inprogress\"&&(d=c.shift()),d&&(b===\"fx\"&&c.unshift(\"inprogress\"),f._data(a,b+\".run\",e),d.call(a,function(){f.dequeue(a,b)},e)),c.length||(f.removeData(a,b+\"queue \"+b+\".run\",!0),n(a,b,\"queue\"))}}),f.fn.extend({queue:function(a,c){var d=2;typeof a!=\"string\"&&(c=a,a=\"fx\",d--);if(arguments.length<d)return f.queue(this[0],a);return c===b?this:this.each(function(){var b=f.queue(this,a,c);a===\"fx\"&&b[0]!==\"inprogress\"&&f.dequeue(this,a)})},dequeue:function(a){return this.each(function(){f.dequeue(this,a)})},delay:function(a,b){a=f.fx?f.fx.speeds[a]||a:a,b=b||\"fx\";return this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||\"fx\",[])},promise:function(a,c){function m(){--h||d.resolveWith(e,[e])}typeof a!=\"string\"&&(c=a,a=b),a=a||\"fx\";var d=f.Deferred(),e=this,g=e.length,h=1,i=a+\"defer\",j=a+\"queue\",k=a+\"mark\",l;while(g--)if(l=f.data(e[g],i,b,!0)||(f.data(e[g],j,b,!0)||f.data(e[g],k,b,!0))&&f.data(e[g],i,f.Callbacks(\"once memory\"),!0))h++,l.add(m);m();return d.promise(c)}});var o=/[\\n\\t\\r]/g,p=/\\s+/,q=/\\r/g,r=/^(?:button|input)$/i,s=/^(?:button|input|object|select|textarea)$/i,t=/^a(?:rea)?$/i,u=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,v=f.support.getSetAttribute,w,x,y;f.fn.extend({attr:function(a,b){return f.access(this,f.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){f.removeAttr(this,a)})},prop:function(a,b){return f.access(this,f.prop,a,b,arguments.length>1)},removeProp:function(a){a=f.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,g,h,i;if(f.isFunction(a))return this.each(function(b){f(this).addClass(a.call(this,b,this.className))});if(a&&typeof a==\"string\"){b=a.split(p);for(c=0,d=this.length;c<d;c++){e=this[c];if(e.nodeType===1)if(!e.className&&b.length===1)e.className=a;else{g=\" \"+e.className+\" \";for(h=0,i=b.length;h<i;h++)~g.indexOf(\" \"+b[h]+\" \")||(g+=b[h]+\" \");e.className=f.trim(g)}}}return this},removeClass:function(a){var c,d,e,g,h,i,j;if(f.isFunction(a))return this.each(function(b){f(this).removeClass(a.call(this,b,this.className))});if(a&&typeof a==\"string\"||a===b){c=(a||\"\").split(p);for(d=0,e=this.length;d<e;d++){g=this[d];if(g.nodeType===1&&g.className)if(a){h=(\" \"+g.className+\" \").replace(o,\" \");for(i=0,j=c.length;i<j;i++)h=h.replace(\" \"+c[i]+\" \",\" \");g.className=f.trim(h)}else g.className=\"\"}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b==\"boolean\";if(f.isFunction(a))return this.each(function(c){f(this).toggleClass(a.call(this,c,this.className,b),b)});return this.each(function(){if(c===\"string\"){var e,g=0,h=f(this),i=b,j=a.split(p);while(e=j[g++])i=d?i:!h.hasClass(e),h[i?\"addClass\":\"removeClass\"](e)}else if(c===\"undefined\"||c===\"boolean\")this.className&&f._data(this,\"__className__\",this.className),this.className=this.className||a===!1?\"\":f._data(this,\"__className__\")||\"\"})},hasClass:function(a){var b=\" \"+a+\" \",c=0,d=this.length;for(;c<d;c++)if(this[c].nodeType===1&&(\" \"+this[c].className+\" \").replace(o,\" \").indexOf(b)>-1)return!0;return!1},val:function(a){var c,d,e,g=this[0];{if(!!arguments.length){e=f.isFunction(a);return this.each(function(d){var g=f(this),h;if(this.nodeType===1){e?h=a.call(this,d,g.val()):h=a,h==null?h=\"\":typeof h==\"number\"?h+=\"\":f.isArray(h)&&(h=f.map(h,function(a){return a==null?\"\":a+\"\"})),c=f.valHooks[this.type]||f.valHooks[this.nodeName.toLowerCase()];if(!c||!(\"set\"in c)||c.set(this,h,\"value\")===b)this.value=h}})}if(g){c=f.valHooks[g.type]||f.valHooks[g.nodeName.toLowerCase()];if(c&&\"get\"in c&&(d=c.get(g,\"value\"))!==b)return d;d=g.value;return typeof d==\"string\"?d.replace(q,\"\"):d==null?\"\":d}}}}),f.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d,e,g=a.selectedIndex,h=[],i=a.options,j=a.type===\"select-one\";if(g<0)return null;c=j?g:0,d=j?g+1:i.length;for(;c<d;c++){e=i[c];if(e.selected&&(f.support.optDisabled?!e.disabled:e.getAttribute(\"disabled\")===null)&&(!e.parentNode.disabled||!f.nodeName(e.parentNode,\"optgroup\"))){b=f(e).val();if(j)return b;h.push(b)}}if(j&&!h.length&&i.length)return f(i[g]).val();return h},set:function(a,b){var c=f.makeArray(b);f(a).find(\"option\").each(function(){this.selected=f.inArray(f(this).val(),c)>=0}),c.length||(a.selectedIndex=-1);return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(a,c,d,e){var g,h,i,j=a.nodeType;if(!!a&&j!==3&&j!==8&&j!==2){if(e&&c in f.attrFn)return f(a)[c](d);if(typeof a.getAttribute==\"undefined\")return f.prop(a,c,d);i=j!==1||!f.isXMLDoc(a),i&&(c=c.toLowerCase(),h=f.attrHooks[c]||(u.test(c)?x:w));if(d!==b){if(d===null){f.removeAttr(a,c);return}if(h&&\"set\"in h&&i&&(g=h.set(a,d,c))!==b)return g;a.setAttribute(c,\"\"+d);return d}if(h&&\"get\"in h&&i&&(g=h.get(a,c))!==null)return g;g=a.getAttribute(c);return g===null?b:g}},removeAttr:function(a,b){var c,d,e,g,h,i=0;if(b&&a.nodeType===1){d=b.toLowerCase().split(p),g=d.length;for(;i<g;i++)e=d[i],e&&(c=f.propFix[e]||e,h=u.test(e),h||f.attr(a,e,\"\"),a.removeAttribute(v?e:c),h&&c in a&&(a[c]=!1))}},attrHooks:{type:{set:function(a,b){if(r.test(a.nodeName)&&a.parentNode)f.error(\"type property can\'t be changed\");else if(!f.support.radioValue&&b===\"radio\"&&f.nodeName(a,\"input\")){var c=a.value;a.setAttribute(\"type\",b),c&&(a.value=c);return b}}},value:{get:function(a,b){if(w&&f.nodeName(a,\"button\"))return w.get(a,b);return b in a?a.value:null},set:function(a,b,c){if(w&&f.nodeName(a,\"button\"))return w.set(a,b,c);a.value=b}}},propFix:{tabindex:\"tabIndex\",readonly:\"readOnly\",\"for\":\"htmlFor\",\"class\":\"className\",maxlength:\"maxLength\",cellspacing:\"cellSpacing\",cellpadding:\"cellPadding\",rowspan:\"rowSpan\",colspan:\"colSpan\",usemap:\"useMap\",frameborder:\"frameBorder\",contenteditable:\"contentEditable\"},prop:function(a,c,d){var e,g,h,i=a.nodeType;if(!!a&&i!==3&&i!==8&&i!==2){h=i!==1||!f.isXMLDoc(a),h&&(c=f.propFix[c]||c,g=f.propHooks[c]);return d!==b?g&&\"set\"in g&&(e=g.set(a,d,c))!==b?e:a[c]=d:g&&\"get\"in g&&(e=g.get(a,c))!==null?e:a[c]}},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode(\"tabindex\");return c&&c.specified?parseInt(c.value,10):s.test(a.nodeName)||t.test(a.nodeName)&&a.href?0:b}}}}),f.attrHooks.tabindex=f.propHooks.tabIndex,x={get:function(a,c){var d,e=f.prop(a,c);return e===!0||typeof e!=\"boolean\"&&(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;b===!1?f.removeAttr(a,c):(d=f.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase()));return c}},v||(y={name:!0,id:!0,coords:!0},w=f.valHooks.button={get:function(a,c){var d;d=a.getAttributeNode(c);return d&&(y[c]?d.nodeValue!==\"\":d.specified)?d.nodeValue:b},set:function(a,b,d){var e=a.getAttributeNode(d);e||(e=c.createAttribute(d),a.setAttributeNode(e));return e.nodeValue=b+\"\"}},f.attrHooks.tabindex.set=w.set,f.each([\"width\",\"height\"],function(a,b){f.attrHooks[b]=f.extend(f.attrHooks[b],{set:function(a,c){if(c===\"\"){a.setAttribute(b,\"auto\");return c}}})}),f.attrHooks.contenteditable={get:w.get,set:function(a,b,c){b===\"\"&&(b=\"false\"),w.set(a,b,c)}}),f.support.hrefNormalized||f.each([\"href\",\"src\",\"width\",\"height\"],function(a,c){f.attrHooks[c]=f.extend(f.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),f.support.style||(f.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=\"\"+b}}),f.support.optSelected||(f.propHooks.selected=f.extend(f.propHooks.selected,{get:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex);return null}})),f.support.enctype||(f.propFix.enctype=\"encoding\"),f.support.checkOn||f.each([\"radio\",\"checkbox\"],function(){f.valHooks[this]={get:function(a){return a.getAttribute(\"value\")===null?\"on\":a.value}}}),f.each([\"radio\",\"checkbox\"],function(){f.valHooks[this]=f.extend(f.valHooks[this],{set:function(a,b){if(f.isArray(b))return a.checked=f.inArray(f(a).val(),b)>=0}})});var z=/^(?:textarea|input|select)$/i,A=/^([^\\.]*)?(?:\\.(.+))?$/,B=/(?:^|\\s)hover(\\.\\S+)?\\b/,C=/^key/,D=/^(?:mouse|contextmenu)|click/,E=/^(?:focusinfocus|focusoutblur)$/,F=/^(\\w*)(?:#([\\w\\-]+))?(?:\\.([\\w\\-]+))?$/,G=function(\r\na){var b=F.exec(a);b&&(b[1]=(b[1]||\"\").toLowerCase(),b[3]=b[3]&&new RegExp(\"(?:^|\\\\s)\"+b[3]+\"(?:\\\\s|$)\"));return b},H=function(a,b){var c=a.attributes||{};return(!b[1]||a.nodeName.toLowerCase()===b[1])&&(!b[2]||(c.id||{}).value===b[2])&&(!b[3]||b[3].test((c[\"class\"]||{}).value))},I=function(a){return f.event.special.hover?a:a.replace(B,\"mouseenter$1 mouseleave$1\")};f.event={add:function(a,c,d,e,g){var h,i,j,k,l,m,n,o,p,q,r,s;if(!(a.nodeType===3||a.nodeType===8||!c||!d||!(h=f._data(a)))){d.handler&&(p=d,d=p.handler,g=p.selector),d.guid||(d.guid=f.guid++),j=h.events,j||(h.events=j={}),i=h.handle,i||(h.handle=i=function(a){return typeof f!=\"undefined\"&&(!a||f.event.triggered!==a.type)?f.event.dispatch.apply(i.elem,arguments):b},i.elem=a),c=f.trim(I(c)).split(\" \");for(k=0;k<c.length;k++){l=A.exec(c[k])||[],m=l[1],n=(l[2]||\"\").split(\".\").sort(),s=f.event.special[m]||{},m=(g?s.delegateType:s.bindType)||m,s=f.event.special[m]||{},o=f.extend({type:m,origType:l[1],data:e,handler:d,guid:d.guid,selector:g,quick:g&&G(g),namespace:n.join(\".\")},p),r=j[m];if(!r){r=j[m]=[],r.delegateCount=0;if(!s.setup||s.setup.call(a,e,n,i)===!1)a.addEventListener?a.addEventListener(m,i,!1):a.attachEvent&&a.attachEvent(\"on\"+m,i)}s.add&&(s.add.call(a,o),o.handler.guid||(o.handler.guid=d.guid)),g?r.splice(r.delegateCount++,0,o):r.push(o),f.event.global[m]=!0}a=null}},global:{},remove:function(a,b,c,d,e){var g=f.hasData(a)&&f._data(a),h,i,j,k,l,m,n,o,p,q,r,s;if(!!g&&!!(o=g.events)){b=f.trim(I(b||\"\")).split(\" \");for(h=0;h<b.length;h++){i=A.exec(b[h])||[],j=k=i[1],l=i[2];if(!j){for(j in o)f.event.remove(a,j+b[h],c,d,!0);continue}p=f.event.special[j]||{},j=(d?p.delegateType:p.bindType)||j,r=o[j]||[],m=r.length,l=l?new RegExp(\"(^|\\\\.)\"+l.split(\".\").sort().join(\"\\\\.(?:.*\\\\.)?\")+\"(\\\\.|$)\"):null;for(n=0;n<r.length;n++)s=r[n],(e||k===s.origType)&&(!c||c.guid===s.guid)&&(!l||l.test(s.namespace))&&(!d||d===s.selector||d===\"**\"&&s.selector)&&(r.splice(n--,1),s.selector&&r.delegateCount--,p.remove&&p.remove.call(a,s));r.length===0&&m!==r.length&&((!p.teardown||p.teardown.call(a,l)===!1)&&f.removeEvent(a,j,g.handle),delete o[j])}f.isEmptyObject(o)&&(q=g.handle,q&&(q.elem=null),f.removeData(a,[\"events\",\"handle\"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,g){if(!e||e.nodeType!==3&&e.nodeType!==8){var h=c.type||c,i=[],j,k,l,m,n,o,p,q,r,s;if(E.test(h+f.event.triggered))return;h.indexOf(\"!\")>=0&&(h=h.slice(0,-1),k=!0),h.indexOf(\".\")>=0&&(i=h.split(\".\"),h=i.shift(),i.sort());if((!e||f.event.customEvent[h])&&!f.event.global[h])return;c=typeof c==\"object\"?c[f.expando]?c:new f.Event(h,c):new f.Event(h),c.type=h,c.isTrigger=!0,c.exclusive=k,c.namespace=i.join(\".\"),c.namespace_re=c.namespace?new RegExp(\"(^|\\\\.)\"+i.join(\"\\\\.(?:.*\\\\.)?\")+\"(\\\\.|$)\"):null,o=h.indexOf(\":\")<0?\"on\"+h:\"\";if(!e){j=f.cache;for(l in j)j[l].events&&j[l].events[h]&&f.event.trigger(c,d,j[l].handle.elem,!0);return}c.result=b,c.target||(c.target=e),d=d!=null?f.makeArray(d):[],d.unshift(c),p=f.event.special[h]||{};if(p.trigger&&p.trigger.apply(e,d)===!1)return;r=[[e,p.bindType||h]];if(!g&&!p.noBubble&&!f.isWindow(e)){s=p.delegateType||h,m=E.test(s+h)?e:e.parentNode,n=null;for(;m;m=m.parentNode)r.push([m,s]),n=m;n&&n===e.ownerDocument&&r.push([n.defaultView||n.parentWindow||a,s])}for(l=0;l<r.length&&!c.isPropagationStopped();l++)m=r[l][0],c.type=r[l][1],q=(f._data(m,\"events\")||{})[c.type]&&f._data(m,\"handle\"),q&&q.apply(m,d),q=o&&m[o],q&&f.acceptData(m)&&q.apply(m,d)===!1&&c.preventDefault();c.type=h,!g&&!c.isDefaultPrevented()&&(!p._default||p._default.apply(e.ownerDocument,d)===!1)&&(h!==\"click\"||!f.nodeName(e,\"a\"))&&f.acceptData(e)&&o&&e[h]&&(h!==\"focus\"&&h!==\"blur\"||c.target.offsetWidth!==0)&&!f.isWindow(e)&&(n=e[o],n&&(e[o]=null),f.event.triggered=h,e[h](),f.event.triggered=b,n&&(e[o]=n));return c.result}},dispatch:function(c){c=f.event.fix(c||a.event);var d=(f._data(this,\"events\")||{})[c.type]||[],e=d.delegateCount,g=[].slice.call(arguments,0),h=!c.exclusive&&!c.namespace,i=f.event.special[c.type]||{},j=[],k,l,m,n,o,p,q,r,s,t,u;g[0]=c,c.delegateTarget=this;if(!i.preDispatch||i.preDispatch.call(this,c)!==!1){if(e&&(!c.button||c.type!==\"click\")){n=f(this),n.context=this.ownerDocument||this;for(m=c.target;m!=this;m=m.parentNode||this)if(m.disabled!==!0){p={},r=[],n[0]=m;for(k=0;k<e;k++)s=d[k],t=s.selector,p[t]===b&&(p[t]=s.quick?H(m,s.quick):n.is(t)),p[t]&&r.push(s);r.length&&j.push({elem:m,matches:r})}}d.length>e&&j.push({elem:this,matches:d.slice(e)});for(k=0;k<j.length&&!c.isPropagationStopped();k++){q=j[k],c.currentTarget=q.elem;for(l=0;l<q.matches.length&&!c.isImmediatePropagationStopped();l++){s=q.matches[l];if(h||!c.namespace&&!s.namespace||c.namespace_re&&c.namespace_re.test(s.namespace))c.data=s.data,c.handleObj=s,o=((f.event.special[s.origType]||{}).handle||s.handler).apply(q.elem,g),o!==b&&(c.result=o,o===!1&&(c.preventDefault(),c.stopPropagation()))}}i.postDispatch&&i.postDispatch.call(this,c);return c.result}},props:\"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which\".split(\" \"),fixHooks:{},keyHooks:{props:\"char charCode key keyCode\".split(\" \"),filter:function(a,b){a.which==null&&(a.which=b.charCode!=null?b.charCode:b.keyCode);return a}},mouseHooks:{props:\"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement\".split(\" \"),filter:function(a,d){var e,f,g,h=d.button,i=d.fromElement;a.pageX==null&&d.clientX!=null&&(e=a.target.ownerDocument||c,f=e.documentElement,g=e.body,a.pageX=d.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=d.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)),!a.relatedTarget&&i&&(a.relatedTarget=i===a.target?d.toElement:i),!a.which&&h!==b&&(a.which=h&1?1:h&2?3:h&4?2:0);return a}},fix:function(a){if(a[f.expando])return a;var d,e,g=a,h=f.event.fixHooks[a.type]||{},i=h.props?this.props.concat(h.props):this.props;a=f.Event(g);for(d=i.length;d;)e=i[--d],a[e]=g[e];a.target||(a.target=g.srcElement||c),a.target.nodeType===3&&(a.target=a.target.parentNode),a.metaKey===b&&(a.metaKey=a.ctrlKey);return h.filter?h.filter(a,g):a},special:{ready:{setup:f.bindReady},load:{noBubble:!0},focus:{delegateType:\"focusin\"},blur:{delegateType:\"focusout\"},beforeunload:{setup:function(a,b,c){f.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){var e=f.extend(new f.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?f.event.trigger(e,null,b):f.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},f.event.handle=f.event.dispatch,f.removeEvent=c.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent(\"on\"+b,c)},f.Event=function(a,b){if(!(this instanceof f.Event))return new f.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?K:J):this.type=a,b&&f.extend(this,b),this.timeStamp=a&&a.timeStamp||f.now(),this[f.expando]=!0},f.Event.prototype={preventDefault:function(){this.isDefaultPrevented=K;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=K;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=K,this.stopPropagation()},isDefaultPrevented:J,isPropagationStopped:J,isImmediatePropagationStopped:J},f.each({mouseenter:\"mouseover\",mouseleave:\"mouseout\"},function(a,b){f.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c=this,d=a.relatedTarget,e=a.handleObj,g=e.selector,h;if(!d||d!==c&&!f.contains(c,d))a.type=e.origType,h=e.handler.apply(this,arguments),a.type=b;return h}}}),f.support.submitBubbles||(f.event.special.submit={setup:function(){if(f.nodeName(this,\"form\"))return!1;f.event.add(this,\"click._submit keypress._submit\",function(a){var c=a.target,d=f.nodeName(c,\"input\")||f.nodeName(c,\"button\")?c.form:b;d&&!d._submit_attached&&(f.event.add(d,\"submit._submit\",function(a){a._submit_bubble=!0}),d._submit_attached=!0)})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&f.event.simulate(\"submit\",this.parentNode,a,!0))},teardown:function(){if(f.nodeName(this,\"form\"))return!1;f.event.remove(this,\"._submit\")}}),f.support.changeBubbles||(f.event.special.change={setup:function(){if(z.test(this.nodeName)){if(this.type===\"checkbox\"||this.type===\"radio\")f.event.add(this,\"propertychange._change\",function(a){a.originalEvent.propertyName===\"checked\"&&(this._just_changed=!0)}),f.event.add(this,\"click._change\",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1,f.event.simulate(\"change\",this,a,!0))});return!1}f.event.add(this,\"beforeactivate._change\",function(a){var b=a.target;z.test(b.nodeName)&&!b._change_attached&&(f.event.add(b,\"change._change\",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&f.event.simulate(\"change\",this.parentNode,a,!0)}),b._change_attached=!0)})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!==\"radio\"&&b.type!==\"checkbox\")return a.handleObj.handler.apply(this,arguments)},teardown:function(){f.event.remove(this,\"._change\");return z.test(this.nodeName)}}),f.support.focusinBubbles||f.each({focus:\"focusin\",blur:\"focusout\"},function(a,b){var d=0,e=function(a){f.event.simulate(b,a.target,f.event.fix(a),!0)};f.event.special[b]={setup:function(){d++===0&&c.addEventListener(a,e,!0)},teardown:function(){--d===0&&c.removeEventListener(a,e,!0)}}}),f.fn.extend({on:function(a,c,d,e,g){var h,i;if(typeof a==\"object\"){typeof c!=\"string\"&&(d=d||c,c=b);for(i in a)this.on(i,c,d,a[i],g);return this}d==null&&e==null?(e=c,d=c=b):e==null&&(typeof c==\"string\"?(e=d,d=b):(e=d,d=c,c=b));if(e===!1)e=J;else if(!e)return this;g===1&&(h=e,e=function(a){f().off(a);return h.apply(this,arguments)},e.guid=h.guid||(h.guid=f.guid++));return this.each(function(){f.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,c,d){if(a&&a.preventDefault&&a.handleObj){var e=a.handleObj;f(a.delegateTarget).off(e.namespace?e.origType+\".\"+e.namespace:e.origType,e.selector,e.handler);return this}if(typeof a==\"object\"){for(var g in a)this.off(g,c,a[g]);return this}if(c===!1||typeof c==\"function\")d=c,c=b;d===!1&&(d=J);return this.each(function(){f.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){f(this.context).on(a,this.selector,b,c);return this},die:function(a,b){f(this.context).off(a,this.selector||\"**\",b);return this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return arguments.length==1?this.off(a,\"**\"):this.off(b,a,c)},trigger:function(a,b){return this.each(function(){f.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return f.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||f.guid++,d=0,e=function(c){var e=(f._data(this,\"lastToggle\"+a.guid)||0)%d;f._data(this,\"lastToggle\"+a.guid,e+1),c.preventDefault();return b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),f.each(\"blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu\".split(\" \"),function(a,b){f.fn[b]=function(a,c){c==null&&(c=a,a=null);return arguments.length>0?this.on(b,null,a,c):this.trigger(b)},f.attrFn&&(f.attrFn[b]=!0),C.test(b)&&(f.event.fixHooks[b]=f.event.keyHooks),D.test(b)&&(f.event.fixHooks[b]=f.event.mouseHooks)}),function(){function x(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}if(j.nodeType===1){g||(j[d]=c,j.sizset=h);if(typeof b!=\"string\"){if(j===b){k=!0;break}}else if(m.filter(b,[j]).length>0){k=j;break}}j=j[a]}e[h]=k}}}function w(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}j.nodeType===1&&!g&&(j[d]=c,j.sizset=h);if(j.nodeName.toLowerCase()===b){k=j;break}j=j[a]}e[h]=k}}}var a=/((?:\\((?:\\([^()]+\\)|[^()]+)+\\)|\\[(?:\\[[^\\[\\]]*\\]|[\'\"][^\'\"]*[\'\"]|[^\\[\\]\'\"]+)+\\]|\\\\.|[^ >+~,(\\[\\\\]+)+|[>+~])(\\s*,\\s*)?((?:.|\\r|\\n)*)/g,d=\"sizcache\"+(Math.random()+\"\").replace(\".\",\"\"),e=0,g=Object.prototype.toString,h=!1,i=!0,j=/\\\\/g,k=/\\r\\n/g,l=/\\W/;[0,0].sort(function(){i=!1;return 0});var m=function(b,d,e,f){e=e||[],d=d||c;var h=d;if(d.nodeType!==1&&d.nodeType!==9)return[];if(!b||typeof b!=\"string\")return e;var i,j,k,l,n,q,r,t,u=!0,v=m.isXML(d),w=[],x=b;do{a.exec(\"\"),i=a.exec(x);if(i){x=i[3],w.push(i[1]);if(i[2]){l=i[3];break}}}while(i);if(w.length>1&&p.exec(b))if(w.length===2&&o.relative[w[0]])j=y(w[0]+w[1],d,f);else{j=o.relative[w[0]]?[d]:m(w.shift(),d);while(w.length)b=w.shift(),o.relative[b]&&(b+=w.shift()),j=y(b,j,f)}else{!f&&w.length>1&&d.nodeType===9&&!v&&o.match.ID.test(w[0])&&!o.match.ID.test(w[w.length-1])&&(n=m.find(w.shift(),d,v),d=n.expr?m.filter(n.expr,n.set)[0]:n.set[0]);if(d){n=f?{expr:w.pop(),set:s(f)}:m.find(w.pop(),w.length===1&&(w[0]===\"~\"||w[0]===\"+\")&&d.parentNode?d.parentNode:d,v),j=n.expr?m.filter(n.expr,n.set):n.set,w.length>0?k=s(j):u=!1;while(w.length)q=w.pop(),r=q,o.relative[q]?r=w.pop():q=\"\",r==null&&(r=d),o.relative[q](k,r,v)}else k=w=[]}k||(k=j),k||m.error(q||b);if(g.call(k)===\"[object Array]\")if(!u)e.push.apply(e,k);else if(d&&d.nodeType===1)for(t=0;k[t]!=null;t++)k[t]&&(k[t]===!0||k[t].nodeType===1&&m.contains(d,k[t]))&&e.push(j[t]);else for(t=0;k[t]!=null;t++)k[t]&&k[t].nodeType===1&&e.push(j[t]);else s(k,e);l&&(m(l,h,e,f),m.uniqueSort(e));return e};m.uniqueSort=function(a){if(u){h=i,a.sort(u);if(h)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a},m.matches=function(a,b){return m(a,null,null,b)},m.matchesSelector=function(a,b){return m(b,null,null,[a]).length>0},m.find=function(a,b,c){var d,e,f,g,h,i;if(!a)return[];for(e=0,f=o.order.length;e<f;e++){h=o.order[e];if(g=o.leftMatch[h].exec(a)){i=g[1],g.splice(1,1);if(i.substr(i.length-1)!==\"\\\\\"){g[1]=(g[1]||\"\").replace(j,\"\"),d=o.find[h](g,b,c);if(d!=null){a=a.replace(o.match[h],\"\");break}}}}d||(d=typeof b.getElementsByTagName!=\"undefined\"?b.getElementsByTagName(\"*\"):[]);return{set:d,expr:a}},m.filter=function(a,c,d,e){var f,g,h,i,j,k,l,n,p,q=a,r=[],s=c,t=c&&c[0]&&m.isXML(c[0]);while(a&&c.length){for(h in o.filter)if((f=o.leftMatch[h].exec(a))!=null&&f[2]){k=o.filter[h],l=f[1],g=!1,f.splice(1,1);if(l.substr(l.length-1)===\"\\\\\")continue;s===r&&(r=[]);if(o.preFilter[h]){f=o.preFilter[h](f,s,d,r,e,t);if(!f)g=i=!0;else if(f===!0)continue}if(f)for(n=0;(j=s[n])!=null;n++)j&&(i=k(j,f,n,s),p=e^i,d&&i!=null?p?g=!0:s[n]=!1:p&&(r.push(j),g=!0));if(i!==b){d||(s=r),a=a.replace(o.match[h],\"\");if(!g)return[];break}}if(a===q)if(g==null)m.error(a);else break;q=a}return s},m.error=function(a){throw new Error(\"Syntax error, unrecognized expression: \"+a)};var n=m.getText=function(a){var b,c,d=a.nodeType,e=\"\";if(d){if(d===1||d===9||d===11){if(typeof a.textContent==\"string\")return a.textContent;if(typeof a.innerText==\"string\")return a.innerText.replace(k,\"\");for(a=a.firstChild;a;a=a.nextSibling)e+=n(a)}else if(d===3||d===4)return a.nodeValue}else for(b=0;c=a[b];b++)c.nodeType!==8&&(e+=n(c));return e},o=m.selectors={order:[\"ID\",\"NAME\",\"TAG\"],match:{ID:/#((?:[\\w\\u00c0-\\uFFFF\\-]|\\\\.)+)/,CLASS:/\\.((?:[\\w\\u00c0-\\uFFFF\\-]|\\\\.)+)/,NAME:/\\[name=[\'\"]*((?:[\\w\\u00c0-\\uFFFF\\-]|\\\\.)+)[\'\"]*\\]/,ATTR:/\\[\\s*((?:[\\w\\u00c0-\\uFFFF\\-]|\\\\.)+)\\s*(?:(\\S?=)\\s*(?:([\'\"])(.*?)\\3|(#?(?:[\\w\\u00c0-\\uFFFF\\-]|\\\\.)*)|)|)\\s*\\]/,TAG:/^((?:[\\w\\u00c0-\\uFFFF\\*\\-]|\\\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\\(\\s*(even|odd|(?:[+\\-]?\\d+|(?:[+\\-]?\\d*)?n\\s*(?:[+\\-]\\s*\\d+)?))\\s*\\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\\((\\d*)\\))?(?=[^\\-]|$)/,PSEUDO:/:((?:[\\w\\u00c0-\\uFFFF\\-]|\\\\.)+)(?:\\(([\'\"]?)((?:\\([^\\)]+\\)|[^\\(\\)]*)+)\\2\\))?/},leftMatch:{},attrMap:{\"class\":\"className\",\"for\":\"htmlFor\"},attrHandle:{href:function(a){return a.getAttribute(\"href\")},type:function(a){return a.getAttribute(\"type\")}},relative:{\"+\":function(a,b){var c=typeof b==\"string\",d=c&&!l.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f=0,g=a.length,h;f<g;f++)if(h=a[f]){while((h=h.previousSibling)&&h.nodeType!==1);a[f]=e||h&&h.nodeName.toLowerCase()===b?h||!1:h===b}e&&m.filter(b,a,!0)},\">\":function(a,b){var c,d=typeof b==\"string\",e=0,f=a.length;if(d&&!l.test(b)){b=b.toLowerCase();for(;e<f;e++){c=a[e];if(c){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}}else{for(;e<f;e++)c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b);d&&m.filter(b,a,!0)}},\"\":function(a,b,c){var d,f=e++,g=x;typeof b==\"string\"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g(\"parentNode\",b,f,a,d,c)},\"~\":function(a,b,c){var d,f=e++,g=x;typeof b==\"string\"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g(\"previousSibling\",b,f,a,d,c)}},find:{ID:function(a,b,c){if(typeof b.getElementById!=\"undefined\"&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof b.getElementsByName!=\"undefined\"){var c=[],d=b.getElementsByName(a[1]);for(var e=0,f=d.length;e<f;e++)d[e].getAttribute(\"name\")===a[1]&&c.push(d[e]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!=\"undefined\")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=\" \"+a[1].replace(j,\"\")+\" \";if(f)return a;for(var g=0,h;(h=b[g])!=null;g++)h&&(e^(h.className&&(\" \"+h.className+\" \").replace(/[\\t\\n\\r]/g,\" \").indexOf(a)>=0)?c||d.push(h):c&&(b[g]=!1));return!1},ID:function(a){return a[1].replace(j,\"\")},TAG:function(a,b){return a[1].replace(j,\"\").toLowerCase()},CHILD:function(a){if(a[1]===\"nth\"){a[2]||m.error(a[0]),a[2]=a[2].replace(/^\\+|\\s*/g,\"\");var b=/(-?)(\\d*)(?:n([+\\-]?\\d*))?/.exec(a[2]===\"even\"&&\"2n\"||a[2]===\"odd\"&&\"2n+1\"||!/\\D/.test(a[2])&&\"0n+\"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else a[2]&&m.error(a[0]);a[0]=e++;return a},ATTR:function(a,b,c,d,e,f){var g=a[1]=a[1].replace(j,\"\");!f&&o.attrMap[g]&&(a[1]=o.attrMap[g]),a[4]=(a[4]||a[5]||\"\").replace(j,\"\"),a[2]===\"~=\"&&(a[4]=\" \"+a[4]+\" \");return a},PSEUDO:function(b,c,d,e,f){if(b[1]===\"not\")if((a.exec(b[3])||\"\").length>1||/^\\w/.test(b[3]))b[3]=m(b[3],null,null,c);else{var g=m.filter(b[3],c,d,!0^f);d||e.push.apply(e,g);return!1}else if(o.match.POS.test(b[0])||o.match.CHILD.test(b[0]))return!0;return b},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!==\"hidden\"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!m(c[3],a).length},header:function(a){return/h\\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute(\"type\"),c=a.type;return a.nodeName.toLowerCase()===\"input\"&&\"text\"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()===\"input\"&&\"radio\"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()===\"input\"&&\"checkbox\"===a.type},file:function(a){return a.nodeName.toLowerCase()===\"input\"&&\"file\"===a.type},password:function(a){return a.nodeName.toLowerCase()===\"input\"&&\"password\"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b===\"input\"||b===\"button\")&&\"submit\"===a.type},image:function(a){return a.nodeName.toLowerCase()===\"input\"&&\"image\"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b===\"input\"||b===\"button\")&&\"reset\"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b===\"input\"&&\"button\"===a.type||b===\"button\"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=o.filters[e];if(f)return f(a,c,b,d);if(e===\"contains\")return(a.textContent||a.innerText||n([a])||\"\").indexOf(b[3])>=0;if(e===\"not\"){var g=b[3];for(var h=0,i=g.length;h<i;h++)if(g[h]===a)return!1;return!0}m.error(e)},CHILD:function(a,b){var c,e,f,g,h,i,j,k=b[1],l=a;switch(k){case\"only\":case\"first\":while(l=l.previousSibling)if(l.nodeType===1)return!1;if(k===\"first\")return!0;l=a;case\"last\":while(l=l.nextSibling)if(l.nodeType===1)return!1;return!0;case\"nth\":c=b[2],e=b[3];if(c===1&&e===0)return!0;f=b[0],g=a.parentNode;if(g&&(g[d]!==f||!a.nodeIndex)){i=0;for(l=g.firstChild;l;l=l.nextSibling)l.nodeType===1&&(l.nodeIndex=++i);g[d]=f}j=a.nodeIndex-e;return c===0?j===0:j%c===0&&j/c>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute(\"id\")===b},TAG:function(a,b){return b===\"*\"&&a.nodeType===1||!!a.nodeName&&a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(\" \"+(a.className||a.getAttribute(\"class\"))+\" \").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=m.attr?m.attr(a,c):o.attrHandle[c]?o.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=d+\"\",f=b[2],g=b[4];return d==null?f===\"!=\":!f&&m.attr?d!=null:f===\"=\"?e===g:f===\"*=\"?e.indexOf(g)>=0:f===\"~=\"?(\" \"+e+\" \").indexOf(g)>=0:g?f===\"!=\"?e!==g:f===\"^=\"?e.indexOf(g)===0:f===\"$=\"?e.substr(e.length-g.length)===g:f===\"|=\"?e===g||e.substr(0,g.length+1)===g+\"-\":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=o.setFilters[e];if(f)return f(a,c,b,d)}}},p=o.match.POS,q=function(a,b){return\"\\\\\"+(b-0+1)};for(var r in o.match)o.match[r]=new RegExp(o.match[r].source+/(?![^\\[]*\\])(?![^\\(]*\\))/.source),o.leftMatch[r]=new RegExp(/(^(?:.|\\r|\\n)*?)/.source+o.match[r].source.replace(/\\\\(\\d+)/g,q));o.match.globalPOS=p;var s=function(a,b){a=Array.prototype.slice.call(a,0);if(b){b.push.apply(b,a);return b}return a};try{Array.prototype.slice.call(c.documentElement.childNodes,0)[0].nodeType}catch(t){s=function(a,b){var c=0,d=b||[];if(g.call(a)===\"[object Array]\")Array.prototype.push.apply(d,a);else if(typeof a.length==\"number\")for(var e=a.length;c<e;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var u,v;c.documentElement.compareDocumentPosition?u=function(a,b){if(a===b){h=!0;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition)return a.compareDocumentPosition?-1:1;return a.compareDocumentPosition(b)&4?-1:1}:(u=function(a,b){if(a===b){h=!0;return 0}if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],g=a.parentNode,i=b.parentNode,j=g;if(g===i)return v(a,b);if(!g)return-1;if(!i)return 1;while(j)e.unshift(j),j=j.parentNode;j=i;while(j)f.unshift(j),j=j.parentNode;c=e.length,d=f.length;for(var k=0;k<c&&k<d;k++)if(e[k]!==f[k])return v(e[k],f[k]);return k===c?v(a,f[k],-1):v(e[k],b,1)},v=function(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}),function(){var a=c.createElement(\"div\"),d=\"script\"+(new Date).getTime(),e=c.documentElement;a.innerHTML=\"<a name=\'\"+d+\"\'/>\",e.insertBefore(a,e.firstChild),c.getElementById(d)&&(o.find.ID=function(a,c,d){if(typeof c.getElementById!=\"undefined\"&&!d){var e=c.getElementById(a[1]);return e?e.id===a[1]||typeof e.getAttributeNode!=\"undefined\"&&e.getAttributeNode(\"id\").nodeValue===a[1]?[e]:b:[]}},o.filter.ID=function(a,b){var c=typeof a.getAttributeNode!=\"undefined\"&&a.getAttributeNode(\"id\");return a.nodeType===1&&c&&c.nodeValue===b}),e.removeChild(a),e=a=null}(),function(){var a=c.createElement(\"div\");a.appendChild(c.createComment(\"\")),a.getElementsByTagName(\"*\").length>0&&(o.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]===\"*\"){var d=[];for(var e=0;c[e];e++)c[e].nodeType===1&&d.push(c[e]);c=d}return c}),a.innerHTML=\"<a href=\'#\'></a>\",a.firstChild&&typeof a.firstChild.getAttribute!=\"undefined\"&&a.firstChild.getAttribute(\"href\")!==\"#\"&&(o.attrHandle.href=function(a){return a.getAttribute(\"href\",2)}),a=null}(),c.querySelectorAll&&function(){var a=m,b=c.createElement(\"div\"),d=\"__sizzle__\";b.innerHTML=\"<p class=\'TEST\'></p>\";if(!b.querySelectorAll||b.querySelectorAll(\".TEST\").length!==0){m=function(b,e,f,g){e=e||c;if(!g&&!m.isXML(e)){var h=/^(\\w+$)|^\\.([\\w\\-]+$)|^#([\\w\\-]+$)/.exec(b);if(h&&(e.nodeType===1||e.nodeType===9)){if(h[1])return s(e.getElementsByTagName(b),f);if(h[2]&&o.find.CLASS&&e.getElementsByClassName)return s(e.getElementsByClassName(h[2]),f)}if(e.nodeType===9){if(b===\"body\"&&e.body)return s([e.body],f);if(h&&h[3]){var i=e.getElementById(h[3]);if(!i||!i.parentNode)return s([],f);if(i.id===h[3])return s([i],f)}try{return s(e.querySelectorAll(b),f)}catch(j){}}else if(e.nodeType===1&&e.nodeName.toLowerCase()!==\"object\"){var k=e,l=e.getAttribute(\"id\"),n=l||d,p=e.parentNode,q=/^\\s*[+~]/.test(b);l?n=n.replace(/\'/g,\"\\\\$&\"):e.setAttribute(\"id\",n),q&&p&&(e=e.parentNode);try{if(!q||p)return s(e.querySelectorAll(\"[id=\'\"+n+\"\'] \"+b),f)}catch(r){}finally{l||k.removeAttribute(\"id\")}}}return a(b,e,f,g)};for(var e in a)m[e]=a[e];b=null}}(),function(){var a=c.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var d=!b.call(c.createElement(\"div\"),\"div\"),e=!1;try{b.call(c.documentElement,\"[test!=\'\']:sizzle\")}catch(f){e=!0}m.matchesSelector=function(a,c){c=c.replace(/\\=\\s*([^\'\"\\]]*)\\s*\\]/g,\"=\'$1\']\");if(!m.isXML(a))try{if(e||!o.match.PSEUDO.test(c)&&!/!=/.test(c)){var f=b.call(a,c);if(f||!d||a.document&&a.document.nodeType!==11)return f}}catch(g){}return m(c,null,null,[a]).length>0}}}(),function(){var a=c.createElement(\"div\");a.innerHTML=\"<div class=\'test e\'></div><div class=\'test\'></div>\";if(!!a.getElementsByClassName&&a.getElementsByClassName(\"e\").length!==0){a.lastChild.className=\"e\";if(a.getElementsByClassName(\"e\").length===1)return;o.order.splice(1,0,\"CLASS\"),o.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!=\"undefined\"&&!c)return b.getElementsByClassName(a[1])},a=null}}(),c.documentElement.contains?m.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:c.documentElement.compareDocumentPosition?m.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)}:m.contains=function(){return!1},m.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!==\"HTML\":!1};var y=function(a,b,c){var d,e=[],f=\"\",g=b.nodeType?[b]:b;while(d=o.match.PSEUDO.exec(a))f+=d[0],a=a.replace(o.match.PSEUDO,\"\");a=o.relative[a]?a+\"*\":a;for(var h=0,i=g.length;h<i;h++)m(a,g[h],e,c);return m.filter(f,e)};m.attr=f.attr,m.selectors.attrMap={},f.find=m,f.expr=m.selectors,f.expr[\":\"]=f.expr.filters,f.unique=m.uniqueSort,f.text=m.getText,f.isXMLDoc=m.isXML,f.contains=m.contains}();var L=/Until$/,M=/^(?:parents|prevUntil|prevAll)/,N=/,/,O=/^.[^:#\\[\\.,]*$/,P=Array.prototype.slice,Q=f.expr.match.globalPOS,R={children:!0,contents:!0,next:!0,prev:!0};f.fn.extend({find:function(a){var b=this,c,d;if(typeof a!=\"string\")return f(a).filter(function(){for(c=0,d=b.length;c<d;c++)if(f.contains(b[c],this))return!0});var e=this.pushStack(\"\",\"find\",a),g,h,i;for(c=0,d=this.length;c<d;c++){g=e.length,f.find(a,this[c],e);if(c>0)for(h=g;h<e.length;h++)for(i=0;i<g;i++)if(e[i]===e[h]){e.splice(h--,1);break}}return e},has:function(a){var b=f(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(f.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(T(this,a,!1),\"not\",a)},filter:function(a){return this.pushStack(T(this,a,!0),\"filter\",a)},is:function(a){return!!a&&(typeof a==\"string\"?Q.test(a)?f(a,this.context).index(this[0])>=0:f.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c=[],d,e,g=this[0];if(f.isArray(a)){var h=1;while(g&&g.ownerDocument&&g!==b){for(d=0;d<a.length;d++)f(g).is(a[d])&&c.push({selector:a[d],elem:g,level:h});g=g.parentNode,h++}return c}var i=Q.test(a)||typeof a!=\"string\"?f(a,b||this.context):0;for(d=0,e=this.length;d<e;d++){g=this[d];while(g){if(i?i.index(g)>-1:f.find.matchesSelector(g,a)){c.push(g);break}g=g.parentNode;if(!g||!g.ownerDocument||g===b||g.nodeType===11)break}}c=c.length>1?f.unique(c):c;return this.pushStack(c,\"closest\",a)},index:function(a){if(!a)return this[0]&&this[0].parentNode?this.prevAll().length:-1;if(typeof a==\"string\")return f.inArray(this[0],f(a));return f.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var c=typeof a==\"string\"?f(a,b):f.makeArray(a&&a.nodeType?[a]:a),d=f.merge(this.get(),c);return this.pushStack(S(c[0])||S(d[0])?d:f.unique(d))},andSelf:function(){return this.add(this.prevObject)}}),f.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return f.dir(a,\"parentNode\")},parentsUntil:function(a,b,c){return f.dir(a,\"parentNode\",c)},next:function(a){return f.nth(a,2,\"nextSibling\")},prev:function(a){return f.nth(a,2,\"previousSibling\")},nextAll:function(a){return f.dir(a,\"nextSibling\")},prevAll:function(a){return f.dir(a,\"previousSibling\")},nextUntil:function(a,b,c){return f.dir(a,\"nextSibling\",c)},prevUntil:function(a,b,c){return f.dir(a,\"previousSibling\",c)},siblings:function(a){return f.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return f.sibling(a.firstChild)},contents:function(a){return f.nodeName(a,\"iframe\")?a.contentDocument||a.contentWindow.document:f.makeArray(a.childNodes)}},function(a,b){f.fn[a]=function(c,d){var e=f.map(this,b,c);L.test(a)||(d=c),d&&typeof d==\"string\"&&(e=f.filter(d,e)),e=this.length>1&&!R[a]?f.unique(e):e,(this.length>1||N.test(d))&&M.test(a)&&(e=e.reverse());return this.pushStack(e,a,P.call(arguments).join(\",\"))}}),f.extend({filter:function(a,b,c){c&&(a=\":not(\"+a+\")\");return b.length===1?f.find.matchesSelector(b[0],a)?[b[0]]:[]:f.find.matches(a,b)},dir:function(a,c,d){var e=[],g=a[c];while(g&&g.nodeType!==9&&(d===b||g.nodeType!==1||!f(g).is(d)))g.nodeType===1&&e.push(g),g=g[c];return e},nth:function(a,b,c,d){b=b||1;var e=0;for(;a;a=a[c])if(a.nodeType===1&&++e===b)break;return a},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var V=\"abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video\",W=/ jQuery\\d+=\"(?:\\d+|null)\"/g,X=/^\\s+/,Y=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>/ig,Z=/<([\\w:]+)/,$=/<tbody/i,_=/<|&#?\\w+;/,ba=/<(?:script|style)/i,bb=/<(?:script|object|embed|option|style)/i,bc=new RegExp(\"<(?:\"+V+\")[\\\\s/>]\",\"i\"),bd=/checked\\s*(?:[^=]|=\\s*.checked.)/i,be=/\\/(java|ecma)script/i,bf=/^\\s*<!(?:\\[CDATA\\[|\\-\\-)/,bg={option:[1,\"<select multiple=\'multiple\'>\",\"</select>\"],legend:[1,\"<fieldset>\",\"</fieldset>\"],thead:[1,\"<table>\",\"</table>\"],tr:[2,\"<table><tbody>\",\"</tbody></table>\"],td:[3,\"<table><tbody><tr>\",\"</tr></tbody></table>\"],col:[2,\"<table><tbody></tbody><colgroup>\",\"</colgroup></table>\"],area:[1,\"<map>\",\"</map>\"],_default:[0,\"\",\"\"]},bh=U(c);bg.optgroup=bg.option,bg.tbody=bg.tfoot=bg.colgroup=bg.caption=bg.thead,bg.th=bg.td,f.support.htmlSerialize||(bg._default=[1,\"div<div>\",\"</div>\"]),f.fn.extend({text:function(a){return f.access(this,function(a){return a===b?f.text(this):this.empty().append((this[0]&&this[0].ownerDocument||c).createTextNode(a))},null,a,arguments.length)},wrapAll:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapAll(a.call(this,b))});if(this[0]){var b=f(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapInner(a.call(this,b))});return this.each(function(){var b=f(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=f.isFunction(a);return this.each(function(c){f(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){f.nodeName(this,\"body\")||f(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=f\r\n.clean(arguments);a.push.apply(a,this.toArray());return this.pushStack(a,\"before\",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,\"after\",arguments);a.push.apply(a,f.clean(arguments));return a}},remove:function(a,b){for(var c=0,d;(d=this[c])!=null;c++)if(!a||f.filter(a,[d]).length)!b&&d.nodeType===1&&(f.cleanData(d.getElementsByTagName(\"*\")),f.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function(){for(var a=0,b;(b=this[a])!=null;a++){b.nodeType===1&&f.cleanData(b.getElementsByTagName(\"*\"));while(b.firstChild)b.removeChild(b.firstChild)}return this},clone:function(a,b){a=a==null?!1:a,b=b==null?a:b;return this.map(function(){return f.clone(this,a,b)})},html:function(a){return f.access(this,function(a){var c=this[0]||{},d=0,e=this.length;if(a===b)return c.nodeType===1?c.innerHTML.replace(W,\"\"):null;if(typeof a==\"string\"&&!ba.test(a)&&(f.support.leadingWhitespace||!X.test(a))&&!bg[(Z.exec(a)||[\"\",\"\"])[1].toLowerCase()]){a=a.replace(Y,\"<$1></$2>\");try{for(;d<e;d++)c=this[d]||{},c.nodeType===1&&(f.cleanData(c.getElementsByTagName(\"*\")),c.innerHTML=a);c=0}catch(g){}}c&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(f.isFunction(a))return this.each(function(b){var c=f(this),d=c.html();c.replaceWith(a.call(this,b,d))});typeof a!=\"string\"&&(a=f(a).detach());return this.each(function(){var b=this.nextSibling,c=this.parentNode;f(this).remove(),b?f(b).before(a):f(c).append(a)})}return this.length?this.pushStack(f(f.isFunction(a)?a():a),\"replaceWith\",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var e,g,h,i,j=a[0],k=[];if(!f.support.checkClone&&arguments.length===3&&typeof j==\"string\"&&bd.test(j))return this.each(function(){f(this).domManip(a,c,d,!0)});if(f.isFunction(j))return this.each(function(e){var g=f(this);a[0]=j.call(this,e,c?g.html():b),g.domManip(a,c,d)});if(this[0]){i=j&&j.parentNode,f.support.parentNode&&i&&i.nodeType===11&&i.childNodes.length===this.length?e={fragment:i}:e=f.buildFragment(a,this,k),h=e.fragment,h.childNodes.length===1?g=h=h.firstChild:g=h.firstChild;if(g){c=c&&f.nodeName(g,\"tr\");for(var l=0,m=this.length,n=m-1;l<m;l++)d.call(c?bi(this[l],g):this[l],e.cacheable||m>1&&l<n?f.clone(h,!0,!0):h)}k.length&&f.each(k,function(a,b){b.src?f.ajax({type:\"GET\",global:!1,url:b.src,async:!1,dataType:\"script\"}):f.globalEval((b.text||b.textContent||b.innerHTML||\"\").replace(bf,\"/*$0*/\")),b.parentNode&&b.parentNode.removeChild(b)})}return this}}),f.buildFragment=function(a,b,d){var e,g,h,i,j=a[0];b&&b[0]&&(i=b[0].ownerDocument||b[0]),i.createDocumentFragment||(i=c),a.length===1&&typeof j==\"string\"&&j.length<512&&i===c&&j.charAt(0)===\"<\"&&!bb.test(j)&&(f.support.checkClone||!bd.test(j))&&(f.support.html5Clone||!bc.test(j))&&(g=!0,h=f.fragments[j],h&&h!==1&&(e=h)),e||(e=i.createDocumentFragment(),f.clean(a,i,e,d)),g&&(f.fragments[j]=h?e:1);return{fragment:e,cacheable:g}},f.fragments={},f.each({appendTo:\"append\",prependTo:\"prepend\",insertBefore:\"before\",insertAfter:\"after\",replaceAll:\"replaceWith\"},function(a,b){f.fn[a]=function(c){var d=[],e=f(c),g=this.length===1&&this[0].parentNode;if(g&&g.nodeType===11&&g.childNodes.length===1&&e.length===1){e[b](this[0]);return this}for(var h=0,i=e.length;h<i;h++){var j=(h>0?this.clone(!0):this).get();f(e[h])[b](j),d=d.concat(j)}return this.pushStack(d,a,e.selector)}}),f.extend({clone:function(a,b,c){var d,e,g,h=f.support.html5Clone||f.isXMLDoc(a)||!bc.test(\"<\"+a.nodeName+\">\")?a.cloneNode(!0):bo(a);if((!f.support.noCloneEvent||!f.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!f.isXMLDoc(a)){bk(a,h),d=bl(a),e=bl(h);for(g=0;d[g];++g)e[g]&&bk(d[g],e[g])}if(b){bj(a,h);if(c){d=bl(a),e=bl(h);for(g=0;d[g];++g)bj(d[g],e[g])}}d=e=null;return h},clean:function(a,b,d,e){var g,h,i,j=[];b=b||c,typeof b.createElement==\"undefined\"&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||c);for(var k=0,l;(l=a[k])!=null;k++){typeof l==\"number\"&&(l+=\"\");if(!l)continue;if(typeof l==\"string\")if(!_.test(l))l=b.createTextNode(l);else{l=l.replace(Y,\"<$1></$2>\");var m=(Z.exec(l)||[\"\",\"\"])[1].toLowerCase(),n=bg[m]||bg._default,o=n[0],p=b.createElement(\"div\"),q=bh.childNodes,r;b===c?bh.appendChild(p):U(b).appendChild(p),p.innerHTML=n[1]+l+n[2];while(o--)p=p.lastChild;if(!f.support.tbody){var s=$.test(l),t=m===\"table\"&&!s?p.firstChild&&p.firstChild.childNodes:n[1]===\"<table>\"&&!s?p.childNodes:[];for(i=t.length-1;i>=0;--i)f.nodeName(t[i],\"tbody\")&&!t[i].childNodes.length&&t[i].parentNode.removeChild(t[i])}!f.support.leadingWhitespace&&X.test(l)&&p.insertBefore(b.createTextNode(X.exec(l)[0]),p.firstChild),l=p.childNodes,p&&(p.parentNode.removeChild(p),q.length>0&&(r=q[q.length-1],r&&r.parentNode&&r.parentNode.removeChild(r)))}var u;if(!f.support.appendChecked)if(l[0]&&typeof (u=l.length)==\"number\")for(i=0;i<u;i++)bn(l[i]);else bn(l);l.nodeType?j.push(l):j=f.merge(j,l)}if(d){g=function(a){return!a.type||be.test(a.type)};for(k=0;j[k];k++){h=j[k];if(e&&f.nodeName(h,\"script\")&&(!h.type||be.test(h.type)))e.push(h.parentNode?h.parentNode.removeChild(h):h);else{if(h.nodeType===1){var v=f.grep(h.getElementsByTagName(\"script\"),g);j.splice.apply(j,[k+1,0].concat(v))}d.appendChild(h)}}}return j},cleanData:function(a){var b,c,d=f.cache,e=f.event.special,g=f.support.deleteExpando;for(var h=0,i;(i=a[h])!=null;h++){if(i.nodeName&&f.noData[i.nodeName.toLowerCase()])continue;c=i[f.expando];if(c){b=d[c];if(b&&b.events){for(var j in b.events)e[j]?f.event.remove(i,j):f.removeEvent(i,j,b.handle);b.handle&&(b.handle.elem=null)}g?delete i[f.expando]:i.removeAttribute&&i.removeAttribute(f.expando),delete d[c]}}}});var bp=/alpha\\([^)]*\\)/i,bq=/opacity=([^)]*)/,br=/([A-Z]|^ms)/g,bs=/^[\\-+]?(?:\\d*\\.)?\\d+$/i,bt=/^-?(?:\\d*\\.)?\\d+(?!px)[^\\d\\s]+$/i,bu=/^([\\-+])=([\\-+.\\de]+)/,bv=/^margin/,bw={position:\"absolute\",visibility:\"hidden\",display:\"block\"},bx=[\"Top\",\"Right\",\"Bottom\",\"Left\"],by,bz,bA;f.fn.css=function(a,c){return f.access(this,function(a,c,d){return d!==b?f.style(a,c,d):f.css(a,c)},a,c,arguments.length>1)},f.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=by(a,\"opacity\");return c===\"\"?\"1\":c}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{\"float\":f.support.cssFloat?\"cssFloat\":\"styleFloat\"},style:function(a,c,d,e){if(!!a&&a.nodeType!==3&&a.nodeType!==8&&!!a.style){var g,h,i=f.camelCase(c),j=a.style,k=f.cssHooks[i];c=f.cssProps[i]||i;if(d===b){if(k&&\"get\"in k&&(g=k.get(a,!1,e))!==b)return g;return j[c]}h=typeof d,h===\"string\"&&(g=bu.exec(d))&&(d=+(g[1]+1)*+g[2]+parseFloat(f.css(a,c)),h=\"number\");if(d==null||h===\"number\"&&isNaN(d))return;h===\"number\"&&!f.cssNumber[i]&&(d+=\"px\");if(!k||!(\"set\"in k)||(d=k.set(a,d))!==b)try{j[c]=d}catch(l){}}},css:function(a,c,d){var e,g;c=f.camelCase(c),g=f.cssHooks[c],c=f.cssProps[c]||c,c===\"cssFloat\"&&(c=\"float\");if(g&&\"get\"in g&&(e=g.get(a,!0,d))!==b)return e;if(by)return by(a,c)},swap:function(a,b,c){var d={},e,f;for(f in b)d[f]=a.style[f],a.style[f]=b[f];e=c.call(a);for(f in b)a.style[f]=d[f];return e}}),f.curCSS=f.css,c.defaultView&&c.defaultView.getComputedStyle&&(bz=function(a,b){var c,d,e,g,h=a.style;b=b.replace(br,\"-$1\").toLowerCase(),(d=a.ownerDocument.defaultView)&&(e=d.getComputedStyle(a,null))&&(c=e.getPropertyValue(b),c===\"\"&&!f.contains(a.ownerDocument.documentElement,a)&&(c=f.style(a,b))),!f.support.pixelMargin&&e&&bv.test(b)&&bt.test(c)&&(g=h.width,h.width=c,c=e.width,h.width=g);return c}),c.documentElement.currentStyle&&(bA=function(a,b){var c,d,e,f=a.currentStyle&&a.currentStyle[b],g=a.style;f==null&&g&&(e=g[b])&&(f=e),bt.test(f)&&(c=g.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),g.left=b===\"fontSize\"?\"1em\":f,f=g.pixelLeft+\"px\",g.left=c,d&&(a.runtimeStyle.left=d));return f===\"\"?\"auto\":f}),by=bz||bA,f.each([\"height\",\"width\"],function(a,b){f.cssHooks[b]={get:function(a,c,d){if(c)return a.offsetWidth!==0?bB(a,b,d):f.swap(a,bw,function(){return bB(a,b,d)})},set:function(a,b){return bs.test(b)?b+\"px\":b}}}),f.support.opacity||(f.cssHooks.opacity={get:function(a,b){return bq.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||\"\")?parseFloat(RegExp.$1)/100+\"\":b?\"1\":\"\"},set:function(a,b){var c=a.style,d=a.currentStyle,e=f.isNumeric(b)?\"alpha(opacity=\"+b*100+\")\":\"\",g=d&&d.filter||c.filter||\"\";c.zoom=1;if(b>=1&&f.trim(g.replace(bp,\"\"))===\"\"){c.removeAttribute(\"filter\");if(d&&!d.filter)return}c.filter=bp.test(g)?g.replace(bp,e):g+\" \"+e}}),f(function(){f.support.reliableMarginRight||(f.cssHooks.marginRight={get:function(a,b){return f.swap(a,{display:\"inline-block\"},function(){return b?by(a,\"margin-right\"):a.style.marginRight})}})}),f.expr&&f.expr.filters&&(f.expr.filters.hidden=function(a){var b=a.offsetWidth,c=a.offsetHeight;return b===0&&c===0||!f.support.reliableHiddenOffsets&&(a.style&&a.style.display||f.css(a,\"display\"))===\"none\"},f.expr.filters.visible=function(a){return!f.expr.filters.hidden(a)}),f.each({margin:\"\",padding:\"\",border:\"Width\"},function(a,b){f.cssHooks[a+b]={expand:function(c){var d,e=typeof c==\"string\"?c.split(\" \"):[c],f={};for(d=0;d<4;d++)f[a+bx[d]+b]=e[d]||e[d-2]||e[0];return f}}});var bC=/%20/g,bD=/\\[\\]$/,bE=/\\r?\\n/g,bF=/#.*$/,bG=/^(.*?):[ \\t]*([^\\r\\n]*)\\r?$/mg,bH=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,bI=/^(?:about|app|app\\-storage|.+\\-extension|file|res|widget):$/,bJ=/^(?:GET|HEAD)$/,bK=/^\\/\\//,bL=/\\?/,bM=/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi,bN=/^(?:select|textarea)/i,bO=/\\s+/,bP=/([?&])_=[^&]*/,bQ=/^([\\w\\+\\.\\-]+:)(?:\\/\\/([^\\/?#:]*)(?::(\\d+))?)?/,bR=f.fn.load,bS={},bT={},bU,bV,bW=[\"*/\"]+[\"*\"];try{bU=e.href}catch(bX){bU=c.createElement(\"a\"),bU.href=\"\",bU=bU.href}bV=bQ.exec(bU.toLowerCase())||[],f.fn.extend({load:function(a,c,d){if(typeof a!=\"string\"&&bR)return bR.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(\" \");if(e>=0){var g=a.slice(e,a.length);a=a.slice(0,e)}var h=\"GET\";c&&(f.isFunction(c)?(d=c,c=b):typeof c==\"object\"&&(c=f.param(c,f.ajaxSettings.traditional),h=\"POST\"));var i=this;f.ajax({url:a,type:h,dataType:\"html\",data:c,complete:function(a,b,c){c=a.responseText,a.isResolved()&&(a.done(function(a){c=a}),i.html(g?f(\"<div>\").append(c.replace(bM,\"\")).find(g):c)),d&&i.each(d,[c,b,a])}});return this},serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?f.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||bN.test(this.nodeName)||bH.test(this.type))}).map(function(a,b){var c=f(this).val();return c==null?null:f.isArray(c)?f.map(c,function(a,c){return{name:b.name,value:a.replace(bE,\"\\r\\n\")}}):{name:b.name,value:c.replace(bE,\"\\r\\n\")}}).get()}}),f.each(\"ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend\".split(\" \"),function(a,b){f.fn[b]=function(a){return this.on(b,a)}}),f.each([\"get\",\"post\"],function(a,c){f[c]=function(a,d,e,g){f.isFunction(d)&&(g=g||e,e=d,d=b);return f.ajax({type:c,url:a,data:d,success:e,dataType:g})}}),f.extend({getScript:function(a,c){return f.get(a,b,c,\"script\")},getJSON:function(a,b,c){return f.get(a,b,c,\"json\")},ajaxSetup:function(a,b){b?b$(a,f.ajaxSettings):(b=a,a=f.ajaxSettings),b$(a,b);return a},ajaxSettings:{url:bU,isLocal:bI.test(bV[1]),global:!0,type:\"GET\",contentType:\"application/x-www-form-urlencoded; charset=UTF-8\",processData:!0,async:!0,accepts:{xml:\"application/xml, text/xml\",html:\"text/html\",text:\"text/plain\",json:\"application/json, text/javascript\",\"*\":bW},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:\"responseXML\",text:\"responseText\"},converters:{\"* text\":a.String,\"text html\":!0,\"text json\":f.parseJSON,\"text xml\":f.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:bY(bS),ajaxTransport:bY(bT),ajax:function(a,c){function w(a,c,l,m){if(s!==2){s=2,q&&clearTimeout(q),p=b,n=m||\"\",v.readyState=a>0?4:0;var o,r,u,w=c,x=l?ca(d,v,l):b,y,z;if(a>=200&&a<300||a===304){if(d.ifModified){if(y=v.getResponseHeader(\"Last-Modified\"))f.lastModified[k]=y;if(z=v.getResponseHeader(\"Etag\"))f.etag[k]=z}if(a===304)w=\"notmodified\",o=!0;else try{r=cb(d,x),w=\"success\",o=!0}catch(A){w=\"parsererror\",u=A}}else{u=w;if(!w||a)w=\"error\",a<0&&(a=0)}v.status=a,v.statusText=\"\"+(c||w),o?h.resolveWith(e,[r,w,v]):h.rejectWith(e,[v,w,u]),v.statusCode(j),j=b,t&&g.trigger(\"ajax\"+(o?\"Success\":\"Error\"),[v,d,o?r:u]),i.fireWith(e,[v,w]),t&&(g.trigger(\"ajaxComplete\",[v,d]),--f.active||f.event.trigger(\"ajaxStop\"))}}typeof a==\"object\"&&(c=a,a=b),c=c||{};var d=f.ajaxSetup({},c),e=d.context||d,g=e!==d&&(e.nodeType||e instanceof f)?f(e):f.event,h=f.Deferred(),i=f.Callbacks(\"once memory\"),j=d.statusCode||{},k,l={},m={},n,o,p,q,r,s=0,t,u,v={readyState:0,setRequestHeader:function(a,b){if(!s){var c=a.toLowerCase();a=m[c]=m[c]||a,l[a]=b}return this},getAllResponseHeaders:function(){return s===2?n:null},getResponseHeader:function(a){var c;if(s===2){if(!o){o={};while(c=bG.exec(n))o[c[1].toLowerCase()]=c[2]}c=o[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){s||(d.mimeType=a);return this},abort:function(a){a=a||\"abort\",p&&p.abort(a),w(0,a);return this}};h.promise(v),v.success=v.done,v.error=v.fail,v.complete=i.add,v.statusCode=function(a){if(a){var b;if(s<2)for(b in a)j[b]=[j[b],a[b]];else b=a[v.status],v.then(b,b)}return this},d.url=((a||d.url)+\"\").replace(bF,\"\").replace(bK,bV[1]+\"//\"),d.dataTypes=f.trim(d.dataType||\"*\").toLowerCase().split(bO),d.crossDomain==null&&(r=bQ.exec(d.url.toLowerCase()),d.crossDomain=!(!r||r[1]==bV[1]&&r[2]==bV[2]&&(r[3]||(r[1]===\"http:\"?80:443))==(bV[3]||(bV[1]===\"http:\"?80:443)))),d.data&&d.processData&&typeof d.data!=\"string\"&&(d.data=f.param(d.data,d.traditional)),bZ(bS,d,c,v);if(s===2)return!1;t=d.global,d.type=d.type.toUpperCase(),d.hasContent=!bJ.test(d.type),t&&f.active++===0&&f.event.trigger(\"ajaxStart\");if(!d.hasContent){d.data&&(d.url+=(bL.test(d.url)?\"&\":\"?\")+d.data,delete d.data),k=d.url;if(d.cache===!1){var x=f.now(),y=d.url.replace(bP,\"$1_=\"+x);d.url=y+(y===d.url?(bL.test(d.url)?\"&\":\"?\")+\"_=\"+x:\"\")}}(d.data&&d.hasContent&&d.contentType!==!1||c.contentType)&&v.setRequestHeader(\"Content-Type\",d.contentType),d.ifModified&&(k=k||d.url,f.lastModified[k]&&v.setRequestHeader(\"If-Modified-Since\",f.lastModified[k]),f.etag[k]&&v.setRequestHeader(\"If-None-Match\",f.etag[k])),v.setRequestHeader(\"Accept\",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+(d.dataTypes[0]!==\"*\"?\", \"+bW+\"; q=0.01\":\"\"):d.accepts[\"*\"]);for(u in d.headers)v.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(d.beforeSend.call(e,v,d)===!1||s===2)){v.abort();return!1}for(u in{success:1,error:1,complete:1})v[u](d[u]);p=bZ(bT,d,c,v);if(!p)w(-1,\"No Transport\");else{v.readyState=1,t&&g.trigger(\"ajaxSend\",[v,d]),d.async&&d.timeout>0&&(q=setTimeout(function(){v.abort(\"timeout\")},d.timeout));try{s=1,p.send(l,w)}catch(z){if(s<2)w(-1,z);else throw z}}return v},param:function(a,c){var d=[],e=function(a,b){b=f.isFunction(b)?b():b,d[d.length]=encodeURIComponent(a)+\"=\"+encodeURIComponent(b)};c===b&&(c=f.ajaxSettings.traditional);if(f.isArray(a)||a.jquery&&!f.isPlainObject(a))f.each(a,function(){e(this.name,this.value)});else for(var g in a)b_(g,a[g],c,e);return d.join(\"&\").replace(bC,\"+\")}}),f.extend({active:0,lastModified:{},etag:{}});var cc=f.now(),cd=/(\\=)\\?(&|$)|\\?\\?/i;f.ajaxSetup({jsonp:\"callback\",jsonpCallback:function(){return f.expando+\"_\"+cc++}}),f.ajaxPrefilter(\"json jsonp\",function(b,c,d){var e=typeof b.data==\"string\"&&/^application\\/x\\-www\\-form\\-urlencoded/.test(b.contentType);if(b.dataTypes[0]===\"jsonp\"||b.jsonp!==!1&&(cd.test(b.url)||e&&cd.test(b.data))){var g,h=b.jsonpCallback=f.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,i=a[h],j=b.url,k=b.data,l=\"$1\"+h+\"$2\";b.jsonp!==!1&&(j=j.replace(cd,l),b.url===j&&(e&&(k=k.replace(cd,l)),b.data===k&&(j+=(/\\?/.test(j)?\"&\":\"?\")+b.jsonp+\"=\"+h))),b.url=j,b.data=k,a[h]=function(a){g=[a]},d.always(function(){a[h]=i,g&&f.isFunction(i)&&a[h](g[0])}),b.converters[\"script json\"]=function(){g||f.error(h+\" was not called\");return g[0]},b.dataTypes[0]=\"json\";return\"script\"}}),f.ajaxSetup({accepts:{script:\"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript\"},contents:{script:/javascript|ecmascript/},converters:{\"text script\":function(a){f.globalEval(a);return a}}}),f.ajaxPrefilter(\"script\",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type=\"GET\",a.global=!1)}),f.ajaxTransport(\"script\",function(a){if(a.crossDomain){var d,e=c.head||c.getElementsByTagName(\"head\")[0]||c.documentElement;return{send:function(f,g){d=c.createElement(\"script\"),d.async=\"async\",a.scriptCharset&&(d.charset=a.scriptCharset),d.src=a.url,d.onload=d.onreadystatechange=function(a,c){if(c||!d.readyState||/loaded|complete/.test(d.readyState))d.onload=d.onreadystatechange=null,e&&d.parentNode&&e.removeChild(d),d=b,c||g(200,\"success\")},e.insertBefore(d,e.firstChild)},abort:function(){d&&d.onload(0,1)}}}});var ce=a.ActiveXObject?function(){for(var a in cg)cg[a](0,1)}:!1,cf=0,cg;f.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&ch()||ci()}:ch,function(a){f.extend(f.support,{ajax:!!a,cors:!!a&&\"withCredentials\"in a})}(f.ajaxSettings.xhr()),f.support.ajax&&f.ajaxTransport(function(c){if(!c.crossDomain||f.support.cors){var d;return{send:function(e,g){var h=c.xhr(),i,j;c.username?h.open(c.type,c.url,c.async,c.username,c.password):h.open(c.type,c.url,c.async);if(c.xhrFields)for(j in c.xhrFields)h[j]=c.xhrFields[j];c.mimeType&&h.overrideMimeType&&h.overrideMimeType(c.mimeType),!c.crossDomain&&!e[\"X-Requested-With\"]&&(e[\"X-Requested-With\"]=\"XMLHttpRequest\");try{for(j in e)h.setRequestHeader(j,e[j])}catch(k){}h.send(c.hasContent&&c.data||null),d=function(a,e){var j,k,l,m,n;try{if(d&&(e||h.readyState===4)){d=b,i&&(h.onreadystatechange=f.noop,ce&&delete cg[i]);if(e)h.readyState!==4&&h.abort();else{j=h.status,l=h.getAllResponseHeaders(),m={},n=h.responseXML,n&&n.documentElement&&(m.xml=n);try{m.text=h.responseText}catch(a){}try{k=h.statusText}catch(o){k=\"\"}!j&&c.isLocal&&!c.crossDomain?j=m.text?200:404:j===1223&&(j=204)}}}catch(p){e||g(-1,p)}m&&g(j,k,m,l)},!c.async||h.readyState===4?d():(i=++cf,ce&&(cg||(cg={},f(a).unload(ce)),cg[i]=d),h.onreadystatechange=d)},abort:function(){d&&d(0,1)}}}});var cj={},ck,cl,cm=/^(?:toggle|show|hide)$/,cn=/^([+\\-]=)?([\\d+.\\-]+)([a-z%]*)$/i,co,cp=[[\"height\",\"marginTop\",\"marginBottom\",\"paddingTop\",\"paddingBottom\"],[\"width\",\"marginLeft\",\"marginRight\",\"paddingLeft\",\"paddingRight\"],[\"opacity\"]],cq;f.fn.extend({show:function(a,b,c){var d,e;if(a||a===0)return this.animate(ct(\"show\",3),a,b,c);for(var g=0,h=this.length;g<h;g++)d=this[g],d.style&&(e=d.style.display,!f._data(d,\"olddisplay\")&&e===\"none\"&&(e=d.style.display=\"\"),(e===\"\"&&f.css(d,\"display\")===\"none\"||!f.contains(d.ownerDocument.documentElement,d))&&f._data(d,\"olddisplay\",cu(d.nodeName)));for(g=0;g<h;g++){d=this[g];if(d.style){e=d.style.display;if(e===\"\"||e===\"none\")d.style.display=f._data(d,\"olddisplay\")||\"\"}}return this},hide:function(a,b,c){if(a||a===0)return this.animate(ct(\"hide\",3),a,b,c);var d,e,g=0,h=this.length;for(;g<h;g++)d=this[g],d.style&&(e=f.css(d,\"display\"),e!==\"none\"&&!f._data(d,\"olddisplay\")&&f._data(d,\"olddisplay\",e));for(g=0;g<h;g++)this[g].style&&(this[g].style.display=\"none\");return this},_toggle:f.fn.toggle,toggle:function(a,b,c){var d=typeof a==\"boolean\";f.isFunction(a)&&f.isFunction(b)?this._toggle.apply(this,arguments):a==null||d?this.each(function(){var b=d?a:f(this).is(\":hidden\");f(this)[b?\"show\":\"hide\"]()}):this.animate(ct(\"toggle\",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(\":hidden\").css(\"opacity\",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){function g(){e.queue===!1&&f._mark(this);var b=f.extend({},e),c=this.nodeType===1,d=c&&f(this).is(\":hidden\"),g,h,i,j,k,l,m,n,o,p,q;b.animatedProperties={};for(i in a){g=f.camelCase(i),i!==g&&(a[g]=a[i],delete a[i]);if((k=f.cssHooks[g])&&\"expand\"in k){l=k.expand(a[g]),delete a[g];for(i in l)i in a||(a[i]=l[i])}}for(g in a){h=a[g],f.isArray(h)?(b.animatedProperties[g]=h[1],h=a[g]=h[0]):b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||\"swing\";if(h===\"hide\"&&d||h===\"show\"&&!d)return b.complete.call(this);c&&(g===\"height\"||g===\"width\")&&(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],f.css(this,\"display\")===\"inline\"&&f.css(this,\"float\")===\"none\"&&(!f.support.inlineBlockNeedsLayout||cu(this.nodeName)===\"inline\"?this.style.display=\"inline-block\":this.style.zoom=1))}b.overflow!=null&&(this.style.overflow=\"hidden\");for(i in a)j=new f.fx(this,b,i),h=a[i],cm.test(h)?(q=f._data(this,\"toggle\"+i)||(h===\"toggle\"?d?\"show\":\"hide\":0),q?(f._data(this,\"toggle\"+i,q===\"show\"?\"hide\":\"show\"),j[q]()):j[h]()):(m=cn.exec(h),n=j.cur(),m?(o=parseFloat(m[2]),p=m[3]||(f.cssNumber[i]?\"\":\"px\"),p!==\"px\"&&(f.style(this,i,(o||1)+p),n=(o||1)/j.cur()*n,f.style(this,i,n+p)),m[1]&&(o=(m[1]===\"-=\"?-1:1)*o+n),j.custom(n,o,p)):j.custom(n,h,\"\"));return!0}var e=f.speed(b,c,d);if(f.isEmptyObject(a))return this.each(e.complete,[!1]);a=f.extend({},a);return e.queue===!1?this.each(g):this.queue(e.queue,g)},stop:function(a,c,d){typeof a!=\"string\"&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||\"fx\",[]);return this.each(function(){function h(a,b,c){var e=b[c];f.removeData(a,c,!0),e.stop(d)}var b,c=!1,e=f.timers,g=f._data(this);d||f._unmark(!0,this);if(a==null)for(b in g)g[b]&&g[b].stop&&b.indexOf(\".run\")===b.length-4&&h(this,g,b);else g[b=a+\".run\"]&&g[b].stop&&h(this,g,b);for(b=e.length;b--;)e[b].elem===this&&(a==null||e[b].queue===a)&&(d?e[b](!0):e[b].saveState(),c=!0,e.splice(b,1));(!d||!c)&&f.dequeue(this,a)})}}),f.each({slideDown:ct(\"show\",1),slideUp:ct(\"hide\",1),slideToggle:ct(\"toggle\",1),fadeIn:{opacity:\"show\"},fadeOut:{opacity:\"hide\"},fadeToggle:{opacity:\"toggle\"}},function(a,b){f.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),f.extend({speed:function(a,b,c){var d=a&&typeof a==\"object\"?f.extend({},a):{complete:c||!c&&b||f.isFunction(a)&&a,duration:a,easing:c&&b||b&&!f.isFunction(b)&&b};d.duration=f.fx.off?0:typeof d.duration==\"number\"?d.duration:d.duration in f.fx.speeds?f.fx.speeds[d.duration]:f.fx.speeds._default;if(d.queue==null||d.queue===!0)d.queue=\"fx\";d.old=d.complete,d.complete=function(a){f.isFunction(d.old)&&d.old.call(this),d.queue?f.dequeue(this,d.queue):a!==!1&&f._unmark(this)};return d},easing:{linear:function(a){return a},swing:function(a){return-Math.cos(a*Math.PI)/2+.5}},timers:[],fx:function(a,b,c){this.options=b,this.elem=a,this.prop=c,b.orig=b.orig||{}}}),f.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(f.fx.step[this.prop]||f.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var a,b=f.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||b===\"auto\"?0:b:a},custom:function(a,c,d){function h(a){return e.step(a)}var e=this,g=f.fx;this.startTime=cq||cr(),this.end=c,this.now=this.start=a,this.pos=this.state=0,this.unit=d||this.unit||(f.cssNumber[this.prop]?\"\":\"px\"),h.queue=this.options.queue,h.elem=this.elem,h.saveState=function(){f._data(e.elem,\"fxshow\"+e.prop)===b&&(e.options.hide?f._data(e.elem,\"fxshow\"+e.prop,e.start):e.options.show&&f._data(e.elem,\"fxshow\"+e.prop,e.end))},h()&&f.timers.push(h)&&!co&&(co=setInterval(g.tick,g.interval))},show:function(){var a=f._data(this.elem,\"fxshow\"+this.prop);this.options.orig[this.prop]=a||f.style(this.elem,this.prop),this.options.show=!0,a!==b?this.custom(this.cur(),a):this.custom(this.prop===\"width\"||this.prop===\"height\"?1:0,this.cur()),f(this.elem).show()},hide:function(){this.options.orig[this.prop]=f._data(this.elem,\"fxshow\"+this.prop)||f.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var b,c,d,e=cq||cr(),g=!0,h=this.elem,i=this.options;if(a||e>=i.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),i.animatedProperties[this.prop]=!0;for(b in i.animatedProperties)i.animatedProperties[b]!==!0&&(g=!1);if(g){i.overflow!=null&&!f.support.shrinkWrapBlocks&&f.each([\"\",\"X\",\"Y\"],function(a,b){h.style[\"overflow\"+b]=i.overflow[a]}),i.hide&&f(h).hide();if(i.hide||i.show)for(b in i.animatedProperties)f.style(h,b,i.orig[b]),f.removeData(h,\"fxshow\"+b,!0),f.removeData(h,\"toggle\"+b,!0);d=i.complete,d&&(i.complete=!1,d.call(h))}return!1}i.duration==Infinity?this.now=e:(c=e-this.startTime,this.state=c/i.duration,this.pos=f.easing[i.animatedProperties[this.prop]](this.state,c,0,1,i.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update();return!0}},f.extend(f.fx,{tick:function(){var a,b=f.timers,c=0;for(;c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||f.fx.stop()},interval:13,stop:function(){clearInterval(co),co=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){f.style(a.elem,\"opacity\",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now}}}),f.each(cp.concat.apply([],cp),function(a,b){b.indexOf(\"margin\")&&(f.fx.step[b]=function(a){f.style(a.elem,b,Math.max(0,a.now)+a.unit)})}),f.expr&&f.expr.filters&&(f.expr.filters.animated=function(a){return f.grep(f.timers,function(b){return a===b.elem}).length});var cv,cw=/^t(?:able|d|h)$/i,cx=/^(?:body|html)$/i;\"getBoundingClientRect\"in c.documentElement?cv=function(a,b,c,d){try{d=a.getBoundingClientRect()}catch(e){}if(!d||!f.contains(c,a))return d?{top:d.top,left:d.left}:{top:0,left:0};var g=b.body,h=cy(b),i=c.clientTop||g.clientTop||0,j=c.clientLeft||g.clientLeft||0,k=h.pageYOffset||f.support.boxModel&&c.scrollTop||g.scrollTop,l=h.pageXOffset||f.support.boxModel&&c.scrollLeft||g.scrollLeft,m=d.top+k-i,n=d.left+l-j;return{top:m,left:n}}:cv=function(a,b,c){var d,e=a.offsetParent,g=a,h=b.body,i=b.defaultView,j=i?i.getComputedStyle(a,null):a.currentStyle,k=a.offsetTop,l=a.offsetLeft;while((a=a.parentNode)&&a!==h&&a!==c){if(f.support.fixedPosition&&j.position===\"fixed\")break;d=i?i.getComputedStyle(a,null):a.currentStyle,k-=a.scrollTop,l-=a.scrollLeft,a===e&&(k+=a.offsetTop,l+=a.offsetLeft,f.support.doesNotAddBorder&&(!f.support.doesAddBorderForTableAndCells||!cw.test(a.nodeName))&&(k+=parseFloat(d.borderTopWidth)||0,l+=parseFloat(d.borderLeftWidth)||0),g=e,e=a.offsetParent),f.support.subtractsBorderForOverflowNotVisible&&d.overflow!==\"visible\"&&(k+=parseFloat(d.borderTopWidth)||0,l+=parseFloat(d.borderLeftWidth)||0),j=d}if(j.position===\"relative\"||j.position===\"static\")k+=h.offsetTop,l+=h.offsetLeft;f.support.fixedPosition&&j.position===\"fixed\"&&(k+=Math.max(c.scrollTop,h.scrollTop),l+=Math.max(c.scrollLeft,h.scrollLeft));return{top:k,left:l}},f.fn.offset=function(a){if(arguments.length)return a===b?this:this.each(function(b){f.offset.setOffset(this,a,b)});var c=this[0],d=c&&c.ownerDocument;if(!d)return null;if(c===d.body)return f.offset.bodyOffset(c);return cv(c,d,d.documentElement)},f.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;f.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(f.css(a,\"marginTop\"))||0,c+=parseFloat(f.css(a,\"marginLeft\"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=f.css(a,\"position\");d===\"static\"&&(a.style.position=\"relative\");var e=f(a),g=e.offset(),h=f.css(a,\"top\"),i=f.css(a,\"left\"),j=(d===\"absolute\"||d===\"fixed\")&&f.inArray(\"auto\",[h,i])>-1,k={},l={},m,n;j?(l=e.position(),m=l.top,n=l.left):(m=parseFloat(h)||0,n=parseFloat(i)||0),f.isFunction(b)&&(b=b.call(a,c,g)),b.top!=null&&(k.top=b.top-g.top+m),b.left!=null&&(k.left=b.left-g.left+n),\"using\"in b?b.using.call(a,k):e.css(k)}},f.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=cx.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(f.css(a,\"marginTop\"))||0,c.left-=parseFloat(f.css(a,\"marginLeft\"))||0,d.top+=parseFloat(f.css(b[0],\"borderTopWidth\"))||0,d.left+=parseFloat(f.css(b[0],\"borderLeftWidth\"))||0;return{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||c.body;while(a&&!cx.test(a.nodeName)&&f.css(a,\"position\")===\"static\")a=a.offsetParent;return a})}}),f.each({scrollLeft:\"pageXOffset\",scrollTop:\"pageYOffset\"},function(a,c){var d=/Y/.test(c);f.fn[a]=function(e){return f.access(this,function(a,e,g){var h=cy(a);if(g===b)return h?c in h?h[c]:f.support.boxModel&&h.document.documentElement[e]||h.document.body[e]:a[e];h?h.scrollTo(d?f(h).scrollLeft():g,d?g:f(h).scrollTop()):a[e]=g},a,e,arguments.length,null)}}),f.each({Height:\"height\",Width:\"width\"},function(a,c){var d=\"client\"+a,e=\"scroll\"+a,g=\"offset\"+a;f.fn[\"inner\"+a]=function(){var a=this[0];return a?a.style?parseFloat(f.css(a,c,\"padding\")):this[c]():null},f.fn[\"outer\"+a]=function(a){var b=this[0];return b?b.style?parseFloat(f.css(b,c,a?\"margin\":\"border\")):this[c]():null},f.fn[c]=function(a){return f.access(this,function(a,c,h){var i,j,k,l;if(f.isWindow(a)){i=a.document,j=i.documentElement[d];return f.support.boxModel&&j||i.body&&i.body[d]||j}if(a.nodeType===9){i=a.documentElement;if(i[d]>=i[e])return i[d];return Math.max(a.body[e],i[e],a.body[g],i[g])}if(h===b){k=f.css(a,c),l=parseFloat(k);return f.isNumeric(l)?l:k}f(a).css(c,h)},c,a,arguments.length,null)}}),a.jQuery=a.$=f,typeof define==\"function\"&&define.amd&&define.amd.jQuery&&define(\"jquery\",[],function(){return f})})(window);','2012-06-21 02:05:34',2,0,'','','',''),(222,'cms_database','// ************************** Database Credentials **************************\r\nfunction getCMSWriter()\r\n{	\r\n	return array(\r\n	\'host\'=>DB_HOST,\r\n	\'username\'=>DB_WRITE_USERNAME,\r\n	\'password\'=>DB_WRITE_PASSWORD,\r\n	\'database\'=>DB_DATABASE,\r\n	\'port\'=>DB_PORT);\r\n}\r\n\r\nfunction getCMSReader()\r\n{		\r\n	return array(\r\n	\'host\'=>DB_HOST,\r\n	\'username\'=>DB_READ_USERNAME,\r\n	\'password\'=>DB_READ_PASSWORD,\r\n	\'database\'=>DB_DATABASE,\r\n	\'port\'=>DB_PORT);\r\n}\r\n\r\nfunction getCMSAdmin()\r\n{		\r\n	return array(\r\n	\'host\'=>DB_HOST,\r\n	\'username\'=>DB_ROOT_USERNAME,\r\n	\'password\'=>DB_ROOT_PASSWORD,\r\n	\'database\'=>DB_DATABASE,\r\n	\'port\'=>DB_PORT);\r\n}\r\n\r\n\r\n// ************************** Error Handling **************************\r\nfunction showError($local_verbose)\r\n{// Determines if an error should be displayed on the web page\r\n\r\n$VERBOSE=true;			// If something is not working, set to true to see any SQL errors\r\n//$SUPPRESS=false; 		// King variable - if set, nothing is verbose. Period.\r\n\r\n	if ($local_verbose || $VERBOSE) return true;\r\n	else return false;\r\n}\r\n\r\n\r\n// ************************** MySQL Functions **************************\r\nfunction query_execute($qry, $params=array(), $sqlwrite=true, $close_db=true)\r\n{\r\n	// Handle memcache\r\n	global $memcache;\r\n	if (isset($memcache)) $memcache->flush();\r\n\r\n	// Handle XCache\r\n	if (extension_loaded(\'xcache\'))\r\n	{\r\n		xcache_clear_cache(XC_TYPE_PHP,0);\r\n		xcache_clear_cache(XC_TYPE_VAR,0);\r\n	}\r\n\r\n	$return = query($qry, $params, $sqlwrite, $close_db, false, true);\r\n\r\n	if (isset($_SESSION[\'id\'])) $id = $_SESSION[\'id\'];\r\n	else $id = 0;\r\n\r\n	$qry_log = \"INSERT INTO log_mysql (userid,change_time,mysql_query,mysql_params,mysql_result) \r\n		VALUES(?,CURRENT_TIMESTAMP,?,?,?)\";\r\n	$params_log = array($id,$qry,print_array_mysql($params),$return);\r\n	if (constant_test(\'SETTING_LOG_DB_CHANGE\',\'enable\')) query_execute_nolog($qry_log, $params_log);\r\n\r\n	return $return;\r\n}\r\n\r\nfunction query_execute_nolog($qry, $params=array(), $sqlwrite=true, $close_db=true)\r\n{\r\n	return query($qry, $params, $sqlwrite, $close_db, false, true);\r\n}\r\n\r\nfunction query($qry, $params=array(), $sql=false, $close_db=true, $count=false, $get_result=false, $temp_tables=false)\r\n{		\r\n	// Source: http://www.populate.it/prepared_query_to_array.html\r\n	// This function easily queries mySQL and projects against SQL injection\r\n	// All the parameters in params() are trimmed before they get to mySQL\r\n	// All the return parameters are cleaned by htmlentities()\r\n\r\n	// Handle memcache\r\n	global $memcache;\r\n	if (isset($memcache) && !$sql)\r\n	{\r\n		$mem_params = \'\';\r\n		if ($params) $mem_params = implode($params);\r\n	\r\n		// Create a lookup key for memcache\r\n		$memcache_key = md5(DB_DATABASE.$qry.$mem_params);\r\n		\r\n		// Lookup value in memcache\r\n		$result = $memcache->get($memcache_key);\r\n		// If memcache doesn\'t have the result\r\n		if($result!=null)\r\n		{\r\n			return $result;\r\n		}//else echo $qry.\' \'.$memcache_key.\'<br />\';\r\n	}\r\n\r\n	global $sql_counter_in;\r\n	$sql_counter_in += 1;\r\n\r\n	if (isset($_SESSION[\'sqlcount\']) && constant_test(\'SETTING_PHP_VARIABLES\',\'show\')) $_SESSION[\'sqlcount\']+=1;\r\n\r\n	$protect_output = false;\r\n	\r\n	// Show the error message\r\n	$verbose = true;\r\n	\r\n	// If the settings have the mysql in readonly mode\r\n	if (constant_test(\'SETTING_DB_WRITE\',\'disable\')) $sql = false;\r\n	if (count($params) == 3 && $params[2]==\'SETTING_DB_WRITE\') $sql = true;\r\n	\r\n	try\r\n	{\r\n		// If the user did NOT pass the database credentials, use the default\r\n		if (constant_test(\'SETTING_DB_ADMIN\',\'enable\')) $sql = getCMSAdmin();\r\n		else if ($sql) $sql = getCMSWriter();\r\n		else $sql = getCMSReader();\r\n		\r\n		// Connect to SQL\r\n		$db = @mysqli_connect($sql[\'host\'], $sql[\'username\'], $sql[\'password\'], $sql[\'database\'], $sql[\'port\']);\r\n		\r\n		// If database connection was unsuccessful\r\n		if (!$db)\r\n		{\r\n			// If there was a problem in the PHP code\r\n			if ($db==\'\')\r\n			{\r\n				// Get the last error in PHP\r\n				$lasterror = error_get_last();\r\n\r\n				// For the error to be thrown\r\n				throw new ErrorException($lasterror[\'message\'], $lasterror[\'type\'], 0, addslashes($lasterror[\'file\']), $lasterror[\'line\']);\r\n			}\r\n			// Else if the error was in SQL, output the error information\r\n			else throw new Exception (mysqli_errno($db).\": \".mysqli_error($db));\r\n		}\r\n\r\n		// Create temp tables\r\n		//if ($temp_tables) mysqli_stmt_execute(mysqli_prepare($db, $temp_tables));\r\n		if ($temp_tables)\r\n		{\r\n			mysqli_multi_query($db, $temp_tables);\r\n			while ($db->next_result()) {;}\r\n		}\r\n\r\n		// If the prepared stmt does not return an error\r\n		if ($preparedStmt = mysqli_prepare($db, $qry))\r\n		{\r\n			// Get the types of inputs (s,i,or d)\r\n			$paramPattern =  getPreparedParamPattern($params);\r\n			\r\n			if (!empty($params))\r\n			{\r\n				// Trim all the variables\r\n				array_walk($params, create_function(\'&$val\', \'$val = trim($val);\'));\r\n			\r\n				// Bind the parameters to the SQL statement\r\n				$test1 = @call_user_func_array(\'mysqli_stmt_bind_param\', refValues(array_merge (array($preparedStmt, $paramPattern), $params)));\r\n			} else $test1 = true;\r\n			\r\n			// If the statement is not valid\r\n			if (!$test1)\r\n			{\r\n				// Get the last error in PHP\r\n				$lasterror = error_get_last();\r\n				\r\n				// For the error to be thrown\r\n				throw new ErrorException($lasterror[\'message\'], $lasterror[\'type\'], 0, addslashes($lasterror[\'file\']), $lasterror[\'line\']);\r\n			}\r\n			\r\n			// Execute the SQL statement\r\n			$exeresult = mysqli_stmt_execute($preparedStmt);\r\n\r\n			// If the statement is not valid\r\n			if (mysqli_errno($db))\r\n			{\r\n				// If the statement caused an error, throw an error\r\n    				throw new Exception (\"<b>Message:</b> \".mysqli_error($db).\"<br /><b>DB Code:</b> \".mysqli_errno($db));\r\n			}\r\n\r\n			if ($get_result)\r\n			{\r\n				//if ($sql) $affected = mysqli_affected_rows($db);\r\n				//else $affected = false;\r\n				//$affected = false;\r\n				$exeresult = mysqli_affected_rows($db);\r\n\r\n				return $exeresult;\r\n			}\r\n\r\n			if ($count)\r\n			{\r\n				//Store the result\r\n				mysqli_stmt_store_result($preparedStmt);\r\n	    \r\n				// Count the number of rows\r\n				$rowcount = mysqli_stmt_num_rows($preparedStmt);\r\n				return $rowcount;\r\n			}\r\n			\r\n			// Get the statement information\r\n			$meta = mysqli_stmt_result_metadata($preparedStmt);\r\n\r\n			// Create a new array for the field names\r\n			$fieldNames = array();\r\n			\r\n			// For each field in the statement\r\n			while ($field = mysqli_fetch_field($meta))\r\n			{\r\n				// Store the column name to an array\r\n			   $fieldNames[] = $field->name;\r\n			}\r\n			\r\n			// Store the array of column names\r\n			$resultRow = array($preparedStmt);\r\n			\r\n			// For each column name\r\n			foreach($fieldNames as $value)\r\n			{\r\n				// Store the cell value in the array\r\n				$resultRow[] = &$$value;\r\n			}\r\n			\r\n			// Bind the column name as the variable\r\n			call_user_func_array(\'mysqli_stmt_bind_result\', $resultRow);\r\n			\r\n			// Create a new array for the results\r\n			$result = array();\r\n			\r\n			// For each record\r\n			while(mysqli_stmt_fetch($preparedStmt))\r\n			{\r\n				// Create a new array for the record\r\n				$thisRow = array();\r\n				\r\n				// For each column\r\n				foreach($fieldNames as $value)\r\n				{\r\n					// Store the cell value to the column in the array\r\n					if ($protect_output) $thisRow[$value] = htmlentities($$value, ENT_QUOTES, \"UTF-8\");\r\n					else $thisRow[$value] = $$value;\r\n				}\r\n				// Store the record to the results array\r\n				$result[] = $thisRow;\r\n			}\r\n\r\n			// Close the statement\r\n			mysqli_stmt_close($preparedStmt);\r\n			\r\n			// If not specified, close the database connection\r\n			if ($close_db) mysqli_close($db);\r\n			\r\n			// If the array is empty, return true because the query completed successfully (no errors)\r\n			//if (empty($result)) $result = true;\r\n			//if ($affected) $result = $affected;\r\n\r\n			// Handle memcache\r\n			if (isset($memcache))\r\n			{	//if (is_array($result)) echo \'yep!\';\r\n				$memcache->set($memcache_key,$result,MEMCACHE_ADD_FLAG,MEMCACHE_ADD_TIMEOUT);\r\n			}\r\n\r\n			// Return either the array with values or the value of true\r\n			return $result;\r\n		}\r\n		// If the prepared stmt DOES return an error\r\n		else\r\n		{\r\n    		// If the statement caused an error, throw an error\r\n    		throw new Exception (\"<b>Message:</b> \".mysqli_error($db).\"<br /><b>DB Code:</b> \".mysqli_errno($db));\r\n		}\r\n	}\r\n	// Catch a PHP error\r\n	catch (ErrorException $e)\r\n	{			\r\n		// If the output should be verbose\r\n		if (showError($verbose) && !isset($_SESSION[\'ignore_errors\']))\r\n		{\r\n			// Suppress the output, save to a variable (must trace from here)\r\n			// Source: http://stackoverflow.com/questions/171318/how-do-i-capture-php-output-into-a-variable\r\n			ob_start();\r\n			debug_print_backtrace();\r\n			$errorout = ob_get_contents();\r\n			ob_end_clean();\r\n	\r\n			// Output the error in a fancybox\r\n			gather_error_info($e, false, $errorout);\r\n		}\r\n	}\r\n	// Catch a mySQL error\r\n	catch (Exception $e)\r\n	{\r\n		// If the output should be verbose\r\n		if (showError($verbose) && !isset($_SESSION[\'ignore_errors\']))\r\n		{\r\n			// Suppress the output, save to a variable (must trace from here)\r\n			// Source: http://stackoverflow.com/questions/171318/how-do-i-capture-php-output-into-a-variable\r\n			ob_start();\r\n			debug_print_backtrace();\r\n			$errorout = ob_get_contents();\r\n			ob_end_clean();\r\n	\r\n			// Output the error in a fancybox\r\n			gather_error_info($e, true, $errorout);\r\n		} \r\n	}\r\n}\r\n\r\nfunction refValues($arr)\r\n{\r\n	// Source: http://stackoverflow.com/questions/3681262/php5-3-mysqli-stmtbind-params-with-call-user-func-array-problem \r\n    if (strnatcmp(phpversion(),\'5.3\') >= 0) //Reference is required for PHP 5.3+\r\n     { \r\n        $refs = array(); \r\n        foreach($arr as $key => $value) \r\n            $refs[$key] = &$arr[$key]; \r\n        return $refs; \r\n    } \r\n    return $arr; \r\n} \r\n\r\nfunction getPreparedParamPattern ($params)\r\n{\r\n	// Source: http://www.populate.it/prepared_query_to_array.html\r\n	// This function easily determines the value type of the value\r\n	\r\n	$paramPattern = \"\";			\r\n	foreach ($params as $thisParam)\r\n	{					\r\n		if (is_string($thisParam))\r\n		{\r\n			$paramPattern .= \"s\";\r\n		}\r\n		else if (is_int($thisParam))\r\n		{\r\n			$paramPattern .= \"i\";\r\n		}\r\n		else if (is_float($thisParam))\r\n		{\r\n			$paramPattern .= \"d\";\r\n		}\r\n		else\r\n		{\r\n			//die(\"Error: Invalid prepare type\");\r\n			//die(\"Error: Invalid prepare type\");\r\n			//echo \"Error: Invalid prepare type: $thisParam\".print_array($params);\r\n			//print_r($params);\r\n			//debug_print_backtrace();\r\n		}\r\n	}\r\n	return $paramPattern;\r\n}','2012-08-20 02:18:08',2,1,'','','',''),(158,'page_welcome','$output .= <<< OUTPUT\r\n<p>You are now logged in...and can\'t really do anything but <a href=\"/page_dynamic_demo\">build dynamic pages</a>. Enjoy!</p>\r\nOUTPUT;\r\n// here','2012-06-25 19:34:15',2,1,'','Welcome','',''),(157,'page_public','$img = img(\'Image Text\',\'/img/logo/icon128.png\');\r\n$output .= <<< OUTPUT\r\n<div class=\"row-fluid\">\r\n	<div class=\"span10\">\r\n		<div class=\"row-fluid\">\r\n			<div class=\"span8\">\r\n				<div class=\"hero-unit\" style=\"padding-left: 130px; background-image:url(\'/img/logo/icon128.png\'); background-position:left; background-repeat:no-repeat;\">\r\n					<h1>FusionLeaf</h1>\r\n					<p>Grow a Web Presence</p>\r\n					<p>\r\n						<a class=\"btn btn-primary btn-large\" href=\"/page_screenshots\">CMS</a>\r\n						<a class=\"btn btn-primary btn-large\" href=\"/page_flstudio\">Stack</a>\r\n					</p>\r\n				</div>\r\n			</div>\r\n			<div class=\"span4\">\r\n				<h3>What is it?</h3>\r\n				<p>FusionLeaf CMS is a dynamic content management system written in PHP. Designed from the ground up, \r\n				FusionLeaf elevates web site control to the next level using MySQL as a database back-end and Nginx \r\n				(pronounced \"engine x\") as the web front-end. FusionLeaf surpasses with its \"change anything\" attitude.</p>\r\n				<p>There are two components: the CMS and Stack.<br />\r\n				<i class=\"icon-search icon-asterisk\"></i> The CMS (FusionLeaf CMS) is a fully functional website \r\n				that allows you to customize every aspect<br />\r\n				<i class=\"icon-search icon-asterisk\"></i> The Stack (FusionLeaf Stack) is a preconfigured \r\n				set of tools that turns any computer with Microsoft Windows into a web server in less than 30 seconds \r\n				(not required for FusionLeaf CMS, just gets it running quickly)</p>\r\n			</div>\r\n		</div>\r\n\r\n		<div class=\"row-fluid\">\r\n			<div class=\"span4\">\r\n				<h3>Not technical?</h3>\r\n				<p>Know anything about SEO (Search Engine Optimization)? \r\n				FusionLeaf handles the technical agenda while you focus on the content. Want a few dropdown menus? \r\n				Fill a couple text boxes and click a few arrows. Assign it to the Anonymous (public) group.\r\n				Add a photo gallery? Drag a couple pictures and write a description for each. \r\n				<a href=\"http://twitter.github.com/bootstrap\">Bootstrap, from Twitter</a> is at the foundation \r\n				of FusionLeaf so all pages use very familiar styling.</p>\r\n			</div>\r\n			<div class=\"span4\">\r\n				<h3>Technical!!</h3>\r\n				<p>If you know PHP, HTML, CSS, JavaScript, jQuery ... you\'ll LOVE what FusionLeaf has for you. \r\n				Try the Code Editor with PHP syntax validation, quick saving, isolated POST handling, CSS variables in PHP, \r\n				notepad, code snippets, multi-line indenting/outdenting, unique title/keywords/description on every page, \r\n				and write all your PHP/HTML/CSS/JavaScript/jQuery from a single tabbed page. Memcache and XCache are also integrated.</p>\r\n			</div>\r\n			<div class=\"span4\">\r\n				<h3>I want control.</h3>\r\n				<p> Good. You should know every little thing about your website. FusionLeaf includes tools to see every logged in \r\n				user along with the ability to kick them. Enable or disable pages with a single click. Grant or deny access to \r\n				pages through intuitive interfaces. View every change that is made on the website or see every database \r\n				modification by user and modification time. Manage every file and folder without using FTP. \r\n				Backup and email the entire website with a single click. View every PHP error that occurs with a detailed \r\n				reporting of who, where, why, and when.</p>\r\n			</div>\r\n		</div>\r\n		\r\n		<div class=\"row-fluid\">\r\n			<div class=\"span4\">\r\n				<h3>Is it fast?</h3>\r\n				<p>Absolutely. Using the integrated PHP debugging tools, you can see exactly how many queries are run on each page \r\n				load as well as the length of time in seconds. Currently, FusionLeaf requires 20 MySQL queries \r\n				to load a blank (uncached) page in .59 seconds. To load the \r\n				same page once it is cached, FusionLeaf requires 2 MySQL queries and loads in .09 seconds. The caching allows \r\n				FusionLeaf to load pages twice as fast with half the load on the database. Nginx allows for the quick \r\n				page loads through its scalable and high performance design.</p>\r\n			</div>\r\n			<div class=\"span4\">\r\n				<h3>Change anything.</h3>\r\n				<p>Don\'t like something? Change it. Change everything. FusionLeaf doesn\'t have hidden or encrypted code. It\'s all \r\n				there to show how powerful it really is. FusionLeaf started from a notepad and a CLI (command-line interface). \r\n				Now FusionLeaf is written entirely from itself using the internal Code Editor. The Code Editor can now modify code \r\n				in the database as well as text in files and includes a Help section with code samples and reference snippets.</p>\r\n			</div>\r\n			<div class=\"span4\">\r\n				<h3>Windows or Linux?</h3>\r\n				<p>FusionLeaf is designed to run on both Windows and Linux operating systems, as well as on servers and desktops. \r\n				FusionLeaf.com is currently hosted on a Linux server while most of the development occurs on a Windows laptop. \r\n				Developers of FusionLeaf can set up a \r\n				Development or \"Localhost\" environment in less than 30 seconds with FusionLeaf Stack (FLS). The current FLS is \r\n				less than 20MB and decompresses to 40MB. One of the \r\n				goals for FusionLeaf is to grow its usage to include offline applications, products, and installers.</p>\r\n			</div>\r\n		</div>\r\n	</div> <!-- span10 -->\r\n	<div class=\"span2\">\r\n		<!--<ul class=\"nav nav-list\">\r\n			<li class=\"nav-header\">Quick Links</li>\r\n			<li><a href=\"/\">Home</a></li>\r\n			<li><a href=\"/page_changelog\">Changelog</a></li>\r\n			<li><a href=\"/page_screenshots\">CMS Screenshots</a></li>\r\n			<li><a href=\"/page_flstudio\">FLS Screenshots</a></li>\r\n		</ul><br />-->\r\n				<div class=\"well\">\r\n					<h4>News</h4>\r\n					<p>Follow all progress through the \r\n					<a href=\"/page_changelog\">Changelog</a> which is updated daily and <a href=\"/page_screenshots\">Screenshot</a> gallery which \r\n					is updated weekly!</p>\r\n				</div>\r\n\r\n<div class=\"well\">\r\n<h4>Current Versions</h4>\r\n<b>CMS:</b> Aug 10, 2012 (<a href=\"http://code.google.com/p/fusionleaf\">v0.4.2</a>)<br />\r\n<b>Stack:</b> Aug 10, 2012 (<a href=\"http://code.google.com/p/fusionleaf\">v0.4.2</a>)</div>\r\n\r\n<div class=\"well\">\r\n<h4>Utilizes</h4>\r\n<i class=\"icon-search icon-asterisk\"></i> <a href=\"http://twitter.github.com/bootstrap\">Bootstrap</a>\r\n<br /><i class=\"icon-search icon-asterisk\"></i> <a href=\"http://github.com/lecar-red/bootstrapx-clickover\">BootstrapX-Clickover</a>\r\n<br /><i class=\"icon-search icon-asterisk\"></i> <a href=\"http://bootswatch.com\">Bootswatch</a>\r\n<br /><i class=\"icon-search icon-asterisk\"></i> <a href=\"http://famfamfam.com\">FamFamFam</a>\r\n<br /><i class=\"icon-search icon-asterisk\"></i> <a href=\"http://acko.net/blog/farbtastic-jquery-color-picker-plug-in\">Farbtastic Color Picker</a>\r\n<br /><i class=\"icon-search icon-asterisk\"></i> <a href=\"http://jquery.com\">jQuery</a>\r\n<br /><i class=\"icon-search icon-asterisk\"></i> <a href=\"http://alan.blog-city.com/jquerylinedtextarea.htm\">JQuery Lined TextArea</a>\r\n<br /><i class=\"icon-search icon-asterisk\"></i> <a href=\"http://lesscss.org\">LESS</a>\r\n<br /><i class=\"icon-search icon-asterisk\"></i> <a href=\"http://leafo.net/lessphp\">Lessphp</a>\r\n<br /><i class=\"icon-search icon-asterisk\"></i> <a href=\"http://memcached.org\">Memcached</a>\r\n<br /><i class=\"icon-search icon-asterisk\"></i> <a href=\"http://mysql.com\">MySQL</a>\r\n<br /><i class=\"icon-search icon-asterisk\"></i> <a href=\"http://nginx.org\">Nginx</a>\r\n<br /><i class=\"icon-search icon-asterisk\"></i> <a href=\"http://php.net\">PHP</a>\r\n<br /><i class=\"icon-search icon-asterisk\"></i> <a href=\"http://code.google.com/p/google-code-prettify\">Prettify</a>\r\n<br /><i class=\"icon-search icon-asterisk\"></i> <a href=\"http://www.phpcaptcha.org\">Securimage</a>\r\n<br /><i class=\"icon-search icon-asterisk\"></i> <a href=\"http://www.komodomedia.com/blog/2008/12/social-media-mini-iconpack\">Social Network Icon Pack</a>\r\n<br /><i class=\"icon-search icon-asterisk\"></i> <a href=\"http://code.google.com/p/twitter-php\">Twitter for PHP</a>\r\n</div>\r\n\r\n	</div><!-- span2 -->\r\n</div> <!-- row-fluid -->\r\n\r\nOUTPUT;\r\n\r\n// Need this to prevent problems with the heredoc','2012-08-10 08:16:51',2,1,'','Grow a Web Presence','',''),(151,'hlp_common_functions','// Output a message to the user\r\nfunction msg_user($title, $msg, $location=false)\r\n{\r\n	$_SESSION[\'message_title\'] = $title;\r\n	$_SESSION[\'message\'] = $msg;\r\n	if ($location) $_SESSION[\'redirect\'] = $location;\r\n\r\n	// Load a new page so notifications are seamless (ignores Page Not Found) - basically a Reload()\r\n	$_SESSION[\'wait\']=true;\r\n}\r\n\r\n// Determines if the current user is a member of the access group (default is Anonymous)\r\nfunction isGroupMember($group_id=3)\r\n{\r\n	// Set the user_id to the session id\r\n	$user_id=0;\r\n	if (isset($_SESSION[\'id\'])) $user_id=$_SESSION[\'id\'];\r\n\r\n	// If the user is a member of the Anonymous group no NOT logged in, return true\r\n	if ($group_id==3 && $user_id==0) return true;\r\n	// Else if the user is a member of the Authenticated group and is logged in, return true\r\n	else if ($group_id==2 && $user_id>0) return true;\r\n\r\n	// Check the database for the group\r\n	$qry = \"SELECT group_id FROM access_membership WHERE user_id=? AND group_id=? LIMIT 1\";\r\n	$params = array($user_id,$group_id);\r\n	$result = query($qry, $params);\r\n	\r\n	// If the user is a member of the group, return true\r\n	if (count($result)==1) return true;\r\n	// Else the user is not a member of the group, return false\r\n	else return false;\r\n}\r\n\r\nfunction send_mail($to=BACKUP_EMAIL,$subject=\"Database Backup\", $message=\'This is an automated email.\',$file=false)\r\n{\r\n	// Source: http://geekology.co.za/article/2009/06/how-to-send-emails-with-attachments-using-php-mail-function\r\n	$random_hash = md5(date(\'r\', time()));\r\n	$headers = \"From: noreply@\".SITE_DOMAIN.\"\\r\\nReply-To: noreply@\".SITE_DOMAIN;\r\n	\r\n	if ($file && file_exists($file))\r\n	{\r\n	$headers .= \"\\r\\nContent-Type: multipart/mixed; boundary=\\\"PHP-mixed-\".$random_hash.\"\\\"\";\r\n	$attachment = chunk_split(base64_encode(file_get_contents($file)));\r\n	\r\n	$message = \"\r\n--PHP-mixed-$random_hash\r\nContent-Type: multipart/alternative; boundary=\'PHP-alt-$random_hash\'\r\n--PHP-alt-$random_hash\r\nContent-Type: text/plain; charset=\'iso-8859-1\'\r\nContent-Transfer-Encoding: 7bit\r\n\r\nThis is an automated email.\r\n\r\n--PHP-alt-$random_hash\r\nContent-Type: text/html; charset=\'iso-8859-1\'\r\nContent-Transfer-Encoding: 7bit\r\n\r\n<p>This is an <b>automated</b> email.</p>\r\n\r\n--PHP-alt-$random_hash--\r\n\r\n--PHP-mixed-$random_hash\r\nContent-Type: application/zip; name=\".basename($file).\"\r\nContent-Transfer-Encoding: base64\r\nContent-Disposition: attachment\r\n\r\n$attachment\r\n--PHP-mixed-$random_hash--\";\r\n	}\r\n	$result = mail($to, $subject, $message, $headers);\r\n	\r\n	if ($result) msg_user(\"Send Mail\",\"Email was sent successfully!\");\r\n	else msg_user(\"Send Mail\",\"Email was NOT sent successfully.\");\r\n}\r\n\r\nfunction database_size()\r\n{\r\n	$qry = \'SELECT table_schema \"name\",sum( data_length + index_length ) \"size\" FROM information_schema.TABLES WHERE table_schema = \"\'.DB_DATABASE.\'\" GROUP BY table_schema\';\r\n	$params = array();\r\n	$result = query($qry, $params);\r\n	\r\n	if (isset($result[0][\'size\']))\r\n	{\r\n		$db_size = $result[0][\'size\'];\r\n		if ($db_size>(1024*1024))\r\n		{\r\n			$db_size = round($db_size/1024/1024,2).\" MB\";\r\n		}else $db_size = round($db_size/1024,2).\" KB\";\r\n	\r\n	} else $db_size = \'unavailable\';\r\n	return $db_size;\r\n}\r\n\r\nfunction secure_password($user,$pass)\r\n{\r\n	// Username is NOT case sensitive, Password IS case sensitive\r\n	// Uses Standard DES to encrypt\r\n	return md5(crypt(md5(trim($pass)),UNIQUE_ID));\r\n}\r\n\r\nfunction secure_username($user)\r\n{\r\n	// Username is NOT case sensitive, Password IS case sensitive\r\n	// Uses Standard DES to encrypt\r\n	return strtolower(trim($user));\r\n}\r\n\r\nfunction random_phrase()\r\n{\r\n	$array = array();\r\n	$array[] = \'surfing in Costa Rica\';\r\n	$array[] = \'skiing on the Alps\';\r\n	$array[] = \'climbing Mount Everest\';\r\n	$array[] = \'sailing in Bermuda\';\r\n	$array[] = \'on an African safari\';\r\n	$array[] = \'taking a sabbatical in Singapore\';\r\n	$array[] = \'on a journey to Mecca\';\r\n	$array[] = \'swimming with the dolphins\';\r\n	$array[] = \'feeding the gerbils\';\r\n	$array[] = \'flying a kite in London\';\r\n	$array[] = \'hang gliding in Bali\';\r\n	$array[] = \'skydiving in New Zealand\';\r\n	return $array[rand(0,count($array)-1)].\' so it is \';\r\n}\r\n\r\nif (!function_exists(\'get_bool\'))\r\n{\r\n	// Returns the boolean value of a string\r\n	function get_bool($v)\r\n	{\r\n		if (strlen($v)==5) return false;\r\n		else return true;\r\n	}\r\n}\r\n\r\n// Creates a popover box that allows updating to the database\r\nfunction smartDB($row,$column,$table)\r\n{\r\n	// If the user is not an admin, just return the plain value\r\n	if (!isGroupMember(1))\r\n	{\r\n		return $row[$column];\r\n	}\r\n	// If the user IS an admin, but the id is missing, just return the plain value\r\n	else if (!isset($row[\'id\']))\r\n	{\r\n		$trace=debug_backtrace(false);\r\n		$str = \'The function was called on line \'.$trace[0][\'line\'].\' of file \'.basename($trace[0][\'file\']).\'. \';\r\n		$str .= \'The request URI was \'.$_SERVER[\'REQUEST_URI\'].\'.\';\r\n\r\n		$mark = \'<i class=\"icon-exclamation-sign\"></i>\';\r\n		$icon = \'<a href=\"#\" rel=\"popover\" \r\n			data-content=\"ID was not passed to smartDB correctly. \'.$str.\'\">\'.$mark.\'</a>\';\r\n		return $row[$column].\' \'.$icon;\r\n	}\r\n	$rand = rand();\r\n	$html_safe = htmlentities($row[$column], ENT_QUOTES, \'UTF-8\');\r\n	$return = <<< OUTPUT\r\n	<p href=\"#\" style=\"display: inline-block; cursor: pointer;\" rel=\"clickover\"\r\n	data-content=\"\r\n	<form class=\'form-horizontal\' name=\'form_{$rand}\' id=\'form_{$rand}\'>\r\n		<div class=\'control-group\'>\r\n			<label></label>\r\n			<input type=\'hidden\'name=\'db_table\' value=\'{$table}\'>\r\n			<input type=\'hidden\'name=\'db_column\' value=\'{$column}\'>\r\n			<input type=\'hidden\'name=\'db_id\' value=\'{$row[\'id\']}\'>\r\n			<input type=\'hidden\'name=\'db_old\' value=\'{$row[$column]}\'>\r\n			<input type=\'text\' class=\'span2\' name=\'db_value\' id=\'db_value\' value=\'{$html_safe}\'\r\n			onkeydown=\'return checkEnter_{$rand}()\'>\r\n			<a id=\'post_{$rand}\' class=\'btn btn-info\' onclick=\'updateDB_{$rand}()\'>Update</a>\r\n		</div>\r\n\r\n	</form>\">{$html_safe} <i class=\"icon-pencil\"></i></p>\r\n	<script>\r\n	// Update the database\r\n	function updateDB_{$rand}()\r\n	{\r\n		$.post(\"/hlp_common_functions\", $(\"#form_{$rand}\").serialize(), function(data) {\r\n			//alert(\'{$_SERVER[\'REQUEST_URI\']}\');\r\n			window.location = \"{$_SERVER[\'REQUEST_URI\']}\";\r\n		});\r\n	}\r\n	// Determine if the user clicks enter\r\n	function checkEnter_{$rand}()\r\n	{\r\n		// If the user clicks enter\r\n		if (event.keyCode == 13)\r\n		{\r\n			// POST the data\r\n			updateDB_{$rand}();\r\n			// Return false so the variables won\'t be appended to the URL\r\n			return false;\r\n		}\r\n		// Else allow the character to be accepted\r\n		else return true;\r\n\r\n	}\r\n	</script>\r\nOUTPUT;\r\n	return $return;\r\n}\r\n\r\n// Creates a popover box that allows updating to a file\r\nfunction smartFile($key,$val,$is_key,$file)\r\n{\r\n	// If the user is not an admin, just return the plain value\r\n	if (!isGroupMember(1))\r\n	{\r\n		if ($is_key) return $key;\r\n		else return $val;\r\n	}\r\n	// If the user IS an admin, but the id is missing, just return the plain value\r\n	else if (!file_exists($file) || json_decode(file_get_contents($file),true)==null)\r\n	{\r\n		$trace=debug_backtrace(false);\r\n		$str = \'The function was called on line \'.$trace[0][\'line\'].\' of file \'.basename($trace[0][\'file\']).\'. \';\r\n		$str .= \'The request URI was \'.$_SERVER[\'REQUEST_URI\'].\'.\';\r\n\r\n		$mark = \'<i class=\"icon-exclamation-sign\"></i>\';\r\n		$icon = \'<a href=\"#\" rel=\"popover\" \r\n			data-content=\"File was not passed to smartFile correctly. \'.$str.\'\">\'.$mark.\'</a>\';\r\n		return $key.\' \'.$icon;\r\n	}\r\n	// Decode the file into an array\r\n	$arr = json_decode(file_get_contents($file),true);\r\n\r\n	$rand = rand();\r\n\r\n	// Code to ensure passed values (like *****) are separate from the real values\r\n	if ($is_key)\r\n	{\r\n		$html_safe_real = htmlentities($key, ENT_QUOTES, \'UTF-8\');\r\n		$html_safe_view = htmlentities($key, ENT_QUOTES, \'UTF-8\');\r\n	}\r\n	else\r\n	{\r\n		$html_safe_real = htmlentities($arr[$key], ENT_QUOTES, \'UTF-8\');\r\n		$html_safe_view = htmlentities($val, ENT_QUOTES, \'UTF-8\');\r\n	}\r\n\r\n	$return = <<< OUTPUT\r\n	<p href=\"#\" style=\"display: inline-block; cursor: pointer;\" rel=\"clickover\"\r\n	data-content=\"\r\n	<form class=\'form-horizontal\' name=\'form_{$rand}\' id=\'form_{$rand}\'>\r\n		<div class=\'control-group\'>\r\n			<label></label>\r\n			<input type=\'hidden\'name=\'file_name\' value=\'{$file}\'>\r\n			<input type=\'hidden\'name=\'file_key\' value=\'{$key}\'>\r\n			<input type=\'hidden\'name=\'file_iskey\' value=\'{$is_key}\'>\r\n			<input type=\'text\' class=\'span2\' name=\'file_value\' id=\'file_value\' value=\'{$html_safe_real}\'\r\n			onkeydown=\'return checkEnter_{$rand}()\'>\r\n			<a id=\'post_{$rand}\' class=\'btn btn-info\' onclick=\'updateFile_{$rand}()\'>Update</a>\r\n		</div>\r\n\r\n	</form>\">{$html_safe_view} <i class=\"icon-pencil\"></i></p>\r\n	<script>\r\n	// Update the database\r\n	function updateFile_{$rand}()\r\n	{\r\n		$.post(\"/hlp_common_functions\", $(\"#form_{$rand}\").serialize(), function(data) {\r\n			//alert(data);\r\n			window.location = \"{$_SERVER[\'REQUEST_URI\']}\";\r\n		});\r\n	}\r\n	// Determine if the user clicks enter\r\n	function checkEnter_{$rand}()\r\n	{\r\n		// If the user clicks enter\r\n		if (event.keyCode == 13)\r\n		{\r\n			// POST the data\r\n			updateFile_{$rand}();\r\n			// Return false so the variables won\'t be appended to the URL\r\n			return false;\r\n		}\r\n		// Else allow the character to be accepted\r\n		else return true;\r\n\r\n	}\r\n	</script>\r\nOUTPUT;\r\n	return $return;\r\n}\r\n\r\n// Redirect to the System Settings page\r\nfunction quickSystemSetting()\r\n{\r\n	if (!isGroupMember(1)) return;\r\n	else return \'<a class=\"brand\" href=\"/toolkit_smart_file?file=\'.CMS_FILE_SITE.\'\"><i class=\"icon-pencil icon-white\"></i></a>\';\r\n}\r\n\r\n// Redirect to the Site Settings page\r\nfunction quickSiteSetting()\r\n{\r\n	if (!isGroupMember(1)) return;\r\n	else return \'<a href=\"/toolkit_site_settings\"><i class=\"icon-pencil\"></i></a>\';\r\n}\r\n\r\nfunction startSQLCounter()\r\n{\r\n	// Set the session variable so the number of SQL queries can be counted after a page load\r\n	if (constant_test(\'SETTING_PHP_VARIABLES\',\'show\'))\r\n	{\r\n		if (!isset($_SESSION[\'sqlcount\'])) $_SESSION[\'sqlcount\']=0;\r\n	} else\r\n	{\r\n		if (isset($_SESSION[\'sqlcount\'])) unset($_SESSION[\'sqlcount\']);\r\n	}\r\n}\r\nfunction outputSQLCounter()\r\n{\r\n	$count = 0;\r\n	// Set the session variable so the number of SQL queries can be counted after a page load\r\n	if (constant_test(\'SETTING_PHP_VARIABLES\',\'show\') && isGroupMember(1))\r\n	{\r\n		if (isset($_SESSION[\'sqlcount\']))\r\n		{\r\n			$count = $_SESSION[\'sqlcount\'];\r\n			unset($_SESSION[\'sqlcount\']);\r\n		}\r\n		return \'<div class=\"container-fluid\">SQL queries using JavaScript/jQuery: \'.$count.\'</div>\';\r\n	}else return;\r\n}','2012-08-04 15:19:34',2,1,'// If data is POSTed from the smartDB() function, update the entry in the database\r\nif (isset($_POST[\'db_table\']) && isset($_POST[\'db_column\']) && isset($_POST[\'db_value\']) && isset($_POST[\'db_id\']))\r\n{\r\n	// Build a query that allows a value to be updated ONLY IF the previous values are known\r\n	$qry = \'UPDATE `\'.$_POST[\'db_table\'].\'` SET \'.$_POST[\'db_column\'].\'=? WHERE id=? AND \'.$_POST[\'db_column\'].\'=? LIMIT 1\';\r\n	\r\n	// Pass the new value, ID, and old value\r\n	$params = array($_POST[\'db_value\'],$_POST[\'db_id\'],$_POST[\'db_old\']);\r\n	\r\n	// Execute the query with the query and parameters\r\n	$result = query_execute($qry, $params);\r\n	\r\n	// If the query is successful\r\n	if ($result)\r\n	{\r\n		die(msg_user(\'Value Update\',\'The value was successfully updated:<br />\'\r\n		.$_POST[\'db_old\'].\' to \'.$_POST[\'db_value\'].\' on id \'.$_POST[\'db_id\'].\' in table \'.$_POST[\'db_table\']));\r\n	}\r\n	else\r\n	{\r\n		die(msg_user(\'Value Update\',\'The value was NOT successfully updated:<br />\'\r\n		.$_POST[\'db_old\'].\' to \'.$_POST[\'db_value\'].\' on id \'.$_POST[\'db_id\'].\' in table \'.$_POST[\'db_table\']));\r\n	}\r\n}\r\n\r\n// If data is POSTed from the smartFile() function, update the entry in the file\r\nelse if (isset($_POST[\'file_name\']) && isset($_POST[\'file_key\']) && isset($_POST[\'file_iskey\']) && isset($_POST[\'file_value\']))\r\n{\r\n	if (!file_exists($_POST[\'file_name\']) || json_decode(file_get_contents($_POST[\'file_name\']),true)==null)\r\n	{\r\n		die(msg_user(\'Value Update\',\'The file value was NOT updated:<br />\'\r\n		.$old.\' to \'.$_POST[\'file_value\'].\' on key \'.$_POST[\'file_key\'].\' in file \'.$_POST[\'file_name\']));\r\n	}\r\n	else\r\n	{\r\n		// Decode the file into an array\r\n		$arr = json_decode(file_get_contents($_POST[\'file_name\']),true);\r\n\r\n		$new_arr = array();\r\n\r\n		foreach($arr as $key=>$val)\r\n		{\r\n			if ($_POST[\'file_iskey\']==\'1\' && $key == $_POST[\'file_key\'])\r\n			{\r\n				$new_arr[$_POST[\'file_value\']]=$val;\r\n				$old = $key;\r\n			}\r\n			else if ($_POST[\'file_iskey\']!=\'1\' && $key == $_POST[\'file_key\'])\r\n			{\r\n				$new_arr[$key]=$_POST[\'file_value\'];\r\n				$old = $val;\r\n			}\r\n			else $new_arr[$key]=$val;\r\n		}\r\n	}\r\n	if (file_put_contents($_POST[\'file_name\'],json_encode(array_filter($new_arr))))\r\n	{\r\n		die(msg_user(\'Value Update\',\'The file value was successfully updated:<br />\'\r\n		.$old.\' to \'.$_POST[\'file_value\'].\' on key \'.$_POST[\'file_key\'].\' in file \'.$_POST[\'file_name\']));\r\n	}\r\n	else\r\n	{\r\n		die(msg_user(\'Value Update\',\'The file value was NOT written:<br />\'\r\n		.$old.\' to \'.$_POST[\'file_value\'].\' on key \'.$_POST[\'file_key\'].\' in file \'.$_POST[\'file_name\']));\r\n	}\r\n}','','',''),(156,'cms_pager','// Backbone of the entire CMS, controls security, posting, and page output\r\n// If you screw this up, the CMS will stop functioning...no joke\r\n\r\nfunction isArraySame($array1,$array2)\r\n{\r\n	if(count($array1) == count($array2))\r\n	{\r\n		$result = array_intersect($array1, $array2);\r\n		if(count($array1) == count($result))\r\n		{\r\n			//echo \'Both arrays are same\';\r\n			return true;\r\n		}\r\n		else\r\n		{\r\n			//echo \'array1 and array2 are not same\';\r\n			return false;\r\n		}\r\n	}\r\n	else\r\n	{\r\n		//echo \'array1 and array2 are not same\';\r\n		return false;\r\n	}\r\n}\r\n\r\n$title = SITE_TITLE;\r\n$keyword = SITE_KEYWORDS;\r\n$description = SITE_TAG;\r\n\r\nif (isset($_GET[\'recache\']))\r\n{\r\n	if (isGroupMember(1)) $_SESSION[\'recache\']=true;\r\n	header(\'location: index.php\');\r\n	return;\r\n}\r\n\r\n// If the settings have the site in disable all, except for admins\r\nif (constant_test(\'SETTING_SITE_MAINTENANCE\',\'enable\') && !isGroupMember(1))\r\n{\r\n	$output .= \"Website is currently under construction. Thanks for your patience.\";\r\n}\r\n// If the settings have the site in disable all\r\nif (constant_test(\'SETTING_SITE_DISASTER\',\'enable\'))\r\n{\r\n	die(\"Website is currently under construction. Thanks for your patience.\");\r\n}\r\nif (isset($_SESSION[\'attempts\']) && $_SESSION[\'attempts\']>=5)\r\n{\r\n	$output .= \"The system logged your failed attempts and an administrator has been notified of your IP: \".$_SERVER[\'REMOTE_ADDR\'];\r\n}\r\nelse\r\n{\r\n	// Set these to allow for better error handling of eval statements\r\n	//restore_error_handler();\r\n	ini_set(\'track_errors\', 1);\r\n\r\n	$error_before = error_get_last();\r\n\r\n	// If the user passed a parameter in the URL bar (or clicked on a link)\r\n	if (!isset($_GET) || !empty($_GET))\r\n	{\r\n		// Output the basic navigate Back link\r\n		//$output .= ahome(\"Back\").br().NEWLINE;\r\n\r\n		// For each get parameter (really will only get the first one)\r\n		foreach ($_GET as $key=>$val)\r\n		{\r\n			$clean_key = str_replace(\'/\',\'\',$key);\r\n			//$method = method_retrieve($clean_key,false,\"php_methods\",!empty($_POST));\r\n			//$type = db_method_type($clean_key);\r\n\r\n			$qry = \"SELECT method,post,type,title,keyword,description,id FROM php_methods WHERE name=? LIMIT 1\";\r\n			$params = array($clean_key);\r\n			$result = query($qry, $params);\r\n			if (isset($result[0][\'method\']))\r\n			{\r\n				//$title = $result[0][\'title\'];\r\n				$title = smartDB($result[0],\'title\',\'php_methods\');\r\n				$keyword = $result[0][\'keyword\'];\r\n				$description = $result[0][\'description\'];\r\n				$type = $result[0][\'type\'];\r\n				if (!empty($_POST)) $method = $result[0][\'post\'];\r\n				else $method = $result[0][\'method\'];\r\n			} else $method=false;\r\n	\r\n			// If the method exists\r\n			if ($method !==false && strpos($clean_key,\'cms_\') !== 0)\r\n			{	\r\n				$has_access=isGroupMember(1);\r\n				if (!$has_access)\r\n				{\r\n					// HERE IS WHERE THE ACCESS SHOULD BE CONTROLLED\r\n		\r\n					// Get all the groups with access\r\n					$qry = \"SELECT method_id, access_group.name, access_group.id\r\n					FROM access_list\r\n					INNER JOIN access_group, php_methods\r\n					WHERE group_id=access_group.id AND method_id=php_methods.id AND php_methods.name=?\";\r\n					$params = array($clean_key);\r\n					$result_access = query($qry, $params);\r\n					foreach($result_access as $row)\r\n					{\r\n						$has_access = isGroupMember($row[\'id\']);\r\n						if ($has_access) break;\r\n					}\r\n				}\r\n				if (!$has_access)\r\n				{\r\n					if (isset($_SESSION[\'id\']))\r\n					{\r\n						//$output .= \'You do not have access to this page.\'.br();\r\n						$output .=  catch_output(\'?>\'.method_retrieve(\'page_not_found\'));\r\n					}\r\n					else\r\n					{\r\n						$output .= \'You must login to access this page.\'.br();\r\n						$result = eval(method_retrieve(\'access_login\'));\r\n					}\r\n				}\r\n				else\r\n				{\r\n					// If the user posted data, get the POST part of the method\r\n					if (!empty($_POST))\r\n					{\r\n						// 10 - Dynamic\r\n						if ($type===10)\r\n						{\r\n							$dyn_table_name = trim($result[0][\'method\']);\r\n							if (strlen($dyn_table_name)<1 || strlen($dyn_table_name)>64)\r\n							{\r\n								$output .= \'Dynamic Page does not contain a valid table name\';\r\n								ob_start();\r\n								trigger_error(\'Dynamic Page does not contain a valid table name\');\r\n								ob_end_clean();\r\n							} else\r\n							{\r\n								$append_var = \'$page_name = \"/\'.$clean_key.\'\";$table_dynamic = \"\'.$dyn_table_name.\'\";\';\r\n								eval($append_var.method_retrieve(\'toolkit_dynamic\',false,\'php_methods\',true));\r\n							}\r\n						}\r\n						else\r\n						{\r\n							ob_start();\r\n							// The new line ensures an heredoc at the very end of a method is terminated correctly\r\n							//$clean_eval = eval($method.NEWLINE);\r\n							$clean_eval = eval($method);\r\n							$result = ob_get_contents();\r\n							ob_end_clean();\r\n							$error = error_get_last();\r\n							if ($error!=NULL && !isset($_SESSION[\'ignore_errors\']) && !isArraySame($error,$error_before))\r\n							//if ($clean_eval===false || isset(error_get_last()))\r\n							{\r\n								try\r\n								{\r\n									$output .= \'You found a bug! Calling in the bug squisher now. Please try again <a href=\"/\">later</a>.\';\r\n									//throw new Exception ($error[\'message\'].\" on line \".$error[\'line\'].\" in \".$error[\'file\'].\", code: \".$error[\'code\']);\r\n								}\r\n								// Catch a PHP error\r\n								catch (Exception $e)\r\n								{			\r\n										// Suppress the output, save to a variable (must trace from here)\r\n										// Source: http://stackoverflow.com/questions/171318/how-do-i-capture-php-output-into-a-variable\r\n										ob_start();\r\n										debug_print_backtrace();\r\n										$errorout = ob_get_contents();\r\n										ob_end_clean();\r\n								\r\n										// Output the error in a fancybox\r\n										gather_error_info($e, false, $errorout);\r\n								}\r\n							} else 	$output .= $result;\r\n						}\r\n					}\r\n					// 0 - HTML (default)		\r\n					//else if ($type===0) $output .=  $method;\r\n					// 1 - PHP\r\n					else if ($type===1 || $type===0)\r\n					{\r\n						ob_start();\r\n						// The new line ensures an heredoc at the very end of a method is terminated correctly\r\n\r\n						//$clean_eval = eval($method.NEWLINE);\r\n						if ($type===0) $clean_eval = eval(\'?>\'.$method);\r\n						else $clean_eval = eval($method);\r\n\r\n						$result = ob_get_contents();\r\n						ob_end_clean();\r\n						$error = error_get_last();\r\n						if ($error!=NULL && !isArraySame($error,$error_before))\r\n						//if ($clean_eval===false && isset(error_get_last()))\r\n						{\r\n							try\r\n							{\r\n								$output .= \'You found a bug! Calling in the bug squisher now. Please try again <a href=\"/\">later</a>.\';\r\n								//throw new Exception ($error[\'message\'].\" on line \".$error[\'line\'].\" in \".$error[\'file\'].\", code: \".$error[\'type\'].\',\'.error_reporting());\r\n							}\r\n							// Catch a PHP error\r\n							catch (Exception $e)\r\n							{			\r\n									// Suppress the output, save to a variable (must trace from here)\r\n									// Source: http://stackoverflow.com/questions/171318/how-do-i-capture-php-output-into-a-variable\r\n									ob_start();\r\n									debug_print_backtrace();\r\n									$errorout = ob_get_contents();\r\n									ob_end_clean();\r\n							\r\n									// Output the error in a fancybox\r\n									gather_error_info($e, false, $errorout);\r\n							}\r\n						} else $output .= $result;\r\n					}\r\n					// 10 - Dynamic\r\n					else if ($type===10)\r\n					{\r\n						$dyn_table_name = trim($result[0][\'method\']);\r\n						if (strlen($dyn_table_name)<1 || strlen($dyn_table_name)>64)\r\n						{\r\n							$output .= \'Dynamic Page does not contain a valid table name\';\r\n							ob_start();\r\n							trigger_error(\'Dynamic Page does not contain a valid table name\');\r\n							ob_end_clean();\r\n						} else\r\n						{\r\n							$append_var = \'$page_name = \"/\'.$clean_key.\'\";$table_dynamic = \"\'.$dyn_table_name.\'\";\';\r\n							eval($append_var.method_retrieve(\'toolkit_dynamic\',false,\'php_methods\',false));\r\n						}\r\n					}\r\n				}\r\n	\r\n			}\r\n			else if (isset($_SESSION[\'suppress\'])) {}\r\n			else\r\n			{\r\n				$test_file = $_SERVER[\'REQUEST_URI\'];\r\n				if (file_exists($test_file)) die(readfile($test_file));\r\n				$title = \'Page Not Found\';\r\n				$output .=  catch_output(\'?>\'.method_retrieve(\'page_not_found\'));\r\n			}\r\n			break;\r\n		}\r\n	}\r\n	// Else the user requested the default or main page\r\n	else\r\n	{\r\n		$qry = \"SELECT php_methods.name FROM php_methods INNER JOIN \r\n			php_index WHERE php_methods.id=php_index.page_id AND group_id=? LIMIT 1\";\r\n\r\n		if (isGroupMember(1))\r\n		{\r\n			$params = array(1);\r\n		}\r\n		else if (isset($_SESSION[\'id\']))\r\n		{\r\n			$params = array(2);\r\n		}\r\n		else\r\n		{\r\n			$params = array(3);\r\n		}\r\n\r\n		$result = query($qry, $params);\r\n		if ($result && isset($result[0][\'name\'])) $meth = $result[0][\'name\'];\r\n		else $meth = \'page_public\';\r\n\r\n		// Get the title, keywords, and description\r\n		$qry = \"SELECT title,keyword,description,type,method,id FROM php_methods WHERE name=? LIMIT 1\";\r\n		$params = array($meth);\r\n		$result = query($qry, $params);\r\n		if (isset($result[0][\'title\']))\r\n		{\r\n			//$title = $result[0][\'title\'];\r\n			$title = smartDB($result[0],\'title\',\'php_methods\');\r\n		}\r\n		if (isset($result[0][\'keyword\'])) $keyword = $result[0][\'keyword\'];\r\n		if (isset($result[0][\'description\'])) $description = $result[0][\'description\'];\r\n\r\n		$index_type = 0;\r\n		if (isset($result[0][\'type\'])) $index_type = $result[0][\'type\'];\r\n		// Evaluate as PHP code\r\n		if ($index_type===1)\r\n		{\r\n			$result = eval($result[0][\'method\']);\r\n			$error = error_get_last();\r\n			if ($error!=NULL && !isArraySame($error,$error_before))\r\n			//if ($clean_eval===false || isset(error_get_last()))\r\n			{\r\n				try\r\n				{\r\n					$output .= \'You found a bug! Calling in the bug squisher now. Please try again <a href=\"/\">later</a>.\';\r\n					//throw new Exception ($error[\'message\'].\" on line \".$error[\'line\'].\" in \".$error[\'file\']);\r\n				}\r\n				// Catch a PHP error\r\n				catch (Exception $e)\r\n				{			\r\n						// Suppress the output, save to a variable (must trace from here)\r\n						// Source: http://stackoverflow.com/questions/171318/how-do-i-capture-php-output-into-a-variable\r\n						ob_start();\r\n						debug_print_backtrace();\r\n						$errorout = ob_get_contents();\r\n						ob_end_clean();\r\n				\r\n						// Output the error in a fancybox\r\n						gather_error_info($e, false, $errorout);\r\n				}\r\n			} else 	$output .= $result;\r\n		}\r\n		// Evaluate as HTML code\r\n		else $output .= catch_output(\'?>\'.$result[0][\'method\']);\r\n	}\r\n}\r\n\r\n\r\nif (isset($_SESSION[\'suppress\'])) unset($_SESSION[\'suppress\']);','2012-08-10 22:29:06',2,1,'','','',''),(328,'page_screenshots','$output .= <<< OUTPUT\r\n<div id=\"myCarousel\" class=\"carousel slide\">\r\n  <!-- Carousel items -->\r\n  <div class=\"carousel-inner\" style=\"text-align: center;\">\r\nOUTPUT;\r\n\r\n$arr = glob (CMS_ROOT.DIR_SEP.\'img\'.DIR_SEP.\'screenshots\'.DIR_SEP.\'*.png\');\r\n$count=0;\r\nforeach($arr as $row)\r\n{\r\n	if ($count==0)\r\n	{\r\n		$output .= \'<div class=\"active item\">\';\r\n		$count +=1;\r\n	}\r\n	else $output .= \'<div class=\"item\">\';\r\n	$output .= \'<img src=\"\'.str_replace(CMS_ROOT,\'\',$row).\'\" style=\" display: inline-block;\"/>\';\r\n$output .= \'</div>\';\r\n}\r\n\r\n$output .= <<< OUTPUT\r\n  </div>\r\n  <!-- Carousel nav -->\r\n  <a class=\"carousel-control left\" href=\"#myCarousel\" data-slide=\"prev\">&lsaquo;</a>\r\n  <a class=\"carousel-control right\" href=\"#myCarousel\" data-slide=\"next\">&rsaquo;</a>\r\n</div>\r\nOUTPUT;\r\n\r\n// Need this for the heredoc','2012-07-09 22:06:54',2,1,'','Site Screenshots','',''),(284,'toolkit_index_selection','function page_list($group_id, $group_name)\r\n{\r\n	$output = \'\';\r\n\r\n	// Output the pages\r\n	$result = query(\"SELECT id,name,type,modified,title,keyword,description FROM php_methods ORDER BY name\", array());\r\n	$return=\'\';\r\n\r\n	$selected_page=0;\r\n\r\n	if (isset($_GET[\'page\']) && isset($_GET[\'group\']) && $group_id==$_GET[\'group\'])\r\n	{\r\n		$page_name = $_GET[\'page_name\'];\r\n		$selected_page = $_GET[\'page\'];\r\n		$qry = \"UPDATE php_index SET page_id=?, modified=CURRENT_TIMESTAMP, modifier=? WHERE group_id=? LIMIT 1\";\r\n		$params = array($_GET[\'page\'], $_SESSION[\'id\'], $group_id);\r\n		$result2 = query_execute($qry, $params);\r\n		if ($result2) msg_user(\"Index Update\",\"Index page for group, $group_name, updated to $page_name!\",\"index.php?toolkit_index_selection\");\r\n		else msg_user(\"Index Update\",\"Index page for group, $group_name, was NOT updated to $page_name.\",\"index.php?toolkit_index_selection\");\r\n	}\r\n	else\r\n	{\r\n		$qry = \"SELECT page_id FROM php_index WHERE group_id=? LIMIT 1\";\r\n		$params = array($group_id);\r\n		$result2 = query($qry, $params);\r\n		if ($result2 && isset($result2[0][\'page_id\'])) $selected_page = $result2[0][\'page_id\'];\r\n	}\r\n	$page_counter = 0;\r\n	\r\n	foreach($result as $element)\r\n	{\r\n		$name = $element[\'name\'];\r\n		$id = $element[\'id\'];\r\n	\r\n		if (strpos($name,\'cms_\')===0) {}\r\n		else if (strpos($name,\'hlp_\')===0) {}\r\n		else if (strpos($name,\'db_\')===0) {}\r\n		else if (strpos($name,\'delete_\')===0) {}\r\n		else if (strpos($name,\'style_\')===0) {}\r\n		else if (strpos($name,\'script_\')===0) {}\r\n		else if (strpos($name,\'div_\')===0) {}\r\n		else if (strpos($name,\'html_\')===0) {}\r\n		else\r\n		{\r\n			if ($id==$selected_page) $return .= img(\'Index\',\'/img/silk/tick.png\').\' \';\r\n			else $return .= img(\'Index\',\'/img/silk/tick.png\',false).\' \';\r\n			$return .= a($name,\"toolkit_index_selection&page=$id&group=$group_id&page_name=$name\").\' \'.br();\r\n			$page_counter += 1;\r\n		}\r\n	}\r\n	$output .= \'<div class=\"three_col\">\';\r\n	$output .= $return;\r\n	$output .= \'</div>\';\r\n	return array($output,$page_counter);\r\n}\r\n\r\n$arr = page_list(1, \'Administrators\');\r\n$output .= \'<b>Select the main page for the Administrators security group (\'.$arr[1].\'): </b>\';\r\n$output .= $arr[0].br();\r\n\r\n$arr = page_list(2, \'Authenticated\');\r\n$output .= \'<b>Select the main page for the Authenticated security group (\'.$arr[1].\'): </b>\';\r\n$output .= $arr[0].br();\r\n\r\n$arr = page_list(3, \'Anonymous\');\r\n$output .= \'<b>Select the main page for the Anonymous security group (\'.$arr[1].\'): </b>\';\r\n$output .= $arr[0];','2012-08-10 22:29:06',2,1,'','Main Page Selection','',''),(183,'cms_backbone','// Create the structure for the cached included file\r\n$writing = \'<?php\'.NEWLINE;\r\n\r\n//$writing .= \'if (file_exists(\"inc/cuteeditor_files/include_CuteEditor.php\")) require_once \"inc/cuteeditor_files/include_CuteEditor.php\";\'.NEWLINE;\r\n\r\n	$result_define = query(\"SELECT name, current_value FROM site_setting\", array());\r\n	foreach ($result_define as $row)\r\n	{\r\n		$writing .= \'if (!defined(\"\'.$row[\'name\'].\'\"))define(\"\'.$row[\'name\'].\'\",\"\'.$row[\'current_value\'].\'\");\'.NEWLINE;\r\n	}\r\n\r\n	$writing .= \'$constant = get_defined_constants();\'.NEWLINE;\r\n\r\n	$helpers = method_retrieve(\'hlp_%\', true);\r\n	foreach ($helpers as $hlp)\r\n	{\r\n		$writing .= $hlp[\'method\'];\r\n		$writing .= NEWLINE;\r\n	}\r\n\r\n	$writing .= NEWLINE;\r\n	$writing .= \'$output = \"\";\';\r\n	$writing .= NEWLINE;\r\n\r\n	// $output variable is first used here\r\n	$writing .= method_retrieve(\'cms_pager\').NEWLINE.NEWLINE;\r\n\r\n	$writing .= \'$html_output1 = <<< OUTPUT\'.NEWLINE;\r\n	$writing .= method_retrieve(\'html_doctype\').NEWLINE;\r\n	$writing .= \'<head lang=\"en\">\'.NEWLINE;\r\n	$writing .= NEWLINE.\'OUTPUT;\'.NEWLINE;\r\n\r\n	// $html_output2 is here\r\n	$writing .= method_retrieve(\'html_head\').NEWLINE;\r\n\r\n	$writing .= \'$html_output3 = <<< OUTPUT\'.NEWLINE;\r\n	$writing .= \'</head>\'.NEWLINE.NEWLINE;\r\n	$writing .= \'<body onload=\"prettyPrint()\">\'.NEWLINE;\r\n	$writing .= NEWLINE.\'OUTPUT;\'.NEWLINE;\r\n	\r\n	// $html_output4 is here\r\n	$writing .= method_retrieve(\'div_header\').NEWLINE;\r\n	\r\n	$writing .= \'$html_output5 = <<< OUTPUT\'.NEWLINE;\r\n	//$writing .= \'<div id=\"content\">\'.NEWLINE;\r\n	$writing .= \'<div class=\"container-fluid\"><div id=\"content_in_0\"><h1>$title_page</h1></div>\';\r\n	$writing .= NEWLINE.\'OUTPUT;\'.NEWLINE;\r\n\r\n	$writing .= \'if (isGroupMember(1)){\'.NEWLINE;\r\n	$writing .= \'$html_output5 .= <<< OUTPUT\'.NEWLINE;\r\n	$writing .= \'<div class=\"row-fluid\">\'.NEWLINE;\r\n	\r\n	// Left\r\n	/*\r\n	$writing .= \'<div name=\"main_sidebar\" id=\"main_sidebar\" class=\"span2\">\'.NEWLINE;\r\n	$writing .= NEWLINE.\'OUTPUT;\'.NEWLINE;\r\n	$writing .= method_retrieve(\'cms_admin_sidebar\').NEWLINE;\r\n	$writing .= \'$html_output5 .= <<< OUTPUT\'.NEWLINE;\r\n	$writing .= \'</div>\'.NEWLINE;\r\n	*/\r\n\r\n	$writing .= \'<div name=\"main_content\" id=\"main_content\" class=\"span10\">\'.NEWLINE;\r\n	$writing .= NEWLINE.\'OUTPUT;\'.NEWLINE;\r\n	$writing .= \'}\'.NEWLINE;\r\n	\r\n	$writing .= \'if (isGroupMember(1)){\'.NEWLINE;\r\n	$writing .= \'$output .= <<< OUTPUT\'.NEWLINE;\r\n	\r\n	// Right\r\n	$writing .= \'</div>\'.NEWLINE;\r\n	$writing .= \'<div name=\"main_sidebar\" id=\"main_sidebar\" class=\"span2\">\'.NEWLINE;\r\n	$writing .= NEWLINE.\'OUTPUT;\'.NEWLINE;\r\n	$writing .= method_retrieve(\'cms_admin_sidebar\').NEWLINE;\r\n	$writing .= \'$output .= <<< OUTPUT\'.NEWLINE;\r\n	\r\n	$writing .= \'</div>\'.NEWLINE;\r\n	$writing .= \'</div>\'.NEWLINE;\r\n	$writing .= NEWLINE.\'OUTPUT;\'.NEWLINE;\r\n	$writing .= \'}\'.NEWLINE;\r\n\r\n	$writing .= \'$output .= <<< OUTPUT\'.NEWLINE;\r\n	\r\n	// Close the tags\r\n	//$writing .= NEWLINE.\'</div>\'.NEWLINE.\'</div>\'.NEWLINE;\r\n	$writing .= NEWLINE.\'</div>\'.NEWLINE;\r\n\r\n	$writing .= NEWLINE.\'OUTPUT;\'.NEWLINE;\r\n	$writing .= method_retrieve(\'div_footer\').NEWLINE;\r\n	$writing .= \'$output .= <<< OUTPUT\'.NEWLINE;\r\n\r\n	$writing .= \'</body>\'.NEWLINE;\r\n	$writing .= \'</html>\'.NEWLINE.NEWLINE;\r\n	$writing .= NEWLINE.\'OUTPUT;\'.NEWLINE;\r\n	\r\n	$writing .= \'$output = $html_output1.$html_output2.$html_output3.$html_output4.$html_output5.$output;\'.NEWLINE;\r\n\r\n	$writing .= method_retrieve(\'cms_notification_control\').NEWLINE;\r\n\r\n	$writing .= \'?>\';\r\n\r\necho $writing;','2012-07-16 22:20:04',2,1,'','','',''),(220,'div_header','$admin=\'\';\r\n$login = \'\';\r\n$drop_down_menu=\'\';\r\n\r\n// Output the admin settings\r\nif (isGroupMember(1))\r\n{\r\n	$admin .= <<< OUTPUT\r\n	<form class=\"navbar-search\" method=\"GET\" action=\"index.php\">\r\n	<input type=\"hidden\" name=\"toolkit_search\" id=\"toolkit_search\" />\r\n	<input type=\"text\" name=\"search\" class=\"search-query\" placeholder=\"Search\">\r\n	</form>\r\nOUTPUT;\r\n}\r\n\r\nif (isset($_SESSION[\'id\']))\r\n{\r\n	// Load the menus for authenticated\r\n	$drop_down_menu .= load_menu(2);\r\n}\r\n\r\n// Output the public menu\r\nelse\r\n{\r\n	// Load the menus for anonymous\r\n	$drop_down_menu .= load_menu(3);\r\n}\r\n\r\n$title_edit = quickSystemSetting();\r\n\r\n$html_output4 = <<< OUTPUT\r\n\r\n    <div class=\"navbar navbar-fixed-{$constant[\'SETTING_NAV_MENU_LOCATION\']}\">\r\n      <div class=\"navbar-inner\">\r\n        <div class=\"container-fluid\">\r\n          <a class=\"btn btn-navbar\" data-toggle=\"collapse\" data-target=\".nav-collapse\">\r\n            <span class=\"icon-bar\"></span>\r\n            <span class=\"icon-bar\"></span>\r\n            <span class=\"icon-bar\"></span>\r\n          </a>\r\n          <a class=\"brand\" href=\"/\">{$title}</a>{$title_edit}\r\n          <div class=\"nav-collapse\">\r\n            <ul class=\"nav pull-{$constant[\'SETTING_NAV_MENU_SIDE\']}\">\r\n			{$admin}\r\n			{$drop_down_menu}\r\n            </ul>\r\n          </div><!--/.nav-collapse -->\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\nOUTPUT;\r\n\r\n//Need this to ensure the heredoc terminates properly when eval()','2012-07-09 15:35:40',2,1,'','','',''),(219,'html_doctype','<!DOCTYPE html>','2012-06-08 16:29:37',2,0,'','','',''),(221,'cms_notification_control','function showUserMessage()\r\n{\r\n	//if (isset($_SESSION[\'message\']) && isset($_SESSION[\'message_title\']) && !isset($_SESSION[\'redirect\']))\r\n	if (isset($_SESSION[\'message\']) && isset($_SESSION[\'message_title\']))\r\n	{\r\n		if (isset($_SESSION[\'id\'])) $id = $_SESSION[\'id\'];\r\n		else $id = 0;\r\n\r\n		$qry = \"INSERT INTO log_change (userid,change_time,change_title,change_details) VALUES(?,CURRENT_TIMESTAMP,?,?)\";\r\n		$params = array($id,$_SESSION[\'message_title\'],$_SESSION[\'message\']);\r\n		if (constant_test(\'SETTING_LOG_CHANGE\',\'enable\')) query_execute_nolog($qry, $params);\r\n\r\n		$message = $_SESSION[\'message\'];\r\n		$message_title = $_SESSION[\'message_title\'];\r\n		\r\n		unset($_SESSION[\'message\']);\r\n		unset($_SESSION[\'message_title\']);\r\n		\r\n		$usermessage = <<< OUTPUT\r\n	\r\n<!--User Popup-->\r\n	<!-- <div id=\"PopUpNotice\">\r\n	<h2 style=\"border: none;\">{$message_title}</h2>	\r\n	<p>{$message}</p> \r\n		<div style=\"text-align: right;\">\r\n			<a onmouseover=\"this.style.cursor=\'pointer\';\"  onfocus=\"this.blur();\" onclick=\"document.getElementById(\'PopUpNotice\').style.display = \'none\';\">\r\n				<p type=\"psulink\">Close</p>\r\n			</a>\r\n		</div>\r\n	</div> -->\r\n	<div id=\"PopUpNotice\">\r\n<div class=\"alert alert-info\" style=\"text-align: left;\">\r\n<button class=\"close\" data-dismiss=\"alert\">Ã—</button>\r\n<strong>{$message_title}:</strong> {$message}\r\n</div>\r\n</div>\r\n<!--User Popup-->\r\n	\r\nOUTPUT;\r\n		return $usermessage;\r\n	}\r\n}\r\n\r\nif (isset($_SESSION[\'wait\']))\r\n{\r\n	if (isset($_SESSION[\'redirect\']))\r\n	{\r\n		$redirect = $_SESSION[\'redirect\'];\r\n		unset($_SESSION[\'redirect\']);\r\n	}\r\n	else $redirect = \'index.php\';\r\n\r\n	// Handle memcache\r\n	global $memcache;\r\n	if (isset($memcache)) $memcache->flush();\r\n\r\n	// Handle XCache\r\n	if (extension_loaded(\'xcache\'))\r\n	{\r\n		xcache_clear_cache(XC_TYPE_PHP,0);\r\n		xcache_clear_cache(XC_TYPE_VAR,0);\r\n	}\r\n\r\n	header(\'location: \'.$redirect);\r\n}\r\nelse\r\n{\r\n	echo $output;\r\n	if (function_exists(\'showUserMessage\')) echo showUserMessage();\r\n\r\n	// Write the error message\r\n	//if (function_exists(\'cms_show_error\')) echo cms_show_error();\r\n}','2012-07-02 02:49:51',2,1,'','','',''),(174,'cms_verbose','global $sql_counter_out, $sql_counter_in;\r\n\r\necho \'<div class=\"well\">\';\r\necho \'SQL queries using query/query_execute function: \'.($sql_counter_in-$sql_counter_out);\r\necho \'<br />SQL queries using method_retrieve function: \'.$sql_counter_out;\r\necho \'<br />SQL queries total: \'.$sql_counter_in;\r\necho \'</div>\';\r\necho \'Session\'.print_array($_SESSION);\r\necho \'<br />Server\'.print_array($_SERVER);\r\necho \'<br />Request\'.print_array($_REQUEST);\r\necho \'<br />Post\'.print_array($_POST);\r\necho \'<br />Get\'.print_array($_GET);\r\necho \'<br />Cookie\'.print_array($_COOKIE);\r\necho \'<br />Env\'.print_array($_ENV);\r\necho \'<br />\';\r\nif (function_exists(\'PtimerStop\')) echo PtimerStop();','2012-07-20 21:36:08',2,1,'','','',''),(185,'toolkit_search','function countResults($passed)\r\n{\r\n	$qry = \"SELECT id,name,method,post,type,title,keyword,description FROM php_methods WHERE method COLLATE latin1_bin LIKE ? || post COLLATE latin1_bin LIKE ?\";\r\n	$params = array(\'%\'.$passed.\'%\',\'%\'.$passed.\'%\');\r\n	$result = query($qry, $params);\r\n	\r\n	$return=\'\';\r\n	$counter = 0;\r\n	$page_counter = 0;\r\n	\r\n	// Add in the index\r\n	$file_index = file_get_contents(\"index.php\");\r\n	array_unshift ($result, array(\'id\'=>-1,\'name\'=>\'index.php\',\'method\'=>$file_index ,\'post\'=>\'\',\'type\'=>1,\'path\'=>CMS_ROOT));\r\n\r\n	// Add in the define.php\r\n	$file_index = file_get_contents(CMS_PHP_SCRIPT.DIR_SEP.\"define.php\");\r\n	array_unshift ($result, array(\'id\'=>-1,\'name\'=>\'define.php\',\'method\'=>$file_index ,\'post\'=>\'\',\'type\'=>1,\'path\'=>CMS_PHP_SCRIPT.DIR_SEP));\r\n\r\n	foreach($result as $row)\r\n	{\r\n		// Output the id and name from SQL\r\n	\r\n		if ($row[\'id\']==-1)\r\n		{\r\n			$index = $row[\'name\'].\'&path=\'.$row[\'path\'];\r\n			$elink = a($row[\'name\'], \'toolkit_file_manager&file_edit=\'.$index);\r\n		}\r\n		else\r\n		{\r\n			$elink = \'<a href=\"index.php?toolkit_edit_method=\'.$row[\'name\'].\'&type=\'.$row[\'type\'].\'&title=\'.$row[\'title\'].\'&keyword=\'.$row[\'keyword\'].\'&description=\'.$row[\'description\'].\'\">\'.$row[\'name\'].\'</a>\';\r\n		}\r\n	\r\n		//$num1 = explode($passed,htmlentities($row[\'method\'], ENT_QUOTES, \'UTF-8\'));\r\n		$num1 = explode($passed,$row[\'method\']);\r\n		//$num2 = explode($passed,htmlentities($row[\'post\'], ENT_QUOTES, \'UTF-8\'));\r\n		$num2 = explode($passed,$row[\'post\']);\r\n	\r\n		$n1 = (count($num1)-1);\r\n		$n2 = (count($num2)-1);\r\n	\r\n		if ($n1<1)\r\n		{\r\n			if (strpos($row[\'method\'],$passed)) $n1=1;\r\n			else $n1=0;\r\n		}\r\n		if ($n2<1)\r\n		{\r\n			if (strpos($row[\'post\'],$passed)) $n2=1;\r\n			else $n2=0;\r\n		}\r\n	\r\n		if ($n1>0) $r1 = $n1.\' in Page\';\r\n		else $r1 = \'\';\r\n		if ($n2>0) $r2 = $n2.\' in Post\';\r\n		else $r2 = \'\';\r\n		\r\n		if ($n1>0 && $n2>0) $comma = \', \';\r\n		else $comma = \'\';\r\n	\r\n		// This is to ensure index doesn\'t show up on 0 results\r\n		if ($n1 != 0 || $n2 != 0)\r\n		{\r\n			$return.=\'<br />Method: \'.$elink.\'<br />\';\r\n			$return.=\'Found: \'.$r1.$comma.$r2;\r\n			$return.=\'<br />\';\r\n			$counter = $counter + $n1 + $n2;\r\n			$page_counter += 1;\r\n		}\r\n	}\r\n	// This is to ensure index doesn\'t show up on 0 results\r\n	if ($counter==0) $result = array();\r\n	return array($counter, $result, $return, $page_counter);\r\n}\r\n\r\nif (isset($_GET[\'search\']) && strlen($_GET[\'search\'])>0)\r\n{\r\n	$passed = htmlentities($_GET[\'search\'], ENT_QUOTES, \'UTF-8\');\r\n	$result = countResults($_GET[\'search\']);\r\n\r\n$output .= <<< OUTPUT\r\n\r\n<div class=\"row-fluid\">\r\n<form class=\"well\" method=\"get\">\r\n<input type=\"hidden\" name=\"toolkit_search\" id=\"toolkit_search\" />\r\n<label>Search:</label><input class=\"span4\" type=\"text\" id=\"search\" name=\"search\" placeholder=\"What are you looking for?\" value=\"{$passed}\" />\r\n<p class=\"help-block\">Search is case-sensitive.</p>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to search\">Search</button>\r\n</form>\r\n</div>\r\n\r\n<script>document.getElementById(\"search\").focus();</script>\r\n\r\nOUTPUT;\r\n\r\n	$output .= \'Options:<br />\';\r\n	$output .= a(\'Reset Search\',\'toolkit_search\').\' or \'.a(\'Search and Replace\',\'toolkit_replace&search=\'.urlencode($_GET[\'search\'])).br();\r\n\r\n	$output .= \'<br /><b>\'.$result[0].\' results found in \'.$result[3].\' page(s)</b><br />\';\r\n	$output .= $result[2];\r\n\r\n}\r\nelse\r\n{\r\n\r\n$output .= <<< OUTPUT\r\n\r\n<div class=\"row-fluid\">\r\n<form class=\"well\" method=\"get\">\r\n<input type=\"hidden\" name=\"toolkit_search\" id=\"toolkit_search\" />\r\n<label>Search:</label><input class=\"span4\" type=\"text\" id=\"search\" name=\"search\" placeholder=\"What are you looking for?\" value=\"\" />\r\n<p class=\"help-block\">Search is case-sensitive.</p>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to search\">Search</button>\r\n</form>\r\n</div>\r\n\r\n<script>document.getElementById(\"search\").focus();</script>\r\n\r\nOUTPUT;\r\n\r\n	$output .= \'Options:<br />\';\r\n	if (isset($_GET[\'detail\'])) $output .= a(\'Less Detail\',\'toolkit_search\').br();\r\n	else $output .= a(\'More Detail\',\'toolkit_search&detail\').br();\r\n	\r\n	// Show all the methods not in the Trash\r\n	$arr = db_method_list();\r\n	$output .= br().\"Available pages for searching (\".count($arr).\"):\";\r\n	foreach($arr as $element)\r\n	{\r\n		$name = $element[\'name\'];\r\n		/* if (strpos($name,\'cms_\')===0) {}\r\n		else if (strpos($name,\'hlp_\')===0) {}\r\n		else if (strpos($name,\'db_\')===0) {}\r\n		else if (strpos($name,\'style_\')===0) {}\r\n		else $name = a($element[\'name\'], $element[\'name\']); */\r\n		\r\n		//if ($name==$element[\'name\']) $delete=\'\';\r\n		//else $delete=a(\'trash\', \'toolkit_control&trash=\'.$element[\'name\']);\r\n		$delete=\'\';\r\n		\r\n		// Output the method name, edit, delete\r\n		//$output .= br().$name.\" \".a(\'preview\', \'toolkit_control&preview=\'.$element[\'name\']).\" \".a(\'edit\', \'toolkit_edit_method=\'.$element[\'name\'].\'&type=\'.$element[\'type\']).\" \".$delete;\r\n	\r\n		if (isset($_GET[\'detail\']))\r\n		{\r\n			$result = countResults($name);\r\n			$output .= br().a($name,\'toolkit_search&search=\'.$name).\' (\'.$result[0].\' references)\';\r\n		}\r\n		else $output .= br().a($name,\'toolkit_search&search=\'.$name);\r\n	}\r\n}','2012-08-10 22:29:06',2,1,'','Search and Replace','',''),(191,'access_change_pass','<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n<label>Old Password:</label><input class=\"span12\" type=\"password\" id=\"pass_old\" name=\"pass_old\" value=\"\" placeholder=\"case sensitive\" />\r\n<label>New Password:</p><input class=\"span12\" type=\"password\" id=\"pass_new\" name=\"pass_new\" value=\"\" placeholder=\"case sensitive\" />\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to change password\">Change</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n\r\n<script>document.getElementById(\"pass_old\").focus();</script>','2012-06-12 04:07:49',2,0,'// Check for required Post values\r\nif (!isset($_POST[\'pass_old\']) || !isset($_POST[\'pass_new\'])) die(\'Invalid Post!\');\r\n\r\n// Query to update password\r\n$qry = \"UPDATE access_user SET password=? WHERE password=? AND id=? LIMIT 1\";\r\n\r\n// Fill the array with the values\r\n//$params = array(md5(trim($_POST[\'pass_new\'])),md5(trim($_POST[\'pass_old\'])),$_SESSION[\'id\']);\r\n$params = array(secure_password($_SESSION[\'username\'], $_POST[\'pass_new\']),\r\n	secure_password($_SESSION[\'username\'], $_POST[\'pass_old\']),\r\n	$_SESSION[\'id\']);\r\n\r\n// Execute the query and return a success or failure\r\n$success = query_execute($qry, $params);\r\n\r\n// Output to the user\r\nif ($success) msg_user(\'Password Change\',\'Password changed successfully\');\r\nelse msg_user(\'Password Change\',\'Password changed failed - invalid password\');','Change Password','',''),(192,'misc_cause_error','$xzipp6 .= \'f\';\r\n\r\n$var = $_POST[\'user\'];\r\n\r\n//PHP or HTML code goes here\r\n//msg_user(\"Hello\",\"I love Justice and Jesus\");\r\n\r\n/*\r\nif (!isset($_POST[\'user\']) || !isset($_POST[\'pass\']))\r\n{\r\necho \'Bad HACKER!\';\r\n}\r\nelse\r\n{\r\n\r\n$qry = \"SELECT id FROM access_user2 WHERE last_name=? ORDER BY id\";\r\n	\r\n$params = array($_GET[\'passed_id\']);\r\n$result = query($qry, $params);\r\n}*/\r\n\r\n//eval(\"strpos2();\");\r\n//$xzipp6 .= \'f\';\r\n//strpos();\r\n//echo $php_errormsg;','2012-06-18 17:24:34',2,1,'','','',''),(196,'toolkit_file_manager','if (isset($_GET[\'show_image\']))\r\n{\r\n	//while(@ob_end_clean());\r\n	$img=$_GET[\'show_image\']; \r\n	$ext = pathinfo($img, PATHINFO_EXTENSION);\r\n	header(\"content-type: image/$ext\"); \r\n	readfile($img);\r\n	exit();\r\n}\r\n\r\n\r\n// If the path is in a GET, use it\r\nif (isset($_GET[\'path\'])) $path = $_GET[\'path\'];\r\nelse\r\n{\r\n$path = CMS_ROOT;\r\n\r\n$dir_name = CMS_HIDDEN.DIR_SEP.\"mysql_backup\";\r\n$img_dir = CMS_ROOT.DIR_SEP.\"img\";\r\n\r\n$output .= <<< OUTPUT\r\n\r\n<p><b>Quick Links:</b></p>\r\n<a href=\"index.php?toolkit_file_manager&path={$dir_name}\">MySQL Backup Folder</a><br />\r\n<a href=\"index.php?toolkit_file_manager&path={$img_dir}\">Web Image Folder</a><br />\r\n<br />\r\n\r\nOUTPUT;\r\n}\r\n\r\n// *********************************************** Create a folder ***********************************************\r\nif (isset($_GET[\'folder_create\']))\r\n{\r\n$output .= <<< OUTPUT\r\n\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" action=\"index.php?toolkit_file_manager&folder_create&path={$path}\" onsubmit=\"return validateForm()\" method=\"post\">\r\n<h3>Create Folder</h3>\r\n<label>Folder name:</label><input class=\"span12\" type=\"text\" id=\"folder\" name=\"folder\" value=\"\" />\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to create folder\">Create</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n\r\n<script>document.getElementById(\"folder\").focus();</script>\r\n\r\nOUTPUT;\r\n}\r\n\r\n// *********************************************** Create a file ***********************************************\r\nelse if (isset($_GET[\'file_create\']))\r\n{\r\n$output .= <<< OUTPUT\r\n\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" action=\"index.php?toolkit_file_manager&file_create&path={$path}\" onsubmit=\"return validateForm()\" method=\"post\">\r\n<h3>Create File</h3>\r\n<label>File name:</label><input class=\"span12\" type=\"text\" id=\"file\" name=\"file\" value=\"\" />\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to create file\">Create</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n\r\n<script>document.getElementById(\"file\").focus();</script>\r\n\r\nOUTPUT;\r\n}\r\n\r\n// *********************************************** Rename a folder ***********************************************\r\nelse if (isset($_GET[\'folder_rename\']))\r\n{\r\n\r\n$folder = $_GET[\'path\'].DIR_SEP.$_GET[\'folder_rename\'];\r\n\r\n$output .= <<< OUTPUT\r\n\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" action=\"index.php?toolkit_file_manager&folder_rename&path={$path}\" onsubmit=\"return validateForm()\" method=\"post\">\r\n<h3>Rename or Move Folder</h3>\r\n<label>Old folder name:</label><input class=\"span12\" type=\"text\" id=\"folder_old\" name=\"folder_old\" value=\"{$folder}\" />\r\n<label>New folder name:</label><input class=\"span12\" type=\"text\" id=\"folder_new\" name=\"folder_new\" value=\"{$folder}\" />\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to rename folder\">Rename</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n\r\n<script>document.getElementById(\"folder_new\").focus();</script>\r\n\r\nOUTPUT;\r\n}\r\n\r\n// *********************************************** Rename a file ***********************************************\r\nelse if (isset($_GET[\'file_rename\']))\r\n{\r\n\r\n$file = $_GET[\'path\'].DIR_SEP.$_GET[\'file_rename\'];\r\n\r\n$output .= <<< OUTPUT\r\n\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" action=\"index.php?toolkit_file_manager&file_rename&path={$path}\" onsubmit=\"return validateForm()\" method=\"post\">\r\n<h3>Rename or Move File</h3>\r\n<label>Old file name:</label><input class=\"span12\" type=\"text\" id=\"file_old\" name=\"file_old\" value=\"{$file}\" />\r\n<label>New file name:</label><input class=\"span12\" type=\"text\" id=\"file_new\" name=\"file_new\" value=\"{$file}\" />\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to rename file\">Rename</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n\r\n<script>document.getElementById(\"file_new\").focus();</script>\r\n\r\nOUTPUT;\r\n}\r\n\r\n// *********************************************** Delete a folder ***********************************************\r\nelse if (isset($_GET[\'folder_delete\']))\r\n{\r\n$output .= <<< OUTPUT\r\n\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" action=\"index.php?toolkit_file_manager&folder_delete&path={$path}\" onsubmit=\"return validateForm()\" method=\"post\">\r\n<h3>Delete Folder</h3>\r\n<label>Folder name:</label><input class=\"span12\" type=\"text\" id=\"folder\" name=\"folder\" value=\"{$_GET[\'folder_delete\']}\" readonly=\"readonly\" />\r\n<p class=\"help-block\">Note: All files and folder within this folder will also be deleted.</p>\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to delete folder\">Delete</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n\r\nOUTPUT;\r\n}\r\n\r\n// *********************************************** Empty a folder ***********************************************\r\nelse if (isset($_GET[\'folder_delete_contents\']))\r\n{\r\n$output .= <<< OUTPUT\r\n\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" action=\"index.php?toolkit_file_manager&folder_delete_contents&path={$path}\" onsubmit=\"return validateForm()\" method=\"post\">\r\n<h3>Empty Folder</h3>\r\n<label>Folder name:</label><input class=\"span12\" type=\"text\" id=\"folder\" name=\"folder\" value=\"{$_GET[\'path\']}\" readonly=\"readonly\" />\r\n<p class=\"help-block\">Note: All files and folder within this folder will be deleted.</p>\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to empty the folder\">Empty</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n\r\nOUTPUT;\r\n}\r\n\r\n// *********************************************** Delete a file ***********************************************\r\nelse if (isset($_GET[\'file_delete\']))\r\n{\r\n$output .= <<< OUTPUT\r\n\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" action=\"index.php?toolkit_file_manager&file_delete&path={$path}\" onsubmit=\"return validateForm()\" method=\"post\">\r\n<h3>Delete File</h3>\r\n<label>File name:</label><input class=\"span12\" type=\"text\" id=\"folder\" name=\"file\" value=\"{$_GET[\'file_delete\']}\" readonly=\"readonly\" />\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to delete file\">Delete</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n\r\nOUTPUT;\r\n}\r\n\r\n// *********************************************** View a file ***********************************************\r\nelse if (isset($_GET[\'file_view\']) && isset($_GET[\'path\']))\r\n{\r\n\r\n$file = $_GET[\'path\'].DIR_SEP.$_GET[\'file_view\'];\r\n\r\nif (!file_exists($file))\r\n{\r\n	$output .= \"File does not exist.\".br();\r\n	return;\r\n}\r\n\r\n$contents = htmlentities(file_get_contents($file));\r\n$file_size = round(filesize($file)/1024,2);\r\n\r\nif (!$contents && $file_size!=0)\r\n{\r\n$contents = \'<div class=\"well\">File cannot be viewed in a webpage: \'.$_GET[\'file_view\'].\'</div>\';\r\n$output .= $contents;\r\n}\r\nelse\r\n{\r\n$output .= <<< OUTPUT\r\n<a href=\"index.php?toolkit_file_manager&path={$_GET[\'path\']}\">Close</a>\r\n<div style=\"width: auto; text-align:left;\">\r\n<h3>View File: {$_GET[\'file_view\']} ({$file_size} KB)</h3>\r\n\r\n<pre class=\"prettyprint linenums\">\r\n{$contents}\r\n</pre>\r\n\r\n<div class=\"clear\"></div>\r\n</div>\r\n\r\nOUTPUT;\r\n}\r\n}\r\n\r\n// *********************************************** Edit a file ***********************************************\r\nelse if (isset($_GET[\'file_edit\']) && isset($_GET[\'path\']))\r\n{\r\n\r\n$file = $_GET[\'path\'].DIR_SEP.$_GET[\'file_edit\'];\r\n$contents = htmlentities(file_get_contents($file));\r\n$file_size = round(filesize($file)/1024,2);\r\n\r\nif (!$contents && $file_size!=0)\r\n{\r\n//$contents = \"File cannot be edited in a webpage.\";\r\n$contents = \'<div class=\"well\">File cannot be edited in a webpage: \'.$_GET[\'file_edit\'].\'</div>\';\r\n$output .= $contents;\r\n}\r\nelse\r\n{\r\n\r\n\r\n$q = \'index.php?toolkit_file_manager&file_edit\';\r\n\r\n$output .= <<< OUTPUT\r\n<a href=\"index.php?toolkit_file_manager&path={$_GET[\'path\']}\">Close</a>\r\n<div class=\"well\" style=\"text-align:left;\">\r\n\r\n<h3>Edit File: {$_GET[\'file_edit\']} ({$file_size} KB)</h3>\r\n<form id=\"postfrm\" name=\"standardform\" method=\"post\">\r\n<textarea class=\"span12\" name=\"file_contents\" id=\"file_contents\" rows=\"25\" cols=\"65\" wrap=\"off\">{$contents}</textarea>\r\n<input type=\"hidden\" name=\"file\" id=\"file\" value=\"{$_GET[\'file_edit\']}\" />\r\n<input type=\"hidden\" name=\"path\" id=\"path\" value=\"{$_GET[\'path\']}\" />\r\n<p class=\"help-block\">Note: All content in file will be replaced.</p>\r\n\r\n<div class=\"btn-toolbar\">\r\n	<div class=\"btn-group\">\r\n		<button class=\"btn btn-primary\" title=\"Click once to update file\">Update</button>\r\n		<a class=\"btn\" title=\"Click once to save the code without leaving the page\" name=\"quicksave\" onClick=\"quickSave()\">Quick Save</a>\r\n	</div>\r\n	<div class=\"btn-group\">\r\n		<a name=\"insertTabs\" class=\"btn\" onClick=\"indentSelection(document.standardform.file_contents, \'	\')\">Indent Line(s)</a>\r\n		<a name=\"decreaseTabs\" class=\"btn\" onClick=\"outdentSelection(document.standardform.file_contents, \'	\')\">Outdent Line(s)</a>\r\n	</div>\r\n	<div class=\"btn-group\">\r\n		<a name=\"add_num1\" class=\"btn\" id=\"add_num1\" onClick=\"addNumbers1()\">Line Numbers On</a>\r\n		<a name=\"del_num1\" class=\"btn\" id=\"del_num1\" onClick=\"delNumbers1()\">Line Numbers Off</a>\r\n	</div>\r\n</div>\r\n</form>\r\n\r\n</div>\r\n\r\n<script>\r\nfunction quickSave()\r\n{\r\n	$.post(\"{$q}\", $(\"#postfrm\").serialize());\r\n}\r\n\r\n$(\"#del_num1\").hide();\r\nfunction addNumbers1()\r\n{\r\n	$(\"#file_contents\").linedtextarea();\r\n	$(\"#add_num1\").hide();\r\n	$(\"#del_num1\").show();\r\n}\r\nfunction delNumbers1()\r\n{\r\n	$(\"#file_contents\").unwrap();\r\n	$(\"#file_contents\").unwrap();\r\n	$(\"#file_contents\").unbind(\"scroll\");\r\n	$(\"#file_contents\").unbind(\"resize\");\r\n	$(\"#file_contents\").removeAttr(\'style\');\r\n	$(\'.lines\').remove();\r\n	$(\"#del_num1\").hide();\r\n	$(\"#add_num1\").show();\r\n}\r\n\r\n</script>\r\n\r\nOUTPUT;\r\n}\r\n}\r\n\r\n// *********************************************** Download a file ***********************************************\r\nelse if (isset($_GET[\'file_download\']) && isset($_GET[\'path\']))\r\n{\r\n	$file = $_GET[\'path\'].DIR_SEP.$_GET[\'file_download\'];\r\n	\r\n	// This cleans up any buffers and removes the leading line feed\r\n	//while(@ob_end_clean());\r\n\r\n	/*$file_handle = fopen($file, \"r\");\r\n	//$download_rate = 20.5;\r\n	//fseek($file_handle,0);\r\n	while(!feof($file_handle))\r\n	{\r\n		// send the current file part to the browser\r\n		//print fread($file_handle, round($download_rate * 1024));\r\n		print fread($file_handle, 1024);\r\n		flush();\r\n		//sleep(1);\r\n	}\r\n	fclose($file_handle);\r\n	*/\r\n	\r\n	//header(\'Content-Type: image/png\');\r\n	//header(\"Cache-Control: must-revalidate, post-check=0, pre-check=0\");\r\n	//header(\"Pragma: public\");     \r\n	//header(\"Cache-Control: maxage=1\"); \r\n	//header(\"Content-Transfer-Encoding: binary\");\r\n\r\nheader(\'Cache-Control: private\');\r\nheader(\"Content-Type: application/octet-stream\");\r\nheader(\"Content-Length: \" . filesize($file));\r\nheader(\'Content-Disposition: attachment; filename=\'.$_GET[\'file_download\']);\r\nheader(\'Expires: 0\');\r\n\r\nreadfile($file);\r\nexit();\r\n}\r\n\r\n// *********************************************** Compress a folder ***********************************************\r\nelse if (isset($_GET[\'folder_compress\']) && isset($_GET[\'path\']))\r\n{\r\n\r\nfunction create_zip($files = array(),$destination = \'\',$overwrite = false)\r\n{\r\n\r\n	// If the destination already exists, return false\r\n	if(file_exists($destination) && !$overwrite) return false;\r\n	\r\n	// Add each real file to another array\r\n	$valid_files = array();\r\n	if(is_array($files))\r\n	{\r\n		foreach($files as $file) { if(is_file($file)) $valid_files[] = $file; }\r\n	}\r\n	\r\n	if(count($valid_files)>0)\r\n	{\r\n		// Create the zip\r\n		$zip = new ZipArchive();\r\n		\r\n		// Check permissions\r\n		if($zip->open($destination,$overwrite ? ZIPARCHIVE::OVERWRITE : ZIPARCHIVE::CREATE) !== true) return false;\r\n		\r\n		foreach($valid_files as $file) $zip->addFile($file,str_replace($_GET[\'path\'].DIR_SEP,\'\',$file));\r\n		//echo \'The zip archive contains \',$zip->numFiles,\' files with a status of \',$zip->status;\r\n		    \r\n		// Close the zip\r\n		$zip->close();\r\n		    \r\n		// Ensure the file exists\r\n		return file_exists($destination);\r\n	}\r\n	else return false;\r\n}\r\n\r\nfunction glob_recursive($path, $pattern, $flags = 0)\r\n{\r\n	$files = glob($path.DIR_SEP.$pattern, $flags);\r\n	\r\n	foreach (glob($path.DIR_SEP.\"*\", GLOB_ONLYDIR|GLOB_NOSORT) as $dir)\r\n	{\r\n		$files = array_merge($files, glob_recursive($dir,$pattern, $flags));\r\n	}       \r\n	return $files;\r\n}\r\n\r\n$zip_name = $_GET[\'path\'].DIR_SEP.basename($_GET[\'path\']).\'_\'.date(\"Y-m-d_H.i.s\").\'.zip\';\r\n$result = create_zip(glob_recursive($_GET[\'path\'],\"*\"),$zip_name);\r\n\r\nif ($result) msg_user(\"Zip Creation\",\"Zip file was created successfully:<br />\".$zip_name,\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\nelse msg_user(\"Zip Creation\",\"Zip file was NOT created successfully. You either don\'t have permission or the file already exists.\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n}\r\n\r\n// *********************************************** Upload a file ***********************************************\r\nelse if (isset($_GET[\'file_upload\']))\r\n{\r\n\r\n$max_up = ini_get(\'max_file_uploads\');\r\n$max_size = ini_get(\'upload_max_filesize\');\r\n\r\n$output .= <<< OUTPUT\r\n\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" action=\"index.php?toolkit_file_manager&file_upload&path={$path}\" onsubmit=\"return validateForm()\" method=\"post\" enctype=\"multipart/form-data\">\r\n<h3>Upload File(s)</h3>\r\n<label>File name:</label><input class=\"span12\" type=\"file\" name=\"file[]\" id=\"file\" multiple=\"multiple\" />\r\n<label>Multi-file drag and drop supported (max uploads: {$max_up}, max filesize: {$max_size})</label>\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" name=\"submit\" title=\"Click once to upload file\">Upload</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n\r\nOUTPUT;\r\n}\r\n// *********************************************** Archive Extract ***********************************************\r\nelse if (isset($_GET[\'zip_extract\']))\r\n{\r\n\r\n$zip = $_GET[\'path\'] . DIR_SEP . $_GET[\'zip_extract\'];\r\n\r\n$output .= <<< OUTPUT\r\n\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n<h3>Extract Archive</h3>\r\n<label>Archive name:</label><input class=\"span12\" type=\"text\" name=\"archive_name\" id=\"archive_name\" value=\"{$zip}\" />\r\n<p class=\"help-block\">The files and folder will be extracted to the current folder.</p>\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to extract the archive\">Extract</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n\r\nOUTPUT;\r\n}\r\n\r\nfunction getPerms($file)\r\n{\r\nif (!file_exists($file)) return \"-\";\r\n\r\n$perms = fileperms($file);\r\n\r\nif (($perms & 0xC000) == 0xC000) {\r\n    // Socket\r\n    $info = \'s\';\r\n} else if (($perms & 0xA000) == 0xA000) {\r\n    // Symbolic Link\r\n    $info = \'l\';\r\n} else if (($perms & 0x8000) == 0x8000) {\r\n    // Regular\r\n    $info = \'-\';\r\n} else if (($perms & 0x6000) == 0x6000) {\r\n    // Block special\r\n    $info = \'b\';\r\n} else if (($perms & 0x4000) == 0x4000) {\r\n    // Directory\r\n    $info = \'d\';\r\n} else if (($perms & 0x2000) == 0x2000) {\r\n    // Character special\r\n    $info = \'c\';\r\n} else if (($perms & 0x1000) == 0x1000) {\r\n    // FIFO pipe\r\n    $info = \'p\';\r\n} else {\r\n    // Unknown\r\n    $info = \'u\';\r\n}\r\n\r\n// Owner\r\n$info .= (($perms & 0x0100) ? \'r\' : \'-\');\r\n$info .= (($perms & 0x0080) ? \'w\' : \'-\');\r\n$info .= (($perms & 0x0040) ?\r\n            (($perms & 0x0800) ? \'s\' : \'x\' ) :\r\n            (($perms & 0x0800) ? \'S\' : \'-\'));\r\n\r\n// Group\r\n$info .= (($perms & 0x0020) ? \'r\' : \'-\');\r\n$info .= (($perms & 0x0010) ? \'w\' : \'-\');\r\n$info .= (($perms & 0x0008) ?\r\n            (($perms & 0x0400) ? \'s\' : \'x\' ) :\r\n            (($perms & 0x0400) ? \'S\' : \'-\'));\r\n\r\n// World\r\n$info .= (($perms & 0x0004) ? \'r\' : \'-\');\r\n$info .= (($perms & 0x0002) ? \'w\' : \'-\');\r\n$info .= (($perms & 0x0001) ?\r\n            (($perms & 0x0200) ? \'t\' : \'x\' ) :\r\n            (($perms & 0x0200) ? \'T\' : \'-\'));\r\nreturn $info.\' \'.substr(sprintf(\'%o\', fileperms($file)), -4);\r\n}\r\n\r\n// *********************************************** Default List Contents ***********************************************\r\n// Get a list of all the backup files\r\n\r\n$files = glob($path.DIR_SEP.\"*\", GLOB_MARK);\r\n\r\nif (!is_dir($path))\r\n{\r\n$output .= \"Directory does not exist\";\r\nreturn;\r\n}\r\n\r\n// Output the current folder\r\n$output .= \'<b>Current Directory:</b> \';\r\n$growing_path=\'\';\r\nforeach(explode(DIR_SEP,$path) as $folder)\r\n{\r\n	if (!IS_WIN_OS && $growing_path==\'\') $output .= \'<a href=\"index.php?toolkit_file_manager&path=\'.DIR_SEP.\'\">root</a>\'.DIR_SEP;\r\n	else $output .= \'<a href=\"index.php?toolkit_file_manager&path=\'.$growing_path.$folder.\'\">\'.$folder.\'</a>\'.DIR_SEP;\r\n	$growing_path.=$folder.DIR_SEP;\r\n}\r\n\r\n$output .= \'<br /><br />\';\r\n\r\n$icons = a(img(\'Create Folder\',\'/img/silk/folder_add.png\'),\'toolkit_file_manager&folder_create&path=\'.$path).\" \";\r\n$icons .= a(img(\'Create File\',\'/img/silk/page_white_add.png\'),\'toolkit_file_manager&file_create&path=\'.$path).\" \";\r\n$icons .= a(img(\'Upload File\',\'/img/silk/page_white_get.png\'),\'toolkit_file_manager&file_upload&path=\'.$path).\" \";\r\n$icons .= a(img(\'Compress Folder\',\'/img/silk/compress.png\'),\'toolkit_file_manager&folder_compress&path=\'.$path).\" \";\r\n$icons .= a(img(\'Empty Folder\',\'/img/silk/bin_empty.png\'),\'toolkit_file_manager&folder_delete_contents&path=\'.$path).\" \";\r\n//$icons .= a(img(\'Rename Folder\',\'/img/silk/folder_wrench.png\'),\'toolkit_file_manager\').\" \";\r\n$output .= $icons;\r\n\r\n$output .= \'<br /><br />\';\r\n\r\n// Get the name of the parent folder\r\n$parent = substr($path,0,strrpos($path,DIR_SEP));\r\n//$output .= \'<a href=\"index.php?toolkit_file_manager&path=\'.$parent.\'\">Parent Dir</a><br /><br />\';\r\n\r\n// Create the arrays with HTML output\r\n$dir=array();\r\n$file=array();\r\n\r\n// Loop through each of the files and folders in the current path\r\nforeach($files as $f)\r\n{\r\n	// Grab the last character to see if it is a directory\r\n	$last = $f[strlen($f)-1];\r\n\r\n	// If the last character is a \\, then it is a directory\r\n	if ($last==DIR_SEP)\r\n	{\r\n		// Get the dir name without the full path\r\n		if (!IS_WIN_OS && $path==DIR_SEP) $d = substr($f,strlen($path));\r\n		else $d = substr($f,strlen($path)+1);\r\n		$full_name = substr($f,0,strlen($f)-1); // No trailing slash\r\n		$short_name = substr($d,0,strlen($d)-1); // No trailing slash\r\n\r\n		$icons = a(img(\'Delete\',\'/img/silk/folder_delete.png\'),\'toolkit_file_manager&folder_delete=\'.$short_name.\'&path=\'.$path).\" \";\r\n		$icons .= a(img(\'Rename or Move\',\'/img/silk/folder_wrench.png\'),\'toolkit_file_manager&folder_rename=\'.$short_name.\'&path=\'.$path).\" \";\r\n\r\n		//$try = exec(\"du -sh $full_name | cut -f1\");\r\n\r\n		if (!IS_WIN_OS) $folder_info = \" \".getPerms($full_name);\r\n		else $folder_info = \"\";\r\n\r\n		array_push($dir,$icons.\'<a href=\"index.php?toolkit_file_manager&path=\'.$full_name.\'\">\'.$short_name.\'</a> \'.$folder_info.\'<br />\');\r\n	}\r\n	// Else is a file\r\n	else\r\n	{ \r\n		if (!IS_WIN_OS && $path==DIR_SEP) $filename_no_path = substr($f,strlen($path));\r\n		else $filename_no_path = substr($f,strlen($path)+1);\r\n\r\n		$icons = a(img(\'Delete\',\'/img/silk/page_white_delete.png\'),\'toolkit_file_manager&file_delete=\'.$filename_no_path.\'&path=\'.$path).\" \";\r\n		$icons .= a(img(\'Rename\',\'/img/silk/page_white_wrench.png\'),\'toolkit_file_manager&file_rename=\'.$filename_no_path.\'&path=\'.$path).\" \";\r\n		$icons .= a(img(\'View\',\'/img/silk/page_white_magnify.png\'),\'toolkit_file_manager&file_view=\'.$filename_no_path.\'&path=\'.$path).\" \";\r\n		$icons .= a(img(\'Edit\',\'/img/silk/page_white_edit.png\'),\'toolkit_file_manager&file_edit=\'.$filename_no_path.\'&path=\'.$path).\" \";\r\n		$icons .= a(img(\'Download\',\'/img/silk/page_white_put.png\'),\'toolkit_file_manager&file_download=\'.$filename_no_path.\'&path=\'.$path).\" \";\r\n		if (strlen($f)>4 && strtolower(substr($f,strlen($f)-4))==\'.zip\') $icons .= a(img(\'Extract\',\'/img/silk/page_white_compressed.png\'),\'toolkit_file_manager&zip_extract=\'.$filename_no_path.\'&path=\'.$path).\" \";\r\n\r\n		//$icons .= a(img(\'Rename\',\'/img/silk/folder_wrench.png\'),\'toolkit_file_manager&folder_rename&path=\'.$path).\" \";\r\n\r\n		if (!IS_WIN_OS) $file_size = \" (\".round(filesize($f)/1024,2).\" KB) \".getPerms($f);\r\n		else $file_size = \" (\".round(filesize($f)/1024,2).\" KB)\";\r\n\r\n		array_push($file,$icons.$filename_no_path.$file_size.br());\r\n	}\r\n}\r\n\r\n// Sort in natural, non case-sensitive order\r\nnatcasesort($dir);\r\nnatcasesort($file);\r\n\r\n$output .= \'<b>Folders (\'.count($dir).\'):</b>\';\r\nif (count($dir)>10) $output .= \'<div class=\"two_col\">\';\r\nelse $output .= br();\r\nforeach($dir as $d) $output .= $d;\r\nif (empty($dir)) $output .= \"None<br />\";\r\nif (count($dir)>10) $output .= \'</div>\';\r\n\r\n$output .= \'<br /><b>Files (\'.count($file).\'):</b>\';\r\nif (count($file)>10) $output .= \'<div class=\"two_col\">\';\r\nelse $output .= br();\r\nforeach($file as $f) $output .= $f;\r\nif (empty($file)) $output .= \"None<br />\";\r\nif (count($file)>10) $output .= \'</div>\';\r\n\r\n$img_count = 0;\r\n$img_output = \'\';\r\n\r\nforeach($files as $f)\r\n{\r\n	$rel = str_replace(array(CMS_ROOT,\'\\\\\'),array(\'\',\'/\'),$f);\r\n	if (stripos($f,\".png\")!==false ||\r\n	stripos($f,\".gif\")!==false ||\r\n	stripos($f,\".jpg\")!==false ||\r\n	stripos($f,\".jpeg\")!==false ||\r\n	stripos($f,\".ico\")!==false ||\r\n	stripos($f,\".bmp\")!==false)\r\n	{\r\n		$img_output .= img_special($rel,\'index.php?toolkit_file_manager&show_image=\'.$f,true,\'2px 2px 2px 2px\', \"$(\'#img_path\').html(\'img(\\\'Image Text\\\',\\\'$rel\\\')\');\").\' \';\r\n		$img_count+=1;\r\n	}\r\n}\r\nif ($img_count>0)\r\n{\r\n	$output .= \'<br /><b>Preview: </b><div id=\"img_path\" name=\"img_path\" style=\"display: inline;\"></div><br />\';\r\n	$output .= $img_output;\r\n	$output .= br().br().\'<b>Items Total:</b> \'.(count($dir) + count($file));\r\n}\r\n\r\n// Refresh the page every 10 seconds\r\n//echo \'<meta http-equiv=\"Refresh\" content=\"10;url=\'.$_SERVER[\'REQUEST_URI\'].\'\">\';','2012-07-09 21:09:25',2,1,'// Create a folder\r\nif (isset($_GET[\'folder_create\']))\r\n{\r\n	// If all the variables are present\r\n	if (isset($_POST[\'folder\']) && isset($_GET[\'path\']))\r\n	{\r\n		// Form the folder name\r\n		$folder = $_GET[\'path\'].DIR_SEP.$_POST[\'folder\'];\r\n		// Make the folder - suppress errors\r\n		$result = @mkdir($folder);\r\n\r\n		// Inform user of result\r\n		if ($result) msg_user(\"Folder Creation\",$folder.\" was created successfully!\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n		else msg_user(\"Folder Creation\",$folder.\" was NOT created successfully. You either don\'t have permission or the folder already exists.\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n\r\n	}else msg_user(\"Folder Creation\",\"Something was missing...\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n}\r\n\r\n// Create a file\r\nelse if (isset($_GET[\'file_create\']))\r\n{\r\n	// If all the variables are present\r\n	if (isset($_POST[\'file\']) && isset($_GET[\'path\']))\r\n	{\r\n		// Form the file name\r\n		$file = $_GET[\'path\'].DIR_SEP.$_POST[\'file\'];\r\n		// Make the file - suppress errors\r\n		$result = @file_put_contents($file,\'\',FILE_APPEND);\r\n\r\n		// Inform user of result\r\n		if ($result!==false) msg_user(\"File Creation\",$file.\" was created successfully!\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n		else msg_user(\"File Creation\",$file.\" was NOT created successfully. You either don\'t have permission.\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n\r\n	}else msg_user(\"File Creation\",\"Something was missing...\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n}\r\n\r\n// Rename a folder\r\nelse if (isset($_GET[\'folder_rename\']))\r\n{\r\n	// If all the variables are present\r\n	if (isset($_POST[\'folder_old\']) && isset($_POST[\'folder_new\']) && isset($_GET[\'path\']))\r\n	{\r\n		// Form the folder name\r\n		//$folder_old = $_GET[\'path\'].DIR_SEP.$_POST[\'folder_old\'];\r\n		//$folder_new = $_GET[\'path\'].DIR_SEP.$_POST[\'folder_new\'];\r\n		$folder_old = $_POST[\'folder_old\'];\r\n		$folder_new = $_POST[\'folder_new\'];\r\n		// Make the folder - suppress errors\r\n		$result = @rename($folder_old, $folder_new);\r\n\r\n		// Inform user of result\r\n		if ($result) msg_user(\"Folder Rename\",$folder_old.\" was renamed successfully to \".$folder_new.\"!\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n		else msg_user(\"Folder Rename\",$folder_old.\" was NOT renamed successfully \".$folder_new.\". You either don\'t have permission or the folder already exists.\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n\r\n	}else msg_user(\"Folder Rename\",\"Something was missing...\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n}\r\n\r\n// Rename a file\r\nelse if (isset($_GET[\'file_rename\']))\r\n{\r\n	// If all the variables are present\r\n	if (isset($_POST[\'file_old\']) && isset($_POST[\'file_new\']) && isset($_GET[\'path\']))\r\n	{\r\n		// Form the file name\r\n		//$file_old = $_GET[\'path\'].DIR_SEP.$_POST[\'file_old\'];\r\n		//$file_new = $_GET[\'path\'].DIR_SEP.$_POST[\'file_new\'];\r\n		$file_old = $_POST[\'file_old\'];\r\n		$file_new = $_POST[\'file_new\'];\r\n		// Make the file - suppress errors\r\n		$result = @rename($file_old, $file_new);\r\n\r\n		// Inform user of result\r\n		if ($result) msg_user(\"File Rename\",$file_old.\" was renamed successfully to \".$file_new.\"!\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n		else msg_user(\"File Rename\",$file_old.\" was NOT renamed successfully \".$file_new.\". You either don\'t have permission or the file already exists.\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n\r\n	}else msg_user(\"File Rename\",\"Something was missing...\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n}\r\n\r\n// Delete a folder\r\nelse if (isset($_GET[\'folder_delete\']))\r\n{\r\n\r\nfunction rrmdir($dir) {\r\n    foreach(glob($dir . \'/*\') as $file) {\r\n        if(is_dir($file))\r\n            rrmdir($file);\r\n        else\r\n            unlink($file);\r\n    }\r\n    rmdir($dir);\r\n}\r\n\r\n	// If all the variables are present\r\n	if (isset($_POST[\'folder\']) && isset($_GET[\'path\']))\r\n	{\r\n		// Form the folder name\r\n		$folder = $_GET[\'path\'].DIR_SEP.$_POST[\'folder\'];\r\n		// Delete the folder - suppress errors\r\n		//$result = @rmdir($folder);\r\n		rrmdir($folder);\r\n\r\n		// Inform user of result\r\n		if (!is_dir($folder)) msg_user(\"Folder Deletion\",$folder.\" was deleted successfully!\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n		else msg_user(\"Folder Deletion\",$folder.\" was NOT deleted successfully. You either don\'t have permission or the folder doesn\'t exist.\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n\r\n	}else msg_user(\"Folder Deletion\",\"Something was missing...\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n}\r\n\r\n// Delete all files in a folder\r\nelse if (isset($_GET[\'folder_delete_contents\']))\r\n{\r\n\r\nfunction rrmdir($dir, $parent) {\r\n    foreach(glob($dir . \'/*\') as $file) {\r\n        if(is_dir($file))\r\n            rrmdir($file, false);\r\n        else\r\n            unlink($file);\r\n    }\r\nif (!$parent) rmdir($dir);\r\n}\r\n\r\n	// If all the variables are present\r\n	if (isset($_GET[\'path\']))\r\n	{\r\n		// Form the folder name\r\n		$folder = $_GET[\'path\'];\r\n		// Delete the folder contents\r\n		rrmdir($folder, true);\r\n\r\n		$arr = glob($_GET[\'path\'] . \'/*\');\r\n\r\n		// Inform user of result\r\n		if (empty($arr)) msg_user(\"Folder Emptying\",$folder.\" was emptied successfully!\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n		else msg_user(\"Folder Emptying\",$folder.\" was NOT emptied successfully. You either don\'t have permission or the folder doesn\'t exist.\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n\r\n	}else msg_user(\"Folder Deletion\",\"Something was missing...\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n}\r\n\r\nelse if (isset($_GET[\'file_delete\']))\r\n{\r\n	// If all the variables are present\r\n	if (isset($_POST[\'file\']) && isset($_GET[\'path\']))\r\n	{\r\n		// Form the file name\r\n		$file = $_GET[\'path\'].DIR_SEP.$_POST[\'file\'];\r\n		// Delete the file - suppress errors\r\n		$result = @unlink($file);\r\n\r\n		// Inform user of result\r\n		if ($result) msg_user(\"File Deletion\",$file.\" was deleted successfully!\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n		else msg_user(\"File Deletion\",$file.\" was NOT deleted successfully. You either don\'t have permission or the file doesn\'t exist.\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n\r\n	}else msg_user(\"File Deletion\",\"Something was missing...\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n}\r\n\r\nelse if (isset($_GET[\'file_upload\']))\r\n{\r\n\r\n$log = \'\';\r\n	// If all the variables are present\r\n	if (count($_FILES)>0 && isset($_GET[\'path\']))\r\n	{\r\n		for($i=0;$i<count($_FILES[\"file\"][\"name\"]);$i++)\r\n		{\r\n			$file = $_GET[\'path\'].DIR_SEP. $_FILES[\"file\"][\"name\"][$i];\r\n			//if (file_exists($file))\r\n			//{\r\n				//msg_user(\"File Upload\",$_FILES[\"file\"][\"name\"][$i].\" was NOT uploaded successfully. The file already exists.\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n				//$log .= $_FILES[\"file\"][\"name\"][$i].\" already exists.<br />\";\r\n			//}\r\n			//else\r\n			//{\r\n				$result = move_uploaded_file($_FILES[\"file\"][\"tmp_name\"][$i],$file);\r\n				if ($result) $log .= $_FILES[\"file\"][\"name\"][$i].\" uploaded successfully!<br />\";\r\n				else $log .= $_FILES[\"file\"][\"name\"][$i].\" upload failed, check permissions.<br />\";\r\n				//msg_user(\"File Upload\",$file.\" was uploaded successfully!\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n			//}\r\n		}\r\n\r\nmsg_user(\"File Upload\",$log,\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n\r\n	}else msg_user(\"File Upload\",\"Something was missing...\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n}\r\n\r\n// Edit file\r\nelse if (isset($_GET[\'file_edit\']))\r\n{\r\n	// If all the variables are present\r\n	if (isset($_POST[\'file\']) && isset($_POST[\'file_contents\']) && isset($_POST[\'path\']))\r\n	{\r\n		// Form the file name\r\n		$file = $_POST[\'path\'].DIR_SEP.$_POST[\'file\'];\r\n		// Update the file - suppress errors\r\n		$result = @file_put_contents($file,$_POST[\'file_contents\']);\r\n\r\n		// Inform user of result\r\n		if ($result!==false) msg_user(\"File Update\",$file.\" was updated successfully!\",\'index.php?toolkit_file_manager&path=\'.$_POST[\'path\']);\r\n		else msg_user(\"File Update\",$file.\" was NOT updated successfully. You either don\'t have permission.\",\'index.php?toolkit_file_manager&path=\'.$_POST[\'path\']);\r\n\r\n	}else msg_user(\"File Update\",\"Something was missing...\",\'index.php?toolkit_file_manager&path=\'.$_POST[\'path\']);\r\n\r\n}\r\n\r\n// Edit file\r\nelse if (isset($_GET[\'zip_extract\']))\r\n{\r\n	// If all the variables are present\r\n	if (isset($_POST[\'archive_name\']) && isset($_GET[\'path\']))\r\n	{\r\n		// Form the file name\r\n		//$file = $_GET[\'path\'].DIR_SEP.$_POST[\'file\'];\r\n\r\n		$archive_name = $_POST[\'archive_name\'];\r\n		$archive_dir = dirname($archive_name);\r\n		\r\n		$zip = new ZipArchive();\r\n		//$zip->open($archive_name);\r\n		\r\n		if ($zip->open($archive_name) === TRUE)\r\n		{\r\n			// For each file in the array\r\n			for ($i=0; $i < $zip->numFiles; $i++)\r\n			{\r\n				$arr = $zip->statIndex($i);\r\n			\r\n				$last_char = $arr[\'name\'][strlen($arr[\'name\'])-1];\r\n			\r\n				if ($last_char==\'/\' || $last_char==\'\\\\\')\r\n				{\r\n					$dir = $archive_dir.DIR_SEP.$arr[\'name\'];\r\n					if (!is_dir($dir)) mkdir($dir);\r\n				}\r\n				else\r\n				{\r\n					$file = $archive_dir.DIR_SEP;\r\n					$zip->extractTo($file,$arr[\'name\']);\r\n				}\r\n			}\r\n			// Inform user of result\r\n			msg_user(\"Archive Extraction\",\"Extract was successful!\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n		} else msg_user(\"Archive Extraction\",\"Extract was NOT successful. You either don\'t have permission.\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n\r\n	}else msg_user(\"Archive Extraction\",\"Something was missing...\",\'index.php?toolkit_file_manager&path=\'.$_GET[\'path\']);\r\n}\r\n\r\nelse echo \"Not implemented yet\";','File Organizer','',''),(210,'access_change_email','$output .= <<< OUTPUT\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n<label>Old Email:</label><input class=\"span12\" type=\"text\" id=\"email_old\" name=\"email_old\" value=\"{$_SESSION[\'email\']}\" />\r\n<label>New Email:</label><input class=\"span12\" type=\"text\" id=\"email_new\" name=\"email_new\" value=\"\" placeholder=\"case insensitive\" />\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to change email\">Change</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n\r\n<script>document.getElementById(\"email_new\").focus();</script>\r\nOUTPUT;\r\n// Need this for the heredoc','2012-06-17 05:13:52',2,1,'// Check for required Post values\r\nif (!isset($_POST[\'email_old\']) || !isset($_POST[\'email_new\'])) die(\'Invalid Post!\');\r\n\r\n// Query to update password\r\n$qry = \"UPDATE access_user SET email=? WHERE email=? AND id=? LIMIT 1\";\r\n\r\n// Fill the array with the values\r\n$params = array(trim($_POST[\'email_new\']),trim($_POST[\'email_old\']),$_SESSION[\'id\']);\r\n\r\n// Execute the query and return a success or failure\r\n$success = query_execute($qry, $params);\r\n\r\n// Output to the user\r\nif ($success) msg_user(\'Email Change\',\'Email changed successfully\');\r\nelse msg_user(\'Email Change\',\'Email changed failed - invalid email\');','Change Email','',''),(211,'access_change_username','$output .= <<< OUTPUT\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n\r\n<label>Old Username:</label><input class=\"span12\" type=\"text\" id=\"username_old\" name=\"username_old\" value=\"{$_SESSION[\'username\']}\" />\r\n<label>New Username:</label><input class=\"span12\" type=\"text\" id=\"username_new\" name=\"username_new\" value=\"\" placeholder=\"case insensitive\" />\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to change username\">Change</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n\r\n<script>document.getElementById(\"username_new\").focus();</script>\r\nOUTPUT;\r\n\r\n//Need this for the heredoc','2012-06-17 05:14:59',2,1,'// Check for required Post values\r\nif (!isset($_POST[\'username_old\']) || !isset($_POST[\'username_new\'])) die(\'Invalid Post!\');\r\n\r\n// Query to update password\r\n$qry = \"UPDATE access_user SET username=? WHERE username=? AND id=? LIMIT 1\";\r\n\r\n// Fill the array with the values\r\n$params = array(trim($_POST[\'username_new\']),trim($_POST[\'username_old\']),$_SESSION[\'id\']);\r\n\r\n// Execute the query and return a success or failure\r\n$success = query_execute($qry, $params);\r\n\r\n// Output to the user\r\nif ($success) msg_user(\'Username Change\',\'username changed successfully\');\r\nelse msg_user(\'Username Change\',\'username changed failed - invalid username\');','Change Username','',''),(214,'page_changelog','<h3><u>August 19th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Updated code using Memcache so the database is included in the key (supports multiple CMS on 1 server)</li>\r\n<li>Increased complexity with database names and user accounts to include random strings</li>\r\n<li>Updated Database Manager to show all databases and users with a delete option when setting, SETTING_DB_ADMIN, is enabled</li>\r\n<li>Released v0.4.3</li>\r\n</ol>\r\n<br />\r\n\r\n<h3><u>August 15th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Added a page called toolkit_create_site (undocumented) which can easily create new FusionLeaf websites on the current server</li>\r\n</ol>\r\n<br />\r\n\r\n<h3><u>August 13th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Added a setting (SETTING_DB_ADMIN) to force MySQL to use the admin database account for easier management of other databases</li>\r\n<li>Updated the database manager to support viewing the \'mysql\' database tables (WIP)</li>\r\n</ol>\r\n<br />\r\n\r\n<h3><u>August 10th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Updated the Planter\'s Guide with more information</li>\r\n<li>Renamed FusionLeaf Studio to FusionLeaf Stack for clarity</li>\r\n<li>Released v0.4.2</li>\r\n</ol>\r\n<br />\r\n\r\n<h3><u>August 8th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Updated page_public with all the utilized technology</li>\r\n<li>Updated the Help section of the toolkit_edit_method to include code highlighting</li>\r\n<li>Updated the cms_admin_sidebar to include CMS and Stack versions</li>\r\n</ol>\r\n<br />\r\n\r\n<h3><u>August 6th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Released the FusionLeaf CMS on Google Code</li>\r\n</ol>\r\n<br />\r\n\r\n<h3><u>August 2nd, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Fixed a bug with the Quick Save feature in the Code Editor that prevented the page name from changing more than once</li>\r\n<li>Updated the security groups so Anonymous and Authenticated provide two completely separate levels of access</li>\r\n<li>Added a Help menu item with a link to the WIP Planter\'s Guide</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>July 20th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Formatted the \"Debugging with PHP Variables\" so it displays better</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>July 18th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Added an upgrade banner to the HTML head for Internet Explorer 6 and lower</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>July 17th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Fixed the Recache icon on the Basic Toolkit page</li>\r\n<li>Updated the HTML head to exclude old items</li>\r\n<li>Updated the code editor to work with the highlighting correctly</li>\r\n<li>Updated the setup.php file</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>July 16th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Fixed a logic bug in the Pager with users that were not a member of the Administrators group</li>\r\n<li>Added a quicklink to the File Organizer from the Smart File Editor</li>\r\n<li>Added a few quick commands to the Command Shell</li>\r\n<li>Fixed an issue with GET parameters in the Code Editor</li>\r\n<li>Updated the Code Editor to better support dynamic pages</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>July 9th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Updated the screenshots (finally!)</li>\r\n<li>Created a Basic Toolkit page for new Administrators</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>July 8th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Removed a bunch of unused settings and made it easier to change the Site and System settings</li>\r\n<li>Added a section to the Planter\'s Guide</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>July 5th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Started writing the Planter\'s Guide (a walkthrough of all the features)</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>July 4th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Updated Bootswatch Theme manager to support previews</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>July 2nd, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Updated cache clear settings so AJAX updates properly with Memcached and XCache</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>July 1st, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Added support for Memcache PHP extension</li>\r\n<li>Added support for <a href=\"http://memcached.org\">Memcached 1.2.6</a> and <a href=\"http://www.couchbase.com\">Memcached Membase_1.7.1.1</a></li>\r\n<li>Added support for APC (Alternative PHP Cache), but disabled but default</li>\r\n<li>Added support for <a href=\"http://xcache.lighttpd.net\">XCache</a></li>\r\n<li>Released FusionLeaf Studio v1.0.3 on <a href=\"http://code.google.com/p/fusionleaf\">Google Code</a> with Memcached</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>June 29th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Add support for PDO (requires PHP to use mysqlnd)</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>June 26th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Added a right click context menu to the dynamic HTML builder for Add/Edit/Delete</li>\r\n<li>Fixed all anchors so the page does not move or scroll when modifying elements in the dynamic HTML builder</li>\r\n<li>Added background colors to all the elements on hover in the dynamic HTML builder</li>\r\n<li>Updated the error handler to support headers missing HTTP_USER_AGENT</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>June 25th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Added a delete button to the dynamic HTML builder</li>\r\n<li>Fixed PRE formatting in the dynamic HTML builder</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>June 24th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Added more HTML tags to the dynamic HTML builder</li>\r\n<li>Optimized the way the dynamic HTML builder saves elements in the database</li>\r\n<li>Updated the dynamic HTML builder so those not in the Administrators group can see the page, but don\'t have access to \r\n	any of the advanced features</li>\r\n<li>Added debugging information to the dynamic HTML builder so SQL queries can be counted and optimized</li>\r\n<li>Added 2 callable methods that count the number of queries when using AJAX</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>June 23rd, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Added the most common HTML tags to the dynamic HTML builder</li>\r\n<li>Enhanced the drag/drop ordering in the dynamic HTML builder</li>\r\n<li>Fixed a bug with File_Array class so it doesn\'t save an unchanged file on each page</li>\r\n<li>Fixed a vulnerability which allows access to the site setup page through a Denial of Service attack</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>June 22nd, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Created a dynamic and scalable way to build HTML pages with modals and drag/drop</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>June 21st, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Added enhancements from <a href=\"https://github.com/lecar-red/bootstrapx-clickover\">BootstrapX Clickover</a></li>\r\n<li>Removed all the z-index</li>\r\n<li>Created a new function called smartDB() which allows quick database updating from any page</li>\r\n<li>Updated page titles to use smartDB</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>June 20th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>FusionLeaf Studio v1.0.2.0 released on <a href=\"http://code.google.com/p/fusionleaf\">Google Code</a>!</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>June 18th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Improved error handling to prevent page redirects and show error messages</li>\r\n<li>Fixed a bug with the Search page showing the incorrect number of entries on a page</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>June 17th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Removed the antiquated Admin settings menu and added them to the Settings Manager</li>\r\n<li>Reduced the number of queries per page load by 75% from 40 queries to 10 queries</li>\r\n<li>Removed all regex called during page loads</li>\r\n<li>Improved PHP support for inline and shorthand echo PHP code</li>\r\n<li>Improved the Page Not Found handling</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>June 16th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Converted entire website to CSS from <a href=\"http://twitter.github.com/bootstrap\">Bootstrap, from Twitter</a> (took a whole week)</li>\r\n<li>Added all the <a href=\"http://bootswatch.com\">Bootswatch themes</a> for Bootstrap</li>\r\n<li>Removed all the old CSS and obsolete Color Manager</li>\r\n<li>Updated the public homepage</li>\r\n<li>Removed the extra space at the beginning of indexinc.php which removed the download requirement for while(@ob_end_clean());</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>June 8th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Discovered the wonderful world of <a href=\"http://twitter.github.com/bootstrap\">Bootstrap, from Twitter</a></li>\r\n<li>Learned the ways of <a href=\"http://lesscss.org\">LESS</a></li>\r\n<li>Incorporated the likes of <a href=\"http://leafo.net/lessphp\">LessPHP</a></li>\r\n<li>Enhanced the code with <a href=\"http://code.google.com/p/google-code-prettify\">Google-Code-Prettify</a></li>\r\n<li>...Redesigned the interface</li>\r\n<li>Updated jQuery to used the class name \"active\" instead of \"current\" to work with Bootstrap</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>June 7th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Added custom default session.name for Setup file</li>\r\n<li>Updated FLS so it can run on Windows without hosts file modifications</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>June 6th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Added support for the <a href=\"http://www.phpcaptcha.org\">Securimage PHP Captcha</a></li>\r\n<li>Reverted to default session.save_path for better compatibility</li>\r\n<li>Reverted to default session.name for better compatibility</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>June 4th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Added the ability to save and load themes</li>\r\n<li>Added a Light and Dark theme</li>\r\n<li>Updated the CSS for the Session Manager</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>June 3rd, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Added a manager for site settings and layout</li>\r\n<li>Added support for sending Tweets via <a href=\"http://code.google.com/p/twitter-php\">Twitter-PHP</a></li>\r\n<li>Added <a href=\"http://www.komodomedia.com/blog/2008/12/social-media-mini-iconpack\">Social Network Icon Pack</a> by <a href=\"http://www.komodomedia.com\">Komodo Media, Rogie King</a></li>\r\n<li>Fixed a bug in the Code Editor so original text can be saved once the Quick Save button is pressed</li>\r\n<li>Fixed a few bugs in the Database Manager so indexes and primary keys can be changed without errors</li>\r\n<li>Fixed a bug in the Database Manager so column deletes in empty tables displays the correct message to the user</li>\r\n<li>Updated the Error Log to wrap text that is outside of the page</li>\r\n<li>Updated the Session Manager to wrap text and display current user session at the top</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>June 1st, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Updated error catching so fatal errors are handled by shutdown function, all others by the error handler</li>\r\n<li>Fixed the high CPU usage problem with the FusionLeaf Studio application</li>\r\n<li>Added custom port support to the FusionLeaf Studio application</li>\r\n<li>Improved problem detection in the FusionLeaf Studio application</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 30th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Updated error catching...again</li>\r\n<li>Updated file manager to handle files that do not exist</li>\r\n<li>Added a simple command shell</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 29th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Fixed the PHP Syntax Check feature which broke with the updated error catching</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 28th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Updated the file manager to only show the Preview section if images are present</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 26th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Improved the error catching so it protects against endless redirects</li>\r\n<li>Added all the error codes so each error is described better</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 25th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Fixed a problem with the search showing mismatched results</li>\r\n<li>Improved the error reporting so it catches more</li>\r\n<li>Made significant changes to the FusionLeaf Studio application like simple load balancing and FastCGI respawn control</li>\r\n<li>Added a screenshots page for FusionLeaf Studio</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 24th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Improved the password encryption algorithm</li>\r\n<li>Improved the error reporting</li>\r\n<li>Updated the public home page as well as the dropdown menu</li>\r\n<li>Improved cleanup for deleted groups</li>\r\n<li>Updated the output for \"Page Not Found\" and \"Access Denied to Page\"</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 23rd, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Updated the menu system to use the new Menu Builder</li>\r\n<li>Improved the backups to include a zip with user specific files</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 22nd, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Restructured FusionLeaf Studio to support file paths with spaces</li>\r\n<li>Updated the backups to include a zip with user specific files along with a database backup</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 21st, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Updated the session manager to use relative offsets for the dropdown menus</li>\r\n<li>Updated the session manager to better support Windows PHP sessions</li>\r\n<li>Added an Nginx version check to the Toolkit</li>\r\n<li>Upgraded the FLS database to MySQL v5.5.24 from v5.5.22</li>\r\n<li>Upgraded the FLS framework to PHP v5.4.3 from v5.4.0</li>\r\n<li>Upgraded the FLS webserver to Nginx v1.2.0 from v1.0.14</li>\r\n<li>Updated the file manager to show two columns in supported browsers when displaying over 10 folders or files</li>\r\n<li>Updated the security manager so it is more intuitive</li>\r\n<li>Updated the Admin menu to support friendly labels</li>\r\n<li>Added Change Control (logging) for over 130 events</li>\r\n<li>Added Change Control (logging) for over 70 SQL write queries</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 18th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Reorganized the Toolkit</li>\r\n<li>Added version checks for PHP and MySQL to the Toolkit</li>\r\n<li>Changed the page of screenshots to a dynamic gallery</li>\r\n<li>Added a session manager</li>\r\n<li>Added the ability to add/remove line numbers</li>\r\n<li>Fixed the Quick Save behavior on a new page</li>\r\n<li>Changed a few of the main page icons</li>\r\n<li>Added code to protect against PHP session hijacking</li>\r\n<li>Add an image preview feature to the file manager</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 17th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Consolidated the access pages into a single security manager page</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 16th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Condensed the error information for simpler error catching</li>\r\n<li>Added support for catching syntax errors and display instructions to end users</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 15th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Completely redesigned the file structure to support unlimited websites</li>\r\n<li>Updated the Nginx configuration to allow for website creation on the fly</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 14th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Added a Quick Save option to the edit feature of the file manager</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 13th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Improved support for <a href=\"http://alan.blog-city.com/jquerylinedtextarea.htm\">JQuery Lined TextArea</a></li>\r\n<li>Updated the index pages title, keywords, and descriptions</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 11th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Added support for <a href=\"http://alan.blog-city.com/jquerylinedtextarea.htm\">JQuery Lined TextArea</a></li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 10th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Updated the SCRIPT_FILENAME, SCRIPT_NAME and PHP_SELF variables to reflect the correct path in FusionLeaf Studio for Windows</li>\r\n<li>Added support for <a href=\"http://phphtmledit.com\">Cute Editor for PHP</a></li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 9th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Added a Quick Save feature for the Code Editor using AJAX</li>\r\n<li>Updated the style sheet to better support background colors</li>\r\n<li>Updated the style sheet to supports themes</li>\r\n<li>Added 3 themes</li>\r\n<li>Isolated border radius, shadows, and opacity to variables to they can be easily turned on or off</li>\r\n<li>Stylesheet and javascript changes now apply instantly</li>\r\n<li>Updated the database manager to better support the timestamp data type</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 8th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Updated the error logging to support non-administrative users</li>\r\n<li>Updated the login page to track invalid attempts and block remote IP after 5 incorrect passwords</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 7th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Updated the Nginx configuration and CMS to support short URLs</li>\r\n<li>Updated page not found redirectors</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 6th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Updated the user, group, and access lists to support deletions of rogue database entries</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 5th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Updated Query Tester to accept \"data manipulation\" queries and be more flexible</li>\r\n<li>Added page titles, keywords, and descriptions to the code editor</li>\r\n<li>Reorganized the backbone of the CMS to support more dynamic content</li>\r\n<li>Worked with a SEO specialist to optimize for search engines</li>\r\n<li>Fixed Linux compatibility issue with the error log file</li>\r\n<li>Added a folder \"empty\" feature to the file manager</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 4th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Updated the order of evaluating the helper methods</li>\r\n<li>Updated all menu items to use the new menu function</li>\r\n<li>Added dropdown menus to the MySQL tables</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>May 3rd, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Added ability to view/add/delete/rename MySQL tables</li>\r\n<li>Added ability to add MySQL columns</li>\r\n<li>Added ability to add/edit/delete MySQL rows</li>\r\n<li>Updated backup algorithm to email both MySQL database restore information and index.php</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>April 29th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Updated the Toolkit images from backslashes to slashes</li>\r\n<li>Added rounded support for older versions of Firefox</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>April 28th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Updated dropdown menu to a clean theme</li>\r\n<li>Started building a MySQL front end</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>April 27th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Updated website to a clean theme</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>April 26th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Update site timezone to UTC instead of GMT</li>\r\n<li>Updated Toolkit main page to include direct links to Sitemap.xml and Robots.txt/li>\r\n<li>Added page which automatically updates sitemap.xml with URL, frequency, and last modified stamp</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>April 25th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Updated all the screenshots</li>\r\n<li>Updated opacity CSS to a PHP variable for easy enabling/disabling</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>April 23rd, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Updated HTML head information</li>\r\n<li>Added robots.txt and a sitemap.xml</li>\r\n<li>Rearranged the cached file structure for better organization</li>\r\n<li>Updated error pages</li>\r\n<li>Set all images relative to the root</li>\r\n<li>Updated all code to use $output instead of \"echo\" to ensure pages output only once</li>\r\n<li>Updated File Manager to focus the first textbox with javascript</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>April 22nd, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Added shadows for supported browsers</li>\r\n<li>Added a Search and Replace Page</li>\r\n<li>Updated forms to focus the first textbox with javascript</li>\r\n<li>FusionLeaf Stack (FLS) can now be built with a single click (includes everything from the live website)</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>April 19th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Updated the home page</li>\r\n<li>Updated the screenshots page</li>\r\n<li>Fixed IE 8/9 issue with dropdown menus and z-index</li>\r\n<li>Added a Twitter and Facebook button to the home page</li>\r\n<li>Updated Google Analytics so it is turned off in Dev or Localhost environment</li>\r\n<li>Updated File Manager for better Windows compatibility</li>\r\n<li>Increased recaching security</li>\r\n</ol>\r\n\r\n<br />\r\n\r\n<h3><u>April 18th, 2012</u></h3>\r\n<ol style=\"padding-left: 20px;\">\r\n<li>Added the new logo</li>\r\n<li>Changed all the corners to rounded</li>\r\n<li>Added Google Analytics</li>\r\n<li>Consolidated a few pages</li>\r\n<li>Added 7 new videos</li>\r\n</ol>','2012-08-20 03:38:56',2,0,'','Changelog','changelog','FusionLeaf is under constant improvement. Check out the changelog for updates!'),(225,'toolkit_replace','if (isset($_GET[\'search\'])) $search = urldecode($_GET[\'search\']);\r\nelse $search = \'\';\r\n\r\n$output .= <<< OUTPUT\r\n\r\n<div class=\"row-fluid\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n<label>Search:</label><input class=\"span4\" type=\"text\" id=\"search\" name=\"search\" value=\"{$search}\" placeholder=\"Search for...\" />\r\n<p>Replace:</p><input class=\"span4\" type=\"text\" id=\"replace\" name=\"replace\" value=\"\" placeholder=\"Replace with...\" />\r\n<p class=\"help-block\">Find every instance of the search string and replace it with another. Applies to Page names, text in Page/Post tabs, \r\nand text in index.php. Case-sensitive.</p>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to replace all instances\">Replace</button>\r\n</form>\r\n</div>\r\n\r\n<script>document.getElementById(\"replace\").focus();</script>\r\n\r\nOUTPUT;\r\n\r\n// Need this for the heredoc','2012-08-10 22:29:06',2,1,'$FIND = $_POST[\'search\'];\r\n$REPLACE = $_POST[\'replace\'];\r\n\r\nfunction replace_file($file)\r\n{\r\n	global $FIND, $REPLACE;\r\n	$file_org = file_get_contents($file);\r\n	$file_new = str_replace($FIND,$REPLACE,$file_org);\r\n	file_put_contents($file,$file_new);\r\n}\r\n\r\nreplace_file(\'index.php\');\r\nreplace_file(CMS_SCRIPT_DEFINE);\r\nreplace_file(CMS_SCRIPT_SETUP);\r\n\r\n$qry = \"UPDATE php_methods SET name = REPLACE(name,\'$FIND\',\'$REPLACE\')\"; simpleDB($qry,true,true);\r\n$qry = \"UPDATE php_methods SET method = REPLACE(method,\'$FIND\',\'$REPLACE\')\"; simpleDB($qry,true,true);\r\n$qry = \"UPDATE php_methods SET post = REPLACE(post,\'$FIND\',\'$REPLACE\')\"; simpleDB($qry,true,true);\r\n$qry = \"RENAME TABLE $FIND TO $REPLACE\"; simpleDB($qry,false,true);\r\n\r\nmsg_user(\"Search and Replace\",\"Done!\",\'index.php?recache\');','Replace','',''),(218,'div_footer','//$copy_name=smartDB(array(\'id\'=>18,\'current_value\'=>$constant[\'COPYRIGHT_NAME\']),\'current_value\',\'site_setting\');\r\n//$copy_date=smartDB(array(\'id\'=>19,\'current_value\'=>$constant[\'COPYRIGHT_DATE\']),\'current_value\',\'site_setting\');\r\n\r\n$copy_link = quickSiteSetting();\r\n\r\n$output .= <<< OUTPUT\r\n<div class=\"container-fluid\">\r\n	<hr>\r\n	<footer>\r\n		<p class=\"pull-left\">{$constant[\'BRANDING_NAME\']} {$copy_link}</p>\r\n		<div class=\"pull-right\">{$constant[\'COPYRIGHT_NAME\']} &#169; {$constant[\'COPYRIGHT_DATE\']} {$copy_link}</div>\r\n	</footer>\r\n</div>\r\n\r\n<script src=\"/inc/bootstrap/js/bootstrap.js\"></script>\r\n<script src=\"/inc/bootstrapx/bootstrapx-clickover.js\"></script>\r\n<script type=\"text/javascript\">\r\n	$(function() { \r\n		$(\'[rel=\"clickover\"]\').clickover(); \r\n		$(\'[rel=\"popover\"]\').popover(); \r\n	})\r\n</script>\r\nOUTPUT;\r\n\r\n// Need this for the heredoc','2012-07-27 03:26:27',2,1,'','','',''),(329,'toolkit_dynamic','//dynamicPage(\'dyn_\'.\'test\',\'/page_dynamic_demo\');\r\n//function dynamicPage($table_dynamic,$page_name)\r\n{\r\n//global $output;\r\n// Build a table if it does not exist\r\n//$table_dynamic = \'dyn_\'.\'test\';\r\n//$page_name = \'/toolkit_dynamic\';\r\n\r\nif (!isset($page_name)) $page_name = \'/toolkit_dynamic\';\r\nif (!isset($table_dynamic)) $table_dynamic = \'dyn_\'.\'test\';\r\n\r\n// Check to see if the table exists\r\n$qry = \'SELECT table_name FROM information_schema.tables WHERE table_schema=? AND table_name=?\';\r\n$result = query($qry, array(DB_DATABASE,$table_dynamic));\r\n\r\n// Build a table if a table does not exist\r\nif (!$result) $result = query_execute(\"CREATE TABLE $table_dynamic LIKE dyn_template\", array());\r\n// Exit if there is a table problem\r\n//if (!$result) { $output .= \'Table problem!\'; return; }\r\n\r\nif (isGroupMember(2) && count($_GET)==1)\r\n{ \r\n$output .= <<< OUTPUT\r\n\r\n<style>\r\n\r\ncomment { display: none; }\r\n\r\n#page_body h1:hover,\r\n#page_body h2:hover,\r\n#page_body h3:hover,\r\n#page_body h4:hover,\r\n#page_body h5:hover,\r\n#page_body h6:hover,\r\n#page_body p:hover,\r\n#page_body span:hover,\r\n#page_body li:hover,\r\n#page_body dd:hover,\r\n#page_body dt:hover,\r\n#page_body blockquote:hover,\r\n#page_body pre:hover { background-color: #F2DEDE; cursor:move; }\r\n\r\n#page_body small:hover,\r\n#page_body img:hover { background-color: #DFF0D8; cursor:move; }\r\n\r\n//.btn:hover, a:hover { background-color: inherit !important; cursor:move; }\r\n\r\n#page_body { padding-top: 15px; padding-bottom: 15px; border-top: 1px dashed black; border-bottom: 1px dashed black; }\r\n\r\n#page_body div:hover { background-color: #FCF8E3; cursor:move; }\r\n\r\n#page_body ul:hover,\r\n#page_body ol:hover,\r\n#page_body dl:hover { background-color: #D9EDF7; cursor:move; }\r\n\r\n#page_body div,\r\n#page_body ul,\r\n#page_body ol,\r\n#page_body dl { padding-top:15px; padding-bottom:15px; }\r\n\r\n#page_body div div:hover { background-color: #D9EDF7; cursor:move; }\r\n\r\n</style>\r\n\r\n<div class=\"btn-toolbar\">\r\n<!--<div class=\"btn-group\">\r\n<a class=\"btn\" href=\"javascript:void(0)\" onclick=\"$(\'#page_body div\').css(\'border\',\'1px dashed silver\');\">Border Add</a>\r\n<a class=\"btn\" href=\"javascript:void(0)\" onclick=\"$(\'#page_body div\').css(\'border\',\'0px solid silver\');\">Remove</a>\r\n</div>\r\n\r\n<div class=\"btn-group\">\r\n<a class=\"btn\" href=\"javascript:void(0)\" onclick=\"$(\'.dynamic-markup\').remove();$().removeAttr(\'data-parentid\');\">Remove all Markup</a>\r\n</div>-->\r\n\r\n<div class=\"btn-group\" data-toggle=\"buttons-radio\">\r\n<button name=\"btnShow\" id=\"btnShow\" class=\"btn active\" \r\n	onclick=\"$(\'.dynamic-markup\').css(\'display\',\'inline-block\');\">Show Markup</button>\r\n<button name=\"btnHide\" id=\"btnHide\" class=\"btn\" \r\n	onclick=\"$(\'.dynamic-markup\').css(\'display\',\'none\');\">Hide Markup</button>\r\n</div>\r\n\r\n<div class=\"btn-group\">\r\n<a class=\"btn\" href=\"{$page_name}?plain\">Preview as User</a>\r\n<a class=\"btn\" href=\"{$page_name}?code\">View HTML Markup</a>\r\n<a class=\"btn\" href=\"{$page_name}?modify\">Modify</a>\r\n</div>\r\n\r\n</div>\r\n\r\n<div class=\"alert alert-success\" style=\"position:fixed;right:20px;bottom:0px;z-index:1031;\">\r\n  <button class=\"close\" data-dismiss=\"alert\">Ã—</button>\r\n  <span>Currently over: </span><span name=\"overitem\" id=\"overitem\"></span>\r\n</div>\r\n\r\n<ul class=\"nav\" id=\"testdrop2\" style=\"display:inline-block; position: absolute;\">\r\n<li class=\"dropdown\" id=\"testdrop\">\r\n<a href=\"javascript:void(0)\" class=\"dropdown-toggle\" data-toggle=\"dropdown\" style=\"display: inline-block;\"></a>\r\n<ul class=\"dropdown-menu\" id=\"right_click_menu\" name=\"right_click_menu\">\r\n<li style=\"text-align: center;\"><a href=\"javascript:void(0)\"><b name=\"bold_name\" id=\"bold_name\">div</b></a></li>\r\n<li class=\"divider-vertical\" style=\"border-bottom:1px solid silver;\"></li>\r\n<li name=\"onlyfortext\" id=\"onlyfortext\"><a href=\"javascript:void(0)\" onclick=\"show_edit_text()\"><i class=\"icon-text-width\"></i> Edit text</a></li>\r\n<li><a href=\"javascript:void(0)\" onclick=\"show_add()\"><i class=\"icon-plus-sign\"></i> Add a child element</a></li>\r\n<li name=\"notforroot\" id=\"notforroot\"><a href=\"javascript:void(0)\" onclick=\"show_edit()\"><i class=\"icon-pencil\"></i> Edit current element</a></li>\r\n<li><a href=\"javascript:void(0)\" onclick=\"reducePosition()\"><i class=\"icon-arrow-left\"></i> Reorder Left/Up</a></li>\r\n<li><a href=\"javascript:void(0)\" onclick=\"advancePosition()\"><i class=\"icon-arrow-right\"></i> Reorder Right/Down</a></li>\r\n<li><a href=\"javascript:void(0)\" onclick=\"show_delete()\"><i class=\"icon-trash\"></i> Delete current element</a></li>\r\n\r\n<!-- The extra menu items will go here -->\r\n\r\n</ul></li></ul>\r\n\r\n<input type=\"hidden\" name=\"click_myid\" id=\"click_myid\" value=\"\" />\r\n<input type=\"hidden\" name=\"click_textid\" id=\"click_textid\" value=\"\" />\r\n<input type=\"hidden\" name=\"click_parentid\" id=\"click_parentid\" value=\"\" />\r\n<input type=\"hidden\" name=\"click_tagtype\" id=\"click_tagtype\" value=\"\" />\r\n\r\n<script>\r\nfunction reducePosition()\r\n{\r\n	var myid = $(\"#click_myid\").val();\r\n	$.post(\'{$page_name}\',{ operation:\"reduce_position\", myid:myid }, function(data) {\r\n		loadPage();\r\n	});\r\n}\r\nfunction advancePosition()\r\n{\r\n	var myid = $(\"#click_myid\").val();\r\n	$.post(\'{$page_name}\',{ operation:\"advance_position\", myid:myid }, function(data) {\r\n		loadPage();\r\n	});\r\n}\r\n\r\nfunction convertCode()\r\n{\r\n\r\n	var newcode = $(\"#new_code\").val();\r\n	$.post(\'{$page_name}\',{ operation:\"convert_code\", newcode:newcode }, function(data) {\r\n		alert(data);\r\n	});\r\n}\r\n\r\nfunction show_modal(par,elem)\r\n{\r\n	$.post(\'{$page_name}\',{ operation:\"build\", parent_id:par, parent_element:elem }, function(data) {\r\n		$(\"#dispose_mod\").empty();\r\n		$(\"#dispose_mod\").append(data);\r\n		$(\'#myModal\').modal(\'show\');\r\n	});\r\n}\r\nfunction show_add()\r\n{\r\n	var par = $(\"#click_myid\").val();\r\n	//var elem = $(\"#click_parentid\").val();\r\n	var elem = $(\"#click_tagtype\").val();\r\n	$.post(\'{$page_name}\',{ operation:\"build\", parent_id:par, parent_element:elem }, function(data) {\r\n		$(\"#dispose_mod\").empty();\r\n		$(\"#dispose_mod\").append(data);\r\n		$(\'#myModal\').modal(\'show\');\r\n	});\r\n}\r\nfunction show_edit()\r\n{\r\n	var scrollTop = $(document).scrollTop();\r\n	var scrollLeft = $(document).scrollLeft();\r\n	var par = $(\"#click_myid\").val();\r\n	var parid = $(\"#click_parentid\").val();\r\n	var elem = $(\"#click_tagtype\").val();\r\n\r\n	$.post(\'{$page_name}\',{ operation:\"build_edit\", parent_id:par, realparentid:parid, parent_element:elem }, function(data) {\r\n		$(\"#dispose_mod\").empty();\r\n		$(\"#dispose_mod\").append(data);\r\n		$(\'#myModal\').modal(\'show\');\r\n		$(document).scrollTop(scrollTop);\r\n		$(document).scrollLeft(scrollLeft);\r\n	});\r\n}\r\nfunction show_edit_text()\r\n{\r\n	var scrollTop = $(document).scrollTop();\r\n	var scrollLeft = $(document).scrollLeft();\r\n	var par = $(\"#click_myid\").val();\r\n	var parid = $(\"#click_parentid\").val();\r\n	var elem = $(\"#click_tagtype\").val();\r\n	var textid = $(\"#click_textid\").val();\r\n\r\n	$.post(\'{$page_name}\',{ operation:\"build_edit\", parent_id:par, realparentid:parid, parent_element:elem,textid:textid }, function(data) {\r\n		$(\"#dispose_mod\").empty();\r\n		$(\"#dispose_mod\").append(data);\r\n		$(\'#myModal\').modal(\'show\');\r\n		$(document).scrollTop(scrollTop);\r\n		$(document).scrollLeft(scrollLeft);\r\n	});\r\n}\r\nfunction show_delete()\r\n{\r\n	var myid = $(\"#click_myid\").val();\r\n	//var elem = $(\"#click_parentid\").val();\r\n	//var elem = $(\"#click_tagtype\").val();\r\n\r\n	$.post(\'{$page_name}\',{ operation:\"delete\", myid:myid\r\n		}, function(data) {\r\n		if (data==\'true\')\r\n		{\r\n			$(\'#delete_myid\').val(myid);\r\n			$(\'#myModalDelete\').modal(\'show\');\r\n		}\r\n		else\r\n		{\r\n			$.post(\'{$page_name}\',{ operation:\"delete_parent\", myid:myid}, function(data) {\r\n				loadPage();\r\n			});\r\n		}\r\n	});\r\n}\r\nfunction show_modal_edit(par,elem)\r\n{\r\n	$.post(\'{$page_name}\',{ operation:\"build_edit\", parent_id:par, parent_element:elem }, function(data) {\r\n		$(\"#dispose_mod\").empty();\r\n		$(\"#dispose_mod\").append(data);\r\n		$(\'#myModal\').modal(\'show\');\r\n	});\r\n}\r\nfunction show_modal_delete(par,elem)\r\n{\r\n	$.post(\'{$page_name}\',{ operation:\"delete\", parent_id:par, parent_element:elem }, function(data) {\r\n		$(\"#dispose_mod\").empty();\r\n		$(\"#dispose_mod\").append(data);\r\n		$(\'#myModal\').modal(\'show\');\r\n	});\r\n}\r\nfunction loadPage()\r\n{\r\n	var scrollTop = $(window).scrollTop();\r\n	var scrollLeft = $(window).scrollLeft();\r\n\r\n	$.post(\'{$page_name}\',{ operation:\"load\" }, function(data) {\r\n		$(\"#page_body\").empty();\r\n		$(\"#page_body\").append(data);\r\n	\r\n		// Keep track of the markup setting\r\n		if ($(\'#btnShow\').attr(\'class\')==\'btn active\') $(\'#btnShow\').click();\r\n		if ($(\'#btnHide\').attr(\'class\')==\'btn active\') $(\'#btnHide\').click();\r\n	\r\n		$( \".draggable\" ).draggable();\r\n		\r\n\r\n$(\"#page_body\").mousemove(function(e) {\r\nvar elem = document.elementFromPoint((e.pageX-window.pageXOffset), (e.pageY-window.pageYOffset));\r\n    $(\'#overitem\').html(elem.tagName + \' - \' + elem.getAttribute(\'class\'));\r\n});\r\n\r\n		$( \".draggable\" ).droppable({\r\n			greedy: true\r\n			,tolerance: \"pointer\"\r\n			,hoverClass: \"drophover\"\r\n			,over: function( event, ui ) {\r\n				$(\'.icon-arrow-left\').remove();\r\n				//$(this).prepend(\'<i class=\"icon-arrow-right\"></i>\');\r\n				$(this).prepend(\'<i class=\"icon-arrow-left\"></i>\');\r\n				$(this).css(\'cursor\',\'move\');\r\n				$(\'#overitem\').html(ui.draggable.attr(\"data-myid\"));\r\n			}\r\n			,out: function( event, ui ) {\r\n				$(\'.icon-arrow-left\').remove();\r\n				//$(\'.icon-arrow-right\').remove();\r\n			}\r\n			,activate: function( event, ui ) {\r\n				$(ui.draggable).css(\"z-index\",\"3000\");\r\n				$(ui.draggable).css(\"visibility\",\"hidden\");\r\n				//$(\'.icon-plus-sign\').css(\'display\',\'none\');\r\n			}\r\n			,deactivate: function( event, ui ) {\r\n				$(ui.draggable).css(\"z-index\",\"inherit\");\r\n				$(this).css(\'cursor\',\'auto\');\r\n				$(\'.icon-arrow-left\').remove();\r\n				//$(\'.icon-arrow-right\').remove();\r\n			}\r\n			,drop: function( event, ui ) {\r\n		\r\n			// Dragged object id\r\n			var myid = $(ui.draggable).attr(\"data-myid\");\r\n			// Dragged object parent id\r\n			var myparentid = $(ui.draggable).attr(\"data-parentid\");\r\n			// Dragged object position\r\n			var myposition = $(ui.draggable).attr(\"data-position\");\r\n		\r\n			// Dropped on object id\r\n			var droppedOnID = $(this).attr(\"data-myid\");\r\n			// Dropped on object parent id\r\n			var droppedOnParentID = $(this).attr(\"data-parentid\");\r\n			// Dropped on object position\r\n			var droppedOnPosition = $(this).attr(\"data-position\");\r\n\r\n			if (myparentid==droppedOnID) { loadPage(); } //alert(\'dropped on parent\');\r\n			// If the DroppedOn is the brother, re-position the elements\r\n			else if (myparentid==droppedOnParentID)\r\n			{\r\n				$.post(\'{$page_name}\',{ operation:\"testnest\", myid:myid, \r\n					myposition:myposition, droppedOnID:droppedOnID, droppedOnPosition:droppedOnPosition\r\n					}, function(data) {\r\n					if (data==\'true\')\r\n					{\r\n						$(\'#reorder_myid\').val(myid);\r\n						$(\'#reorder_myposition\').val(myposition);\r\n						$(\'#reorder_droppedOnID\').val(droppedOnID);\r\n						$(\'#reorder_droppedOnPosition\').val(droppedOnPosition);\r\n\r\n						$(\'#myModalOption\').modal(\'show\');\r\n						//loadPage();\r\n					}\r\n					else\r\n					{\r\n						$.post(\'{$page_name}\',{ operation:\"reorder\", myid:myid, \r\n							myposition:myposition, droppedOnID:droppedOnID,\r\n							droppedOnPosition:droppedOnPosition, droppedOnParentID:droppedOnParentID\r\n							}, function(data) {\r\n							loadPage();\r\n						});\r\n					}\r\n				});\r\n			}\r\n			// If the DroppedOn is a different parent, re-parent the element\r\n			else if (myparentid!=droppedOnParentID)\r\n			{\r\n				$.post(\'{$page_name}\',{ operation:\"testnest2\", myid:myid, \r\n					myposition:myposition, droppedOnID:droppedOnID,\r\n					droppedOnPosition:droppedOnPosition,droppedOnParentID:droppedOnParentID,\r\n					myparentid:myparentid\r\n					}, function(data) {\r\n						//alert(data);\r\n					if (data==\'true\')\r\n					{\r\n						$(\'#reorder_myid\').val(myid);\r\n						$(\'#reorder_myposition\').val(myposition);\r\n						$(\'#reorder_droppedOnID\').val(droppedOnID);\r\n						$(\'#reorder_droppedOnPosition\').val(droppedOnPosition);\r\n						$(\'#reorder_droppedOnParentID\').val(droppedOnParentID);\r\n\r\n						$(\'#myModalOption\').modal(\'show\');\r\n						//loadPage();\r\n					}\r\n					else\r\n					{\r\n\r\n						$.post(\'{$page_name}\',{ operation:\"parentswap\", myid:myid, \r\n							droppedOnID:droppedOnID, droppedOnParentID:droppedOnParentID, droppedOnPosition:droppedOnPosition\r\n							}, function(data) {\r\n							loadPage();\r\n						});\r\n					}\r\n				});\r\n\r\n			}\r\n			}\r\n		});\r\n\r\n		$.post(\'{$page_name}\',{ operation:\"stats\" }, function(data) {\r\n			$(\"#page_body\").append(data);\r\n		});\r\n\r\n		//$(document).scrollTop(window);\r\n		//$(document).scrollLeft(window);\r\n	});\r\n}\r\n\r\nfunction reorder()\r\n{\r\n	var myid = $(\'#reorder_myid\').val();\r\n	var myposition = $(\'#reorder_myposition\').val();\r\n	var droppedOnID = $(\'#reorder_droppedOnID\').val();\r\n	var droppedOnPosition = $(\'#reorder_droppedOnPosition\').val();\r\n	var droppedOnParentID = $(\'#reorder_droppedOnParentID\').val();\r\n\r\n	$.post(\'{$page_name}\',{ operation:\"reorder\", myid:myid, parentpos:\"true\",\r\n		myposition:myposition, droppedOnID:droppedOnID,\r\n		droppedOnPosition:droppedOnPosition,droppedOnParentID:droppedOnParentID\r\n		}, function(data) {\r\n		loadPage();\r\n	});\r\n}\r\nfunction nest()\r\n{\r\n	var myid = $(\'#reorder_myid\').val();\r\n	var myposition = $(\'#reorder_myposition\').val();\r\n	var droppedOnID = $(\'#reorder_droppedOnID\').val();\r\n	var droppedOnPosition = $(\'#reorder_droppedOnPosition\').val();\r\n	var droppedOnParentID = $(\'#reorder_droppedOnParentID\').val();\r\n\r\n	$.post(\'{$page_name}\',{ operation:\"parentswap\", myid:myid, \r\n		droppedOnID:droppedOnID,droppedOnParentID:droppedOnParentID,droppedOnPosition:droppedOnPosition\r\n		}, function(data) {\r\n		loadPage();\r\n	});\r\n}\r\nfunction delete_element(myid,mytag)\r\n{\r\n	$.post(\'{$page_name}\',{ operation:\"delete\", myid:myid\r\n		}, function(data) {\r\n		if (data==\'true\')\r\n		{\r\n			$(\'#delete_myid\').val(myid);\r\n			$(\'#myModalDelete\').modal(\'show\');\r\n		}\r\n		else\r\n		{\r\n			$.post(\'{$page_name}\',{ operation:\"delete_parent\", myid:myid}, function(data) {\r\n				loadPage();\r\n			});\r\n		}\r\n	});\r\n}\r\nfunction delete_element_children()\r\n{\r\n	var myid = $(\'#delete_myid\').val();\r\n	$.post(\'{$page_name}\',{ operation:\"delete_all\", myid:myid},function(data) {\r\n		loadPage();\r\n	});\r\n}\r\n\r\nfunction showBootstrapMenu(elem_class)\r\n{\r\n	// Grab all the variables for the parent element\r\n	var myid = $(\"#click_myid\").val();\r\n	var parentid = $(\"#click_parentid\").val();\r\n	var elementtype = $(\"#click_tagtype\").val();\r\n	if (elem_class==null) element_class = \'\';\r\n	else element_class = elem_class;\r\n\r\n	// Get the bootstrap possible classes and elements\r\n	$.post(\'{$page_name}\',{ operation:\"bootstrap_menu\", myid:myid, parentid:parentid, elementtype:elementtype,elemclass:element_class },function(data) {\r\n		//loadPage();\r\n		$(\'#right_click_menu\').append(data);\r\n	});\r\n}\r\nfunction auto_add(tag,a_class,myid,parentid,text_value)\r\n{\r\n	$.post(\"{$page_name}\", { operation:\"dbadd\",\'data-myid\':myid,\r\n	\'data-parentid\':parentid,\'tag\':tag,\'class\':a_class,\'text\':text_value },function(data) {\r\n		loadPage();\r\n	});\r\n}\r\nfunction auto_toggle(tag,a_class,myid,parentid)\r\n{\r\n	$.post(\"{$page_name}\", { operation:\"dbtoggle\",\'myid\':myid,\r\n	\'data-parentid\':parentid,\'tag\':tag,\'toggle_class\':a_class },function(data) {\r\n		loadPage();\r\n	});\r\n}\r\nfunction auto_radio(tag,a_class,myid,parentid)\r\n{\r\n	$.post(\"{$page_name}\", { operation:\"dbradio\",\'myid\':myid,\r\n	\'data-parentid\':parentid,\'tag\':tag,\'toggle_class\':a_class },function(data) {\r\n		loadPage();\r\n	});\r\n}\r\n\r\n$(document).ready(function() {\r\n	loadPage();\r\n\r\n	$(\'.container-fluid\').bind(\"contextmenu\", function(e) {\r\n		$(\'#testdrop\').removeClass(\'open\');\r\n		return true;\r\n	});\r\n	\r\n	// Disable right click for the whole page\r\n	$(\'#page_body\').bind(\"contextmenu\", function(e) {\r\n	\r\n		// Need to set the menu to 0 so it doesn\'t get picked up by the elementFromPoint\r\n		$(\'#testdrop\').removeClass(\'open\');\r\n		// Remove all the old items\r\n		$(\'.bootstrap_delete\').remove();\r\n		$(\'#onlyfortext\').css({\"display\": \"none\"});\r\n		$(\'#testdrop2\').css({\r\n		top: (0)+\'px\',\r\n		left: (0)+\'px\'\r\n		});\r\n\r\n		var elem = document.elementFromPoint((e.pageX-window.pageXOffset), (e.pageY-window.pageYOffset));\r\n		$(\"#click_myid\").val(\'\');\r\n		$(\"#click_parentid\").val(\'\');\r\n		$(\"#click_tagtype\").val(\'\');\r\n		$(\"#click_textid\").val(\'\');\r\n\r\n		$(\'#testdrop2\').css({\r\n		top: (e.pageY-62)+\'px\',\r\n		left: (e.pageX-5)+\'px\'\r\n		});\r\n\r\n		var shouldExist = elem.getAttribute(\'data-myid\');\r\n\r\n		if (elem!=null && shouldExist!=null)\r\n		{\r\n			// If a user clicks on a span tab for an empty element (like a DIV or UL),\r\n			// make sure the parent menu appears\r\n			var actual_parent_type = elem.getAttribute(\'data-element-type\');\r\n\r\n			if (actual_parent_type!=null)\r\n			{\r\n				$(\"#bold_name\").html(actual_parent_type.toUpperCase());\r\n				$(\"#click_tagtype\").val(actual_parent_type.toLowerCase());\r\n			}\r\n			else\r\n			{\r\n				$(\"#bold_name\").html(elem.tagName);\r\n				$(\"#click_tagtype\").val(elem.tagName.toLowerCase());\r\n			}\r\n\r\n			$(\"#click_myid\").val(elem.getAttribute(\'data-myid\'));\r\n			$(\"#click_parentid\").val(elem.getAttribute(\'data-parentid\'));\r\n\r\n			if (actual_parent_type==\'text\')\r\n			{\r\n				myid = elem.getAttribute(\'data-myid\');\r\n				//alert(\'text!\');\r\n				$(\"#click_textid\").val(myid);\r\n				$(\"#click_myid\").val(elem.getAttribute(\'data-parentid\'));\r\n				$(\'#onlyfortext\').css({\"display\": \"\"});\r\n\r\n				$.post(\"{$page_name}\", { operation:\"quick_parent\",\'myid\':myid },function(data) {\r\n					$(\"#bold_name\").html(data);\r\n					$(\"#click_tagtype\").val(data.toLowerCase());\r\n					$(\'#testdrop\').addClass(\'open\');\r\n				});\r\n			}\r\n			else\r\n			{\r\n				if (elem.getAttribute(\'data-myid\')==\'root\')\r\n				{\r\n					$(\'#notforroot\').css({\"display\": \"none\"});\r\n					$(\"#bold_name\").html(\'Root \' + elem.tagName);\r\n				}\r\n				else $(\'#notforroot\').css({\"display\": \"\"});\r\n				showBootstrapMenu(elem.getAttribute(\'class\'));\r\n				$(\'#testdrop\').addClass(\'open\');\r\n			}\r\n		\r\n			return false;\r\n		}else return false;\r\n	});\r\n});\r\n\r\n</script>\r\n\r\n<div name=\"page_body\" id=\"page_body\" data-myid=\"root\" data-parentid=\"root\" class=\"draggable\">\r\n</div>\r\n\r\n<div name=\"dispose_mod\" id=\"dispose_mod\"></div>\r\n\r\n<div class=\"modal hide\" id=\"myModalOption\">\r\n  <div class=\"modal-header\">\r\n    <button type=\"button\" class=\"close\" data-dismiss=\"modal\">Ã—</button>\r\n    <h3>Reorder or Nest?</h3>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <p>Would you like to reorder the dragged element or nest the dragged element?</p>\r\n  </div>\r\n  <div class=\"modal-footer\">\r\n\r\n<input type=\"hidden\" name=\"reorder_myid\" id=\"reorder_myid\" value=\"\" />\r\n<input type=\"hidden\" name=\"reorder_myposition\" id=\"reorder_myposition\" value=\"\" />\r\n<input type=\"hidden\" name=\"reorder_droppedOnID\" id=\"reorder_droppedOnID\" value=\"\" />\r\n<input type=\"hidden\" name=\"reorder_droppedOnPosition\" id=\"reorder_droppedOnPosition\" value=\"\" />\r\n<input type=\"hidden\" name=\"reorder_droppedOnParentID\" id=\"reorder_droppedOnParentID\" value=\"\" />\r\n\r\n    <a href=\"javascript:void(0)\" class=\"btn btn-primary\" data-dismiss=\"modal\" onclick=\"reorder()\">Reorder</a>\r\n    <a href=\"javascript:void(0)\" class=\"btn btn-primary\" data-dismiss=\"modal\" onclick=\"nest()\">Nest</a>\r\n    <a href=\"javascript:void(0)\" class=\"btn\" data-dismiss=\"modal\">Close</a>\r\n\r\n  </div>\r\n</div>\r\n\r\n\r\n\r\n\r\n<div class=\"modal hide\" id=\"myModalDelete\">\r\n  <div class=\"modal-header\">\r\n    <button type=\"button\" class=\"close\" data-dismiss=\"modal\">Ã—</button>\r\n    <h3>Delete Parent and Children?</h3>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <p>Would you like to delete the parent element and all children?</p>\r\n  </div>\r\n  <div class=\"modal-footer\">\r\n\r\n<input type=\"hidden\" name=\"delete_myid\" id=\"delete_myid\" value=\"\" />\r\n\r\n    <a href=\"javascript:void(0)\" class=\"btn btn-primary\" data-dismiss=\"modal\" onclick=\"delete_element_children()\">Delete Parent and Children</a>\r\n    <a href=\"javascript:void(0)\" class=\"btn\" data-dismiss=\"modal\">Close</a>\r\n\r\n  </div>\r\n</div>\r\n\r\nOUTPUT;\r\n\r\n}\r\nelse\r\n{\r\n	$back = \'\';\r\n	$code = \'\';\r\n	if (isGroupMember(2)) $back = \'<a style=\"float:right;\" href=\"\'.$page_name.\'\">Back to Dynamic HTML Editor</a><br />\';\r\n\r\n	$plain = \',plain:\"\"\';\r\n	if (isset($_GET[\'code\'])) $code = \',code:\"\"\';\r\n	if (isset($_GET[\'modify\'])) {$code = \',code:\"\"\'; $plain=\',modify:\"\"\'; }\r\n\r\n	$output .= <<< OUTPUT\r\n	<script>\r\n	function loadPage()\r\n	{\r\n		$.post(\'{$page_name}\',{ operation:\"load\"{$plain}{$code} }, function(data) {\r\n			$(\"#page_body\").empty();\r\n			$(\"#page_body\").append(\'{$back}\'+data);\r\n		});\r\n	}\r\n\r\n	function convertCode()\r\n	{\r\n		var newcode = $(\"#new_code\").val();\r\n		$.post(\'{$page_name}\',{ operation:\"convert_code\", newcode:newcode }, function(data) {\r\n			alert(data);\r\n		});\r\n	}\r\n\r\n$(document).ready(function() {\r\n	loadPage();\r\n});\r\n	</script>\r\n	\r\n	<div name=\"page_body\" id=\"page_body\">\r\n	</div>\r\nOUTPUT;\r\n\r\n}\r\n}','2012-07-09 08:16:55',2,1,'// Bootstrap Builder\r\n$arr_bootstrap = array();\r\n\r\narray_push($arr_bootstrap,array(\r\n	\'element\'=>\'div\'\r\n	,\'class\'=>\'row-fluid\'\r\n	,\'toggle\'=>false\r\n	,\'radio\'=>false\r\n	,\'description\'=>\'\'\r\n	,\'requires_class\'=>\'root\'\r\n));\r\n\r\narray_push($arr_bootstrap,array(\r\n	\'element\'=>\'div\'\r\n	,\'class\'=>\'well\'\r\n	,\'toggle\'=>true\r\n	,\'radio\'=>false\r\n	,\'description\'=>\'Dark Background\'\r\n	,\'requires_class\'=>\'row-fluid,span\'\r\n));\r\n\r\n\r\narray_push($arr_bootstrap,array(\r\n	\'element\'=>\'div\'\r\n	,\'class\'=>\'span2,span4,span6,span8,span10,span12\'\r\n	,\'toggle\'=>false\r\n	,\'radio\'=>false\r\n	,\'description\'=>\'\'\r\n	,\'requires_class\'=>\'row-fluid\'\r\n));\r\n\r\narray_push($arr_bootstrap,array(\r\n	\'element\'=>\'a\'\r\n	,\'class\'=>\'btn\'\r\n	,\'toggle\'=>false\r\n	,\'radio\'=>false\r\n	,\'description\'=>\'Button\'\r\n	,\'requires_class\'=>\'row-fluid,span,btn-group,btn-toolbar\'\r\n));\r\n\r\narray_push($arr_bootstrap,array(\r\n	\'element\'=>\'div\'\r\n	,\'class\'=>\'btn-group\'\r\n	,\'toggle\'=>false\r\n	,\'radio\'=>false\r\n	,\'description\'=>\'Button group\'\r\n	,\'requires_class\'=>\'row-fluid,span,btn-group,btn-toolbar\'\r\n));\r\narray_push($arr_bootstrap,array(\r\n	\'element\'=>\'div\'\r\n	,\'class\'=>\'btn-toolbar\'\r\n	,\'toggle\'=>false\r\n	,\'radio\'=>false\r\n	,\'description\'=>\'Button toolbar\'\r\n	,\'requires_class\'=>\'row-fluid,span,btn-group,btn-toolbar\'\r\n));\r\n\r\narray_push($arr_bootstrap,array(\r\n	\'element\'=>\'a\'\r\n	,\'class\'=>\'btn-primary,btn-info,btn-success,btn-warning,btn-danger,btn-inverse\'\r\n	,\'toggle\'=>false\r\n	,\'radio\'=>true\r\n	,\'description\'=>\'Button type\'\r\n	,\'requires_class\'=>\'btn\'\r\n));\r\nif (isset($_POST[\'operation\']) && $_POST[\'operation\']==\'bootstrap_menu\')\r\n{\r\n	if ($_POST[\'myid\']==\'root\') $class = \'root\';\r\n	else $class = $_POST[\'elemclass\'];\r\n	$possible = \'\';\r\n	$possible_toggle = \'\';\r\n	foreach ($arr_bootstrap as $row)\r\n	{\r\n		$check_parents = explode(\',\',$row[\'requires_class\']);\r\n		foreach ($check_parents as $par)\r\n		{\r\n			$available_children = explode(\',\',$row[\'class\']);\r\n			if (stripos($class,$par)!==false)\r\n			{\r\n				foreach ($available_children as $r)\r\n				{\r\n					$my_id = $unique_id = md5(uniqid(rand(), TRUE));\r\n					if ($row[\'toggle\'])\r\n					{\r\n						$onClick = \'onclick=\"auto_toggle(\\\'\'.$row[\'element\'].\'\\\',\\\'\'.$r.\'\\\',\\\'\'.$_POST[\'myid\'].\r\n							\'\\\',\\\'\'.$_POST[\'myid\'].\'\\\')\"\';\r\n						$possible_toggle .= \'<li><a class=\"bootstrap_delete\" href=\"javascript:void(0)\" \'.\r\n							$onClick.\'>\'.$r.\'</a></li>\';\r\n					}\r\n					else if ($row[\'radio\'])\r\n					{\r\n						$onClick = \'onclick=\"auto_radio(\\\'\'.$row[\'element\'].\'\\\',\\\'\'.$r.\'\\\',\\\'\'.$_POST[\'myid\'].\r\n							\'\\\',\\\'\'.$_POST[\'myid\'].\'\\\')\"\';\r\n						$possible_toggle .= \'<li><a class=\"bootstrap_delete\" href=\"javascript:void(0)\" \'.\r\n							$onClick.\'>\'.$r.\'</a></li>\';\r\n					}\r\n					else\r\n					{\r\n						$onClick = \'onclick=\"auto_add(\\\'\'.$row[\'element\'].\'\\\',\\\'\'.$r.\'\\\',\\\'\'.$my_id.\r\n							\'\\\',\\\'\'.$_POST[\'myid\'].\'\\\',\\\'\'.$row[\'description\'].\'\\\')\"\';\r\n						$possible .= \'<li><a class=\"bootstrap_delete\" href=\"javascript:void(0)\" \'.\r\n							$onClick.\'>\'.$r.\'</a></li>\';\r\n					}\r\n				}\r\n			}\r\n		}\r\n	}\r\n\r\n\r\nif ($possible!=\'\')\r\n{\r\n$return_menu_top = <<< OUTPUT\r\n<li class=\"bootstrap_delete\" style=\"text-align: center;\"><a href=\"javascript:void(0)\"><b>Bootstrap</b></a></li>\r\n<li class=\"bootstrap_delete\" style=\"border-bottom:1px solid silver;\"></li>\r\n{$possible}\r\nOUTPUT;\r\n}else $return_menu_top=\'\';\r\n\r\nif ($possible_toggle!=\'\')\r\n{\r\n$return_menu_bottom = <<< OUTPUT\r\n<li class=\"bootstrap_delete\" style=\"text-align: center;\"><a href=\"javascript:void(0)\"><b>Bootstrap Toggle</b></a></li>\r\n<li class=\"bootstrap_delete\" style=\"border-bottom:1px solid silver;\"></li>\r\n{$possible_toggle}\r\nOUTPUT;\r\n}else $return_menu_bottom=\'\';\r\n\r\n	die($return_menu_top.$return_menu_bottom);\r\n}\r\n\r\n\r\n//dynamicPost(\'dyn_\'.\'test\',\'/page_dynamic_demo\');\r\n//dynamicPost(\'dyn_\'.\'test\',\'/toolkit_dynamic\');\r\n//function dynamicPost($table_dynamic,$page_name)\r\n{\r\n// Set the session variable so the number of SQL queries can be counted after a page load\r\nstartSQLCounter();\r\n\r\nif (!isset($page_name)) $page_name = \'/toolkit_dynamic\';\r\nif (!isset($table_dynamic)) $table_dynamic = \'dyn_\'.\'test\';\r\n\r\n$arr_defined = array();			// Array with HTML element definitions\r\n$array_of_index = array();		// Array with numbers of keys to arr_defined\r\n$arr_standard = array();		// Array with standard HTML attributes\r\n\r\narray_push($arr_standard,array(\'class\',\'bootstrap style\'));\r\narray_push($arr_standard,array(\'id\',\'unique ID\'));\r\narray_push($arr_standard,array(\'name\',\'unique name\'));\r\narray_push($arr_standard,array(\'style\',\'CSS separated by semi-colons\'));\r\narray_push($arr_standard,array(\'title\',\'hover over text\'));\r\narray_push($arr_standard,array(\'data-child-side\',\'out-left,in-left,in-right,out-right\'));\r\n\r\n$typical_tags = array(\'a\',\'img\',\'span\');\r\n\r\nfunction array_add($arr,$add)\r\n{\r\n	foreach(array_reverse($add) as $row) { array_unshift($arr,$row); }\r\n	return $arr;\r\n}\r\nfunction array_remove($arr,$remove)\r\n{\r\n	foreach($remove as $row) { unset($arr[$row]); }\r\n	return $arr;\r\n}\r\n\r\n// text - text (made up)\r\narray_push($arr_defined,array(\r\n	\'element\'=>\'text\'\r\n	,\'description\'=>\'Text\'\r\n	,\'required_attribute\'=>array(\'text\')\r\n	,\'required_attribute_description\'=>array(\'text to display\')\r\n	,\'optional_attribute\'=>array()\r\n	,\'optional_attribute_description\'=>array()\r\n	,\'selfclosing\'=>false\r\n	,\'children\'=>array()\r\n));\r\n\r\n// p - paragraph\r\narray_push($arr_defined,array(\r\n	\'element\'=>\'p\'\r\n	,\'description\'=>\'Text\'\r\n	,\'required_attribute\'=>array(\'text\')\r\n	,\'required_attribute_description\'=>array(\'text to display\')\r\n	,\'optional_attribute\'=>array()\r\n	,\'optional_attribute_description\'=>array()\r\n	,\'selfclosing\'=>false\r\n	,\'children\'=>$typical_tags\r\n));\r\n\r\n// br - break\r\narray_push($arr_defined,array(\r\n	\'element\'=>\'br\'\r\n	,\'description\'=>\'Line Break\'\r\n	,\'required_attribute\'=>array()\r\n	,\'required_attribute_description\'=>array()\r\n	,\'optional_attribute\'=>array()\r\n	,\'optional_attribute_description\'=>array()\r\n	,\'selfclosing\'=>true\r\n	,\'children\'=>array()\r\n));\r\n\r\n\r\n// cdata-section - some random section that appears around JavaScript\r\narray_push($arr_defined,array(\r\n	\'element\'=>\'cdata-section\'\r\n	,\'description\'=>\'CDATA section\'\r\n	,\'required_attribute\'=>array()\r\n	,\'required_attribute_description\'=>array()\r\n	,\'optional_attribute\'=>array()\r\n	,\'optional_attribute_description\'=>array()\r\n	,\'selfclosing\'=>false\r\n	,\'notag\'=>true\r\n	,\'children\'=>array()\r\n));\r\n\r\n// div - division\r\narray_push($arr_defined,array(\r\n	\'element\'=>\'div\'\r\n	,\'description\'=>\'Division or section\'\r\n	,\'required_attribute\'=>array()\r\n	,\'required_attribute_description\'=>array()\r\n	,\'optional_attribute\'=>array()\r\n	,\'optional_attribute_description\'=>array()\r\n	,\'selfclosing\'=>false\r\n	,\'children\'=>array_add($typical_tags,array(\'div\',\'p\',\'h1\',\'h2\',\'h3\',\'h4\',\'h5\',\'h6\',\'ul\',\'ol\',\'li\',\'dl\',\'blockquote\',\'pre\',\'small\'))\r\n));\r\n\r\n// img - image\r\narray_push($arr_defined,array(\r\n	\'element\'=>\'img\'\r\n	,\'description\'=>\'Image\'\r\n	,\'required_attribute\'=>array(\'alt\',\'src\')\r\n	,\'required_attribute_description\'=>array(\'alternative text\',\'image URL\')\r\n	,\'optional_attribute\'=>array()\r\n	,\'optional_attribute_description\'=>array()\r\n	,\'selfclosing\'=>true\r\n	,\'children\'=>array()\r\n));\r\n\r\n// a - anchor\r\narray_push($arr_defined,array(\r\n	\'element\'=>\'a\'\r\n	,\'description\'=>\'Link or anchor\'\r\n	,\'required_attribute\'=>array(\'text\',\'href\')\r\n	,\'required_attribute_description\'=>array(\'text to display\',\'URL of the link\')\r\n	,\'optional_attribute\'=>array()\r\n	,\'optional_attribute_description\'=>array()\r\n	,\'selfclosing\'=>false\r\n	,\'children\'=>array_remove($typical_tags,array(\'a\'))\r\n));\r\n\r\n// span - part of a text\r\narray_push($arr_defined,array(\r\n	\'element\'=>\'span\'\r\n	,\'description\'=>\'Part of a text\'\r\n	,\'required_attribute\'=>array(\'text\')\r\n	,\'required_attribute_description\'=>array(\'text to display\')\r\n	,\'optional_attribute\'=>array()\r\n	,\'optional_attribute_description\'=>array()\r\n	,\'selfclosing\'=>false\r\n	,\'children\'=>array_remove($typical_tags,array(\'span\'))\r\n));\r\n\r\n// h1 - heading\r\narray_push($arr_defined,array(\r\n	\'element\'=>\'h1\'\r\n	,\'description\'=>\'Heading 1\'\r\n	,\'required_attribute\'=>array(\'text\')\r\n	,\'required_attribute_description\'=>array(\'text to display\')\r\n	,\'optional_attribute\'=>array()\r\n	,\'optional_attribute_description\'=>array()\r\n	,\'selfclosing\'=>false\r\n	,\'children\'=>$typical_tags\r\n));\r\n// h2 - heading\r\narray_push($arr_defined,array(\r\n	\'element\'=>\'h2\'\r\n	,\'description\'=>\'Heading 2\'\r\n	,\'required_attribute\'=>array(\'text\')\r\n	,\'required_attribute_description\'=>array(\'text to display\')\r\n	,\'optional_attribute\'=>array()\r\n	,\'optional_attribute_description\'=>array()\r\n	,\'selfclosing\'=>false\r\n	,\'children\'=>$typical_tags\r\n));\r\n// h3 - heading\r\narray_push($arr_defined,array(\r\n	\'element\'=>\'h3\'\r\n	,\'description\'=>\'Heading 3\'\r\n	,\'required_attribute\'=>array(\'text\')\r\n	,\'required_attribute_description\'=>array(\'text to display\')\r\n	,\'optional_attribute\'=>array()\r\n	,\'optional_attribute_description\'=>array()\r\n	,\'selfclosing\'=>false\r\n	,\'children\'=>$typical_tags\r\n));\r\n// h4 - heading\r\narray_push($arr_defined,array(\r\n	\'element\'=>\'h4\'\r\n	,\'description\'=>\'Heading 4\'\r\n	,\'required_attribute\'=>array(\'text\')\r\n	,\'required_attribute_description\'=>array(\'text to display\')\r\n	,\'optional_attribute\'=>array()\r\n	,\'optional_attribute_description\'=>array()\r\n	,\'selfclosing\'=>false\r\n	,\'children\'=>$typical_tags\r\n));\r\n// h5 - heading\r\narray_push($arr_defined,array(\r\n	\'element\'=>\'h5\'\r\n	,\'description\'=>\'Heading 5\'\r\n	,\'required_attribute\'=>array(\'text\')\r\n	,\'required_attribute_description\'=>array(\'text to display\')\r\n	,\'optional_attribute\'=>array()\r\n	,\'optional_attribute_description\'=>array()\r\n	,\'selfclosing\'=>false\r\n	,\'children\'=>$typical_tags\r\n));\r\n// h6 - heading\r\narray_push($arr_defined,array(\r\n	\'element\'=>\'h6\'\r\n	,\'description\'=>\'Heading 6\'\r\n	,\'required_attribute\'=>array(\'text\')\r\n	,\'required_attribute_description\'=>array(\'text to display\')\r\n	,\'optional_attribute\'=>array()\r\n	,\'optional_attribute_description\'=>array()\r\n	,\'selfclosing\'=>false\r\n	,\'children\'=>$typical_tags\r\n));\r\n\r\n// ul - unordered list\r\narray_push($arr_defined,array(\r\n	\'element\'=>\'ul\'\r\n	,\'description\'=>\'Unordered list\'\r\n	,\'required_attribute\'=>array()\r\n	,\'required_attribute_description\'=>array()\r\n	,\'optional_attribute\'=>array()\r\n	,\'optional_attribute_description\'=>array()\r\n	,\'selfclosing\'=>false\r\n	,\'children\'=>array_add($typical_tags,array(\'li\'))\r\n));\r\n\r\n// ol - ordered list\r\narray_push($arr_defined,array(\r\n	\'element\'=>\'ol\'\r\n	,\'description\'=>\'Ordered list\'\r\n	,\'required_attribute\'=>array()\r\n	,\'required_attribute_description\'=>array()\r\n	,\'optional_attribute\'=>array()\r\n	,\'optional_attribute_description\'=>array()\r\n	,\'selfclosing\'=>false\r\n	,\'children\'=>array_add($typical_tags,array(\'li\'))\r\n));\r\n\r\n// dl - definition list\r\narray_push($arr_defined,array(\r\n	\'element\'=>\'dl\'\r\n	,\'description\'=>\'Definition list\'\r\n	,\'required_attribute\'=>array()\r\n	,\'required_attribute_description\'=>array()\r\n	,\'optional_attribute\'=>array()\r\n	,\'optional_attribute_description\'=>array()\r\n	,\'selfclosing\'=>false\r\n	,\'children\'=>array_add($typical_tags,array(\'dt\',\'dd\'))\r\n));\r\n\r\n// li - list item\r\narray_push($arr_defined,array(\r\n	\'element\'=>\'li\'\r\n	,\'description\'=>\'List item\'\r\n	,\'required_attribute\'=>array(\'text\')\r\n	,\'required_attribute_description\'=>array(\'text to display\')\r\n	,\'optional_attribute\'=>array()\r\n	,\'optional_attribute_description\'=>array()\r\n	,\'selfclosing\'=>false\r\n	,\'children\'=>$typical_tags\r\n));\r\n\r\n// dt - definition list item\r\narray_push($arr_defined,array(\r\n	\'element\'=>\'dt\'\r\n	,\'description\'=>\'Definition list item\'\r\n	,\'required_attribute\'=>array(\'text\')\r\n	,\'required_attribute_description\'=>array(\'text to display\')\r\n	,\'optional_attribute\'=>array()\r\n	,\'optional_attribute_description\'=>array()\r\n	,\'selfclosing\'=>false\r\n	,\'children\'=>$typical_tags\r\n));\r\n\r\n// dd - description of list item\r\narray_push($arr_defined,array(\r\n	\'element\'=>\'dd\'\r\n	,\'description\'=>\'Description of list item\'\r\n	,\'required_attribute\'=>array(\'text\')\r\n	,\'required_attribute_description\'=>array(\'text to display\')\r\n	,\'optional_attribute\'=>array()\r\n	,\'optional_attribute_description\'=>array()\r\n	,\'selfclosing\'=>false\r\n	,\'children\'=>$typical_tags\r\n));\r\n\r\n// blockquote - blockquote\r\narray_push($arr_defined,array(\r\n	\'element\'=>\'blockquote\'\r\n	,\'description\'=>\'Text\'\r\n	,\'required_attribute\'=>array(\'text\')\r\n	,\'required_attribute_description\'=>array(\'text to display\')\r\n	,\'optional_attribute\'=>array()\r\n	,\'optional_attribute_description\'=>array()\r\n	,\'selfclosing\'=>false\r\n	,\'children\'=>array_add($typical_tags,array(\'small\'))\r\n));\r\n\r\n// pre - pre\r\narray_push($arr_defined,array(\r\n	\'element\'=>\'pre\'\r\n	,\'description\'=>\'Preformatted text\'\r\n	,\'required_attribute\'=>array(\'text\')\r\n	,\'required_attribute_description\'=>array(\'text to display\')\r\n	,\'optional_attribute\'=>array()\r\n	,\'optional_attribute_description\'=>array()\r\n	,\'selfclosing\'=>false\r\n	,\'children\'=>$typical_tags\r\n));\r\n\r\n// small - smaller text\r\narray_push($arr_defined,array(\r\n	\'element\'=>\'small\'\r\n	,\'description\'=>\'Smaller text\'\r\n	,\'required_attribute\'=>array(\'text\')\r\n	,\'required_attribute_description\'=>array(\'text to display\')\r\n	,\'optional_attribute\'=>array()\r\n	,\'optional_attribute_description\'=>array()\r\n	,\'selfclosing\'=>false\r\n	,\'children\'=>$typical_tags\r\n));\r\n\r\n\r\n// Load an array with keys to the defined array of element definitions\r\nforeach($arr_defined as $row) { array_push($array_of_index,$row[\'element\']); }\r\n\r\n// Get the defined element array for one element\r\nfunction getElementArray($element)\r\n{\r\n	global $array_of_index;\r\n	global $arr_defined;\r\n\r\n	// Get the key in the defined array for the parent element\r\n	$key = array_search($element,$array_of_index);\r\n	// If the parent element is not defined, just use the DIV element\r\n	if ($key===false) array_search(\'div\',$array_of_index);\r\n	\r\n	// The array that represents the parent element\r\n	$current_parent_array = $arr_defined[$key];\r\n\r\n	return $current_parent_array;\r\n}\r\n\r\n// Adds an input box for an HTML attribute\r\nfunction build_attrib($name,$placeholder,$value=\'\')\r\n{\r\n	$cap = ucfirst($name);\r\n	$safe_value = htmlentities($value, ENT_QUOTES, \'UTF-8\');\r\n	return <<< OUTPUT\r\n	<div class=\"control-group\">\r\n		<label class=\"control-label\" for=\"{$name}\">{$cap}</label>\r\n		<div class=\"controls\"><input type=\"text\" name=\"{$name}\" id=\"{$name}\" \r\n		placeholder=\"{$placeholder}\" value=\"{$safe_value}\"></div>\r\n	</div>\r\nOUTPUT;\r\n}\r\n\r\nfunction getContentArray($myid)\r\n{\r\n	global $table_dynamic;\r\n	// Grab the Dragged element\r\n	$result = query(\'SELECT my_id,content,parent FROM \'.$table_dynamic.\' WHERE my_id=? LIMIT 1\', array($myid));\r\n	\r\n	if ($result)\r\n	{\r\n		// Convert the json encoded string to an array\r\n		$a = json_decode($result[0][\'content\'],true);\r\n		$a[\'data-myid\']=$result[0][\'my_id\'];\r\n		$a[\'data-parentid\']=$result[0][\'parent\'];\r\n\r\n	}\r\n	else $a = false;\r\n	return $a;\r\n}\r\nfunction getElementType($myid)\r\n{\r\n	$a = getContentArray($myid);\r\n	// Get the HTML element type\r\n	return $a[\'tag\'];\r\n}\r\n\r\nfunction getChildren($result, $parentid, $isPre, $prepend)\r\n{\r\n	global $table_dynamic;\r\n	$admin=isGroupMember(2);\r\n\r\n	if (isset($_POST[\'plain\'])) $admin=false;\r\n	//if (isset($_POST[\'modify\'])) $admin=false;\r\n\r\n	$return = \'\';\r\n	$position = 0;\r\n	foreach($result as $row)\r\n	{\r\n		// Skip to the next if the seek element is the parent or itself\r\n		if ($row[\'parent\']!=$parentid || $row[\'my_id\']==$parentid) continue;\r\n\r\n		// Update the position of the element\r\n		$qry = \'UPDATE \'.$table_dynamic.\' SET position=? WHERE id=?\';\r\n		$params = array($position,$row[\'id\']);\r\n		if ($admin) query_execute($qry, $params);\r\n\r\n		// Convert the json encoded string to an array\r\n		$a = json_decode($row[\'content\'],true);\r\n		// Add the position as an html attribute\r\n		if ($admin) $a[\'data-position\']=$position;\r\n\r\n		// Get the HTML element type\r\n		$element = $a[\'tag\'];\r\n\r\n// Don\'t output comments\r\nif ($element==\'comment\') continue;\r\n\r\n		// Get the HTML element template\r\n		$template = getElementArray($element);\r\n\r\n		$loc = \'in-right\';\r\n		if (isset($a[\'data-child-side\']))\r\n		{\r\n			$loc = $a[\'data-child-side\'];\r\n			unset($a[\'data-child-side\']);\r\n		}\r\n\r\n		// Add each attribute to a string\r\n		$attrib = \'\';\r\n		foreach($a as $key=>$val)\r\n		{\r\n			// Only add attributes and exclude \'text\'\r\n			//if (strpos($key,\'\')===0 && $key != \'text\' && strlen($val)>0)\r\n			if ($key != \'text\' && $key != \'tag\')\r\n			{\r\n				$val2 = \'\';\r\n				if ($key==\'class\' && $admin && !isset($_POST[\'modify\'])) $val2=\' draggable\';\r\n				$attrib .= \' \'.$key.\'=\"\'.$val.$val2.\'\"\';\r\n			}\r\n		}\r\n\r\n		// Ensure the ID and Parent ID are on the element\r\n		if ($admin) $attrib .= \' data-myid=\"\'.$row[\'my_id\'].\'\" data-parentid=\"\'.$row[\'parent\'].\'\"\';\r\n\r\n		// Ensure the draggable class is added to each element\r\n		if ($admin && !isset($_POST[\'modify\'])) if (strpos($attrib,\'class=\')===false) $attrib .= \' class=\"draggable\"\';\r\n\r\n		// Output the element based on the type\r\n		//if ($element==\'text\') $return .= \'<span>\'.$a[\'text\'].\'</span>\';\r\n		if ($element==\'text\')\r\n		{\r\n\r\n			// Set the element text attribute since it is between the element tags\r\n			if (isset($a[\'text\']) && strlen($a[\'text\'])>0) $text = $a[\'text\'];\r\n			else\r\n			{\r\n				$text=\'\';\r\n			}\r\n\r\n			if ($admin && !isset($_POST[\'modify\']) && $text!=\'\') $return .= \'<text class=\"dynamic-text-markup\" data-element-type=\"\'.$element.\'\" data-myid=\"\'.$row[\'my_id\'].\'\" \r\n			data-parentid=\"\'.$row[\'parent\'].\'\">\'.$text.\'</text>\';\r\n\r\n			//if ($admin) $return .= smartDB($row,\'column\',$table_dynamic);\r\n\r\n			else $return .= $text;\r\n		}\r\n		else if (isset($template[\'notag\']) && $template[\'notag\']) $return .= $a[\'text\'];\r\n		else if ($template[\'selfclosing\']) $return .= \"<$element$attrib/>\";\r\n		else\r\n		{\r\n			if ($isPre || $element==\'pre\' || $element==\'textarea\') $newline = \'\';\r\n			else $newline = NEWLINE;\r\n//if (isset($_POST[\'modify\'])) $newline = \'\';\r\n\r\n			// Retrieve all the children tags\r\n//if (isset($_POST[\'modify\'])) $children = getChildren($result, $row[\'my_id\'],($newline!=NEWLINE),\'\');\r\n			//else\r\n$children = getChildren($result, $row[\'my_id\'],($newline!=NEWLINE),$prepend.\'	\');\r\n\r\n//if (isset($_POST[\'modify\'])) $prepend=\'\';\r\n\r\n			$text = \'\';\r\n			// Set the element text attribute since it is between the element tags\r\n			if (isset($a[\'text\']) && strlen($a[\'text\'])>0) $text = $a[\'text\'];\r\n			else if ($children==\'\')\r\n			{\r\n				if ($admin && !isset($_POST[\'modify\'])) $text=\'<span class=\"dynamic-markup\" data-element-type=\"\'.$element.\'\" data-myid=\"\'.$row[\'my_id\'].\'\" \r\n				data-parentid=\"\'.$row[\'parent\'].\'\">***** Empty \'.strtoupper($element).\' *****</span>\';\r\n			}\r\n\r\n			$end_line = \'\';\r\n\r\n			if ($isPre || $element==\'pre\' || $element==\'textarea\')\r\n			{\r\n				$newline = NEWLINE;\r\n				$prepend = \'\';\r\n			}\r\n			\r\n			// Make sure children start on a new line\r\n			if ($children!=\'\' && strpos(trim($children),\'<\')===0)\r\n			{\r\n				//$children = $newline.$prepend.$children;\r\n				$children = $prepend.$children;\r\n				$end_line = \"$newline$prepend\";\r\n			}\r\n\r\n			if ($loc==\'out-left\') $variation = \"$children$newline<$element$attrib>$text$end_line</$element>\";\r\n			else if ($loc==\'in-left\')  $variation = $newline.$prepend.\"<$element$attrib>$children$text$end_line</$element>\";\r\n			else if ($loc==\'in-right\') $variation = \"$newline$prepend<$element$attrib>$text$children$end_line</$element>\";\r\n			else if ($loc==\'out-right\') $variation = $newline.$prepend.\"<$element$attrib>$text</$element>$end_line$children\";\r\n			$return .= $variation;\r\n		}\r\n		// Update the position to the next one\r\n		$position+=1;\r\n	}\r\nreturn $return;\r\n}\r\n\r\n// Determines if the dragged element can be dropped on the DroppedOn element\r\nfunction isAllowedDrop($myid, $droppedOnID)\r\n{\r\n	if ($droppedOnID==\'root\') return true;\r\n	// Get the Dragged element\r\n	$element = getElementType($myid);\r\n\r\n	// Grab the DroppedOn element\r\n	$element2 = getElementType($droppedOnID);\r\n\r\n	// Get the HTML element template for the DroppedOn element\r\n	$template = getElementArray($element2);\r\n\r\n	// If the Dragged element is an allowed child of the DroppedOn element, return true\r\n	if (in_array($element,$template[\'children\'])!==false) return true;\r\n	else return false;\r\n}\r\n\r\nif (isset($_POST[\'operation\']) && $_POST[\'operation\']==\'load\')\r\n{\r\n	// MySQL query with LIMIT to improve performance\r\n	$qry = \'SELECT my_id,content,parent,id,position FROM \'.$table_dynamic.\' ORDER BY position\';\r\n\r\n	// Pass a variable via GET or POST\r\n	$params = array();\r\n	\r\n	// Execute the query with the query and parameters\r\n	$result = query($qry, $params);\r\n\r\n	// Build the element tree\r\n	$return = getChildren($result,\'root\',false,\'\');\r\n\r\n	if (isset($_POST[\'modify\']))\r\n	{\r\n		$return = \'<textarea name=\"new_code\" id=\"new_code\" wrap=\"off\" style=\"width: 100%;height: 500px;\">\'.htmlentities($return, ENT_QUOTES, \'UTF-8\').\'</textarea>\';\r\n		$return .= <<< OUTPUT\r\n<div class=\"btn-group\">\r\n<a class=\"btn\" href=\"javascript:void(0)\" onclick=\"convertCode()\">Update</a>\r\n</div>\r\nOUTPUT;\r\n	}\r\n	else if (isset($_POST[\'code\']))\r\n	{\r\n		$return = \'<textarea wrap=\"off\" style=\"width: 100%; height:500px;\">\'.htmlentities($return, ENT_QUOTES, \'UTF-8\').\'</textarea>\';\r\n	}\r\n\r\n	die($return);\r\n}\r\n\r\n// Prevent everyone but admins from posting to unsafe functions\r\nif (!isGroupMember(2)) die(\'You do not have access to this function.\');\r\n\r\n\r\nif (isset($_POST[\'operation\']) && $_POST[\'operation\']==\'delete\')\r\n{\r\n	// Determine if the element you want to delete has children\r\n	$result = query(\'SELECT my_id FROM \'.$table_dynamic.\' WHERE parent=? LIMIT 1\', array($_POST[\'myid\']));\r\n	if ($result) die(\"true\");\r\n	else die(\"false\");\r\n}\r\nelse if (isset($_POST[\'operation\']) && $_POST[\'operation\']==\'delete_parent\')\r\n{\r\n	query_execute(\'DELETE FROM \'.$table_dynamic.\' WHERE my_id=? LIMIT 1\', array($_POST[\'myid\']));\r\n	die();\r\n}\r\nelse if (isset($_POST[\'operation\']) && $_POST[\'operation\']==\'delete_all\')\r\n{\r\n	function delete_children($id,$table_dynamic)\r\n	{		\r\n		// Get all the children of the passed parent\r\n		$result = query(\'SELECT my_id FROM \'.$table_dynamic.\' WHERE parent=?\', array($id));\r\n		// Foreach child\r\n		foreach($result as $row)\r\n		{\r\n			// Find there children\r\n			delete_children($row[\'my_id\'],$table_dynamic);\r\n	\r\n			// Delete the current child\r\n			query_execute(\'DELETE FROM \'.$table_dynamic.\' WHERE my_id=? LIMIT 1\', array($row[\'my_id\']));	\r\n		}\r\n		// Delete the parent\r\n		query_execute(\'DELETE FROM \'.$table_dynamic.\' WHERE my_id=? LIMIT 1\', array($id));\r\n	}\r\n	delete_children($_POST[\'myid\'],$table_dynamic);\r\n}\r\nelseif (isset($_POST[\'operation\']) && ($_POST[\'operation\']==\'build\' || $_POST[\'operation\']==\'build_edit\'))\r\n{\r\n// Types of tags\r\n//$arr_main = array(\'a\',\'img\',\'p\',\'pre\',\'div\',\'h1\',\'h2\',\'h3\',\'h4\',\'h5\',\'h6\',\'ul\',\'li\');\r\n\r\n$return = \'\';						// Output of the modal to return using DIE\r\n$parent_children = \'<option value=\"\"></option>\';	// Build the option selector for the children\r\n\r\n\r\n$unique_id = md5(uniqid(rand(), TRUE));\r\n$parent_id = $_POST[\'parent_id\'];\r\n$parent_type = $_POST[\'parent_element\'];\r\n\r\n$opt1 = \'Add an Element to \'.$_POST[\'parent_element\'];\r\n$script = \'\';\r\n$btn = \'<a href=\"javascript:void(0)\" class=\"btn btn-primary\" onclick=\"addElement()\">Add</a>\';\r\n$post_type = \'dbadd\';\r\n$my_type = \'\';\r\n$change_inputs = \'Add\';\r\n\r\nif ($_POST[\'operation\']==\'build_edit\')\r\n{\r\n	$opt1 = \'Edit Element\';\r\n$change_inputs = \'Edit\';\r\n	$content = getContentArray($_POST[\'parent_id\']);\r\n	$unique_id = $content[\'data-myid\'];\r\n	$parent_id = $content[\'data-parentid\'];\r\n	$my_type = $content[\'tag\'];\r\n	$parent_content = getContentArray($parent_id);\r\n	if (!$parent_content) $parent_type = \'div\';\r\n	else $parent_type = $parent_content[\'tag\'];\r\n\r\n$script = \'<script>changeInputs\'.$change_inputs.\'();</script>\';\r\n//$btn = \'<button class=\"btn btn-primary\" onclick=\"updateElement();\">Update</button>\';\r\n$btn = \'<a class=\"btn btn-primary\" href=\"javascript:void(0)\" onclick=\"updateElement();\">Update</a>\';\r\n$post_type = \'dbupdate\';\r\n}\r\n\r\n$current_parent_array = getElementArray($parent_type);\r\n\r\n// For each allowed child of the parent\r\nforeach($current_parent_array[\'children\'] as $row)\r\n{\r\n	// Determine if the child is in the defined array of HTML elements\r\n	$k = array_search($row,$array_of_index);\r\n\r\nif ($row==$my_type && $_POST[\'operation\']==\'build_edit\') $selected=\' selected=\"selected\" \';\r\nelse $selected = \'\';\r\n\r\n	// If the element is FOUND, output the description\r\n	if ($k!==false) $parent_children .= \'<option \'.$selected.\' value=\"\'.$row.\'\">\'.$arr_defined[$k][\'description\'].\' (\'.$row.\')</option>\';\r\n	// Else the element is NOT found so do not output the description name because you do not have it\r\n	else $parent_children .= \'<option \'.$selected.\' value=\"\'.$row.\'\">\'.$row.\'</option>\';\r\n}\r\n\r\n$return = <<< OUTPUT\r\n<div class=\"modal hide\" id=\"myModal\">\r\n	<div class=\"modal-header\">\r\n		<button type=\"button\" class=\"close\" data-dismiss=\"modal\">Ã—</button>\r\n		<h3>{$opt1}</h3>\r\n	</div>\r\n	\r\n	<form class=\"form-horizontal\" name=\"dyn_form\" id=\"dyn_form\">\r\n		<input type=\"hidden\" name=\"operation\" id=\"operation\" value=\"{$post_type}\">\r\n		<input type=\"hidden\" name=\"data-parentid\" id=\"data-parentid\" value=\"{$parent_id}\">\r\n		<input type=\"hidden\" name=\"data-myid\" id=\"data-myid\" value=\"{$unique_id}\">\r\n	  	<div class=\"modal-body\">\r\n			<fieldset>\r\n				<div class=\"control-group\">\r\n					<label class=\"control-label\" for=\"tag\">Tag</label>\r\n					<div class=\"controls\">\r\n					<select name=\"tag\" id=\"tag\" onchange=\"changeInputs{$change_inputs}()\">\r\n						{$parent_children}\r\n					</select>\r\n					</div>\r\n				</div>\r\n\r\n<div name=\"dispose_mod_input_top\" id=\"dispose_mod_input_top\"></div>\r\n\r\n<div name=\"dispose_mod_input_bottom\" id=\"dispose_mod_input_bottom\"></div>\r\n				\r\n			</fieldset>\r\n	  	</div> <!-- modal-body -->\r\n		<div class=\"modal-footer\">\r\n			{$btn}\r\n			<button type=\"reset\" class=\"btn btn-danger\">Reset</button>\r\n			<a href=\"javascript:void(0)\" class=\"btn\" data-dismiss=\"modal\">Close</a>\r\n		</div>\r\n	</form>\r\n</div>\r\n\r\n<script>\r\nfunction changeInputsAdd()\r\n{\r\n	var val = $(\'#tag\').val();\r\n	var val2 = $(\'#data-myid\').val();\r\n	$.post(\'{$page_name}\',{ operation:\"change_top\", selected_element:val, myid:val2 }, function(data) {\r\n		$(\"#dispose_mod_input_top\").empty();\r\n		$(\"#dispose_mod_input_top\").append(data);\r\n		//$(\'#myModal\').modal(\'show\');\r\n	});\r\n	$.post(\'{$page_name}\',{ operation:\"change_bottom\", selected_element:val, myid:val2 }, function(data) {\r\n		$(\"#dispose_mod_input_bottom\").empty();\r\n		$(\"#dispose_mod_input_bottom\").append(data);\r\n		$(\'#myModal\').modal(\'show\');\r\n	});\r\n}\r\nfunction changeInputsEdit()\r\n{\r\n	var val = $(\'#tag\').val();\r\n	var val2 = $(\'#data-myid\').val();\r\n	$.post(\'{$page_name}\',{ operation:\"change_top\", selected_element:val, myid:val2, isedit:\'true\' }, function(data) {\r\n		$(\"#dispose_mod_input_top\").empty();\r\n		$(\"#dispose_mod_input_top\").append(data);\r\n		//$(\'#myModal\').modal(\'show\');\r\n	});\r\n	$.post(\'{$page_name}\',{ operation:\"change_bottom\", selected_element:val, myid:val2, isedit:\'true\' }, function(data) {\r\n		$(\"#dispose_mod_input_bottom\").empty();\r\n		$(\"#dispose_mod_input_bottom\").append(data);\r\n		$(\'#myModal\').modal(\'show\');\r\n	});\r\n}\r\nfunction addElement()\r\n{\r\n	$.post(\"{$page_name}\", $(\"#dyn_form\").serialize(),function(data) {\r\n		//window.location = \"{$_SERVER[\'REQUEST_URI\']}\";\r\n		// Set the unique ID to a new one so multiple elements can be created without closing the modal\r\n		$(\'#data-myid\').val(data);\r\n		loadPage();\r\n	});\r\n}\r\nfunction updateElement()\r\n{\r\n	var scrollTop = $(document).scrollTop();\r\n	var scrollLeft = $(document).scrollLeft();\r\n	$.post(\"{$page_name}\", $(\"#dyn_form\").serialize(),function(data) {\r\n		loadPage();\r\n		//$(document).scrollTop(scrollTop);\r\n		//$(document).scrollLeft(scrollLeft);\r\n		//return false;\r\n	});\r\n		//return false;\r\n}\r\n</script>\r\n\r\n{$script}\r\n\r\nOUTPUT;\r\n//if ($my_type==\'text\') $disable_all = true;\r\nif (isset($_POST[\'textid\']))\r\n{\r\n\r\n$unique_id = $_POST[\'textid\'];\r\n$mycontent = getContentArray($unique_id);\r\n$parent_id = $mycontent[\'data-parentid\'];\r\n$text = htmlentities($mycontent[\'text\'], ENT_QUOTES, \'UTF-8\');\r\n\r\n$return = <<< OUTPUT\r\n<div class=\"modal hide\" id=\"myModal\">\r\n	<div class=\"modal-header\">\r\n		<button type=\"button\" class=\"close\" data-dismiss=\"modal\">Ã—</button>\r\n		<h3>{$opt1}</h3>\r\n	</div>\r\n	\r\n	<form class=\"form-horizontal\" name=\"dyn_form\" id=\"dyn_form\">\r\n		<input type=\"hidden\" name=\"operation\" id=\"operation\" value=\"{$post_type}\">\r\n		<input type=\"hidden\" name=\"data-parentid\" id=\"data-parentid\" value=\"{$parent_id}\">\r\n		<input type=\"hidden\" name=\"data-myid\" id=\"data-myid\" value=\"{$unique_id}\">\r\n		<input type=\"hidden\" name=\"tag\" id=\"tag\" value=\"text\">\r\n	  	<div class=\"modal-body\">\r\n			<fieldset>\r\n\r\n\r\n<div name=\"dispose_mod_input_top\" id=\"dispose_mod_input_top\">\r\n\r\n<div class=\"control-group\">\r\n		<label class=\"control-label\" for=\"text\">Text</label>\r\n		<div class=\"controls\"><input type=\"text\" name=\"text\" id=\"text\" placeholder=\"text to display\" value=\"{$text}\"></div>\r\n	</div>\r\n</div>\r\n\r\n<div name=\"dispose_mod_input_bottom\" id=\"dispose_mod_input_bottom\"></div>\r\n				\r\n			</fieldset>\r\n	  	</div> <!-- modal-body -->\r\n		<div class=\"modal-footer\">\r\n			{$btn}\r\n			<button type=\"reset\" class=\"btn btn-danger\">Reset</button>\r\n			<a href=\"javascript:void(0)\" class=\"btn\" data-dismiss=\"modal\">Close</a>\r\n		</div>\r\n	</form>\r\n</div>\r\n\r\n<script>\r\nfunction updateElement()\r\n{\r\n	var scrollTop = $(document).scrollTop();\r\n	var scrollLeft = $(document).scrollLeft();\r\n	$.post(\"{$page_name}\", $(\"#dyn_form\").serialize(),function(data) {\r\n		loadPage();\r\n		//$(document).scrollTop(scrollTop);\r\n		//$(document).scrollLeft(scrollLeft);\r\n		//return false;\r\n	});\r\n		//return false;\r\n}\r\n</script>\r\n\r\nOUTPUT;\r\n}\r\n\r\n	die($return);\r\n}\r\nelse if (isset($_POST[\'operation\']) && $_POST[\'operation\']==\'change_top\')\r\n{\r\n\r\n	$content_array = getContentArray($_POST[\'myid\']);\r\n\r\n	$current_selected_array = getElementArray($_POST[\'selected_element\']);\r\n	$return = \'\';\r\n\r\n	for ($i=0;$i<count($current_selected_array[\'required_attribute\']);$i++)\r\n	{\r\n		$attrib = $current_selected_array[\'required_attribute\'][$i];\r\n\r\n		if (isset($_POST[\'isedit\']) && $attrib==\'text\') continue;\r\n\r\n		if ($content_array && isset($content_array[\'\'.$attrib])) $value = $content_array[\'\'.$attrib];\r\n		else $value=\'\';\r\n		$return .= build_attrib($attrib,\r\n			$current_selected_array[\'required_attribute_description\'][$i],$value);\r\n	}\r\n	die($return);\r\n}\r\nelse if (isset($_POST[\'operation\']) && $_POST[\'operation\']==\'change_bottom\')\r\n{\r\n	$current_selected_array = getElementArray($_POST[\'selected_element\']);\r\n	$content_array = getContentArray($_POST[\'myid\']);\r\n	global $arr_standard;\r\n	$return = \'\';\r\n	\r\n	$return .= \'<a href=\"javascript:void(0)\" data-toggle=\"collapse\" data-target=\"#collapse_advanced\" style=\"cursor:pointer;\">Optional</a>\r\n		<div class=\"collapse in\" id=\"collapse_advanced\" name=\"collapse_advanced\">\';\r\n\r\n	for ($i=0;$i<count($current_selected_array[\'optional_attribute\']);$i++)\r\n	{\r\n		$attrib = $current_selected_array[\'optional_attribute\'][$i];\r\n\r\n		if (isset($_POST[\'isedit\']) && $attrib==\'text\') continue;\r\n\r\n		if ($content_array && isset($content_array[\'\'.$attrib])) $value = $content_array[\'\'.$attrib];\r\n		else $value=\'\';\r\n		$return .= build_attrib($attrib,\r\n			$current_selected_array[\'optional_attribute_description\'][$i],$value);\r\n	}\r\n\r\n	foreach($arr_standard as $row)\r\n	{\r\n		if ($content_array && isset($content_array[\'\'.$row[0]])) $value = $content_array[\'\'.$row[0]];\r\n		else $value=\'\';\r\n		$return .= build_attrib($row[0],$row[1],$value);\r\n	}\r\n\r\n	$return .= \'</div> <! -- collapse_advanced -->\';\r\n	die($return);\r\n}\r\nelse if (isset($_POST[\'operation\']) && $_POST[\'operation\']==\'dbadd\')\r\n{\r\n	// Remove these from the content array\r\n	$myid = $_POST[\'data-myid\'];\r\n	$parentid = $_POST[\'data-parentid\'];\r\n\r\n	// Don\'t need these variables\r\n	unset($_POST[\'operation\']);\r\n	unset($_POST[\'data-myid\']);\r\n	unset($_POST[\'data-parentid\']);\r\n\r\n	if ($_POST[\'tag\']!=\'text\' && isset($_POST[\'text\']) && strlen($_POST[\'text\'])>0)\r\n	{\r\n		$new_text = array();\r\n		$new_text[\'tag\']=\'text\';\r\n		$new_text[\'text\']=$_POST[\'text\'];\r\n	\r\n		$qry = \'INSERT INTO \'.$table_dynamic.\' (content,parent,my_id,position) VALUES(?,?,?,10000)\';\r\n		$params = array(json_encode(array_filter($new_text)),$myid,md5(uniqid(rand(), TRUE)));\r\n		$result = query_execute($qry, $params);\r\n\r\n		unset($_POST[\'text\']);\r\n	}\r\n\r\n	$qry = \'INSERT INTO \'.$table_dynamic.\' (content,parent,my_id,position) VALUES(?,?,?,10000)\';\r\n	$params = array(json_encode(array_filter($_POST)),$parentid,$myid);\r\n	\r\n	// Execute the query with the query and parameters\r\n	$result = query_execute($qry, $params);\r\n	// Return a new unique ID for a new element\r\n	die(md5(uniqid(rand(), TRUE)));\r\n}\r\nelse if (isset($_POST[\'operation\']) && $_POST[\'operation\']==\'dbtoggle\')\r\n{\r\n	$content = getContentArray($_POST[\'myid\']);\r\n	if (!isset($content[\'class\'])) $content[\'class\'] = $_POST[\'toggle_class\'];\r\n	else if (stripos($content[\'class\'],$_POST[\'toggle_class\'])!==false)\r\n	{\r\n		$content[\'class\'] = trim(str_ireplace($_POST[\'toggle_class\'],\'\',$content[\'class\']));\r\n	}\r\n	else $content[\'class\'] .= \' \'.$_POST[\'toggle_class\'];\r\n\r\n	// Don\'t need these variables\r\n	unset($content[\'operation\']);\r\n	unset($content[\'data-myid\']);\r\n	unset($content[\'data-parentid\']);\r\n\r\n	// MySQL query with LIMIT to improve performance\r\n	$qry = \'UPDATE \'.$table_dynamic.\' SET content=? WHERE my_id=?\';\r\n	$params = array(json_encode(array_filter($content)),$_POST[\'myid\']);\r\n	$result = query_execute($qry, $params);\r\n\r\n	die($_POST[\'myid\']);\r\n}\r\nelse if (isset($_POST[\'operation\']) && $_POST[\'operation\']==\'dbradio\')\r\n{\r\n	$content = getContentArray($_POST[\'myid\']);\r\n	if (!isset($content[\'class\'])) $content[\'class\'] = $_POST[\'toggle_class\'];\r\n	else if (stripos($content[\'class\'],$_POST[\'toggle_class\'])!==false)\r\n	{\r\n		$content[\'class\'] = trim(str_ireplace($_POST[\'toggle_class\'],\'\',$content[\'class\']));\r\n	}\r\n	else\r\n	{\r\n		foreach($arr_bootstrap as $row)\r\n		{\r\n			if (stripos($row[\'class\'],$_POST[\'toggle_class\'])!==false)\r\n			{\r\n				$all = explode(\',\',$row[\'class\']);\r\n				foreach($all as $indiv)\r\n				{\r\n					$content[\'class\'] = trim(str_ireplace($indiv,\'\',$content[\'class\']));\r\n				}\r\n			}\r\n		}\r\n		$content[\'class\'] .= \' \'.$_POST[\'toggle_class\'];\r\n	}\r\n\r\n	// Don\'t need these variables\r\n	unset($content[\'operation\']);\r\n	unset($content[\'data-myid\']);\r\n	unset($content[\'data-parentid\']);\r\n\r\n	// MySQL query with LIMIT to improve performance\r\n	$qry = \'UPDATE \'.$table_dynamic.\' SET content=? WHERE my_id=?\';\r\n	$params = array(json_encode(array_filter($content)),$_POST[\'myid\']);\r\n	$result = query_execute($qry, $params);\r\n\r\n	die($_POST[\'myid\']);\r\n}\r\nelse if (isset($_POST[\'operation\']) && $_POST[\'operation\']==\'dbupdate\')\r\n{\r\n	// Remove these from the content array\r\n	$myid = $_POST[\'data-myid\'];\r\n	$parentid = $_POST[\'data-parentid\'];\r\n\r\n	// Don\'t need these variables\r\n	unset($_POST[\'operation\']);\r\n	unset($_POST[\'data-myid\']);\r\n	unset($_POST[\'data-parentid\']);\r\n\r\n	// MySQL query with LIMIT to improve performance\r\n	$qry = \'UPDATE \'.$table_dynamic.\' SET content=? WHERE my_id=?\';\r\n	\r\n	// Pass a variable via GET or POST\r\n	$params = array(json_encode(array_filter($_POST)),$myid);\r\n	\r\n	// Execute the query with the query and parameters\r\n	$result = query_execute($qry, $params);\r\n	die(\'saved\');\r\n}\r\nelse if (isset($_POST[\'operation\']) && $_POST[\'operation\']==\'testnest\')\r\n{\r\n	if (isAllowedDrop($_POST[\'myid\'],$_POST[\'droppedOnID\'])) die(\'true\');\r\n	else die(\'false\');\r\n}\r\nelse if (isset($_POST[\'operation\']) && $_POST[\'operation\']==\'testnest2\')\r\n{\r\n	$content = getContentArray($_POST[\'droppedOnParentID\']);\r\n\r\n	if (!isAllowedDrop($_POST[\'myid\'],$_POST[\'droppedOnID\'])\r\n		&& isAllowedDrop($_POST[\'myid\'],$_POST[\'droppedOnParentID\'])\r\n		&& $_POST[\'myparentid\'] == $content[\'data-parentid\']) die(\'true\');\r\n	else die(\'false\');\r\n}\r\nelse if (isset($_POST[\'operation\']) && $_POST[\'operation\']==\'reorder\')\r\n{\r\n	$pos1 = $_POST[\'droppedOnPosition\'];\r\n	$pos2 = $_POST[\'myposition\'];\r\n	if (isset($_POST[\'parentpos\']))\r\n	{\r\n		$result = query(\'SELECT position FROM \'.$table_dynamic.\' WHERE my_id=? LIMIT 1\', array($_POST[\'droppedOnParentID\']));\r\n		\r\n		if ($result) $pos1 = $result[0][\'position\'];\r\n	}\r\n\r\n	// If the brother is beside, just change places\r\n	if (abs($pos2-$pos1)==1)\r\n	{\r\n		// Update the position of the second element\r\n		$qry = \'UPDATE \'.$table_dynamic.\' SET position=? WHERE my_id=?\';\r\n		$params = array($pos2,$_POST[\'droppedOnID\']);\r\n		query_execute($qry, $params);\r\n	}\r\n\r\n	if (($pos2-$pos1)<0) $pos1+=.5;\r\n	else $pos1-=.5;\r\n\r\n	// Update the position of the first element\r\n	$qry = \'UPDATE \'.$table_dynamic.\' SET position=? WHERE my_id=?\';\r\n	$params = array($pos1,$_POST[\'myid\']);\r\n	query_execute($qry, $params);\r\n}\r\nelse if (isset($_POST[\'operation\']) && $_POST[\'operation\']==\'parentswap\')\r\n{\r\n	//die(print_array($_POST));\r\n	if (isAllowedDrop($_POST[\'myid\'],$_POST[\'droppedOnID\']))\r\n	{\r\n		$content = getContentArray($_POST[\'myid\']);\r\n		if (isset($content[\'data-parentid\'])) unset($content[\'data-parentid\']);\r\n		if (isset($content[\'data-myid\'])) unset($content[\'data-myid\']);\r\n\r\n		// Update the parent of the element\r\n		$qry = \'UPDATE \'.$table_dynamic.\' SET parent=?,position=?,content=? WHERE my_id=?\';\r\n		$params = array($_POST[\'droppedOnID\'],.5,json_encode($content),$_POST[\'myid\']);\r\n		query_execute($qry, $params);\r\n	}\r\n	else if (isAllowedDrop($_POST[\'myid\'],$_POST[\'droppedOnParentID\']))\r\n	{\r\n		$content = getContentArray($_POST[\'myid\']);\r\n		if (isset($content[\'data-parentid\'])) unset($content[\'data-parentid\']);\r\n		if (isset($content[\'data-myid\'])) unset($content[\'data-myid\']);\r\n\r\n		// Update the parent of the element\r\n		$qry = \'UPDATE \'.$table_dynamic.\' SET parent=?,position=?,content=? WHERE my_id=?\';\r\n		$params = array($_POST[\'droppedOnParentID\'],($_POST[\'droppedOnPosition\']-.5),json_encode($content),$_POST[\'myid\']);\r\n		query_execute($qry, $params);\r\n	}\r\n	die();\r\n}\r\nelse if (isset($_POST[\'operation\']) && $_POST[\'operation\']==\'stats\' && constant_test(\'SETTING_PHP_VARIABLES\',\'show\') && isGroupMember(1))\r\n{\r\n	// Output the SQL count and page load time\r\n	if (function_exists(\'PtimerStop\')) die(outputSQLCounter().PtimerStop());\r\n}\r\nelse if (isset($_POST[\'operation\']) && $_POST[\'operation\']==\'quick_parent\')\r\n{\r\n	$content = getContentArray($_POST[\'myid\']);\r\n	$content2 = getContentArray($content[\'data-parentid\']);\r\n	die($content2[\'tag\']);\r\n}\r\nelse if (isset($_POST[\'operation\']) && $_POST[\'operation\']==\'convert_code\')\r\n{\r\n	$a = substr_count($_POST[\'newcode\'],\'<\');\r\n	$b = substr_count($_POST[\'newcode\'],\'>\');\r\n	if ($a!=$b) die(\'HTML is invalid\');\r\n\r\n	$doc = new DOMDocument();\r\n	$doc->loadHTML($_POST[\'newcode\']);\r\n	\r\n	$all_elements = array();\r\n	function findThem($kids, $real_parentid, $trim=true)\r\n	{\r\n		global $all_elements;\r\n		$temp_position = 0;\r\n		$return_text = \'\';\r\n		foreach ($kids->childNodes as $node)\r\n		{\r\n			$element = array();\r\n	\r\n			// Determine if the node doesn\'t have any children so it should have text (hopefully)\r\n			$node_text = trim($node->nodeValue);\r\n			if (!$node->hasChildNodes() && strlen($node_text)>0)\r\n			{$trim=false;\r\n				if ($trim)\r\n				{\r\n					//$element[\'text\'] = str_replace(array(NEWLINE,\'	\'),array(\'\',\'\'),trim($node->nodeValue));\r\n					$element[\'text\'] = trim($node->nodeValue);\r\n				}\r\n				else $element[\'text\'] = $node->nodeValue;\r\n			}\r\n	\r\n			// Gather all the attributes\r\n			if ($node->hasAttributes())\r\n			{\r\n				// Gather all the hard attributes\r\n				foreach ($node->attributes as $attr)\r\n				{\r\n					$name = $attr->nodeName;\r\n					$value = $attr->nodeValue;\r\n					$element[$name] = $value;\r\n				}\r\n			}\r\n	\r\n			//if ($node->hasAttributes() || trim($node->nodeValue)>0 || $node->hasChildNodes() || isset($element[\'text\']))\r\n			if (strlen($node_text)>0 || $node->hasAttributes() || $node->nodeName==\'br\')\r\n			{\r\n				// Set the required attributes\r\n				$element[\'tag\'] = trim($node->nodeName,\'#\');\r\n		\r\n				// If MYID doesn\'t exist, create one\r\n				if (!$node->hasAttributes() || !$node->hasAttribute(\'data-myid\')) $element[\'data-myid\'] = md5(uniqid(rand(), TRUE));\r\n		\r\n				// Ensure the PARENTID is correct\r\n				//if (!$node->hasAttribute(\'data-parentid\')) $element[\'data-parentid\'] = $real_parentid;\r\n				$element[\'data-parentid\'] = $real_parentid;\r\n	\r\n				// Ensure the POSITION is correct\r\n				//if (!$node->hasAttribute(\'data-position\')) $element[\'data-position\'] = $temp_position;\r\n				$element[\'data-position\'] = $temp_position;\r\n				$temp_position+=1;\r\n			}\r\n	\r\n			// If the node has children (including just text), get them\r\n			if ($node->hasChildNodes())\r\n			{\r\n				if (!isset($element[\'data-myid\'])) $my_temp_id = $real_parentid;\r\n				else $my_temp_id = $element[\'data-myid\'];\r\n	\r\n				// Grab the text\r\n				//$text_return = \r\n				findThem($node, $my_temp_id,($element[\'tag\']!=\'pre\' && $element[\'tag\']!=\'textarea\'));\r\n				//if (strlen(trim($text_return))>0) $element[\'text\']=$text_return;\r\n			}\r\n			// If the array has stuff in it, save it\r\n			if (!empty($element)) array_push($all_elements, $element);\r\n		}\r\n			if ($return_text != \'\') return $return_text;\r\n	}\r\n	\r\n	$root = $doc->documentElement;\r\n	findThem($root->firstChild,\'root\');\r\n	\r\n	query_execute(\"DELETE FROM $table_dynamic\", array());\r\n	\r\n	foreach ($all_elements as $row)\r\n	{\r\n		// Remove these from the content array\r\n		$myid = $row[\'data-myid\'];\r\n		$parentid = $row[\'data-parentid\'];\r\n		$position = $row[\'data-position\'];\r\n	\r\n		// Don\'t need these variables\r\n		unset($row[\'operation\']);\r\n		unset($row[\'data-myid\']);\r\n		unset($row[\'data-parentid\']);\r\n		unset($row[\'data-position\']);\r\n	\r\n		$qry = \'INSERT INTO \'.$table_dynamic.\' (content,parent,my_id,position) VALUES(?,?,?,?)\';\r\n		$params = array(json_encode(array_filter($row)),$parentid,$myid,$position);\r\n		\r\n		// Execute the query with the query and parameters\r\n		$result = query_execute($qry, $params);\r\n	}\r\ndie(\'HTML parsed and database updated\');\r\n}\r\nelse if (isset($_POST[\'operation\']) && $_POST[\'operation\']==\'reduce_position\')\r\n{\r\n	// Update the position of the element\r\n	$qry = \'UPDATE \'.$table_dynamic.\' SET position=position-1.5 WHERE my_id=?\';\r\n	$params = array($_POST[\'myid\']);\r\n	$result = query_execute($qry, $params);\r\ndie($result);\r\n}\r\nelse if (isset($_POST[\'operation\']) && $_POST[\'operation\']==\'advance_position\')\r\n{\r\n	// Update the position of the element\r\n	$qry = \'UPDATE \'.$table_dynamic.\' SET position=position+1.5 WHERE my_id=?\';\r\n	$params = array($_POST[\'myid\']);\r\n	query_execute($qry, $params);\r\n}\r\nelse\r\n{\r\n	//die(\'<p class=\"dynamic-markup\">***** End of Dynamic Page *****</p>\');\r\n	die(\'\');\r\n}\r\n}','Dynamic HTML','',''),(330,'page_dynamic_demo','dyn_demo','2012-07-09 08:06:30',2,10,'','Dynamic Demo','',''),(228,'page_not_found','<table width=\"100%\" height=\"100%\">\r\n<tr>\r\n<td align=\"center\" valign=\"middle\" style=\"padding: 50px;\">\r\nThe page you seek is <?=random_phrase()?>unavailable.<br/>\r\nPlease travel back to the last place you <a href=\"javascript: history.go(-1)\">visited</a> or return to the <a href=\"/\">home page</a>.\r\n</td>\r\n</tr>\r\n</table>','2012-06-17 05:58:05',2,0,'','Page Not Found','',''),(230,'misc_php_info','die(phpinfo());','2012-05-05 18:34:09',2,1,'','','',''),(231,'toolkit_update_sitemap','if (file_exists(\'sitemap.xml\')) $text = file_get_contents(\'sitemap.xml\');\r\nelse $text = \'\';\r\n\r\npreg_match_all(\'/\'.RECORDED_DOMAIN.\'\\/([^<]+)<\\/loc>/\',$text,$matches);\r\n\r\n$current_site_pages = array();\r\n\r\nif (isset($matches[1]))\r\n{\r\n	foreach($matches[1] as $match) $current_site_pages[] = $match;\r\n}\r\n\r\n// Show all the methods not in the Trash\r\n$arr = db_method_list();\r\n$list = \'\';\r\n$counter = 0;\r\n\r\nforeach($arr as $element)\r\n{\r\n	$name = $element[\'name\'];\r\n	$id = $element[\'id\'];\r\n	//$mysql_time = date(\'Y-m-d H:i:s\', $element[\'modified\']);\r\n	$mod = strtotime($element[\'modified\']);\r\n\r\n	$qry = \"SELECT id FROM access_list WHERE method_id=? AND group_id=? LIMIT 1\";\r\n	$params = array($id,3);\r\n	$result = query($qry, $params);\r\n\r\n	if (count($result)==1)\r\n	{\r\n		if (in_array($name, $current_site_pages))$checked = \'checked=\"checked\"\';\r\n		else $checked=\'\';\r\n		$list .= \'<input type=\"checkbox\" name=\"\'.$name.\'\" value=\"\'.$mod.\'\" \'.$checked.\' /> \'.$name.br();\r\n		$counter+=1;\r\n	}\r\n}\r\n\r\n//$output .= br().br().\"Publically Available Pages (\".$counter.\"):\";\r\n\r\n$output .= <<< OUTPUT\r\n\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n<h3>Update Sitemap.xml</h3><br />\r\n{$list}\r\n<div class=\"clear\"></div><br />\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to update sitemap\">Update</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n\r\nOUTPUT;\r\n\r\n//Need this','2012-07-17 22:50:26',2,1,'// Add all the pages\r\n$arr_page = array();\r\n$arr_page[] = array(SITE_FULL,false);\r\n\r\n// Loop through all the checkboxes\r\nif (isset($_POST))\r\n{\r\n	foreach($_POST as $key=>$val)\r\n	{\r\n		if ($key!=\"submit\") array_push($arr_page, array(SITE_FULL.\'/\'.$key, $val));\r\n	}\r\n}\r\n\r\n// Set the current date and frequency\r\n$change_freq = array(\'always\',\'hourly\',\'daily\',\'weekly\',\'monthly\',\'yearly\',\'never\');\r\n\r\n// Output the sitemap\r\n$output2 = <<< OUTPUT\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<urlset\r\n      xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\"\r\n      xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\r\n      xsi:schemaLocation=\"http://www.sitemaps.org/schemas/sitemap/0.9\r\n            http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd\">\r\nOUTPUT;\r\n\r\nforeach ($arr_page as $page)\r\n{\r\n//$date_updated = date_format(date_create(), \'Y-m-d\\TH:i:s\').\'Z\';\r\n//$date_updated = date_format(date_create($page[1]), \'Y-m-d\\TH:i:s\').\'Z\';\r\nif (!$page[1]) $date_updated = date_format(date_create(), \'Y-m-d\\TH:i:s\').\'Z\';\r\nelse $date_updated = date(\'Y-m-d\\TH:i:s\',(int)$page[1]).\'Z\';\r\n\r\n$output2 .= NEWLINE;\r\n$output2 .= <<< OUTPUT\r\n<url>\r\n  <loc>{$page[0]}</loc>\r\n  <lastmod>{$date_updated}</lastmod>\r\n  <changefreq>{$change_freq[2]}</changefreq>\r\n</url>\r\nOUTPUT;\r\n}\r\n\r\n$output2 .= NEWLINE.\"</urlset>\";\r\n\r\n//$output .= \'<pre>\';\r\n//$output .= htmlentities($output2, ENT_QUOTES, \"UTF-8\");\r\n//$output .= \'</pre>\';\r\n\r\n$result = file_put_contents(\'sitemap.xml\',$output2);\r\n\r\nif ($result) msg_user(\"Sitemap.xml Update\",\"Sitemap was updated successfully for \".count($arr_page).\" page(s).\");\r\nelse msg_user(\"Sitemap.xml Update\",\"Sitemap was NOT updated successfully.\");','Sitemap Generator','',''),(272,'toolkit_security_manager','// ********************************************* User Options *********************************************\r\nif (isset($_GET[\'user_info\']))\r\n{\r\n	$return=a(\'Back to security manager\',\'toolkit_security_manager\').br().br();\r\n\r\n	$qry = \'SELECT username,\r\n	password,\r\n	email,\r\n	first_login,\r\n	last_login,\r\n	total_login,\r\n	modified,\r\n	modifier,\r\n	created,\r\n	creator FROM access_user WHERE id=? LIMIT 1\';\r\n	$params = array($_GET[\'user_info\']);\r\n	$result = query($qry, $params);\r\n\r\n	function pretty_date($val)\r\n	{\r\n		if ($val==\'0000-00-00 00:00:00\') return \'Never logged in\';\r\n		$cdate = new DateTime($val);\r\n		date_timezone_set($cdate, timezone_open(\'US/Eastern\'));\r\n		return date_format($cdate, \'M d, Y \\a\\t h:i A\');\r\n	}\r\n	function get_user($val)\r\n	{\r\n		$qry = \"SELECT username FROM access_user WHERE id=? LIMIT 1\";\r\n		$params = array($val);\r\n		$result = query($qry, $params);\r\n		if (count($result)==1) return $result[0][\'username\'];\r\n		else return \'Unknown user\';\r\n	}\r\n\r\n	if (isset($_GET[\'user_delete\']))\r\n	{\r\n		$return .= <<< OUTPUT\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n		<h3>Delete User</h3>\r\n		<label>Username:</label><input class=\"span12\" type=\"text\" id=\"user\" name=\"user\" readonly=\"readonly\" value=\"{$_GET[\'user_name\']}\" />\r\n		<input class=\"span12\" type=\"hidden\" id=\"user_id\" name=\"user_id\" value=\"{$_GET[\'user_delete\']}\" />\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to delete\">Delete</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\nOUTPUT;\r\n	}\r\n	else if (isset($_GET[\'remove_member\']))\r\n	{\r\n		$qry = \"DELETE FROM access_membership WHERE group_id=? AND user_id=?\";\r\n		$params = array($_GET[\'remove_member\'],$_GET[\'user_info\']);\r\n		$result2 = query_execute($qry, $params);\r\n		if ($result2) msg_user(\"User Removed from Group\",$result[0][\'username\'].\" is no longer a member of the group, \".$_GET[\'member_name\'],\"index.php?toolkit_security_manager&user_info=\".$_GET[\'user_info\']);\r\n		else msg_user(\"User Problem\",$result[0][\'username\'].\" could not be removed as a member of the group, \".$_GET[\'member_name\'],\"index.php?toolkit_security_manager&user_info=\".$_GET[\'user_info\']);\r\n	}\r\n	else if (isset($_GET[\'add_member\']))\r\n	{\r\n		$qry = \"INSERT INTO access_membership (user_id,group_id,modified,modifier) VALUES(?,?,?,CURRENT_TIMESTAMP)\";\r\n		$params = array($_GET[\'user_info\'], $_GET[\'add_member\'], $_SESSION[\'id\']);\r\n		$result2 = query_execute($qry, $params);\r\n		if ($result2) msg_user(\"User Added to Group\",$result[0][\'username\'].\" is now a member of the group, \".$_GET[\'member_name\'],\"index.php?toolkit_security_manager&user_info=\".$_GET[\'user_info\']);\r\n		else msg_user(\"User Problem\",$result[0][\'username\'].\" could not be added as a member of the group, \".$_GET[\'member_name\'],\"index.php?toolkit_security_manager&user_info=\".$_GET[\'user_info\']);\r\n	}\r\n	else if (isset($_GET[\'user_edit\']))\r\n	{\r\n		$return .= <<< OUTPUT\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n		<h3>Edit User</h3>\r\n		<label>Username:</label><input class=\"span12\" type=\"text\" id=\"user\" name=\"user\" value=\"{$result[0][\'username\']}\" />\r\n		<label>Old Password:</label><input class=\"span12\" type=\"password\" id=\"pass\" name=\"pass\" readonly=\"readonly\" value=\"{$result[0][\'password\']}\" />\r\n		<label>New Password:</label><input class=\"span12\" type=\"password\" id=\"pass_new\" name=\"pass_new\" value=\"{$result[0][\'password\']}\" />\r\n		<label>Email:</label><input class=\"span12\" type=\"text\" id=\"email\" name=\"email\" value=\"{$result[0][\'email\']}\" />\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to update\">Update</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n\r\n		<script>document.getElementById(\"user\").focus();</script>\r\nOUTPUT;\r\n	}\r\n\r\n	$return.=\'<b>Manage User:</b> \'.$result[0][\'username\'].br();\r\n	$return.=\'<b>Email:</b> \'.$result[0][\'email\'].br().br();\r\n\r\n	$return.=a(img(\'Edit User\',\'/img/silk/user_edit.png\'),\'toolkit_security_manager&user_info=\'.$_GET[\'user_info\'].\'&user_edit=\'.$_GET[\'user_info\'].\'&user_name=\'.$result[0][\'username\']).\' \';\r\n	$return.=a(img(\'User Information\',\'/img/silk/user_comment.png\'),\'toolkit_security_manager&user_info=\'.$_GET[\'user_info\'].\'&user_comment=\'.$_GET[\'user_info\'].\'&user_name=\'.$result[0][\'username\']).\' \';\r\n	$return.=a(img(\'Delete User\',\'/img/silk/user_delete.png\'),\'toolkit_security_manager&user_info=\'.$_GET[\'user_info\'].\'&user_delete=\'.$_GET[\'user_info\'].\'&user_name=\'.$result[0][\'username\']).\' \';\r\n	$return.=br();\r\n\r\n	if (isset($_GET[\'user_comment\']))\r\n	{\r\n		$return .= br();\r\n		$return.=\'<b>Total Logins:</b> \'.$result[0][\'total_login\'].br();\r\n	\r\n		$return.=\'<b>First Login:</b> \'.pretty_date($result[0][\'first_login\']).br();\r\n		$return.=\'<b>Last Login:</b> \'.pretty_date($result[0][\'last_login\']).br();\r\n		$return.=\'<b>Modified:</b> \'.pretty_date($result[0][\'modified\']).br();\r\n		$return.=\'<b>Modifier:</b> \'.get_user($result[0][\'modifier\']).br();\r\n		$return.=\'<b>Created:</b> \'.pretty_date($result[0][\'created\']).br();\r\n		$return.=\'<b>Creator:</b> \'.get_user($result[0][\'creator\']).br();\r\n	}\r\n\r\n	$qry = \"SELECT access_group.name, access_group.id, access_group.description FROM access_group\r\n		INNER JOIN access_membership WHERE access_membership.group_id=access_group.id AND\r\n		access_membership.user_id=?\";\r\n\r\n	$params = array($_GET[\'user_info\']);\r\n	$result = query($qry, $params);\r\n\r\n	$is_Admin = false;\r\n	$access_list = array();\r\n\r\n	$member_groups=br().\'<b>This user is a member of the following groups (\'.count($result).\'):</b>\'.br();\r\n	if (count($result)==0) $member_groups .= \'None of them\'.br();\r\n	$result3 = $result;\r\n	foreach($result as $row)\r\n	{\r\n		$member_groups.=a(img(\'Remove from Group\',\'/img/silk/delete.png\'),\'toolkit_security_manager&user_info=\'.$_GET[\'user_info\'].\'&remove_member=\'.$row[\'id\'].\'&member_name=\'.$row[\'name\']).\' \';\r\n		$member_groups.=a(img(\'Manage Group\',\'/img/silk/group_key.png\'),\'toolkit_security_manager&access_group_manage=\'.$row[\'id\'].\'&name=\'.$row[\'name\']).\' \';\r\n		$member_groups.=$row[\'name\'].\' - \'.$row[\'description\'].br();\r\n\r\n		if ($row[\'name\']==\'Administrators\') $is_Admin=true;\r\n		else if (!$is_Admin)\r\n		{\r\n			$qry = \"SELECT php_methods.name FROM php_methods\r\n			INNER JOIN access_list WHERE access_list.method_id = php_methods.id AND \r\n			access_list.group_id=?\";\r\n		\r\n			$params = array($row[\'id\']);\r\n			$result2 = query($qry, $params);\r\n\r\n			foreach($result2 as $row2) $access_list[$row2[\'name\']]=$row[\'name\'];\r\n		}\r\n	}\r\n\r\n	$member_pages = br().\'<b>This user has access to the following pages (\'.count($access_list).\'):</b>\'.br();\r\n	if ($is_Admin) $member_pages .= \'Everything\'.br();\r\n	else if (count($access_list)==0) $member_pages .= \'None of them\'.br();\r\n	else\r\n	{\r\n		foreach($access_list as $key=>$val) $member_pages.=$key.\' (\'.$val.\')\'.br();\r\n	}\r\n\r\n	$result = query(\"SELECT name, id, description FROM access_group\", array());\r\n	$available_groups = br().\'<b>Available groups (\'.(count($result)-count($result3)-2).\'):</b>\'.br();\r\n	foreach ($result as $row)\r\n	{\r\n		$found = false;\r\n		foreach($result3 as $row2)\r\n		{\r\n			if ($row2[\'id\']==$row[\'id\']) $found = true;\r\n		}\r\n		if (!$found && $row[\'name\']!=\'Authenticated\' && $row[\'name\']!=\'Anonymous\')\r\n		{\r\n			$available_groups.=a(img(\'Add to Group\',\'/img/silk/add.png\'),\'toolkit_security_manager&user_info=\'.$_GET[\'user_info\'].\'&add_member=\'.$row[\'id\'].\'&member_name=\'.$row[\'name\']).\' \';\r\n			$available_groups.=a(img(\'Manage Group\',\'/img/silk/group_key.png\'),\'toolkit_security_manager&access_group_manage=\'.$row[\'id\'].\'&name=\'.$row[\'name\']).\' \';\r\n			$available_groups.=$row[\'name\'].\' - \'.$row[\'description\'].br();\r\n		}\r\n	}\r\n\r\n\r\n	$output.=$return;\r\n	$output.=$member_pages;\r\n	$output.=$member_groups;\r\n	$output.=$available_groups;\r\n	return;\r\n}\r\n// ********************************************* Group Options *********************************************\r\nelse if (isset($_GET[\'access_group_manage\']) && $_GET[\'access_group_manage\']>0)\r\n{\r\n	$return=a(\'Back to security manager\',\'toolkit_security_manager\').br().br();\r\n	// If the user has been added and passed via GET\r\n	if (isset($_GET[\'adduser\']) && $_GET[\'adduser\']>0)\r\n	{\r\n		// Determine if the user is already a member of the group\r\n		$qry = \"SELECT access_membership.id, access_user.username FROM access_membership\r\n				INNER JOIN access_user WHERE group_id=? AND user_id=? AND\r\n				user_id=access_user.id LIMIT 1\";\r\n		$params = array($_GET[\'access_group_manage\'],$_GET[\'adduser\']);\r\n		$result = query($qry, $params);\r\n\r\n		$qry = \"SELECT username FROM access_user WHERE id=? LIMIT 1\";\r\n		$params = array($_GET[\'adduser\']);\r\n		$result2 = query($qry, $params);\r\n		if (count($result2)==1) $user = $result2[0][\'username\'];\r\n		else $user = \'User\';\r\n\r\n		// If the user is already a member of the group\r\n		if (count($result)==1)\r\n		{\r\n			$user = $result[0][\'username\'];\r\n			msg_user(\"No Change\",\"$user is already a member of the group, \",\"index.php?toolkit_security_manager&access_group_manage=\".$_GET[\'access_group_manage\']);\r\n			return;\r\n		}\r\n		//Else the user is not a member of the group so add\r\n		else\r\n		{\r\n			$qry = \"INSERT INTO access_membership (user_id,group_id,modified,modifier)\r\n				VALUES(?,?,CURRENT_TIMESTAMP,?)\";\r\n			$params = array($_GET[\'adduser\'],$_GET[\'access_group_manage\'],$_SESSION[\'id\']);\r\n			$result = query_execute($qry, $params);\r\n			if ($result) msg_user(\"User Added to Group\",\"$user is now a member of the group\",\"index.php?toolkit_security_manager&access_group_manage=\".$_GET[\'access_group_manage\']);\r\n			else msg_user(\"User Problem\",\"$user could not be made a member of the group\",\"index.php?toolkit_security_manager&access_group_manage=\".$_GET[\'access_group_manage\']);\r\n			return;\r\n		}\r\n	}\r\n	// If the user has been removed and passed via GET\r\n	else if (isset($_GET[\'deluser\']) && $_GET[\'deluser\']>0)\r\n	{\r\n		// Determine if the user is already a member of the group\r\n		$qry = \"SELECT access_membership.id, access_user.username FROM access_membership\r\n				INNER JOIN access_user WHERE group_id=? AND user_id=? AND\r\n				user_id=access_user.id LIMIT 1\";\r\n		$params = array($_GET[\'access_group_manage\'],$_GET[\'deluser\']);\r\n		$result = query($qry, $params);\r\n\r\n		$qry = \"SELECT username FROM access_user WHERE id=? LIMIT 1\";\r\n		$params = array($_GET[\'deluser\']);\r\n		$result2 = query($qry, $params);\r\n		if (count($result2)==1) $user = $result2[0][\'username\'];\r\n		else $user = \'User\';\r\n\r\n		// If the user is already a member of the group\r\n		if (count($result)!=1)\r\n		{\r\n			msg_user(\"No Change\",\"$user is not a member of the group\",\"index.php?toolkit_security_manager&access_group_manage=\".$_GET[\'access_group_manage\']);\r\n			//return;\r\n		}\r\n		//Else the user is not a member of the group so add\r\n		else\r\n		{\r\n			$qry = \"DELETE FROM access_membership WHERE group_id=? AND user_id=?\";\r\n			$params = array($_GET[\'access_group_manage\'],$_GET[\'deluser\']);\r\n			$result = query_execute($qry, $params);\r\n			if ($result) msg_user(\"User Removed from Group\",\"$user is no longer a member of the group\",\"index.php?toolkit_security_manager&access_group_manage=\".$_GET[\'access_group_manage\']);\r\n			else msg_user(\"User Problem\",\"$user could not be removed as a member of the group\",\"index.php?toolkit_security_manager&access_group_manage=\".$_GET[\'access_group_manage\']);\r\n			//return;\r\n		}\r\n	}\r\n	// If the user has been added and passed via GET\r\n	else if (isset($_GET[\'addmethod\']) && $_GET[\'addmethod\']>0)\r\n	{\r\n		$qry = \"SELECT name FROM access_group WHERE id=? LIMIT 1\";\r\n		$params = array($_GET[\'access_group_manage\']);\r\n		$result = query($qry, $params);\r\n		if (count($result)==1) $group_name = $result[0][\'name\'];\r\n		else $group_name = \'Group\';\r\n\r\n		$qry = \"SELECT id FROM access_list WHERE method_id=? AND group_id=?\";\r\n		$params = array($_GET[\'addmethod\'],$_GET[\'access_group_manage\']);\r\n		$result = query($qry, $params);\r\n		if (count($result)>0)\r\n		{\r\n			msg_user(\"Access Change Skipped\",\"$group_name already has access to: \".$_GET[\'name\'],\"index.php?toolkit_security_manager&access_group_manage=\".$_GET[\'access_group_manage\']);\r\n			//return;\r\n		}\r\n		else\r\n		{\r\n			$qry = \"INSERT INTO access_list(method_id,group_id,modified,modifier) VALUES(?,?,CURRENT_TIMESTAMP,?)\";\r\n			$params = array($_GET[\'addmethod\'],$_GET[\'access_group_manage\'],$_SESSION[\'id\']);\r\n			$result = query_execute($qry, $params);\r\n			if ($result) msg_user(\"Access Granted\",\"$group_name can now access: \".$_GET[\'name\'],\"index.php?toolkit_security_manager&access_group_manage=\".$_GET[\'access_group_manage\']);\r\n			else msg_user(\"Access Problem\",\"$group_name could not be added to the access list for: \".$_GET[\'name\'],\"index.php?toolkit_security_manager&access_group_manage=\".$_GET[\'access_group_manage\']);\r\n			//return;\r\n		}\r\n	}\r\n	// If the user has been added and passed via GET\r\n	else if (isset($_GET[\'delmethod\']) && $_GET[\'delmethod\']>0)\r\n	{\r\n		$qry = \"SELECT name FROM access_group WHERE id=? LIMIT 1\";\r\n		$params = array($_GET[\'access_group_manage\']);\r\n		$result = query($qry, $params);\r\n		if (count($result)==1) $group_name = $result[0][\'name\'];\r\n		else $group_name = \'Group\';\r\n\r\n		$qry = \"DELETE FROM access_list WHERE method_id=? AND group_id=? LIMIT 1\";\r\n		$params = array($_GET[\'delmethod\'],$_GET[\'access_group_manage\']);\r\n		$result = query_execute($qry, $params);\r\n		if ($result) msg_user(\"Access Removed\",\"$group_name can no longer access: \".$_GET[\'name\'],\"index.php?toolkit_security_manager&access_group_manage=\".$_GET[\'access_group_manage\']);\r\n		else msg_user(\"Access Problem\",\"$group_name could not be removed from the access list for: \".$_GET[\'name\'],\"index.php?toolkit_security_manager&access_group_manage=\".$_GET[\'access_group_manage\']);\r\n		//return;\r\n	}\r\n	// ********************************************* Group Delete *********************************************\r\n	else if (isset($_GET[\'group_delete\']))\r\n	{\r\n		$return .= <<< OUTPUT\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n		<h3>Delete Group</h3>\r\n		<label>Group:</label><input class=\"span12\" type=\"text\" id=\"group\" name=\"group\" readonly=\"readonly\" value=\"{$_GET[\'name\']}\" />\r\n		<input type=\"hidden\" id=\"group_id\" name=\"group_id\" value=\"{$_GET[\'group_delete\']}\" />\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to delete\">Delete</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n	\r\nOUTPUT;\r\n	}\r\n	else if (isset($_GET[\'group_edit\']))\r\n	{\r\n		$return .= <<< OUTPUT\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n		<h3>Edit Group</h3>\r\n		<label>Group Name:</label><input class=\"span12\" type=\"text\" id=\"name\" name=\"name\" value=\"{$_GET[\'name\']}\" />\r\n		<label>Description:</label><input class=\"span12\" type=\"text\" id=\"description\" name=\"description\" value=\"{$_GET[\'description\']}\" />\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to update\">Update</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n		\r\n		<script>document.getElementById(\"name\").focus();</script>\r\n	\r\nOUTPUT;\r\n	}\r\n\r\n	$qry = \"SELECT id,name,description FROM access_group WHERE id=?\";\r\n	$params = array($_GET[\'access_group_manage\']);\r\n	$result = query($qry, $params);\r\n\r\n	if (count($result)!=1) { header(\"Location: index.php?toolkit_security_manager&access_group_manage\"); return; }\r\n	\r\n	$group_name = $result[0][\'name\'];\r\n\r\n	$return.=\'<b>Manage Group:</b> \'.$result[0][\'name\'].br().\'<b>Description:</b> \'.$result[0][\'description\'].br();\r\n	if ($group_name != \'Administrators\' && $group_name != \'Authenticated\' && $group_name != \'Anonymous\')\r\n	{\r\n		$return .= br();\r\n		$return .= a(img(\'Edit Group\',\'/img/silk/group_edit.png\'),\'toolkit_security_manager&access_group_manage=\'.$_GET[\'access_group_manage\'].\'&group_edit=\'.$result[0][\'id\'].\'&name=\'.$result[0][\'name\'].\'&description=\'.$result[0][\'description\']).\' \';\r\n		$return .= a(img(\'Delete Group\',\'/img/silk/group_delete.png\'),\'toolkit_security_manager&access_group_manage=\'.$_GET[\'access_group_manage\'].\'&group_delete=\'.$result[0][\'id\'].\'&name=\'.$result[0][\'name\']).\' \';\r\n		$return .= br();\r\n	}\r\n\r\n	// ********************* Member Users *********************\r\n	$member_users=\'\';\r\n	// Get all member users\r\n	$qry = \"SELECT user_id, access_user.username FROM access_membership INNER JOIN access_user WHERE group_id=? AND access_membership.user_id=access_user.id ORDER BY access_user.username ASC\";\r\n	$params = array($_GET[\'access_group_manage\']);\r\n	$result = query($qry, $params);\r\n	\r\n	$member_users .=\'<br /><b>This group has the following members (\'.count($result).\'):</b>\'.br();\r\n	if (count($result)>10) $member_users .=\'<div class=\"three_col\">\';\r\n	if (count($result)>0)\r\n	{	\r\n		foreach($result as $row)\r\n		{\r\n			// Output the id and name from SQL\r\n			$member_users.=a(img(\'Remove member\',\'/img/silk/delete.png\'),\'toolkit_security_manager&access_group_manage=\'.$_GET[\'access_group_manage\'].\'&deluser=\'.$row[\'user_id\']).\' \';\r\n			$member_users.=a(img(\'Edit User\',\'/img/silk/user_edit.png\'),\'toolkit_security_manager&user_info=\'.$row[\'user_id\']).\' \';\r\n			$member_users.=$row[\'username\'].br();\r\n		}\r\n	}\r\n	else if($group_name==\'Anonymous\') $member_users .=\'Anyone without a login for this website\'.br();\r\n	else if($group_name==\'Authenticated\') $member_users .=\'Anyone with a login for this website\'.br();\r\n	else $member_users .=\'None\'.br();\r\n	if (count($result)>10) $member_users .=\'</div>\';\r\n\r\n	// ********************* Available Users *********************\r\n	$available_users=\'\';\r\n	if ($group_name!=\'Anonymous\' && $group_name!=\'Authenticated\')\r\n	{	\r\n		$qry = \"SELECT id,username FROM access_user ORDER BY username ASC\";\r\n		$params = array();\r\n		$result2 = query($qry, $params);\r\n\r\n		if ((count($result2)-count($result))!=0)\r\n		{\r\n			$available_users .=br().\'<b>Available users (\'.(count($result2)-count($result)).\'):</b>\'.br();\r\n			if ((count($result2)-count($result))>10) $available_users .=\'<div class=\"three_col\">\';\r\n		}\r\n		\r\n		foreach($result2 as $row)\r\n		{\r\n			$found = false;\r\n			foreach($result as $row2)\r\n			{\r\n				if ($row[\'username\']==$row2[\'username\']) $found = true;\r\n			}\r\n			if (!$found)\r\n			{\r\n				// Output the id and name from SQL\r\n				//$return.=\'<br />\'.$row[\'username\'].\' <a href=\"index.php?toolkit_security_manager&access_group_manage=\'.$_GET[\'access_group_manage\'].\'&adduser=\'.$row[\'id\'].\'\">add</a>\';\r\n				$available_users.=a(img(\'Add member\',\'/img/silk/add.png\'),\'toolkit_security_manager&access_group_manage=\'.$_GET[\'access_group_manage\'].\'&adduser=\'.$row[\'id\']).\' \';\r\n				$available_users.=a(img(\'Edit User\',\'/img/silk/user_edit.png\'),\'toolkit_security_manager&user_info=\'.$row[\'id\']).\' \';\r\n				$available_users.=$row[\'username\'].br();\r\n			}\r\n		}\r\n		if ((count($result2)-count($result))>10) $available_users .=\'</div>\';\r\n	}\r\n\r\n	// ********************* Member Pages *********************\r\n	$member_pages=\'\';\r\n	$qry = \"SELECT php_methods.name, php_methods.id FROM php_methods\r\n	INNER JOIN access_list WHERE access_list.method_id = php_methods.id AND \r\n	access_list.group_id=?\";\r\n	$params = array($_GET[\'access_group_manage\']);\r\n	$result2 = query($qry, $params);\r\n\r\n	if ($_GET[\'access_group_manage\']==1)\r\n	{\r\n		$member_pages .= br().\'<b>This group has access to the following pages:</b>\'.br();\r\n		if (count($result2)>10) $member_pages .=\'<div class=\"three_col\">\';\r\n		$member_pages .= \'All of them\'.br();\r\n	}\r\n	else if (count($result2)==0)\r\n	{\r\n		$member_pages .= br().\'<b>This group has access to the following pages (0):</b>\'.br();\r\n		if (count($result2)>10) $member_pages .=\'<div class=\"three_col\">\';\r\n		$member_pages .= \'None of them\'.br();\r\n	}\r\n	else\r\n	{\r\n		$member_pages .= br().\'<b>This group has access to the following pages (\'.count($result2).\'):</b>\'.br();\r\n		if (count($result2)>10) $member_pages .=\'<div class=\"three_col\">\';\r\n		foreach($result2 as $row2)\r\n		{\r\n			$member_pages .= a(img(\'Remove access\',\'/img/silk/delete.png\'),\'toolkit_security_manager&access_group_manage=\'.$_GET[\'access_group_manage\'].\'&delmethod=\'.$row2[\'id\'].\'&name=\'.$row2[\'name\']).\' \';\r\n			$member_pages .= a(img(\'Manage Page\',\'/img/silk/group_key.png\'),\'toolkit_security_manager&access_list_manage=\'.$row2[\'id\']).\' \';\r\n			$member_pages .= $row2[\'name\'].br();\r\n		}\r\n	}\r\n	if (count($result2)>10) $member_pages .=\'</div>\';\r\n\r\n	// ********************* Available Pages *********************\r\n	$available_pages=\'\';\r\n	if ($_GET[\'access_group_manage\']!=1)\r\n	{\r\n		$qry = \"SELECT name,id FROM php_methods ORDER by name\";\r\n		$params = array();\r\n		$result3 = query($qry, $params);\r\n\r\n\r\n$page_count = 0;\r\n$available_pages_inner=\'\';\r\n		if ($_GET[\'access_group_manage\']==1) $available_pages_inner .= \'Everything\';\r\n		else foreach($result3 as $row2)\r\n		{\r\n			$found=false;\r\n			foreach($result2 as $row)\r\n			{\r\n				if ($row2[\'name\']==$row[\'name\']) $found = true;\r\n			}\r\n			$name = $row2[\'name\'];\r\n			if (!$found)\r\n			{\r\n				if (strpos($name,\'cms_\')===0) {}\r\n				else if (strpos($name,\'hlp_\')===0) {}\r\n				else if (strpos($name,\'db_\')===0) {}\r\n				else if (strpos($name,\'delete_\')===0) {}\r\n				else if (strpos($name,\'style_\')===0) {}\r\n				else if (strpos($name,\'script_\')===0) {}\r\n				else if (strpos($name,\'div_\')===0) {}\r\n				else if (strpos($name,\'html_\')===0) {}\r\n				else\r\n				{$page_count+=1;\r\n					$available_pages_inner .= a(img(\'Add access\',\'/img/silk/add.png\'),\'toolkit_security_manager&access_group_manage=\'.$_GET[\'access_group_manage\'].\'&addmethod=\'.$row2[\'id\'].\'&name=\'.$row2[\'name\']).\' \';\r\n					$available_pages_inner .= a(img(\'Manage Page\',\'/img/silk/group_key.png\'),\'toolkit_security_manager&access_list_manage=\'.$row2[\'id\']).\' \';\r\n					$available_pages_inner .= $row2[\'name\'].br();\r\n				}\r\n			}\r\n		}\r\n		$available_pages .= br().\'<b>Available pages (\'.$page_count.\'):</b>\'.br();\r\n		if ($page_count>10) $available_pages .=\'<div class=\"three_col\">\';\r\n		$available_pages .= $available_pages_inner;\r\n		if ($page_count>10) $available_pages .= \'</div>\';\r\n	}\r\n\r\n	$output .= $return;\r\n	$output .= $member_users;\r\n	$output .= $member_pages;\r\n	$output .= $available_users;\r\n	$output .= $available_pages;\r\n	return;\r\n}\r\n\r\n// zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz\r\n\r\n// ********************************************* Page Options *********************************************\r\nelse if (isset($_GET[\'access_list_manage\']) && $_GET[\'access_list_manage\']>0)\r\n{\r\n	$return=a(\'Back to security manager\',\'toolkit_security_manager\').br().br();\r\n\r\n	// If the group has been added and passed via GET\r\n	if (isset($_GET[\'addgroup\']) && $_GET[\'addgroup\']>0)\r\n	{\r\n		$qry = \"SELECT name FROM php_methods WHERE id=? LIMIT 1\";\r\n		$params = array($_GET[\'access_list_manage\']);\r\n		$result = query($qry, $params);\r\n		if (count($result)==1) $page_name = $result[0][\'name\'];\r\n		else $page_name = \'Page\';\r\n\r\n		$qry = \"SELECT id FROM access_list WHERE method_id=? AND group_id=?\";\r\n		$params = array($_GET[\'access_list_manage\'], $_GET[\'addgroup\']);\r\n		$result = query($qry, $params);\r\n		if (count($result)>0)\r\n		{\r\n			msg_user(\"Access Change Skipped\",$_GET[\'name\'].\" already has access to the page, \".$page_name.\'.\',\"index.php?toolkit_security_manager&access_list_manage=\".$_GET[\'access_list_manage\']);\r\n		}\r\n		else\r\n		{\r\n			$qry = \"INSERT INTO access_list(method_id,group_id,modified,modifier) VALUES(?,?,CURRENT_TIMESTAMP,?)\";\r\n			$params = array($_GET[\'access_list_manage\'],$_GET[\'addgroup\'],$_SESSION[\'id\']);\r\n			$result = query_execute($qry, $params);\r\n			if ($result) msg_user(\"Access Granted\",$_GET[\'name\'].\" can now access the page, \".$page_name.\'!\',\"index.php?toolkit_security_manager&access_list_manage=\".$_GET[\'access_list_manage\']);\r\n			else msg_user(\"Access Problem\",$_GET[\'name\'].\" could not be added to the access list for the page, \".$page_name.\'.\',\"index.php?toolkit_security_manager&access_list_manage=\".$_GET[\'access_list_manage\']);\r\n		}\r\n	}\r\n	// If the group has been removed and passed via GET\r\n	else if (isset($_GET[\'delgroup\']) && $_GET[\'delgroup\']>0)\r\n	{\r\n		$qry = \"SELECT name FROM php_methods WHERE id=? LIMIT 1\";\r\n		$params = array($_GET[\'access_list_manage\']);\r\n		$result = query($qry, $params);\r\n		if (count($result)==1) $page_name = $result[0][\'name\'];\r\n		else $page_name = \'Page\';\r\n\r\n		$qry = \"DELETE FROM access_list WHERE method_id=? AND group_id=? LIMIT 1\";\r\n		$params = array($_GET[\'access_list_manage\'],$_GET[\'delgroup\']);\r\n		$result = query_execute($qry, $params);\r\n		if ($result) msg_user(\"Access Removed\",$_GET[\'name\'].\" can no longer access the page, \".$page_name.\'.\',\"index.php?toolkit_security_manager&access_list_manage=\".$_GET[\'access_list_manage\']);\r\n		else msg_user(\"Access Problem\",$_GET[\'name\'].\" could not be removed from the access list for, \".$page_name.\'.\',\"index.php?toolkit_security_manager&access_list_manage=\".$_GET[\'access_list_manage\']);\r\n		//return;\r\n	}\r\n	// ********************************************* Page Trash *********************************************\r\n	else if (isset($_GET[\'trash\']))\r\n	{\r\n		db_method_trash($_GET[\'trash\']);\r\n		msg_user(\"Trash\",\"Method \".$_GET[\'trash\'].\" moved to the trash!\",\"/index.php?toolkit_security_manager\");\r\n	}\r\n\r\n	$qry = \"SELECT id,name,type,title,keyword,description FROM php_methods WHERE id=?\";\r\n	$params = array($_GET[\'access_list_manage\']);\r\n	$result = query($qry, $params);\r\n\r\n	if (count($result)!=1) { header(\"Location: index.php?toolkit_security_manager\"); return; }\r\n	\r\n	$group_name = $result[0][\'name\'];\r\n\r\n	$return.=\'<b>Manage Page:</b> \'.$result[0][\'name\'].br();//.\'<b>Description:</b> \'.$result[0][\'description\'].br();\r\n	if ($group_name != \'Administrators\' && $group_name != \'Authenticated\' && $group_name != \'Anonymous\')\r\n	{\r\n		$return .= br();\r\n		$return .= a(img(\'Edit Page\',\'img/silk/page_white_edit.png\'),\'toolkit_edit_method=\'.$result[0][\'name\']).\' \';\r\n		$return .= a(img(\'Trash Page\',\'/img/silk/page_white_database.png\'),\'toolkit_security_manager&access_list_manage=\'.$_GET[\'access_list_manage\'].\'&trash=\'.$result[0][\'name\']).\' \';\r\n		$return .= br();\r\n	}\r\n\r\n	// ********************* Member Groups *********************\r\n	$member_groups=\'\';\r\n\r\n	$qry = \"SELECT access_group.name, access_group.id FROM access_group\r\n	INNER JOIN access_list WHERE access_list.group_id = access_group.id AND \r\n	access_list.method_id=?\";\r\n\r\n	$params = array($_GET[\'access_list_manage\']);\r\n	$result2 = query($qry, $params);\r\n\r\n	$member_groups .= br().\'<b>This page can be accessed by the following security groups (\'.(count($result2)+1).\'):</b>\'.br();\r\n	if ((count($result2)+1)>10) $member_groups .=\'<div class=\"three_col\">\';\r\n\r\n	$member_groups .= img(\'The Administrators security group always has access to every page.\',\'/img/silk/information.png\').\' \';\r\n	$member_groups .= a(img(\'Manage Group\',\'/img/silk/group_key.png\'),\'toolkit_security_manager&access_group_manage=1&name=Administrators\').\' \';\r\n	$member_groups .= \'Administrators\'.br();\r\n\r\n	foreach($result2 as $row2)\r\n	{\r\n		$member_groups .= a(img(\'Remove access\',\'/img/silk/delete.png\'),\'toolkit_security_manager&access_list_manage=\'.$_GET[\'access_list_manage\'].\'&delgroup=\'.$row2[\'id\'].\'&name=\'.$row2[\'name\']).\' \';\r\n		$member_groups .= a(img(\'Manage Group\',\'/img/silk/group_key.png\'),\'toolkit_security_manager&access_group_manage=\'.$row2[\'id\'].\'&name=\'.$row2[\'name\']).\' \';\r\n		$member_groups .= $row2[\'name\'].br();\r\n	}\r\n	if ((count($result2)+1)>10) $member_groups .=\'</div>\';\r\n\r\n	// ********************* Available Groups *********************\r\n	$available_pages=\'\';\r\n	if ($_GET[\'access_list_manage\']!=1)\r\n	{\r\n		$qry = \"SELECT name,id FROM access_group ORDER by name\";\r\n		$params = array();\r\n		$result3 = query($qry, $params);\r\n\r\n		if ((count($result3)-count($result2)-1)!=0)\r\n		{\r\n			$available_pages .= br().\'<b>Available security groups (\'.(count($result3)-count($result2)-1).\'):</b>\'.br();\r\n			if ((count($result3)-count($result2)-1)>10) $available_pages .=\'<div class=\"three_col\">\';\r\n		}\r\n\r\n		if ($_GET[\'access_list_manage\']==1) $available_pages .= \'Everything\';\r\n		else foreach($result3 as $row2)\r\n		{\r\n			$found=false;\r\n			foreach($result2 as $row)\r\n			{\r\n				if ($row2[\'name\']==$row[\'name\']) $found = true;\r\n			}\r\n\r\n			if (!$found && $row2[\'name\'] != \'Administrators\')\r\n			{\r\n				$available_pages .= a(img(\'Add access\',\'/img/silk/add.png\'),\'toolkit_security_manager&access_list_manage=\'.$_GET[\'access_list_manage\'].\'&addgroup=\'.$row2[\'id\'].\'&name=\'.$row2[\'name\']).\' \';\r\n				$available_pages .= a(img(\'Manage Group\',\'/img/silk/group_key.png\'),\'toolkit_security_manager&access_group_manage=\'.$row2[\'id\'].\'&name=\'.$row2[\'name\']).\' \';\r\n				$available_pages .= $row2[\'name\'].br();\r\n			}\r\n		}\r\n		if ((count($result3)-count($result2)-1)>10) $available_pages .= \'</div>\';\r\n	}\r\n\r\n	$output .= $return;\r\n	//$output .= $member_users;\r\n	$output .= $member_groups;\r\n	//$output .= $available_users;\r\n	$output .= $available_pages;\r\n	return;\r\n}\r\n\r\n\r\n\r\n\r\n// ********************************************* User Create *********************************************\r\nelse if (isset($_GET[\'user_create\']))\r\n{\r\n	$output .= <<< OUTPUT\r\n\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n<h3>Create User</h3>\r\n	<form onsubmit=\"return validateLoginCreateForm()\" method=\"post\">\r\n	<label>Username:</label><input class=\"span12\" type=\"text\" id=\"user\" name=\"user\" />\r\n	<label>Password:</label><input class=\"span12\" type=\"password\" id=\"pass\" name=\"pass\" />\r\n	<label>Email:</label><input class=\"span12\" type=\"text\" id=\"email\" name=\"email\" />\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to create\">Create</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n\r\n	<script>document.getElementById(\"user\").focus();</script>\r\nOUTPUT;\r\n}\r\n// ********************************************* Group Create *********************************************\r\nelse if (isset($_GET[\'group_create\']))\r\n{\r\n	$output .= <<< OUTPUT\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n	<h3>Create Group</h3>\r\n	<label>Group Name:</label><input class=\"span12\" type=\"text\" id=\"name\" name=\"name\" />\r\n	<label>Description:</label><input class=\"span12\" type=\"text\" id=\"description\" name=\"description\" />\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to create\">Create</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n	\r\n	<script>document.getElementById(\"name\").focus();</script>\r\n\r\nOUTPUT;\r\n}\r\n\r\n// Output the icons at the top\r\n//$output .= \'<b>Current User:</b> \'.$_SESSION[\'username\'].br().br();\r\n\r\n//$output .= \'<b>Security Options:</b>\'.br();\r\n//$output .= a(img(\'Create User\',\'/img/silk/user_add.png\'),\'toolkit_security_manager&user_create\').\' \';\r\n//$output .= a(img(\'Create Group\',\'/img/silk/group_add.png\'),\'toolkit_security_manager&group_create\').\' \';\r\n\r\n// Output the users\r\n$result = query(\"SELECT id,username FROM access_user ORDER BY username ASC\", array());\r\n$return=\'\';\r\nforeach($result as $row)\r\n{\r\n	// Output the user\r\n	$return.=a($row[\'username\'],\'toolkit_security_manager&user_info=\'.$row[\'id\']).br();\r\n}\r\n$output .= a(img(\'Create User\',\'/img/silk/user_add.png\'),\'toolkit_security_manager&user_create\').\' \';\r\n$output .= \'<b>Users (\'.count($result).\'):</b>\'.br().$return;\r\n\r\n// Output the groups\r\n$result = query(\"SELECT id,name,description FROM access_group ORDER BY name\", array());\r\n$return=\'\';\r\nforeach($result as $row)\r\n{\r\n	$return.=a($row[\'name\'],\'toolkit_security_manager&access_group_manage=\'.$row[\'id\'].\'&name=\'.$row[\'name\']).\' - \'.$row[\'description\'].br();\r\n}\r\n$output .= br().a(img(\'Create Group\',\'/img/silk/group_add.png\'),\'toolkit_security_manager&group_create\').\' \';\r\n$output .= \'<b>Security Groups (\'.count($result).\'):</b>\'.br().$return;\r\n\r\n\r\n\r\n\r\n\r\n// Output the pages\r\n$result = query(\"SELECT id,name,type,modified,title,keyword,description FROM php_methods ORDER BY name\", array());\r\n$return=\'\';\r\nforeach($result as $row)\r\n{\r\n	//$return.=a($row[\'name\'],\'toolkit_security_manager&access_page_manage=\'.$row[\'id\'].\'&name=\'.$row[\'name\']).br();\r\n}\r\n$page_counter = 0;\r\n	foreach($result as $element)\r\n	{\r\n		$name = $element[\'name\'];\r\n		$id = $element[\'id\'];\r\n	\r\n		$qry = \"SELECT group_id,name FROM access_list INNER JOIN access_group WHERE method_id=? AND access_group.id=group_id ORDER BY name\";\r\n		$params = array($id);\r\n		$result = query($qry, $params);\r\n		$remove = \'\';\r\n		foreach($result as $row)\r\n		{\r\n			//$remove.=a($row[\'name\'],\"access_list_manage=$id&delgroup=\".$row[\'group_id\']).\' \';\r\n			$remove.=\'(\'.a($row[\'name\'],\"toolkit_security_manager&access_group_manage=\".$row[\'group_id\']).\') \';\r\n		}\r\n	\r\n		if (strpos($name,\'cms_\')===0) {}\r\n		else if (strpos($name,\'hlp_\')===0) {}\r\n		else if (strpos($name,\'db_\')===0) {}\r\n		else if (strpos($name,\'delete_\')===0) {}\r\n		else if (strpos($name,\'style_\')===0) {}\r\n		else if (strpos($name,\'script_\')===0) {}\r\n		else if (strpos($name,\'div_\')===0) {}\r\n		else if (strpos($name,\'html_\')===0) {}\r\n		//else $output .= br().\'<div style=\"width: 400px; display: inline-block;\">\'.$remove.\' \'.$name.\'</div><div style=\"display: inline-block;\">\'.$add.\'</div>\';\r\n		else\r\n		{\r\n			//$return .= $name.\' \'.$remove.br();\r\n			$return .= a($name,\"toolkit_security_manager&access_list_manage=$id\").\' \'.$remove.br();\r\n			$page_counter += 1;\r\n		}\r\n	}\r\n\r\n$output .= br().a(img(\'Create Page\',\'/img/silk/page_add.png\'),\'toolkit_add_method&html\').\' \';\r\n$output .= \'<b>Pages (\'.$page_counter.\'):</b>\';\r\nif ($page_counter>10) $output .= \'<div class=\"three_col\">\';\r\n$output .= $return;\r\nif ($page_counter>10) $output .= \'</div>\';','2012-08-10 22:29:06',2,1,'if (isset($_GET[\'user_create\']))\r\n{\r\n	$qry = \"INSERT INTO access_user (\r\n	username,\r\n	password,\r\n	email,\r\n	first_login,\r\n	last_login,\r\n	total_login,\r\n	modified,\r\n	modifier,\r\n	created,\r\n	creator) VALUES (?,?,?,0,0,0,CURRENT_TIMESTAMP,?,CURRENT_TIMESTAMP,?)\";\r\n	$params = array(secure_username($_POST[\'user\']),secure_password($_POST[\'user\'], $_POST[\'pass\']),$_POST[\'email\'],$_SESSION[\'id\'],$_SESSION[\'id\']);\r\n	$return = query_execute($qry, $params);\r\n	\r\n	if ($return) msg_user(\'Account Creation\',\'User, \'.$_POST[\'user\'].\', created successfully\',\"index.php?toolkit_security_manager\");\r\n	else msg_user(\'Account Creation\',\'User, \'.$_POST[\'user\'].\', already exists\',\"index.php?toolkit_security_manager\");\r\n}\r\nelse if (isset($_GET[\'user_delete\']))\r\n{\r\n	$val = $_POST[\'user_id\'];\r\n\r\n	// Delete the user from the database\r\n	$qry = \"DELETE FROM access_user WHERE id=? LIMIT 1\";\r\n	$params = array($val);\r\n	query_execute($qry, $params);\r\n\r\n	// Delete the user from any groups\r\n	$qry = \"DELETE FROM access_membership WHERE user_id=?\";\r\n	$params = array($val);\r\n	query_execute($qry, $params);\r\n\r\n	// Check for proper removal\r\n	$qry = \"SELECT id FROM access_user WHERE id=? LIMIT 1\";\r\n	$params = array($val);\r\n	$result = query($qry, $params);\r\n\r\n	if (!$result) msg_user(\"User Removal\",\"User, \".$_POST[\'user\'].\", removed successfully!\",\"index.php?toolkit_security_manager\");\r\n	else msg_user(\"User Removal\",\"User, \".$_POST[\'user\'].\", was NOT removed successfully.\",\"index.php?toolkit_security_manager\");\r\n}\r\nelse if (isset($_GET[\'user_edit\']))\r\n{\r\n	if ($_POST[\'pass_new\']!=$_POST[\'pass\']) $pass_new = secure_password($_POST[\'user\'], $_POST[\'pass_new\']);\r\n	else $pass_new = $_POST[\'pass\'];\r\n\r\n	$qry = \"UPDATE access_user SET username=?, password=?, email=?, modified=CURRENT_TIMESTAMP, modifier=? WHERE id=?\";\r\n	$params = array(secure_username($_POST[\'user\']),$pass_new,$_POST[\'email\'],$_SESSION[\'id\'],$_GET[\'user_edit\']);\r\n	$return = query_execute($qry, $params);\r\n	\r\n	if ($return) msg_user(\'Account Update\',\'User, \'.$_POST[\'user\'].\', updated successfully!\',\"index.php?toolkit_security_manager&user_info=\".$_GET[\'user_edit\']);\r\n	else msg_user(\'Account Update\',\'User, \'.$_POST[\'user\'].\', was NOT updated successfully.\',\"index.php?toolkit_security_manager&user_info=\".$_GET[\'user_edit\']);\r\n}\r\nelse if (isset($_GET[\'group_create\']))\r\n{\r\n	$qry = \"INSERT INTO access_group (name,description,modified,modifier,created,creator)\r\n		VALUES (?,?,CURRENT_TIMESTAMP,?,CURRENT_TIMESTAMP,?)\";\r\n	$params = array($_POST[\'name\'],$_POST[\'description\'],$_SESSION[\'id\'],$_SESSION[\'id\']);\r\n	$return = query_execute($qry, $params);\r\n	\r\n	if ($return) msg_user(\'Group Creation\',\'Group, \'.$_POST[\'name\'].\', created successfully\',\"index.php?toolkit_security_manager\");\r\n	else msg_user(\'Group Creation\',\'Group, \'.$_POST[\'name\'].\', already exists\',\"index.php?toolkit_security_manager\");\r\n}\r\nelse if (isset($_GET[\'group_delete\']))\r\n{\r\n	$val = $_POST[\'group_id\'];\r\n\r\n	// Delete the group from the access list\r\n	$qry = \"DELETE FROM access_list WHERE group_id=?\";\r\n	$params = array($val);\r\n	query_execute($qry, $params);\r\n\r\n	// Delete the group from the access menu\r\n	$qry = \"DELETE FROM access_menu WHERE group_id=?\";\r\n	$params = array($val);\r\n	query_execute($qry, $params);\r\n\r\n	// Delete the users from the group\r\n	$qry = \"DELETE FROM access_membership WHERE group_id=?\";\r\n	$params = array($val);\r\n	query_execute($qry, $params);\r\n\r\n	// Delete the group\r\n	$qry = \"DELETE FROM access_group WHERE id=?\";\r\n	$params = array($val);\r\n	query_execute($qry, $params);\r\n\r\n	// Check for proper removal\r\n	$qry = \"SELECT id FROM access_group WHERE id=?\";\r\n	$params = array($val);\r\n	$result = query($qry, $params);\r\n\r\n	if (!$result) msg_user(\"Group Removal\",\"Group, \".$_POST[\'group\'].\", removed successfully!\",\"index.php?toolkit_security_manager\");\r\n	else msg_user(\"Group Removal\",\"Group, \".$_POST[\'group\'].\", was NOT removed successfully.\",\"index.php?toolkit_security_manager\");\r\n}\r\nelse if (isset($_GET[\'group_edit\']))\r\n{\r\n	$qry = \"INSERT INTO access_group (name,description,modified,modifier,created,creator)\r\n		VALUES (?,?,CURRENT_TIMESTAMP,?,CURRENT_TIMESTAMP,?)\";\r\n	$qry = \"UPDATE access_group SET name=?, description=?, modified=CURRENT_TIMESTAMP, modifier=? WHERE id=?\";\r\n	$params = array($_POST[\'name\'],$_POST[\'description\'],$_SESSION[\'id\'],$_GET[\'group_edit\']);\r\n	$return = query_execute($qry, $params);\r\n	\r\n	if ($return) msg_user(\'Group Update\',\'Group, \'.$_POST[\'name\'].\', updated successfully!\',\"index.php?toolkit_security_manager&access_group_manage=\".$_GET[\'group_edit\']);\r\n	else msg_user(\'Group Update\',\'Group, \'.$_POST[\'name\'].\', was NOT updated successfully.\',\"index.php?toolkit_security_manager&access_group_manage=\".$_GET[\'group_edit\']);\r\n}','Security Controller','',''),(275,'toolkit_session_manager','if (isset($_GET[\'delete\']))\r\n{\r\n	unlink($_GET[\'delete\']);\r\n	msg_user(\"Session Removal\",\"The session was deleted.\",\'/toolkit_session_manager\');\r\n}\r\nelse if (isset($_GET[\'deleteall\']))\r\n{\r\n	if (!isset($_GET[\'mine\'])) $mycookie = \'sess_\'.$_COOKIE[ini_get(\'session.name\')];\r\n	else $mycookie = \'\';\r\n	if (ini_get(\'session.save_path\')==\'\') $path = sys_get_temp_dir();\r\n	else $path = ini_get(\'session.save_path\');\r\n	foreach (glob($path.DIR_SEP.\"ses*\") as $filename)\r\n	{\r\n		if (basename($filename)!=$mycookie) unlink($filename);\r\n	}\r\n	msg_user(\"Session Removal\",\"All sessions were deleted.\",\'/toolkit_session_manager\');\r\n}\r\nelse if (isset($_GET[\'empty\']))\r\n{\r\n	if (ini_get(\'session.save_path\')==\'\') $path = sys_get_temp_dir();\r\n	else $path = ini_get(\'session.save_path\');\r\n	foreach (glob($path.DIR_SEP.\"ses*\") as $filename)\r\n	{\r\n		if (filesize($filename)==0) unlink($filename);\r\n	}\r\n	msg_user(\"Session Removal\",\"All empty sessions were deleted.\",\'/toolkit_session_manager\');\r\n}\r\nelse if (isset($_GET[\'logged\']))\r\n{\r\n	if (!isset($_GET[\'mine\'])) $mycookie = \'sess_\'.$_COOKIE[ini_get(\'session.name\')];\r\n	else $mycookie = \'\';\r\n	if (ini_get(\'session.save_path\')==\'\') $path = sys_get_temp_dir();\r\n	else $path = ini_get(\'session.save_path\');\r\n	foreach (glob($path.DIR_SEP.\"ses*\") as $filename)\r\n	{\r\n		if (strpos(file_get_contents($filename),\'id|\')!==false)\r\n		{		\r\n			if (basename($filename)!=$mycookie) unlink($filename);\r\n		}\r\n	}\r\n	msg_user(\"Session Removal\",\"All sessions were deleted.\",\'/toolkit_session_manager\');\r\n}\r\n\r\nfunction item_right($filename)\r\n{\r\n	$div_name = basename($filename);\r\n	$menu_name = basename($filename).\'_m\';\r\n\r\n	$file_size = filesize($filename);\r\n	$file_contents = htmlentities(file_get_contents($filename), ENT_QUOTES, \"UTF-8\");\r\n\r\n//$file_contents = str_replace(\';\',\'<br />\',$file_contents);\r\n\r\n	$mycookie = \'sess_\'.$_COOKIE[ini_get(\'session.name\')];\r\n	if (basename($filename)==$mycookie) $mine=true;\r\n	else $mine=false;\r\n\r\n	if (!$mine) $img = img(\'Another user session\',\'/img/silk/bullet_green.png\');\r\n	else $img = img(\'My session\',\'/img/silk/bullet_red.png\');\r\n\r\n	$entry1=\'\';\r\n	// Prevent Windows Problems\r\n	if (!IS_WIN_OS)\r\n	{\r\n		$entry1=\'<li><a href=\"\'.$_SERVER[\'QUERY_STRING\'].\'&delete=\'.$filename.\'\">Delete session</a></li>\';\r\n		$entry2=\'<li><a href=\"\'.$_SERVER[\'QUERY_STRING\'].\'&logged&mine\">Delete all logged in sessions, including mine</a></li>\';\r\n		$entry3=\'<li><a href=\"\'.$_SERVER[\'QUERY_STRING\'].\'&deleteall&mine\">Delete all sessions, including mine</a></li>\';\r\n	}else\r\n	{\r\n		if (!$mine) $entry1=\'<li><a href=\"\'.$_SERVER[\'QUERY_STRING\'].\'&delete=\'.$filename.\'\">Delete session</a></li>\';\r\n		$entry2=\'\';\r\n		$entry3=\'\';\r\n	}\r\n\r\n	$text = <<< OUTPUT\r\n\r\n<div class=\"btn-group pull-right\">\r\n<a class=\"btn dropdown-toggle\" data-toggle=\"dropdown\" href=\"#\">Options<span class=\"caret\"></span></a>\r\n<ul class=\"dropdown-menu\">\r\n\r\n			{$entry1}\r\n			<li><a href=\"{$_SERVER[\'QUERY_STRING\']}&empty\">Delete all empty sessions</a></li>\r\n			<li><a href=\"{$_SERVER[\'QUERY_STRING\']}&logged\">Delete all logged in sessions, except mine</a></li>\r\n			{$entry2}\r\n			<li><a href=\"{$_SERVER[\'QUERY_STRING\']}&deleteall\">Delete all sessions, except mine</a></li>\r\n			{$entry3}\r\n			</ul>\r\n		</div>\r\n<pre>{$img}{$filename} - {$file_size} bytes<br />{$file_contents}</pre>\r\n\r\n	\r\n	<script language=\"javascript\">\r\n	\r\n	$(\"#{$div_name}\").bind(\'contextmenu\',function(e){\r\n		$(\"#{$menu_name}\").css({left: e.pageX-10, top: e.pageY-35, zIndex: \'101\', position: \'absolute\', display: \'block\'}).show();\r\n	}).bind(\'contextmenu\' , function(){\r\n	return false;\r\n	});\r\n	$(\"#{$div_name}\").mouseleave(function(){\r\n	$(\"#{$menu_name}\").hide();\r\n	});\r\n	\r\n	</script>\r\n\r\nOUTPUT;\r\n\r\n	return array($text,$mine);\r\n}\r\n\r\n$empty = 0;\r\n$total = 0;\r\n$loggedin = 0;\r\n$text = \'\';\r\n$mine = \'\';\r\nif (ini_get(\'session.save_path\')==\'\') $path = sys_get_temp_dir();\r\nelse $path = ini_get(\'session.save_path\');\r\nforeach (glob($path.DIR_SEP.\"ses*\") as $filename)\r\n{\r\n\r\n	if (filesize($filename)==0) $empty+=1;\r\n	else\r\n	{\r\n		$return_arr = item_right($filename); \r\n		if ($return_arr[1]) $mine .= $return_arr[0];\r\n		else $text .= $return_arr[0];\r\n	}\r\n\r\n	if (strpos(file_get_contents($filename),\'id|\')!==false) $loggedin+=1;\r\n\r\n	$total+=1;\r\n}\r\n\r\n$output .= \'<b>Empty sessions:</b> \'. $empty.br();\r\n$output .= \'<b>Logged in sessions:</b> \'.$loggedin.br();\r\n$output .= \'<b>Total sessions:</b> \'. $total.br().br();\r\n\r\n$output .= $mine;\r\n$output .= $text;','2012-08-08 22:33:52',2,1,'','Session Manager','',''),(281,'toolkit_silk_gallery','$files = glob(CMS_ROOT.DIR_SEP.\'img\'.DIR_SEP.\'silk\'.DIR_SEP.\"*\", GLOB_MARK);\r\n\r\n$output .= \'<div id=\"img_path\" name=\"img_path\" style=\"display: inline;\"></div><br /><br /><b>Preview: </b><br />\';\r\nforeach($files as $f)\r\n{\r\n	$rel = str_replace(array(CMS_ROOT,\'\\\\\'),array(\'\',\'/\'),$f);\r\n	if (stripos($f,\".png\")!==false ||\r\n	stripos($f,\".gif\")!==false ||\r\n	stripos($f,\".jpg\")!==false ||\r\n	stripos($f,\".jpeg\")!==false ||\r\n	stripos($f,\".ico\")!==false ||\r\n	stripos($f,\".bmp\")!==false) $output .= img_special($rel,$rel,true,\'3px 2px 2px 3px\', \"$(\'#img_path\').html(\'img(\\\'Image Text\\\',\\\'$rel\\\')\');\").\' \';\r\n}','2012-07-09 21:10:49',2,1,'','Silk Gallery','',''),(285,'toolkit_index_basic','<script>\r\n$(document).ready(function() {\r\n	$(\'#main_sidebar\').css(\'display\',\'none\');$(\'#main_content\').removeClass(\'span10\');\r\n	$(\'#main_content\').addClass(\'span12\');\r\n});\r\n</script>\r\n\r\n<div class=\"row-fluid\">\r\n	<div class=\"hero-unit span6\">\r\n		<h1>Toolkit</h1>\r\n		<p>Welcome, Admin! Take a look around the FusionLeaf interface.</p>\r\n		<p><a class=\"btn btn-primary btn-large\" href=\"/page_guide_planters\">Planter\'s Guide</a></p>\r\n	</div>\r\n	<div class=\"span4 well\">\r\n		<p>Thanks for trying FusionLeaf! Be sure to check out the Planter\'s Guide for more information on the different features included in the FusionLeaf Content Management System. If you have any problems or find any bugs, please create a new <a href=\"http://code.google.com/p/fusionleaf/issues\">issue</a>.</p>\r\n		<p>FusionLeaf is licensed under the <a href=\"http://www.apache.org/licenses/LICENSE-2.0.html\">Apache License, Version 2.0</a> so feel free to change anything you need to fit your requirements. The CMS is very customizable and includes a full arsenal of tools.</p>\r\n		<p>Check for new versions on <a href=\"http://www.fusionleaf.com\">FusionLeaf.com</a>.</p>\r\n	</div>\r\n	<div class=\"span2 well\">\r\n		<p><strong>Tip:</strong></p>\r\n		<p>Once you are comfortable with the Basic Toolkit, you can use the Main Page Selection tool to change the default Administrators page to the advanced Web Toolkit which is page: /toolkit_index.</p>\r\n	</div>\r\n</div>\r\n<div class=\"row-fluid\">\r\n	<div class=\"span2 well\">\r\n		<a href=\"toolkit_security_manager\"><img src=\"/img/silk/group_key.png\"/> Security Controller</a>\r\n		<p>Modify the users, security groups, and access lists for every page.</p>\r\n	</div>\r\n	<div class=\"span2 well\">\r\n		<a href=\"toolkit_file_manager\"><img src=\"/img/silk/folder_page.png\"/> File Organizer\r\n		</a>\r\n		<p>Upload, decompress, and modify any file on your web server.</p>\r\n	</div>\r\n	<div class=\"span2 well\">\r\n		<a href=\"toolkit_session_manager\"><img src=\"/img/silk/lock.png\"/> Session Manager\r\n		</a>\r\n		<p>Quickly see and destroy any sessions on your web site.</p>\r\n	</div>\r\n	<div class=\"span2 well\">\r\n		<a href=\"toolkit_site_settings\"><img src=\"/img/silk/layout_content.png\"/> Site Settings\r\n		</a>\r\n		<p>Change the location of the navigation bar or the \"Powered by\" text.</p>\r\n	</div>\r\n	<div class=\"span2 well\">\r\n		<a href=\"toolkit_bootstrap_themes\"><img src=\"/img/silk/palette.png\"/> Theme Selector\r\n		</a>\r\n		<p>Pick a new theme from the selection of swatches from Bootswatch.</p>\r\n	</div>\r\n	<div class=\"span2 well\">\r\n		<a href=\"toolkit_menu_builder\"><img src=\"/img/silk/tab.png\"/> Menu Builder\r\n		</a>\r\n		<p>Create a new navigation menu or customize an existing one.</p>\r\n	</div>\r\n</div>\r\n<div class=\"row-fluid\">\r\n	<div class=\"span2 well\">\r\n		<a href=\"toolkit_query\"><img src=\"/img/silk/database_table.png\"/> Database Manager</a>\r\n		<p>Access any of the tables or add a new row a data easily.</p>\r\n	</div>\r\n	<div class=\"span2 well\">\r\n		<a href=\"toolkit_database?backup\"><img src=\"/img/silk/database_save.png\"/> Backup Database</a>\r\n		<p>Save and email the database to prevent any data loss.</p>\r\n	</div>\r\n	<div class=\"span2 well\">\r\n		<a href=\"toolkit_database?restore\"><img src=\"/img/silk/database_refresh.png\"/> Restore Database</a>\r\n		<p>Restore the newest database backup from development.</p>\r\n	</div>\r\n	<div class=\"span2 well\">\r\n		<a href=\"toolkit_search\"><img src=\"/img/silk/zoom.png\"/> Search/Replace</a>\r\n		<p>Find what you\'re looking for or make quick changes.</p>\r\n	</div>\r\n	<div class=\"span2 well\">\r\n		<a href=\"recache\"><img src=\"/img/silk/vector.png\"/> Recache</a>\r\n		<p>Clear out Memcache and the file cache if you make an external change.</p>\r\n	</div>\r\n	<div class=\"span2 well\">\r\n		<a href=\"toolkit_update_sitemap\"><img src=\"/img/silk/chart_organisation.png\"/> Sitemap</a>\r\n		<p>Generate a new sitemap when you make changes to public pages.</p>\r\n	</div>\r\n</div>\r\n<div class=\"row-fluid\">\r\n	<div class=\"span2 well\">\r\n		<a href=\"toolkit_index_selection\"><img src=\"/img/silk/house.png\"/> Main Page Selection</a>\r\n		<p>Change the default home page for the main security groups.</p>\r\n	</div>\r\n	<div class=\"span2 well\">\r\n		<a href=\"toolkit_silk_gallery\"><img src=\"/img/silk/application_view_tile.png\"/> Silk Gallery</a>\r\n		<p>Quickly find a Silk icon to use on any of your pages.</p>\r\n	</div>\r\n	<div class=\"span2 well\">\r\n		<a href=\"toolkit_command_shell\"><img src=\"/img/silk/application_osx_terminal.png\"/> Command Shell</a>\r\n		<p>Run a command on your web server and view the output.</p>\r\n	</div>\r\n	<div class=\"span2 well\">\r\n		<a href=\"toolkit_twitter\"><img src=\"/img/social/twitter.png\"/> Tweet</a>\r\n		<p>Send a tweet to keep everyone updated.</p>\r\n	</div>\r\n	<div class=\"span2 well\">\r\n		<a href=\"toolkit_error_log\"><img src=\"/img/silk/error.png\"/> Error Log</a>\r\n		<p>View any problems or errors that occurred on the web site.</p>\r\n	</div>\r\n	<div class=\"span2 well\">\r\n		<a href=\"toolkit_index\"><img src=\"/img/silk/bricks.png\"/> Web Toolkit</a>\r\n		<p>See all the pages included in FusionLeaf.</p>\r\n	</div>\r\n</div>','2012-08-20 02:20:55',2,0,'','Basic Toolkit','',''),(286,'toolkit_menu_builder','$output .= a(img(\'Add a menu item\',\'/img/silk/tab_add.png\'),\'toolkit_menu_builder&add\').br();\r\n$output .= \'<div style=\"text-align: right;\">Test out your menus here:</div>\';\r\n\r\n\r\n\r\n// ********************************************* Add a menu item *********************************************\r\nif (isset($_GET[\'add\']) || isset($_GET[\'edit\']))\r\n{\r\n	if (isset($_GET[\'edit\']))\r\n	{\r\n		$edit = $_GET[\'edit\'];\r\n		$qry = \"SELECT id,label,url,parent FROM php_menu WHERE id=? LIMIT 1\";\r\n		$params = array($edit);\r\n		$edit_info = query($qry, $params);\r\n	}\r\n	else $edit=false;\r\n\r\n	// ******************************** Build select ******************************** \r\n	$qry = \"SELECT id,label FROM php_menu WHERE parent=0 ORDER BY id\";\r\n	$params = array();\r\n	$result = query($qry, $params);\r\n	\r\n	$select = \'<select id=\"parent\" name=\"parent\">\';\r\n	$select .= \'<option value=\"0\">(No parent)</option>\';\r\n\r\n	$label = \'\';\r\n	$url = \'\';\r\n	$button_text = \"Add\";\r\n	if ($edit)\r\n	{\r\n		$label = $edit_info[0][\'label\'];\r\n		$url = $edit_info[0][\'url\'];\r\n		$button_text = \"Update\";\r\n	}\r\n\r\n	foreach($result as $row)\r\n	{\r\n		$selected = \'\';\r\n		if ($edit)\r\n		{\r\n			if ($edit_info[0][\'parent\']==$row[\'id\']) $selected=\'selected\';\r\n		}\r\n		$select .= \'<option \'.$selected.\' value=\"\'.$row[\'id\'].\'\">\'.$row[\'label\'].\'</option>\';\r\n	}\r\n	$select .= \'</select>\';\r\n\r\n	// ******************************** Output form ******************************** \r\n	$output .= <<< OUTPUT\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n	\r\n	<div class=\"span4\">\r\n	<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n	<h3>{$button_text} Menu Item</h3>\r\n	<label>Label:</label><input class=\"span12\" type=\"text\" id=\"label\" name=\"label\" value=\"{$label}\" />\r\n	<label>URL (optional):</label><input class=\"span12\" type=\"text\" id=\"url_optional\" name=\"url_optional\" value=\"{$url}\" />\r\n	<label>Parent:</label>{$select}\r\n	<div class=\"clear\"></div>\r\n	<button type=\"submit\" class=\"btn\" title=\"Click once to {$button_text} menu item\">{$button_text}</button>\r\n	</form>\r\n	</div>\r\n	\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n	<div class=\"clear\"></div>\r\n\r\n<script>document.getElementById(\"label\").focus();</script>\r\nOUTPUT;\r\n}\r\n// ********************************************* Move a menu item *********************************************\r\nelse if (isset($_GET[\'down\']))\r\n{\r\n	$num = floatval($_GET[\'down\']);\r\n	$num += 1.5;\r\n	$qry = \"UPDATE php_menu SET position=? WHERE id=?\";\r\n	$params = array($num,$_GET[\'id\']);\r\n	$result = query_execute($qry, $params);\r\n	msg_user(\"Menu Moved\",\"Menu item moved down!\",\'toolkit_menu_builder\');\r\n}\r\nelse if (isset($_GET[\'up\']))\r\n{\r\n	$num = floatval($_GET[\'up\']);\r\n	$num -= 1.5;\r\n	$qry = \"UPDATE php_menu SET position=? WHERE id=?\";\r\n	$params = array($num,$_GET[\'id\']);\r\n	$result = query_execute($qry, $params);\r\n	msg_user(\"Menu Moved\",\"Menu item moved up!\",\'toolkit_menu_builder\');\r\n}\r\nelse if (isset($_GET[\'delete\']))\r\n{\r\n	$qry = \"DELETE FROM php_menu WHERE id=?\";\r\n	$params = array($_GET[\'delete\']);\r\n	$result = query_execute($qry, $params);\r\n\r\n	$qry = \"DELETE FROM php_menu WHERE parent=?\";\r\n	$params = array($_GET[\'delete\']);\r\n	$result = query_execute($qry, $params);\r\n\r\n	$qry = \"DELETE FROM access_menu WHERE menu_id=?\";\r\n	$params = array($_GET[\'delete\']);\r\n	$result = query_execute($qry, $params);\r\n\r\n	msg_user(\"Menu Deletion\",\"Menu item deleted!\",\'toolkit_menu_builder\');\r\n}\r\n\r\n// ********************************************* Change security settings *********************************************\r\n	// If the group has been added and passed via GET\r\n	if (isset($_GET[\'addgroup\']) && $_GET[\'addgroup\']>0)\r\n	{\r\n		$qry = \"SELECT label FROM php_menu WHERE id=? LIMIT 1\";\r\n		$params = array($_GET[\'access_list_manage\']);\r\n		$result = query($qry, $params);\r\n		if (count($result)==1) $page_name = $result[0][\'label\'];\r\n		else $page_name = \'Page\';\r\n\r\n		$qry = \"SELECT id FROM access_menu WHERE menu_id=? AND group_id=?\";\r\n		$params = array($_GET[\'access_list_manage\'], $_GET[\'addgroup\']);\r\n		$result = query($qry, $params);\r\n		if (count($result)>0)\r\n		{\r\n			msg_user(\"Access Change Skipped\",$_GET[\'name\'].\" already has access to the menu, \".$page_name.\'.\',\"index.php?toolkit_menu_builder\");\r\n		}\r\n		else\r\n		{\r\n			$qry = \"INSERT INTO access_menu(menu_id,group_id,modified,modifier) VALUES(?,?,CURRENT_TIMESTAMP,?)\";\r\n			$params = array($_GET[\'access_list_manage\'],$_GET[\'addgroup\'],$_SESSION[\'id\']);\r\n			$result = query_execute($qry, $params);\r\n			if ($result) msg_user(\"Access Granted\",$_GET[\'name\'].\" can now access the menu, \".$page_name.\'!\',\"index.php?toolkit_menu_builder\");\r\n			else msg_user(\"Access Problem\",$_GET[\'name\'].\" could not be added to the access list for the menu, \".$page_name.\'.\',\"index.php?toolkit_menu_builder\");\r\n		}\r\n	}\r\n	// If the group has been removed and passed via GET\r\n	else if (isset($_GET[\'delgroup\']) && $_GET[\'delgroup\']>0)\r\n	{\r\n		$qry = \"SELECT label FROM php_menu WHERE id=? LIMIT 1\";\r\n		$params = array($_GET[\'access_list_manage\']);\r\n		$result = query($qry, $params);\r\n		if (count($result)==1) $page_name = $result[0][\'label\'];\r\n		else $page_name = \'Page\';\r\n\r\n		$qry = \"DELETE FROM access_menu WHERE menu_id=? AND group_id=? LIMIT 1\";\r\n		$params = array($_GET[\'access_list_manage\'],$_GET[\'delgroup\']);\r\n		$result = query_execute($qry, $params);\r\n		if ($result) msg_user(\"Access Removed\",$_GET[\'name\'].\" can no longer access the menu, \".$page_name.\'.\',\"index.php?toolkit_menu_builder\");\r\n		else msg_user(\"Access Problem\",$_GET[\'name\'].\" could not be removed from the access list for the menu, \".$page_name.\'.\',\"index.php?toolkit_menu_builder\");\r\n	}\r\n\r\n\r\n$qry = \"SELECT id,label,url FROM php_menu WHERE parent=? ORDER BY position\";\r\n$params = array(0);\r\n$result = query($qry, $params);\r\n\r\n$new_menu = array();\r\n//foreach($result as $row)\r\n\r\n$has_sisters = (count($result)>1);\r\n\r\n$menu_out=\'\';\r\n$menu_out_final=\'\';\r\n\r\nfor($j=0;$j<count($result);$j++)\r\n{$new_menu = array();\r\n	$menu_num = $j+1;\r\n	$menu_out = \"<b>Menu $menu_num: </b>\".br();\r\n	$row = $result[$j];\r\n\r\n	// Down Arrow		\r\n	if ($has_sisters && $j!=count($result)-1) $menu_out .= a(img(\'Move Down\',\'/img/silk/arrow_down.png\'),\'toolkit_menu_builder&id=\'.$row[\'id\'].\'&down=\'.$j.\'&total=\'.count($result)).\' \';\r\n	else if (count($result)>2) $menu_out .= img(\'\',\'/img/silk/arrow_up.png\',false).\' \';\r\n	else $menu_out .= img(\'\',\'/img/silk/arrow_up.png\',false).\' \';\r\n\r\n	// Up Arrow\r\n	if ($has_sisters && $j!=0) $menu_out .= a(img(\'Move Up\',\'/img/silk/arrow_up.png\'),\'toolkit_menu_builder&id=\'.$row[\'id\'].\'&up=\'.$j.\'&total=\'.count($result)).\' \';\r\n	else if (count($result)>2) $menu_out .= img(\'\',\'/img/silk/arrow_up.png\',false).\' \';\r\n	else $menu_out .= img(\'\',\'/img/silk/arrow_up.png\',false).\' \';\r\n\r\n	$menu_out .= img(\'\',\'/img/silk/bullet_green.png\',false).\' \';\r\n	$menu_out .= img(\'\',\'/img/silk/bullet_green.png\',false).\' \';\r\n\r\n	$menu_out .= a(img(\'Edit Parent Menu Item\',\'/img/silk/tab_edit.png\'),\'toolkit_menu_builder&edit=\'.$row[\'id\']).\' \';\r\n	$menu_out .= a(img(\'Delete Parent Menu Item and All Children\',\'/img/silk/tab_delete.png\'),\'toolkit_menu_builder&delete=\'.$row[\'id\']).\' \';\r\n	$menu_out .= \'<b>\'.$row[\'label\'].\'</b>\';\r\n\r\n$menu_out .= br();\r\n\r\n	$qry = \"UPDATE php_menu SET position=? WHERE id=?\";\r\n	$params = array($j,$row[\'id\']);\r\n	query_execute($qry, $params);\r\n\r\n	$qry = \"SELECT id,label,url FROM php_menu WHERE parent=? ORDER BY position\";\r\n	$params = array($row[\'id\']);\r\n	$result2 = query($qry, $params);\r\n	$children = array();\r\n	//foreach($result2 as $row2)\r\n\r\n	$has_brothers = (count($result2)>1);\r\n	\r\n	if (count($result2)==0)\r\n	{\r\n		$menu_out .= img(\'\',\'/img/silk/tab_edit.png\',false).\' \';\r\n		$menu_out .= img(\'\',\'/img/silk/tab_edit.png\',false).\' \';\r\n		$menu_out .= img(\'\',\'/img/silk/tab_edit.png\',false).\' \';\r\n		$menu_out .= img(\'\',\'/img/silk/tab_edit.png\',false).\' \';\r\n		$menu_out .= img(\'\',\'/img/silk/tab_edit.png\',false).\' \';\r\n		$menu_out .= img(\'\',\'/img/silk/tab_edit.png\',false).\' \';\r\n		$menu_out .= \'(No child menu items)\'.br();\r\n	}\r\n\r\n	for($i=0;$i<count($result2);$i++)\r\n	{\r\n		$row2 = $result2[$i];\r\n		array_push($children, array($row2[\'label\'],$row2[\'url\']));\r\n\r\n		$menu_out .= img(\'\',\'/img/silk/tab_edit.png\',false).\' \';\r\n		$menu_out .= img(\'\',\'/img/silk/tab_edit.png\',false).\' \';\r\n\r\n		$qry = \"UPDATE php_menu SET position=? WHERE id=?\";\r\n		$params = array($i,$row2[\'id\']);\r\n		query_execute($qry, $params);\r\n\r\n		// Down Arrow		\r\n		if ($has_brothers && $i!=count($result2)-1) $menu_out .= a(img(\'Move Down\',\'/img/silk/arrow_down.png\'),\'toolkit_menu_builder&id=\'.$row2[\'id\'].\'&down=\'.$i.\'&total=\'.count($result2)).\' \';\r\n		else if (count($result2)>2) $menu_out .= img(\'\',\'/img/silk/arrow_up.png\',false).\' \';\r\n		else $menu_out .= img(\'\',\'/img/silk/arrow_up.png\',false).\' \';\r\n\r\n		// Up Arrow\r\n		if ($has_brothers && $i!=0) $menu_out .= a(img(\'Move Up\',\'/img/silk/arrow_up.png\'),\'toolkit_menu_builder&id=\'.$row2[\'id\'].\'&up=\'.$i.\'&total=\'.count($result2)).\' \';\r\n		else if (count($result2)>2) $menu_out .= img(\'\',\'/img/silk/arrow_up.png\',false).\' \';\r\n		else $menu_out .= img(\'\',\'/img/silk/arrow_up.png\',false).\' \';\r\n\r\n		$menu_out .= img(\'\',\'/img/silk/tab_edit.png\',false).\' \';\r\n		$menu_out .= img(\'\',\'/img/silk/tab_edit.png\',false).\' \';\r\n\r\n		$menu_out .= a(img(\'Edit Child Menu Item\',\'/img/silk/tab_edit.png\'),\'toolkit_menu_builder&edit=\'.$row2[\'id\']).\' \';\r\n		$menu_out .= a(img(\'Delete Child Menu Item\',\'/img/silk/tab_delete.png\'),\'toolkit_menu_builder&delete=\'.$row2[\'id\']).\' \';\r\n		$menu_out .= $row2[\'label\'].br();\r\n	}\r\n	$parent_url = false;\r\n	if (strlen($row[\'url\'])>0) $parent_url = $row[\'url\'];\r\n	$parent = array($row[\'label\'],$parent_url,$children);\r\n	array_push($new_menu, $parent);\r\n\r\n\r\n\r\n\r\n\r\n	// ********************* Member Groups *********************\r\n	$member_groups=\'\';\r\n\r\n	$qry = \"SELECT access_group.name, access_group.id FROM access_group\r\n	INNER JOIN access_menu WHERE access_menu.group_id = access_group.id AND \r\n	access_menu.menu_id=?\";\r\n\r\n	$params = array($row[\'id\']);\r\n	$result2 = query($qry, $params);\r\n\r\n	$member_groups .= br().\'<b>This menu is set for the following security groups (\'.(count($result2)).\'):</b>\'.br();\r\n	if ((count($result2))>10) $member_groups .=\'<div class=\"three_col\">\';\r\n	else if (count($result2)==0) $member_groups .= \'None of them\'.br();\r\n\r\n	foreach($result2 as $row2)\r\n	{\r\n		$member_groups .= a(img(\'Remove access\',\'/img/silk/delete.png\'),\'toolkit_menu_builder&access_list_manage=\'.$row[\'id\'].\'&delgroup=\'.$row2[\'id\'].\'&name=\'.$row2[\'name\']).\' \';\r\n		//$member_groups .= a(img(\'Manage Group\',\'/img/silk/group_key.png\'),\'toolkit_menu_builder&access_group_manage=\'.$row2[\'id\'].\'&name=\'.$row2[\'name\']).\' \';\r\n		$member_groups .= $row2[\'name\'].br();\r\n	}\r\n	if ((count($result2))>10) $member_groups .=\'</div>\';\r\n\r\n	// ********************* Available Groups *********************\r\n	$available_pages=\'\';\r\n\r\n	$qry = \"SELECT name,id FROM access_group ORDER by name\";\r\n	$params = array();\r\n	$result3 = query($qry, $params);\r\n\r\n	if ((count($result3)-count($result2))!=0)\r\n	{\r\n		$available_pages .= br().\'<b>Available security groups (\'.(count($result3)-count($result2)).\'):</b>\'.br();\r\n		if ((count($result3)-count($result2)-1)>10) $available_pages .=\'<div class=\"three_col\">\';\r\n	}\r\n\r\n	foreach($result3 as $row2)\r\n	{\r\n		$found=false;\r\n		foreach($result2 as $row4)\r\n		{\r\n			if ($row2[\'name\']==$row4[\'name\']) $found = true;\r\n		}\r\n\r\n		if (!$found)\r\n		{\r\n			$available_pages .= a(img(\'Add access\',\'/img/silk/add.png\'),\'toolkit_menu_builder&access_list_manage=\'.$row[\'id\'].\'&addgroup=\'.$row2[\'id\'].\'&name=\'.$row2[\'name\']).\' \';\r\n			//$available_pages .= a(img(\'Manage Group\',\'/img/silk/group_key.png\'),\'toolkit_menu_builder&access_group_manage=\'.$row2[\'id\'].\'&name=\'.$row2[\'name\']).\' \';\r\n			$available_pages .= $row2[\'name\'].br();\r\n		}\r\n	}\r\n	if ((count($result3)-count($result2)-1)>10) $available_pages .= \'</div>\';\r\n\r\n	$menu_out .= $member_groups;\r\n	$menu_out .= $available_pages;\r\n\r\n\r\n$menu_out .= br();\r\n$menu_out .= \'<div style=\"border-bottom: 1px solid silver;\"></div>\';\r\n$menu_out .= br();\r\n\r\n$menu_out_demo = \'<div class=\"navbar\"><div class=\"navbar-inner\"><div class=\"container\"><ul class=\"nav pull-right\">\';\r\n$menu_out_demo .= drop_menu_bootstrap($new_menu, false);\r\n$menu_out_demo .= \'</ul></div></div></div>\';\r\n\r\n$menu_out_final .= $menu_out_demo.$menu_out;\r\n\r\n}\r\n\r\n$output .= $menu_out_final;','2012-06-16 18:46:55',2,1,'if (isset($_GET[\'add\']))\r\n{\r\n	$qry = \"INSERT INTO php_menu (label,url,parent,position) VALUES (?,?,?,?)\";\r\n	$params = array($_POST[\'label\'],$_POST[\'url_optional\'],$_POST[\'parent\'],0);\r\n	$result = query_execute($qry, $params);\r\n	msg_user(\"Menu Addition\",\"Menu item added!\",\'toolkit_menu_builder\');\r\n}\r\nelse if (isset($_GET[\'edit\']))\r\n{\r\n	$qry = \"UPDATE php_menu SET label=?, url=?, parent=? WHERE id=?\";\r\n	$params = array($_POST[\'label\'],$_POST[\'url_optional\'],$_POST[\'parent\'], $_GET[\'edit\']);\r\n	$result = query_execute($qry, $params);\r\n	msg_user(\"Menu Update\",\"Menu item updated!\",\'toolkit_menu_builder\');\r\n}','Menu Builder','',''),(292,'page_flstudio','$page_name = \'page_flstudio\';\r\n\r\n// Array of items\r\n$gallery = array();\r\n\r\narray_push($gallery, array(\'FusionLeaf Stack\',\'FusionLeaf Stack (FLS) is the development lab for FusionLeaf CMS. FLS provides a quick setup for a Windows environment and is where most of the FusionLeaf CMS development occurs. \', img(\"FusionLeaf Stack\",\"/img/flstudio/filestructure.png\")));\r\narray_push($gallery, array(\'FusionLeaf Studio Application\',\'One of the crucial components of the FusionLeaf Stack (FLS) is the C# application which manages Nginx, PHP, and MySQL. Since none of the other components are installed as services, the FLS application executes each of the other components in the background so it is seamless to the user. The only software requirements to run the FLS is the .NET Framework v2.0 and the Microsoft 2008 C++ Runtime. Once installed, click the \"Start\" button at the bottom to get everything up an running.\', img(\"FLS Application\",\"/img/flstudio/app.png\")));\r\n\r\narray_push($gallery, array(\'Advanced Tab\',\'For those requiring more control, the Advanced tab in the application provides \"Start\" and \"Stop\" controls for all the components as well as FastCGI settings for simple load balancing. If any of the components are stopped for any reason, they will be restarted within a second for a stable, high availability environment.\', img(\"Advanced Tab\",\"/img/flstudio/advanced.png\")));\r\narray_push($gallery, array(\'Log Tab\',\'To keep track of the components, the Log tab provides timestamps as well as addressing information. There is currently a known issue with the FastCGI component of PHP where 503 errors occur after an unspecified number of requests. The FastCGI component actually terminates and can cause a website to be unresponsive. FLS handles the issue by allowing the user to specify the maximum number of requests before the component terminates. When the threshold is reached, FLS will automatically spawn a new FastCGI instance within a second and report it on the Log tab.\', img(\"Log Tab\",\"/img/flstudio/log.png\")));\r\n\r\narray_push($gallery, array(\'Process Control\',\'FLS is designed to protect against accidental application termination and will restart any of the components when errors and problems occur. Even after a forced termination of one of the FastCGI components, FLS will respawn a new process until you are ready to shutdown the environment. \', img(\"Process Control\",\"/img/flstudio/processcontrol.png\")));\r\n\r\n$output .= \'<div style=\"text-align: center;\"><div class=\"public\">\';\r\n\r\n// If no GET parameter, set to the first one\r\nif (!isset($_GET[\'num\'])) $num = 0;\r\nelse $num = $_GET[\'num\'];\r\n\r\n// If the number passed is invalid, return a message\r\nif (!isset($gallery[$num]) || !is_numeric($num))\r\n{\r\n	$output .= \"Item does not exist\";\r\n}\r\nelse\r\n{\r\n	// Set all the items\r\n	$item = $gallery[$num];\r\n	\r\n	$next = (int)$num;\r\n	$next += 1;\r\n	$prev = $next-2;\r\n	\r\n	// Output the item page\r\n	$output .= \'<div style=\"text-align: center;\">\';\r\n		$output .= \'<p class=\"pull-left\">\';\r\n		if ($prev>=0)$output .= a(\'Previous\',$page_name.\'&num=\'.$prev);\r\n		else $output .= \"---\";\r\n		$output .= \'</p>\';\r\n		\r\n		$output .= \'Item \'.($num+1).\' of \'.count($gallery);\r\n		\r\n		$output .= \'<p class=\"pull-right\">\';\r\n		if ($next<count($gallery))$output .= a(\'Next\',$page_name.\'&num=\'.$next);\r\n		else $output .= \"---\";\r\n		$output .= \'</p>\';\r\n	$output .= \'<div class=\"clear\"></div></div>\';\r\n	\r\n	$output .= br().\'<h1>\'.$item[0].\'</h1>\'.br();\r\n	$output .= $item[2].br();\r\n	$output .= $item[1].br();\r\n}\r\n$output .= \'</div></div>\';','2012-08-10 07:59:44',2,1,'','FusionLeaf Stack','FusionLeaf Stack, fusion leaf stack, fls,','FusionLeaf Stack is a Windows development lab that allows setup of the FusionLeaf CMS in 10 seconds.'),(293,'toolkit_site_settings','$output .= a(img(\'Add Setting\',\'/img/silk/layout_add.png\'),\'toolkit_site_settings&add\').br();\r\n\r\nif (isset($_GET[\'delete\']))\r\n{\r\n	$set_desc = $_GET[\'name\'];\r\n	$output .= <<< OUTPUT\r\n	<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n	<h3>Delete Setting</h3><br />\r\n	<label>Description:</label><input class=\"span12\" type=\"text\" id=\"set_desc\" name=\"set_desc\" value=\"{$set_desc}\" readonly=\"readonly\" />\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to delete setting\">Delete</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n\r\nOUTPUT;\r\n}\r\n\r\nif (isset($_GET[\'add\']) || isset($_GET[\'edit\']))\r\n{\r\n	$set_name = \'\';\r\n	$set_desc = \'\';\r\n	$set_value = \'\';\r\n	$set_avail = \'\';\r\n\r\n	$val1 = \'add\';\r\n	$val2 = \'Add\';\r\n	$val3 = \'Add\';\r\n\r\n	if (isset($_GET[\'edit\']))\r\n	{\r\n		$qry = \'SELECT name,description,current_value,all_option FROM site_setting WHERE id=? LIMIT 1\';\r\n		$params = array($_GET[\'edit\']);\r\n		$result = query($qry, $params);\r\n\r\n		$set_name = $result[0][\'name\'];\r\n		$set_desc = $result[0][\'description\'];\r\n		$set_value = $result[0][\'current_value\'];\r\n		$set_avail = $result[0][\'all_option\'];\r\n\r\n		$val1 = \'update\';\r\n		$val2 = \'Edit\';\r\n		$val3 = \'Update\';\r\n	}\r\n\r\n	$output .= <<< OUTPUT\r\n	\r\n	<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n	<h3>{$val2} Setting</h3><br />\r\n	<label>Name (all capitals, no spaces, underscores allowed):</label><input class=\"span12\" type=\"text\" \r\n	id=\"set_name\" name=\"set_name\" value=\"{$set_name}\" />\r\n	<label>Description:</label><input class=\"span12\" type=\"text\" id=\"set_desc\" name=\"set_desc\" value=\"{$set_desc}\" />\r\n	<label>Current Value:</label><input class=\"span12\" type=\"text\" id=\"set_value\" name=\"set_value\" value=\"{$set_value}\" />\r\n	<label>Available Values (separated by commas):</label><input class=\"span12\" type=\"text\" \r\n		id=\"set_avail\" name=\"set_avail\" value=\"{$set_avail}\" />\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to {$val2} setting\">{$val3}</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n\r\n	<script>document.getElementById(\"set_name\").focus();</script>\r\nOUTPUT;\r\n}\r\n\r\nif (isset($_GET[\'option\']))\r\n{\r\n	$qry = \"UPDATE site_setting SET current_value=? WHERE id=? AND name=?\";\r\n	$params = array($_GET[\'option\'],$_GET[\'toolkit_site_settings\'],$_GET[\'description\']);\r\n	$result = query_execute($qry, $params);\r\n	if ($result) msg_user(\'Setting Changed\',\'Setting, \'.$_GET[\'name\'].\', changed successfully to \'.$_GET[\'option\'].\'!\',\r\n		\'toolkit_site_settings\');\r\n	else msg_user(\'Setting Changed\',\'Setting, \'.$_GET[\'name\'].\', was NOT changed successfully to \'.$_GET[\'option\'].\'.\',\r\n		\'toolkit_site_settings\');\r\n}	\r\n\r\n$qry = \"SELECT id, name, description, current_value, all_option FROM site_setting ORDER BY description\";\r\n$params = array();\r\n$result = query($qry, $params);\r\n\r\nforeach ($result as $row)\r\n{\r\n	$output .= br();\r\n	$output .= a(img(\'Edit Setting\',\'/img/silk/layout_edit.png\'),\'toolkit_site_settings&edit=\'.$row[\'id\'].\r\n		\'&name=\'.$row[\'description\']).\' \';\r\n	$output .= a(img(\'Delete Setting\',\'/img/silk/layout_delete.png\'),\'toolkit_site_settings&delete=\'.$row[\'id\'].\r\n		\'&name=\'.$row[\'description\']).\' \';\r\n	$output .= $row[\'description\'].\' (\'.$row[\'name\'].\'):\'.br();\r\n	$options_arr = explode(\',\',$row[\'all_option\']);\r\n	foreach ($options_arr as $option)\r\n	{\r\n		if ($row[\'current_value\']==$option) $output .= \'<b>\'.$option.\'</b> \';\r\n		else $output .= a($option,\'toolkit_site_settings=\'.$row[\'id\'].\'&option=\'.$option.\'&name=\'.\r\n			$row[\'description\'].\'&description=\'.$row[\'name\']).\' \';\r\n	}\r\n	$output .= br();\r\n}\r\n\r\n$output .= br().a(\'Recache when finished making changes\',\'recache\');','2012-07-09 02:43:29',2,1,'if (isset($_GET[\'add\']))\r\n{\r\n	$qry = \'INSERT INTO site_setting (name,description,current_value,all_option,modified,modifier) VALUES(?,?,?,?,CURRENT_TIMESTAMP,?)\';\r\n	\r\n	$params = array($_POST[\'set_name\'],$_POST[\'set_desc\'],$_POST[\'set_value\'],\r\n		$_POST[\'set_avail\'],$_SESSION[\'id\']);\r\n	$result = query_execute($qry, $params);\r\n	if ($result) msg_user(\'Setting Addition\',\'Setting, \'.$_POST[\'set_name\'].\', added successfully!\',\'toolkit_site_settings\');\r\n	else msg_user(\'Setting Addition\',\'Setting, \'.$_POST[\'set_name\'].\', was NOT added successfully.\',\'toolkit_site_settings\');\r\n}\r\nelse if (isset($_GET[\'edit\']))\r\n{\r\n	$qry = \'UPDATE site_setting SET name=?, description=?, current_value=?, all_option=?, modifier=? WHERE id=?\';\r\n	\r\n	$params = array($_POST[\'set_name\'],$_POST[\'set_desc\'],$_POST[\'set_value\'],\r\n		$_POST[\'set_avail\'],$_SESSION[\'id\'],$_GET[\'edit\']);\r\n	$result = query_execute($qry, $params);\r\n	if ($result) msg_user(\'Setting Update\',\'Setting, \'.$_GET[\'name\'].\', updated successfully to \'.$_POST[\'set_desc\'].\'!\',\'toolkit_site_settings\');\r\n	else msg_user(\'Setting Update\',\'Setting, \'.$_GET[\'name\'].\', was NOT updated successfully\'.$_POST[\'set_desc\'].\'.\',\'toolkit_site_settings\');\r\n}\r\nelse if (isset($_GET[\'delete\']))\r\n{\r\n	$qry = \'DELETE FROM site_setting WHERE id=? LIMIT 1\';\r\n	\r\n	$params = array($_GET[\'delete\']);\r\n	$result = query_execute($qry, $params);\r\n	if ($result) msg_user(\'Setting Removal\',\'Setting, \'.$_GET[\'name\'].\', deleted successfully!\',\'toolkit_site_settings\');\r\n	else msg_user(\'Setting Removal\',\'Setting, \'.$_GET[\'name\'].\', was NOT deleted successfully.\',\'toolkit_site_settings\');\r\n}','Site Settings','',''),(296,'toolkit_command_shell','$return = \'\';\r\n$pass_cmd = \'\';\r\n\r\nif (isset($_POST[\'shell_cmd\']))\r\n{\r\n	$pass_cmd = $_POST[\'shell_cmd\'];\r\n	$return .= shell_exec($pass_cmd);\r\n}\r\n\r\n$output .= <<< OUTPUT\r\n\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n<label>Shell Command:</label><input class=\"span12\" type=\"text\" id=\"shell_cmd\" name=\"shell_cmd\" value=\"{$pass_cmd}\" placeholder=\"Type a command...\" />\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to run command\">Execute</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n\r\n<div><h3>Quick Commands:</h3>\r\n<ul>\r\n<li><a href=\"javascript:void(0)\" onclick=\"cmd(\'/usr/lib/update-notifier/update-motd-updates-available --force\')\">Check for Host Updates</a></li>\r\n<li><a href=\"javascript:void(0)\" onclick=\"cmd(\'uname -a\')\">System Information</a></li>\r\n<li><a href=\"javascript:void(0)\" onclick=\"cmd(\'cat /proc/version\')\">Version Information</a></li>\r\n</ul>\r\n</div>\r\n\r\n<br />\r\n\r\n<script>\r\nfunction cmd(passed)\r\n{\r\n$(\'#shell_cmd\').val(passed);\r\n}\r\n</script>\r\n\r\n<script>document.getElementById(\"shell_cmd\").focus();</script>\r\n\r\nOUTPUT;\r\n\r\n$output .= \'<b>Current Directory:</b> \'.shell_exec(\'pwd\').br();\r\n$output .= br().\'<pre>\';\r\n$output .= $return;\r\n$output .= \'</pre>\';','2012-07-16 22:09:19',2,1,'$return = \'\';\r\n$pass_cmd = \'\';\r\n\r\nif (isset($_POST[\'shell_cmd\']))\r\n{\r\n	$pass_cmd = $_POST[\'shell_cmd\'];\r\n	$return .= shell_exec($pass_cmd);\r\n}\r\n\r\n$output .= <<< OUTPUT\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n<label>Shell Command:</label><input class=\"span12\" type=\"text\" id=\"shell_cmd\" name=\"shell_cmd\" value=\"{$pass_cmd}\" placeholder=\"Type a command...\" />\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to run command\">Execute</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n\r\n<script>document.getElementById(\"shell_cmd\").focus();</script>\r\n\r\nOUTPUT;\r\n\r\n$output .= \'<b>Current Directory:</b> \'.shell_exec(\'pwd\').br();\r\n$output .= br().\'<pre>\';\r\n$output .= htmlentities($return, ENT_QUOTES, \'UTF-8\');\r\n$output .= \'</pre>\';','Command Shell','',''),(298,'toolkit_twitter','$output .= <<< OUTPUT\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n<label>Tweet for <a href=\"http://twitter.com/{$constant[\'TWITTER_NAME\']}\">{$constant[\'TWITTER_NAME\']}</a>:</label>\r\n<input class=\"span12\" type=\"text\"id=\"tweet\" name=\"tweet\" value=\"\" maxlength=\"140\"  placeholder=\"Tweet something...\" />\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to tweet\">Tweet</button>\r\n<a class=\"btn\" title=\"Click once to edit settings\" href=\"/toolkit_edit_method=cms_preload_define\">Settings</a>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n\r\n<script>document.getElementById(\"tweet\").focus();</script>\r\nOUTPUT;\r\n\r\n//Need this for the heredoc','2012-08-10 22:16:37',2,1,'if (isset($_POST[\'tweet\']))\r\n{\r\n	require_once(\'inc/twitter/twitter.class.php\');\r\n	\r\n	$twitter = new Twitter(TWITTER_CONSUMER_KEY, TWITTER_CONSUMER_SECRET, TWITTER_ACCESS_TOKEN, TWITTER_ACCESS_SECRET);\r\n	$twitter->send($_POST[\'tweet\']);\r\n	msg_user(\'Tweet Successful!\',\'<a href=\"http://twitter.com/\'.TWITTER_NAME.\'\">\'.$_POST[\'tweet\'].\'</a>\');\r\n}','Twitter','',''),(302,'toolkit_theme','$output .= a(img(\'Add Color\',\'/img/silk/add.png\'),\'toolkit_theme&add\').\" \";\r\n$output .= a(img(\'Save Theme\',\'/img/silk/folder_palette.png\'),\'toolkit_theme&save\').\" \";\r\n$output .= a(img(\'Load Theme\',\'/img/silk/paintcan.png\'),\'toolkit_theme&load\').br();\r\n\r\nif (isset($_GET[\'save\']))\r\n{\r\n	$out = \'\';\r\n	$qry = \"SELECT id, color, description,name FROM site_color ORDER BY description\";\r\n	$params = array();\r\n	$result = query($qry, $params);\r\n	foreach ($result as $row)\r\n	{\r\n		$out .= strtoupper($row[\'color\']).\';\'.$row[\'description\'].\';\'.$row[\'name\'].NEWLINE;\r\n	}\r\n\r\n	$output .= <<< OUTPUT\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n	<h3>Save Theme</h3>\r\n	<label>Theme Name (no file extension or random characters):</label><input class=\"span12\" type=\"text\" id=\"theme_name\" name=\"theme_name\" value=\"\" />\r\n	<label>Code:</label><textarea class=\"span12\" name=\"code\" id=\"code\">{$out}</textarea>\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to save theme\">Save</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n\r\n	<script>document.getElementById(\"theme_name\").focus();</script>\r\nOUTPUT;\r\n\r\n}\r\nelse if (isset($_GET[\'load\']))\r\n{\r\n	$out = \'\';\r\n	foreach (glob(CMS_THEME.DIR_SEP.\"*.theme\") as $file)\r\n	{\r\n		$out .= a(img(basename($file),\'/img/silk/delete.png\'),\'toolkit_theme&delete_theme=\'.$file).\' \';\r\n		$out .= a(basename($file),\'toolkit_theme&load_theme=\'.$file).br();\r\n	}\r\n\r\n	$output .= <<< OUTPUT\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n	<label>Choose a local theme:</label>\r\n	<p>{$out}</p>\r\n	\r\n	<label>or Paste a new theme:</label>\r\n	<textarea class=\"span12\" name=\"code\" id=\"code\"></textarea>\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to delete load\">Load</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n\r\nOUTPUT;\r\n}\r\nelse if (isset($_GET[\'load_theme\']))\r\n{\r\n	$result = file($_GET[\'load_theme\']);\r\n	$count = 0;\r\n	foreach ($result as $row)\r\n	{\r\n		$arr = explode(\';\',$row);\r\n		$result = query(\'SELECT color FROM site_color WHERE name=?\', array($arr[2]));\r\n		if ($result) query_execute(\'UPDATE site_color SET color=? WHERE name=?\', array($arr[0],$arr[2]));\r\n		else $count+=1;\r\n	}\r\n	if ($count==0) msg_user(\'Theme Load\',\'Theme loaded successfully!\',\'toolkit_theme\');\r\n	else msg_user(\'Theme Load\',\'Theme could not load \'.$count.\' colors.\',\'toolkit_theme\');\r\n}\r\nelse if (isset($_GET[\'delete\']))\r\n{\r\n	$set_desc = $_GET[\'name\'];\r\n	$output .= <<< OUTPUT\r\n	\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n	<h3>Delete Color</h3>\r\n	<label>Color:</label><input class=\"span12\" type=\"text\" id=\"set_desc\" name=\"set_desc\" value=\"{$set_desc}\" readonly=\"readonly\" />\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to delete setting\">Delete</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n\r\nOUTPUT;\r\n}\r\nelse if (isset($_GET[\'delete_theme\']))\r\n{\r\n	$theme = $_GET[\'delete_theme\'];\r\n	$name = basename($theme);\r\n	$output .= <<< OUTPUT\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n	<h3>Delete Theme</h3>\r\n	<label>Theme:</label><input class=\"span12\" type=\"text\" id=\"del_theme\" name=\"del_theme\" value=\"{$name}\" readonly=\"readonly\" />\r\n	<input type=\"hidden\" id=\"filename\" name=\"filename\" value=\"{$theme}\" />\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to delete theme\">Delete</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n\r\nOUTPUT;\r\n}\r\nelse if (isset($_GET[\'add\']) || isset($_GET[\'edit\']))\r\n{\r\n	$set_color = \'#123456\';\r\n	$set_desc = \'\';\r\n	$set_name = \'\';\r\n\r\n	$val1 = \'add\';\r\n	$val2 = \'Add\';\r\n	$val3 = \'Add\';\r\n\r\n	if (isset($_GET[\'edit\']))\r\n	{\r\n		$qry = \'SELECT color,description,name FROM site_color WHERE id=? LIMIT 1\';\r\n		$params = array($_GET[\'edit\']);\r\n		$result = query($qry, $params);\r\n\r\n		$set_color = $result[0][\'color\'];\r\n		$set_desc = $result[0][\'description\'];\r\n		$set_name = $result[0][\'name\'];\r\n\r\n		$val1 = \'update\';\r\n		$val2 = \'Edit\';\r\n		$val3 = \'Update\';\r\n	}\r\n\r\n	$output .= <<< OUTPUT\r\n	\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n	<h3>{$val2} Color</h3>\r\n\r\n	<div id=\"colorpicker\"></div>\r\n	<form onsubmit=\"return validateForm()\" method=\"post\">\r\n\r\n	<script type=\"text/javascript\" src=\"/inc/farbtastic/farbtastic.js\"></script>\r\n	<link rel=\"stylesheet\" href=\"/inc/farbtastic/farbtastic.css\" type=\"text/css\" />\r\n	\r\n	<label>Color:</label>\r\n	<input class=\"span12\" type=\"text\" id=\"color\" name=\"color\" value=\"{$set_color}\" style=\"width: 195px;\" />\r\n	<label>Name (all capitals, no spaces, underscores allowed):</label><input class=\"span12\" type=\"text\" \r\n	id=\"set_name\" name=\"set_name\" value=\"{$set_name}\" />\r\n	<label>Description:</label><input class=\"span12\" type=\"text\" id=\"set_desc\" name=\"set_desc\" value=\"{$set_desc}\" />\r\n<div class=\"clear\"></div>\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to {$val2} setting\">{$val3}</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n<div class=\"clear\"></div>\r\n\r\n<script type=\"text/javascript\">\r\n  $(document).ready(function() {\r\n    $(\'#colorpicker\').farbtastic(\'#color\');\r\n  });\r\n</script>\r\n\r\n	<script>document.getElementById(\"set_color\").focus();</script>\r\nOUTPUT;\r\n}	\r\n\r\n$qry = \"SELECT id, color, description,name FROM site_color ORDER BY description\";\r\n$params = array();\r\n$result = query($qry, $params);\r\n\r\nforeach ($result as $row)\r\n{\r\n	$output .= br();\r\n	$output .= a(img(\'Delete Color\',\'/img/silk/delete.png\'),\'toolkit_theme&delete=\'.$row[\'id\'].\r\n		\'&name=\'.$row[\'description\']).\' \';\r\n	$output .= a(img(\'Choose Color\',\'/img/silk/color_wheel.png\'),\'toolkit_theme&edit=\'.$row[\'id\'].\r\n		\'&name=\'.$row[\'description\']).\' \';\r\n	$output .= \'(\'.strtoupper($row[\'color\']).\') \'.$row[\'description\'].\': \'.$row[\'name\'].\' <div style=\"border: 1px solid black; float: right; display: inline-block; vertical-align: middle; background: \'.$row[\'color\'].\'; width: 300px; height: 16px\"></div>\'.br();\r\n}\r\n\r\n$output .= br().a(\'Recache when finished making changes\',\'recache\');','2012-08-04 06:38:22',2,1,'if (isset($_GET[\'save\']))\r\n{\r\n	$result = file_put_contents(CMS_THEME.DIR_SEP.$_POST[\'theme_name\'].\'.theme\',$_POST[\'code\']);\r\n	if ($result) msg_user(\'Theme Save\',\'Theme, \'.$_POST[\'theme_name\'].\', saved successfully!\',\'toolkit_theme\');\r\n	else msg_user(\'Theme Save\',\'Theme, \'.$_POST[\'theme_name\'].\', was NOT saved successfully.\',\'toolkit_theme\');\r\n}\r\nelse if (isset($_GET[\'add\']))\r\n{\r\n	$qry = \'INSERT INTO site_color (color,description,name,modified,modifier) VALUES(?,?,?,CURRENT_TIMESTAMP,?)\';\r\n	\r\n	$params = array($_POST[\'color\'],$_POST[\'set_desc\'],$_POST[\'set_name\'],$_SESSION[\'id\']);\r\n	$result = query_execute($qry, $params);\r\n	if ($result) msg_user(\'Color Addition\',\'Color, \'.$_POST[\'set_desc\'].\', added successfully!\',\'toolkit_theme\');\r\n	else msg_user(\'Color Addition\',\'Color, \'.$_POST[\'set_desc\'].\', was NOT added successfully.\',\'toolkit_theme\');\r\n}\r\nelse if (isset($_GET[\'edit\']))\r\n{\r\n	$qry = \'UPDATE site_color SET color=?, name=?, description=?, modifier=? WHERE id=?\';\r\n	\r\n	$params = array($_POST[\'color\'],$_POST[\'set_name\'],$_POST[\'set_desc\'],$_SESSION[\'id\'],$_GET[\'edit\']);\r\n	$result = query_execute($qry, $params);\r\n	if ($result) msg_user(\'Color Update\',\'Setting, \'.$_POST[\'set_desc\'].\', updated successfully to \'.$_POST[\'color\'].\'!\',\'toolkit_theme\');\r\n	else msg_user(\'Color Update\',\'Setting, \'.$_POST[\'set_desc\'].\', was NOT updated successfully\'.$_POST[\'color\'].\'.\',\'toolkit_theme\');\r\n}\r\nelse if (isset($_GET[\'delete\']))\r\n{\r\n	$qry = \'DELETE FROM site_color WHERE id=? LIMIT 1\';\r\n	\r\n	$params = array($_GET[\'delete\']);\r\n	$result = query_execute($qry, $params);\r\n	if ($result) msg_user(\'Color Removal\',\'Setting, \'.$_GET[\'name\'].\', deleted successfully!\',\'toolkit_theme\');\r\n	else msg_user(\'Color Removal\',\'Setting, \'.$_GET[\'name\'].\', was NOT deleted successfully.\',\'toolkit_theme\');\r\n}\r\nelse if (isset($_GET[\'delete_theme\']))\r\n{\r\n	$result = @unlink($_POST[\'filename\']);\r\n	if ($result) msg_user(\'Theme Delete\',\'Theme, \'.$_POST[\'filename\'].\', deleted successfully!\',\'toolkit_theme\');\r\n	else msg_user(\'Theme Delete\',\'Theme, \'.$_POST[\'filename\'].\', was NOT deleted successfully.\',\'toolkit_theme\');\r\n\r\n}\r\nelse if (isset($_GET[\'load\']))\r\n{\r\n	$result = explode(\"\\n\",$_POST[\'code\']);\r\n	$count = 0;\r\n	foreach ($result as $row)\r\n	{\r\n		$arr = explode(\';\',$row);\r\n		$result = query(\'SELECT color FROM site_color WHERE name=?\', array($arr[2]));\r\n		if ($result) query_execute(\'UPDATE site_color SET color=? WHERE name=?\', array($arr[0],$arr[2]));\r\n		else $count+=1;\r\n	}\r\n	if ($count==0) msg_user(\'Theme Load\',\'Custom theme loaded successfully!\',\'toolkit_theme\');\r\n	else msg_user(\'Theme Load\',\'Custom theme could not load \'.$count.\' colors.\',\'toolkit_theme\');\r\n}','Theme Manager (Not Functional)','',''),(305,'access_register','if (isset($_GET[\'image\']))\r\n{\r\n	//while(@ob_end_clean());\r\n	include_once \'inc/securimage/securimage.php\';\r\n	$securimage = new Securimage();\r\n	$securimage->show();  // outputs the image and content headers to the browser\r\n	exit;\r\n}\r\n\r\n$rand = rand();\r\n\r\n$output .= <<< OUTPUT\r\n\r\n<div class=\"fluid-row\">\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n<div class=\"span4\">\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n<p class=\"help-block\">In order to access content, you need an account. \r\nPlease enter your information below. Your email address will be safe.</p>\r\n\r\n<label>First Name:</label><input class=\"span12\" type=\"text\" id=\"first_name\" name=\"first_name\" value=\"\" placeholder=\"required\" />\r\n<label>Last Name:</label><input class=\"span12\" type=\"text\" id=\"last_name\" name=\"last_name\" value=\"\" placeholder=\"required\" />\r\n<label>Email:</label><input class=\"span12\" type=\"text\" id=\"email\" name=\"email\" value=\"\" placeholder=\"required\" />\r\n\r\n<div style=\"height: 100px;\">\r\n	<img id=\"captcha\" src=\"/access_register&image={$rand}\" alt=\"CAPTCHA Image\" />\r\n</div>\r\n<label>Code:</label><input class=\"span12\" type=\"text\" name=\"captcha_code\" size=\"10\" maxlength=\"6\" placeholder=\"required\" />\r\n<a href=\"#\" onclick=\"document.getElementById(\'captcha\').src = \'/access_register&image?\' + Math.random(); return false\">[ Different Image ]</a>\r\n\r\n<div class=\"clear\"></div><br />\r\n<button type=\"submit\" class=\"btn\" title=\"Click once to register\">Register</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"span4\">\r\n</div>\r\n\r\n</div>\r\n\r\n<script>document.getElementById(\"first_name\").focus();</script>\r\n\r\nOUTPUT;\r\n\r\n// Need this','2012-06-17 04:56:34',2,1,'include_once \'inc/securimage/securimage.php\';\r\n$securimage = new Securimage();\r\n\r\nif ($securimage->check($_POST[\'captcha_code\']) == false)\r\n{\r\n	$output .= \'The security code entered was incorrect.<br /><br />\';\r\n	$output .= \'Please go <a href=\"javascript:history.go(-1)\">back</a> and try again.\';\r\n}\r\nelse\r\n{\r\n	$output .= \'Captcha worked!\';\r\n	unset($_SESSION[\'securimage_code_value\']);\r\n	unset($_SESSION[\'securimage_code_ctime\']);\r\n}\r\n\r\n//unset($_SESSION[\'captchafailed\']);\r\n//unset($_SESSION[\'CESecurity\']);','Register a New Account','',''),(320,'toolkit_edit_method','$qry = \'SELECT name,method,type,post,title,keyword,description FROM php_methods WHERE name=? LIMIT 1\';\r\n$params = array($_GET[\'toolkit_edit_method\']);\r\n$page_arr = query($qry, $params);\r\n$page_text = htmlentities($page_arr[0][\'method\'], ENT_QUOTES, \'UTF-8\');\r\n$page_post = htmlentities($page_arr[0][\'post\'], ENT_QUOTES, \'UTF-8\');\r\n\r\n$arr = query(\'SELECT method FROM php_methods WHERE name=? LIMIT 1\', array(\'script_javascript\'));\r\n$js_method = htmlentities($arr[0][\'method\'], ENT_QUOTES, \'UTF-8\');\r\n\r\n$arr = query(\'SELECT method FROM php_methods WHERE name=? LIMIT 1\', array(\'style_default\'));\r\n$cssvar_method = htmlentities($arr[0][\'method\'], ENT_QUOTES, \'UTF-8\');\r\n\r\n$arr = query(\'SELECT method FROM php_methods WHERE name=? LIMIT 1\', array(\'style_html\'));\r\n$csscode_method = htmlentities($arr[0][\'method\'], ENT_QUOTES, \'UTF-8\');\r\n\r\n$arr = query(\'SELECT method FROM php_methods WHERE name=? LIMIT 1\', array(\'misc_notepad\'));\r\n$notepad_method = htmlentities($arr[0][\'method\'], ENT_QUOTES, \'UTF-8\');\r\n\r\n$type0 = \'\';\r\n$type1 = \'\';\r\n$type10 = \'\';\r\n$select_language = \'\';\r\n\r\nif (isset($page_arr[0][\'type\']) && $page_arr[0][\'type\']===0)\r\n{\r\n	$type0 = \'checked\';\r\n	$select_language = \'<option value=\"htm\">HTML</option>\';\r\n}\r\nelse if (isset($page_arr[0][\'type\']) && $page_arr[0][\'type\']===1)\r\n{\r\n	$type1 = \'checked\';\r\n	$select_language = \'<option value=\"php\">PHP</option>\';\r\n}\r\nelse if (isset($page_arr[0][\'type\']) && $page_arr[0][\'type\']===10)\r\n{\r\n	$type10 = \'checked\';\r\n	$select_language = \'<option value=\"htm\">HTML</option>\';\r\n}\r\n\r\n$output .= <<< OUTPUT\r\n<!-- Tabs -->\r\n      <ul class=\"nav nav-tabs pull-left\">\r\n        <li class=\"active\"><a href=\"#tab1\" data-toggle=\"tab\">Page</a></li>\r\n        <li id=\"post_tab\"><a href=\"#tab2\" data-toggle=\"tab\">Post</a></li>\r\n        <li id=\"js_tab\"><a href=\"#tab3\" data-toggle=\"tab\">JavaScript</a></li>\r\n        <li id=\"cssvar_tab\"><a href=\"#tab4\" data-toggle=\"tab\">CSS Var</a></li>\r\n        <li id=\"csscode_tab\"><a href=\"#tab5\" data-toggle=\"tab\">CSS Code</a></li>\r\n        <li><a href=\"#tab6\" data-toggle=\"tab\">Notepad</a></li>\r\n        <li><a href=\"#tab7\" data-toggle=\"tab\">Help</a></li>\r\n      </ul>\r\n\r\n<script>\r\nfunction checkDynamic()\r\n{\r\n	rad_val = $(\"input:checked\").val();\r\n	if (rad_val==10)\r\n	{\r\n		$(\'#methodtextedit\').attr(\'disabled\',\'disabled\');\r\n		$(\'#methodtextedit\').css(\'display\',\'none\');\r\n\r\n		$(\'#page_buttons\').css(\'display\',\'none\');\r\n		$(\'#post_tab\').css(\'display\',\'none\');\r\n		$(\'#js_tab\').css(\'display\',\'none\');\r\n		$(\'#cssvar_tab\').css(\'display\',\'none\');\r\n		$(\'#csscode_tab\').css(\'display\',\'none\');\r\n		\r\n		if ($(\'#methodtextedit_dyn\').val().length>64 || $(\'#methodtextedit_dyn\').val()==\'blank\') $(\'#methodtextedit_dyn\').val(\'\');\r\n\r\n		if ($(\'#methodtextedit\').val().length<1)\r\n		{\r\n			$(\'#methodtextedit\').val(\'blank\');\r\n			$(\'#methodtexteditorg\').val(\'blank\');\r\n		}\r\n		\r\n		$(\'#methodtextedit_dyn\').removeAttr(\'disabled\');\r\n		$(\'#methodtextedit_dyn\').css(\'display\',\'\');\r\n	}\r\n	else\r\n	{\r\n		$(\'#methodtextedit_dyn\').attr(\'disabled\',\'disabled\');\r\n		$(\'#methodtextedit_dyn\').css(\'display\',\'none\');\r\n\r\n		$(\'#page_buttons\').css(\'display\',\'\');\r\n		$(\'#post_tab\').css(\'display\',\'\');\r\n		$(\'#js_tab\').css(\'display\',\'\');\r\n		$(\'#cssvar_tab\').css(\'display\',\'\');\r\n		$(\'#csscode_tab\').css(\'display\',\'\');\r\n\r\n		if ($(\'#methodtexteditorg\').val()==\'\')\r\n		{\r\n			$(\'#methodtexteditorg\').val(\'blank\');\r\n		}\r\n\r\n		if ($(\'#methodtextedit_dyn\').val()==\'\')\r\n		{\r\n			$(\'#methodtextedit_dyn\').val(\'blank\');\r\n		}\r\n\r\n		if ($(\'#methodtextedit\').val()==\'blank\')\r\n		{\r\n			$(\'#methodtextedit\').val(\'\');\r\n			$(\'#methodtexteditorg\').val(\'blank\');\r\n		}\r\n\r\n		$(\'#methodtextedit\').removeAttr(\'disabled\');\r\n		$(\'#methodtextedit\').css(\'display\',\'\');\r\n	}\r\n}\r\n\r\n$(function() {\r\n	checkDynamic()\r\n});\r\n\r\n</script>\r\n\r\n	<div style=\"clear:both;\"></div>\r\n\r\n<!-- Beginning of the Save form -->\r\n<form name=\"standardform\" class=\"form-horizontal\" id=\"editfrm\" method=\"post\" onsubmit=\"return validateEditMethodForm()\">\r\n<fieldset>\r\n<!-- Tab \"Panes\" -->\r\n<div class=\"tab-content\">\r\n\r\n<style>\r\ntextarea {  height: 400px; }\r\n</style>\r\n\r\n<!-- Tab: Page -->\r\n<div class=\"tab-pane fade active in\" id=\"tab1\" style=\"height: auto;\">\r\n\r\n	<input type=\"text\" name=\"methodnameedit\" id=\"methodnameedit\" placeholder=\"Name\" \r\n	title=\"Page Name: one word, only letters, numbers, and underscores\"\r\n	value=\"{$page_arr[0][\'name\']}\"/>\r\n\r\n	<input type=\"hidden\" id=\"methodtitle_org\" name=\"methodtitle_org\" value=\"{$page_arr[0][\'title\']}\" />\r\n	<input type=\"hidden\" id=\"methoddescription_org\" name=\"methoddescription_org\" value=\"{$page_arr[0][\'description\']}\" />\r\n	<input type=\"hidden\" id=\"methodkeyword_org\" name=\"methodkeyword_org\" value=\"{$page_arr[0][\'keyword\']}\" />\r\n	<input type=\"hidden\" id=\"methodtype_org\" name=\"methodtype_org\" value=\"{$page_arr[0][\'type\']}\" />\r\n\r\n	<input type=\"text\" name=\"methodtitle_optional\" id=\"methodtitle_optional\" placeholder=\"Title\" \r\n	title=\"Page Title: max of 70 characters, title shows in search engines\"\r\n	value=\"{$page_arr[0][\'title\']}\"/>\r\n\r\n	<input type=\"text\" name=\"methoddescription_optional\" id=\"methoddescription_optional\" placeholder=\"Description\" \r\n	title=\"Page Description: max of 160 characters, description shows in search engines\"\r\n	value=\"{$page_arr[0][\'description\']}\"/>\r\n\r\n	<input type=\"text\" name=\"methodkeyword_optional\" id=\"methodkeyword_optional\" placeholder=\"Keywords\" \r\n	title=\"Page Keywords: enter about 5 words separated by commas, the more relevant the better\"\r\n	value=\"{$page_arr[0][\'keyword\']}\"/>\r\n			<label class=\"radio inline\">\r\n				<input type=\"radio\" id=\"rad1\" name=\"methodtypeedit\" value=\"0\" {$type0} onchange=\"checkDynamic()\"/> HTML\r\n			</label>\r\n			<label class=\"radio inline\">\r\n				<input type=\"radio\" id=\"rad2\" name=\"methodtypeedit\" value=\"1\" {$type1} onchange=\"checkDynamic()\"/> PHP\r\n			</label>\r\n			<label class=\"radio inline\" title=\"Dynamic Page, simply add a table name below\">\r\n				<input type=\"radio\" id=\"rad10\" name=\"methodtypeedit\" value=\"10\" {$type10} onchange=\"checkDynamic()\"/> DYN\r\n			</label>\r\n\r\n	<div class=\"clear\"></div><br />\r\n\r\n	<textarea id=\"methodtextedit\" name=\"methodtextedit\" wrap=\"off\" class=\"span12\" placeholder=\"PHP or HTML code goes here\">{$page_text}</textarea>\r\n\r\n	<textarea id=\"methodtexteditorg\" name=\"methodtexteditorg\" style=\"display:none;\">{$page_text}</textarea>\r\n\r\n	<input type=\"text\" name=\"methodtextedit\" id=\"methodtextedit_dyn\" placeholder=\"Table name\" \r\n	title=\"Create a new table name using only letters and underscores, no spaces, 64 characters max\" maxlength=\"64\"\r\n	value=\"{$page_text}\" disabled=\"disabled\" style=\"display: none;\" />\r\n\r\n	<div class=\"clear\"></div>\r\n\r\n	<select id=\"language\" name=\"language\" title=\"Select the correct language and click Highlight\"\r\n	style=\"float: left; padding: 3px 4px 4px 0px; margin-right: 7px; display: none;\">\r\n	{$select_language}\r\n	<option value=\"htm\">HTML</option>\r\n	<option value=\"css\">CSS</option>\r\n	<option value=\"js\">JavaScript</option>\r\n	<option value=\"php\">PHP</option>\r\n	<option value=\"sql\">MySQL</option>\r\n	<option value=\"sqlite\">SQLite</option>\r\n	<option value=\"pgsql\">PostgreSQL</option>\r\n	<option value=\"mssql\">MS SQL</option>\r\n	<option value=\"oracle\">Oracle</option>\r\n	<option value=\"cnf\">Apache</option>\r\n	<option value=\"phpini\">php.ini</option>\r\n	<option value=\"http\">HTTP</option>\r\n	<option value=\"mail\">E-mail</option>\r\n	<option value=\"xml\">XML</option>\r\n	<option value=\"txt\">Text</option>\r\n	</select>\r\n\r\n	<div id=\"page_buttons\" class=\"btn-toolbar\">\r\n		<div class=\"btn-group\">\r\n			<a class=\"btn\" onClick=\"receiveSyntaxCheck(document.getElementsByName(\'methodtextedit\')[0].value)\">PHP Syntax Check</a>\r\n		</div>\r\n		<div class=\"btn-group\">\r\n			<a class=\"btn btn-success\" onClick=\"document.getElementById(\'jush-result\').innerHTML = \'<pre><code class=\\\'jush-\' + document.getElementById(\'language\').value + \'\\\'>\' +\r\n			jush.highlight(document.getElementById(\'language\').value, document.getElementsByName(\'methodtextedit\')[0].value) + \'</code></pre>\';\">Highlight</a>\r\n		\r\n			<a class=\"btn btn-danger\" onClick=\"document.getElementById(\'jush-result\').innerHTML = \'\';\">Clear</a>\r\n		</div>\r\n		<div class=\"btn-group\">\r\n			<a class=\"btn\" onClick=\"indentSelection(document.getElementsByName(\'methodtextedit\')[0], \'	\')\">Indent Line(s)</a>\r\n			<a class=\"btn\" onClick=\"outdentSelection(document.getElementsByName(\'methodtextedit\')[0], \'	\')\">Outdent Line(s)</a>\r\n		</div>\r\n		<div class=\"btn-group\">\r\n			<a class=\"btn\" name=\"add_num1\" id=\"add_num1\" onClick=\"addNumbers1()\">Line Numbers On</a>\r\n			<a class=\"btn\" name=\"del_num1\" id=\"del_num1\" onClick=\"delNumbers1()\">Line Numbers Off</a>\r\n		</div>\r\n	</div>\r\n	\r\n	<div class=\"clear\"></div>\r\n	\r\n	<div id=\"jush-result\">\r\n	</div>\r\n	\r\n	<script type=\"text/javascript\" src=\"jush/jush.js\"></script>\r\n	<script type=\"text/javascript\">\r\n	jush.style(\'jush/jush.css\');\r\n	jush.highlight_tag(\'code\');\r\n	</script>\r\n	\r\n	<div class=\"clear\"></div>\r\n	\r\n	<input type=\"hidden\" id=\"methodorgname\" name=\"methodorgname\" value=\"{$page_arr[0][\'name\']}\" />\r\n\r\n	<div style=\"clear:both;\"></div>\r\n	\r\n</div>\r\n\r\n<!-- Tab: Post -->\r\n<div class=\"tab-pane fade\" id=\"tab2\" style=\"height: auto;\">\r\n\r\n	<textarea id=\"methodpostedit\" name=\"methodpostedit\" class=\"span12\"\r\n	rows=\"25\" cols=\"65\" wrap=\"off\">{$page_post}</textarea>\r\n	\r\n	<textarea id=\"methodposteditorg\" name=\"methodposteditorg\" style=\"display:none;\">{$page_post}</textarea>\r\n\r\n	<div class=\"btn-toolbar\">\r\n		<div class=\"btn-group\">\r\n			<a class=\"btn\" onClick=\"receiveSyntaxCheck(document.getElementById(\'methodpostedit\').value)\">PHP Syntax Check</a>\r\n		</div>\r\n		<div class=\"btn-group\">\r\n			<a class=\"btn btn-success\" onClick=\"document.getElementById(\'jush-result-post\').innerHTML = \'<pre><code class=\\\'jush-\' + document.getElementById(\'language\').value + \'\\\'>\' +\r\n			jush.highlight(document.getElementById(\'language\').value, document.getElementById(\'methodpostedit\').value) + \'</code></pre>\';\">Highlight</a>\r\n		\r\n			<a class=\"btn btn-danger\" onClick=\"document.getElementById(\'jush-result-post\').innerHTML = \'\';\">Clear</a>\r\n		</div>\r\n		<div class=\"btn-group\">\r\n			<a class=\"btn\" onClick=\"indentSelection(document.standardform.methodpostedit, \'	\')\">Indent Line(s)</a>\r\n			<a class=\"btn\" onClick=\"outdentSelection(document.standardform.methodpostedit, \'	\')\">Outdent Line(s)</a>\r\n		</div>\r\n		<div class=\"btn-group\">\r\n			<a class=\"btn\" name=\"add_num2\" id=\"add_num2\" onClick=\"addNumbers2()\">Line Numbers On</a>\r\n			<a class=\"btn\" name=\"del_num2\" id=\"del_num2\" onClick=\"delNumbers2()\">Line Numbers Off</a>\r\n		</div>\r\n	</div>\r\n	\r\n	<div class=\"clear\"></div>\r\n	\r\n	<div id=\"jush-result-post\">\r\n	</div>\r\n	\r\n	<div style=\"clear:both;\"></div>\r\n\r\n</div>\r\n\r\n<!-- Tab: JavaScript -->\r\n<div class=\"tab-pane fade\" id=\"tab3\" style=\"height: auto;\">\r\n\r\n	<textarea id=\"methodjsedit\" name=\"methodjsedit\" class=\"span12\"\r\n	rows=\"25\" cols=\"65\" wrap=\"off\">{$js_method}</textarea>\r\n	\r\n	<textarea id=\"methodjseditorg\" name=\"methodjseditorg\" style=\"display:none;\">{$js_method}</textarea>\r\n\r\n	<div class=\"btn-toolbar\">\r\n		<div class=\"btn-group\">\r\n			<a class=\"btn btn-success\" onClick=\"document.getElementById(\'jush-result-js\').innerHTML = \'<pre><code class=\\\'jush-\' + \'js\' + \'\\\'>\' +\r\n			jush.highlight(\'js\', document.getElementById(\'methodjsedit\').value) + \'</code></pre>\';\">Highlight</a>\r\n		\r\n			<a class=\"btn btn-danger\" onClick=\"document.getElementById(\'jush-result-js\').innerHTML = \'\';\">Clear</a>\r\n		</div>\r\n		<div class=\"btn-group\">\r\n			<a class=\"btn\" onClick=\"indentSelection(document.standardform.methodjsedit, \'	\')\">Indent Line(s)</a>\r\n			<a class=\"btn\" onClick=\"outdentSelection(document.standardform.methodjsedit, \'	\')\">Outdent Line(s)</a>\r\n		</div>\r\n	</div>\r\n	\r\n	<div class=\"clear\"></div>\r\n	\r\n	<div id=\"jush-result-js\">\r\n	</div>\r\n	\r\n	<div style=\"clear:both;\"></div>\r\n\r\n\r\n</div>\r\n\r\n<!-- Tab: CSS Var -->\r\n<div class=\"tab-pane fade\" id=\"tab4\" style=\"height: auto;\">\r\n\r\n	<textarea id=\"methodcssvaredit\" name=\"methodcssvaredit\" class=\"span12\"\r\n	rows=\"25\" cols=\"65\" wrap=\"off\">{$cssvar_method}</textarea>\r\n	\r\n	<textarea id=\"methodcssvareditorg\" name=\"methodcssvareditorg\" style=\"display:none;\">{$cssvar_method}</textarea>\r\n\r\n	<div class=\"btn-toolbar\">\r\n		<div class=\"btn-group\">\r\n			<a class=\"btn btn-success\" onClick=\"document.getElementById(\'jush-result-cssvar\').innerHTML = \'<pre><code class=\\\'jush-\' + \'php\' + \'\\\'>\' +\r\n			jush.highlight(\'php\', document.getElementById(\'methodcssvaredit\').value) + \'</code></pre>\';\">Highlight</a>\r\n		\r\n			<a class=\"btn btn-danger\" onClick=\"document.getElementById(\'jush-result-cssvar\').innerHTML = \'\';\">Clear</a>\r\n		</div>\r\n		<div class=\"btn-group\">\r\n			<a class=\"btn\" onClick=\"indentSelection(document.standardform.methodcssvaredit, \'	\')\">Indent Line(s)</a>\r\n			<a class=\"btn\" onClick=\"outdentSelection(document.standardform.methodcssvaredit, \'	\')\">Outdent Line(s)</a>\r\n		</div>\r\n	</div>\r\n	\r\n	<div class=\"clear\"></div>\r\n	\r\n	<div id=\"jush-result-cssvar\">\r\n	</div>\r\n	\r\n	<div style=\"clear:both;\"></div>\r\n\r\n</div>\r\n\r\n<!-- Tab: CSS Code -->\r\n<div class=\"tab-pane fade\" id=\"tab5\" style=\"height: auto;\">\r\n\r\n	<textarea id=\"methodcsscodeedit\" name=\"methodcsscodeedit\" class=\"span12\"\r\n	rows=\"25\" cols=\"65\" wrap=\"off\">{$csscode_method}</textarea>\r\n	\r\n	<textarea id=\"methodcsscodeeditorg\" name=\"methodcsscodeeditorg\" style=\"display:none;\">{$csscode_method}</textarea>\r\n\r\n	<div class=\"btn-toolbar\">\r\n		<div class=\"btn-group\">\r\n			<a class=\"btn btn-success\" onClick=\"document.getElementById(\'jush-result-csscode\').innerHTML = \'<pre><code class=\\\'jush-\' + \'css\' + \'\\\'>\' +\r\n			jush.highlight(\'css\', document.getElementById(\'methodcsscodeedit\').value) + \'</code></pre>\';\">Highlight</a>\r\n		\r\n			<a class=\"btn btn-danger\" onClick=\"document.getElementById(\'jush-result-csscode\').innerHTML = \'\';\">Clear</a>\r\n		</div>\r\n		<div class=\"btn-group\">\r\n			<a class=\"btn\" onClick=\"indentSelection(document.standardform.methodcsscodeedit, \'	\')\">Indent Line(s)</a>\r\n			<a class=\"btn\" onClick=\"outdentSelection(document.standardform.methodcsscodeedit, \'	\')\">Outdent Line(s)</a>\r\n		</div>\r\n	</div>\r\n	\r\n	<div class=\"clear\"></div>\r\n	\r\n	<div id=\"jush-result-csscode\">\r\n	</div>\r\n	\r\n	<div style=\"clear:both;\"></div>\r\n\r\n</div>\r\n\r\n<!-- Tab: Notepad -->\r\n<div class=\"tab-pane fade\" id=\"tab6\" style=\"height: auto;\">\r\n	<textarea id=\"methodnotepadedit\" name=\"methodnotepadedit\" class=\"span12\"\r\n	rows=\"25\" cols=\"65\" wrap=\"off\">{$notepad_method}</textarea>\r\n	\r\n	<textarea id=\"methodnotepadeditorg\" name=\"methodnotepadeditorg\" style=\"display:none;\">{$notepad_method}</textarea>\r\n\r\n	<div class=\"btn-toolbar\">\r\n		<div class=\"btn-group\">\r\n			<a class=\"btn\" onClick=\"indentSelection(document.standardform.methodnotepadedit, \'	\')\">Indent Line(s)</a>\r\n			<a class=\"btn\" onClick=\"outdentSelection(document.standardform.methodnotepadedit, \'	\')\">Outdent Line(s)</a>\r\n		</div>\r\n	</div>\r\n	\r\n	<div class=\"clear\"></div>\r\n	\r\n	<div id=\"jush-result-notepad\">\r\n	</div>\r\n	\r\n	<div style=\"clear:both;\"></div>\r\n</div>\r\n\r\n<!-- Tab: Help -->\r\n<div class=\"tab-pane fade\" id=\"tab7\">\r\n<div class=\"tabbable tabs-left\">\r\n      <ul class=\"bottom nav nav-tabs pull-left\">\r\nOUTPUT;\r\n\r\n	$result = query(\'SELECT topic,entry FROM site_help ORDER BY topic\', array());\r\n$count = 10;\r\n	foreach($result as $row)\r\n	{\r\n$count += 1;\r\n		// Output the result\r\nif ($count==11) $active = \'class=\"active\"\';\r\nelse $active = \'\';\r\n		$output .= \'<li \'.$active.\'><a href=\"#tab\'.$count.\'\" data-toggle=\"tab\">\'.htmlentities($row[\'topic\'], ENT_QUOTES, \'UTF-8\').\'</a></li>\';\r\n	}\r\n\r\n$output .= <<< OUTPUT\r\n      </ul>\r\n	<!-- <div style=\"clear:both;\"></div> -->\r\n<div class=\"tab-content\">\r\n<!-- Tab \"panes\" inside Tab: Help -->\r\n\r\nOUTPUT;\r\n\r\n	$result = query(\'SELECT topic,entry,id FROM site_help ORDER BY topic\', array());\r\n$count = 10;\r\n	foreach($result as $row)\r\n	{\r\n$count += 1;\r\n		// Output the result\r\nif ($count==11) $active = \' fade active in\';\r\nelse $active = \' fade\';\r\n		$output .= \'<div class=\"tab-pane\'.$active.\'\" id=\"tab\'.$count.\'\"><pre class=\"prettyprint linenums\">\'.htmlentities($row[\'entry\'], ENT_QUOTES, \'UTF-8\').\'</pre></div>\';\r\n	}\r\n\r\n$output .= <<< OUTPUT\r\n\r\n</div> <!-- End Tab: Help -->\r\n</div> <!-- End Tab \"Panes\" -->\r\n</div>\r\n</div>\r\n\r\n<div class=\"btn-toolbar\">\r\n	<div class=\"btn-group\">\r\n		<button class=\"btn btn-primary\" title=\"Click once to save the code\">Save</button>\r\n		<a class=\"btn\" title=\"Click once to save the code without leaving the page\" name=\"quicksave\" onClick=\"quickSave()\">Quick Save</a>\r\n	</div>\r\n</div>\r\n\r\n<div style=\"clear:both;\"></div>\r\n\r\n</fieldset>\r\n<!-- End of the Save form -->\r\n</form>\r\n\r\n\r\n<!-- This JavaScript snippet activates those tabs -->\r\n<script>\r\n\r\nfunction quickSave()\r\n{\r\n	if (validateEditMethodForm())\r\n	{\r\n		//$(\"#methodtexteditorg\").val($(\"#methodtextedit\").val());\r\n		//$(\"#methodposteditorg\").val($(\"#methodpostedit\").val());\r\n		//$(\"#methodjseditorg\").val($(\"#methodjsedit\").val());\r\n		//$(\"#methodcssvareditorg\").val($(\"#methodcssvaredit\").val());\r\n		//$(\"#methodcsscodeeditorg\").val($(\"#methodcsscodeedit\").val());\r\n		//$(\"#methodnotepadeditorg\").val($(\"#methodnotepadedit\").val());\r\n		//this.form.elements[\"methodtexteditorg\"].value = this.form.elements[\"methodtextedit\"].value;\r\n		$.post(\"{$_SERVER[\'REQUEST_URI\']}\", $(\"#editfrm\").serialize());\r\n		document.getElementById(\"methodorgname\").value = document.getElementById(\"methodnameedit\").value;\r\n		document.getElementById(\"methodtexteditorg\").value = document.getElementById(\"methodtextedit\").value;\r\n		document.getElementById(\"methodposteditorg\").value = document.getElementById(\"methodpostedit\").value;\r\n		document.getElementById(\"methodjseditorg\").value = document.getElementById(\"methodjsedit\").value;\r\n		document.getElementById(\"methodcssvareditorg\").value = document.getElementById(\"methodcssvaredit\").value;\r\n		document.getElementById(\"methodcsscodeeditorg\").value = document.getElementById(\"methodcsscodeedit\").value;\r\n		document.getElementById(\"methodnotepadeditorg\").value = document.getElementById(\"methodnotepadedit\").value;\r\n	}\r\n}\r\n\r\n$(\"#del_num1\").hide();\r\nfunction addNumbers1()\r\n{\r\n	$(\"#methodtextedit\").linedtextarea();\r\n	$(\"#add_num1\").hide();\r\n	$(\"#del_num1\").show();\r\n}\r\nfunction delNumbers1()\r\n{\r\n	$(\"#methodtextedit\").unwrap();\r\n	$(\"#methodtextedit\").unwrap();\r\n	$(\"#methodtextedit\").removeAttr(\'style\');\r\n	$(\"#methodtextedit\").unbind(\"scroll\");\r\n	$(\"#methodtextedit\").unbind(\"resize\");\r\n	$(\'.lines\').remove();\r\n	$(\"#del_num1\").hide();\r\n	$(\"#add_num1\").show();\r\n\r\nif( $(\"#add_num2\").css(\"display\") == \'none\' ) delNumbers2();\r\n\r\n}\r\n\r\n$(\"#del_num2\").hide();\r\nfunction addNumbers2()\r\n{\r\n	$(\"#methodpostedit\").linedtextarea();\r\n	$(\"#add_num2\").hide();\r\n	$(\"#del_num2\").show();\r\n}\r\nfunction delNumbers2()\r\n{\r\n	$(\"#methodpostedit\").unwrap();\r\n	$(\"#methodpostedit\").unwrap();\r\n	$(\"#methodpostedit\").removeAttr(\'style\');\r\n	$(\"#methodpostedit\").unbind(\"scroll\");\r\n	$(\"#methodpostedit\").unbind(\"resize\");\r\n	$(\'.lines\').remove();\r\n	$(\"#del_num2\").hide();\r\n	$(\"#add_num2\").show();\r\n\r\nif( $(\"#add_num1\").css(\"display\") == \'none\' ) delNumbers1();\r\n}\r\n\r\n</script>\r\nOUTPUT;\r\n\r\n//Need this for the heredoc','2012-08-10 22:29:06',2,1,'if (isset($_POST[\'txtcode\']))\r\n{\r\n	restore_error_handler();\r\n	ini_set(\'log_errors\', 0);\r\n	ini_set(\'track_errors\', 1);\r\n	\r\n	$_SESSION[\'ignore_errors\']=true;\r\n	ob_start();\r\n	// The new line ensures an heredoc at the very end of a method is terminated correctly\r\n	$return = eval($_POST[\'txtcode\']);\r\n	$result = ob_get_contents();\r\n	ob_end_clean();\r\n	//$output .= $result;\r\n	\r\n	if ($return===false || isset($php_errormsg)) die(\"Code Syntax Error\".NEWLINE.$php_errormsg.NEWLINE.$result);\r\n	else die(\"Code Syntax Correct\");\r\n}\r\n\r\nif (isset($_POST[\'methodnameedit\'])\r\n && isset($_POST[\'methodorgname\'])\r\n\r\n && isset($_POST[\'methodtextedit\'])\r\n && isset($_POST[\'methodtexteditorg\'])\r\n\r\n && isset($_POST[\'methodtypeedit\'])\r\n\r\n && isset($_POST[\'methodjsedit\'])\r\n && isset($_POST[\'methodjseditorg\'])\r\n\r\n && isset($_POST[\'methodcssvaredit\'])\r\n && isset($_POST[\'methodcssvareditorg\'])\r\n\r\n && isset($_POST[\'methodcsscodeedit\'])\r\n && isset($_POST[\'methodcsscodeeditorg\'])\r\n\r\n && isset($_POST[\'methodnotepadedit\'])\r\n && isset($_POST[\'methodnotepadeditorg\'])\r\n\r\n && isset($_POST[\'methodpostedit\'])\r\n && isset($_POST[\'methodposteditorg\']))\r\n{\r\n	$clean_name = str_replace(\' \',\'-\',$_POST[\'methodnameedit\']);\r\n\r\n	$append=\'\';//\r\n\r\n	// Check for rename operation\r\n	if (isset($clean_name) && isset($_POST[\'methodorgname\']))\r\n	{\r\n		if ($clean_name != $_POST[\'methodorgname\'])\r\n		{\r\n			db_method_update($clean_name,$_POST[\'methodtextedit\'],\r\n			$_POST[\'methodtypeedit\'],\r\n			$_POST[\'methodorgname\'],$_POST[\'methodpostedit\'],\r\n			$_POST[\'methodtitle_optional\'],$_POST[\'methodkeyword_optional\'],$_POST[\'methoddescription_optional\']);\r\n			$append.=\'Rename (\'.$_POST[\'methodorgname\'].\' to <a href=\"index.php?toolkit_edit_method=\'.$clean_name.\'&type=\'.$_POST[\'methodtypeedit\'].\'\">\'.$clean_name.\'</a>)\';\r\n		}\r\n	}\r\n\r\n	// Check for method text change\r\n	if (isset($_POST[\'methodtextedit\']) && isset($_POST[\'methodtexteditorg\']))\r\n	{\r\n		if ($_POST[\'methodtextedit\'] != $_POST[\'methodtexteditorg\']\r\n			|| $_POST[\'methodtitle_optional\'] != $_POST[\'methodtitle_org\']\r\n			|| $_POST[\'methodkeyword_optional\'] != $_POST[\'methodkeyword_org\']\r\n			|| $_POST[\'methoddescription_optional\'] != $_POST[\'methoddescription_org\']\r\n			|| $_POST[\'methodtypeedit\'] != $_POST[\'methodtype_org\'])\r\n		{\r\n			db_method_update($clean_name,$_POST[\'methodtextedit\'],\r\n			$_POST[\'methodtypeedit\'],\r\n			$_POST[\'methodorgname\'],$_POST[\'methodpostedit\'],\r\n			$_POST[\'methodtitle_optional\'],$_POST[\'methodkeyword_optional\'],$_POST[\'methoddescription_optional\']);\r\n			if ($append!=\'\')$append.=\', \';\r\n			$append.=\'Page (<a href=\"\'.$_SERVER[\'REQUEST_URI\'].\'\">\'.$clean_name.\'</a>)\';\r\n		}\r\n	}\r\n\r\n	// Check for method post text change\r\n	if (isset($_POST[\'methodpostedit\']) && isset($_POST[\'methodposteditorg\']))\r\n	{\r\n		if ($_POST[\'methodpostedit\'] != $_POST[\'methodposteditorg\'])\r\n		{\r\n			db_method_update($clean_name,$_POST[\'methodtextedit\'],\r\n			$_POST[\'methodtypeedit\'],\r\n			$_POST[\'methodorgname\'],$_POST[\'methodpostedit\'],\r\n			$_POST[\'methodtitle_optional\'],$_POST[\'methodkeyword_optional\'],$_POST[\'methoddescription_optional\']);\r\n			if ($append!=\'\')$append.=\', \';\r\n			$append.=\'Post (<a href=\"\'.$_SERVER[\'REQUEST_URI\'].\'\">\'.$clean_name.\'</a>)\';\r\n		}\r\n	}\r\n\r\n	// Check for CMS javascript text change\r\n	if (isset($_POST[\'methodjsedit\']) && isset($_POST[\'methodjseditorg\']))\r\n	{\r\n		if ($_POST[\'methodjsedit\'] != $_POST[\'methodjseditorg\'])\r\n		{\r\n			db_method_update(\'script_javascript\',$_POST[\'methodjsedit\'],3,\r\n			\'script_javascript\',\'\');\r\n			if ($append!=\'\')$append.=\', \';\r\n			$append.=\'JavaScript\';\r\n		}\r\n	}\r\n\r\n	// Check for CSS Variables text change\r\n	if (isset($_POST[\'methodcssvaredit\']) && isset($_POST[\'methodcssvareditorg\']))\r\n	{\r\n		if ($_POST[\'methodcssvaredit\'] != $_POST[\'methodcssvareditorg\'])\r\n		{\r\n			db_method_update(\'style_default\',$_POST[\'methodcssvaredit\'],3,\r\n			\'style_default\',\'\');\r\n			if ($append!=\'\')$append.=\', \';\r\n			$append.=\'CSS Variables\';\r\n		}\r\n	}\r\n\r\n	// Check for CSS Variables text change\r\n	if (isset($_POST[\'methodcsscodeedit\']) && isset($_POST[\'methodcsscodeeditorg\']))\r\n	{\r\n		if ($_POST[\'methodcsscodeedit\'] != $_POST[\'methodcsscodeeditorg\'])\r\n		{\r\n			db_method_update(\'style_html\',$_POST[\'methodcsscodeedit\'],3,\r\n			\'style_html\',\'\');\r\n			if ($append!=\'\')$append.=\', \';\r\n			$append.=\'CSS Code\';\r\n		}\r\n	}\r\n\r\n	// Check for Notepad text change\r\n	if (isset($_POST[\'methodnotepadedit\']) && isset($_POST[\'methodnotepadeditorg\']))\r\n	{\r\n		if ($_POST[\'methodnotepadedit\'] != $_POST[\'methodnotepadeditorg\'])\r\n		{\r\n			db_method_update(\'misc_notepad\',$_POST[\'methodnotepadedit\'],0,\r\n			\'misc_notepad\',\'\');\r\n			if ($append!=\'\')$append.=\', \';\r\n			$append.=\'Notepad\';\r\n		}\r\n	}\r\n\r\n	if ($append==\'\') msg_user(\"Update Status\",\'No components updated\');\r\n	else msg_user(\"Update Status\",\'Components Updated: \'.$append,\'index.php?recache\');\r\n}','Code Editor','',''),(314,'cms_admin_sidebar','$arr = array();\r\narray_push($arr, array(\'Add Page\',\'/img/silk/page_add.png\',\'toolkit_add_method\'));\r\n//array_push($arr, array(\'Search Pages\',\'/img/silk/page_find.png\',\'toolkit_search\'));\r\n//array_push($arr, array(\'Create User\',\'/img/silk/user_add.png\',\'toolkit_security_manager&user_create\'));\r\n//array_push($arr, array(\'Create Group\',\'/img/silk/group_add.png\',\'toolkit_security_manager&group_create\'));\r\n//array_push($arr, array(\'View Error Log\',\'/img/silk/page_error.png\',\'toolkit_error_log\'));\r\narray_push($arr, array(\'Security\',\'/img/silk/group_key.png\',\'toolkit_security_manager\'));\r\narray_push($arr, array(\'Files\',\'/img/silk/folder_page.png\',\'toolkit_file_manager\'));\r\narray_push($arr, array(\'Sessions\',\'/img/silk/lock.png\',\'toolkit_session_manager\'));\r\narray_push($arr, array(\'Menus\',\'/img/silk/tab.png\',\'toolkit_menu_builder\'));\r\narray_push($arr, array(\'Settings\',\'/img/silk/layout_content.png\',\'toolkit_site_settings\'));\r\n//array_push($arr, array(\'Colors\',\'/img/silk/palette.png\',\'toolkit_theme\'));\r\narray_push($arr, array(\'Themes\',\'/img/silk/palette.png\',\'toolkit_bootstrap_themes\'));\r\n\r\n$output .= <<< OUTPUT\r\n<button class=\"close\" style=\"padding:10px;\" onclick=\"$(\'#main_sidebar\').css(\'display\',\'none\');$(\'#main_content\').removeClass(\'span10\');\r\n$(\'#main_content\').addClass(\'span12\');\">Ã—</button>\r\nOUTPUT;\r\n\r\n$output .= \'<div class=\"well sidebar-nav\"><ul class=\"nav nav-list\"><li class=\"nav-header\">Sidebar</li>\';\r\nforeach ($arr as $row)\r\n{\r\n$output .= <<< OUTPUT\r\n<li><a href=\"{$row[2]}\"><img src=\"{$row[1]}\" /> {$row[0]}</a></li>\r\nOUTPUT;\r\n}\r\n\r\n$arr = array();\r\narray_push($arr, array(\'View/Manage\',\'/img/silk/database_table.png\',\'toolkit_query\'));\r\narray_push($arr, array(\'Backup\',\'/img/silk/database_save.png\',\'toolkit_database&backup\'));\r\narray_push($arr, array(\'Restore\',\'/img/silk/database_refresh.png\',\'toolkit_database&restore\'));\r\n$output .= \'<li class=\"nav-header\">Database</li>\';\r\nforeach ($arr as $row)\r\n{\r\n$output .= <<< OUTPUT\r\n<li><a href=\"{$row[2]}\"><img src=\"{$row[1]}\" /> {$row[0]}</a></li>\r\nOUTPUT;\r\n}\r\n\r\n$arr = array();\r\narray_push($arr, array(\'Search/Replace\',\'/img/silk/zoom.png\',\'toolkit_search\'));\r\narray_push($arr, array(\'Recache\',\'/img/silk/vector.png\',\'recache\'));\r\narray_push($arr, array(\'Sitemap\',\'/img/silk/chart_organisation.png\',\'toolkit_update_sitemap\'));\r\narray_push($arr, array(\'Main Pages\',\'/img/silk/house.png\',\'toolkit_index_selection\'));\r\n\r\narray_push($arr, array(\'Silk Gallery\',\'/img/silk/application_view_tile.png\',\'toolkit_silk_gallery\'));\r\narray_push($arr, array(\'Command Shell\',\'/img/silk/application_osx_terminal.png\',\'toolkit_command_shell\'));\r\narray_push($arr, array(\'Tweet\',\'/img/social/twitter.png\',\'toolkit_twitter\'));\r\n$output .= \'<li class=\"nav-header\">Tools</li>\';\r\nforeach ($arr as $row)\r\n{\r\n$output .= <<< OUTPUT\r\n<li><a href=\"{$row[2]}\"><img src=\"{$row[1]}\" /> {$row[0]}</a></li>\r\nOUTPUT;\r\n}\r\n\r\n//$output .= \"Welcome to FusionLeaf. Build something inspiring.\";\r\n\r\nfunction i($d,$c,$t=\'\')\r\n{\r\n	return \'<\'.$d.\' class=\"\'.$c.\'\">\'.$t.\'</\'.$d.\'>\'.NEWLINE;\r\n}\r\nfunction a2($c,$t,$h,$dt=\'\')\r\n{\r\n	return \'<a class=\"\'.$c.\'\" data-toggle=\"\'.$dt.\'\" href=\"\'.$h.\'\">\'.$t.\'</a>\'.NEWLINE;\r\n}\r\n\r\n// ****************************************************** Version Information ******************************************************\r\n$output .= \'<li class=\"nav-header\">System</li>\';\r\n\r\n// Open the version file\r\n$set = new file_array(CMS_FILE_VERSION);\r\n\r\n$mysqli = @new mysqli(DB_HOST, DB_READ_USERNAME, DB_READ_PASSWORD, DB_DATABASE);\r\nif ($mysqli->connect_error) $mysql = \'NA\';\r\nelse $mysql = mysqli_get_server_info($mysqli);\r\n\r\nif (isset($_GET[\'accept_version\']))\r\n{\r\n	if ($_GET[\'accept_version\']==1) $set->add(\'php\', PHP_VERSION);\r\n	else if ($_GET[\'accept_version\']==2) $set->add(\'mysql\', mysqli_get_server_info($mysqli));\r\n	else if ($_GET[\'accept_version\']==3) $set->add(\'nginx\',$_SERVER[\'SERVER_SOFTWARE\']);\r\n	else if ($_GET[\'accept_version\']==4 && extension_loaded(\'memcache\') && isset($memcache)) $set->add(\'memcache\',$memcache->getVersion());\r\n	msg_user(\"Version Acceptance\",\"Version settings updated!\");\r\n}\r\n\r\nfunction ver_compare($name, $val, $description, $ver)\r\n{\r\n	global $set;\r\n	global $output;\r\n	$return = false;\r\n	if ($set->get($name)===false)\r\n	{\r\n		$set->add($name, $val);\r\n		$return = true;\r\n	}\r\n	else\r\n	{\r\n		if (version_compare($set->get($name), $val, \'!=\')) $return = false;\r\n		else $return = true;\r\n	}\r\n	$flag = a(img(\'Accept\',\'/img/silk/flag_green.png\'),\'toolkit_index&accept_version=\'.$ver);\r\n	$output .= \'<b>\'.$description.\':</b><br />\'.$val;\r\n	if (!$return) $output .= \' <span style=\"color: red;\">(updated recently from \'.$set->get($name).\')</span> \'.$flag;\r\n	$output .= br();\r\n}\r\n\r\n//$output .= \'<div class=\"clear\"></div><br />\';\r\n$output .= \'<b>CMS Version:</b><br />\';\r\n\r\n$release_file = CMS_HIDDEN.DIR_SEP.\'release\';\r\n\r\nif (file_exists($release_file)) $release_version = file_get_contents($release_file);\r\nelse $release_version = \'--\';\r\n\r\nif (IS_WIN_OS) $output .= $release_version.\' (Windows)\';\r\nelse $output .= $release_version.\' (Linux)\';\r\n$output .= br();\r\n\r\n$release_file_studio = FLS_ROOT.DIR_SEP.\'RELEASE.txt\';\r\nif (file_exists($release_file_studio)) $output .= \'<b>Stack Version:</b><br />\'.file_get_contents($release_file_studio).\'<br />\';\r\n\r\nver_compare(\'php\',PHP_VERSION,\'PHP Version\',1);\r\nver_compare(\'mysql\',$mysql,\'MySQL Version\',2);\r\nver_compare(\'nginx\',$_SERVER[\'SERVER_SOFTWARE\'],\'Nginx Version\',3);\r\nif (extension_loaded(\'memcache\') && isset($memcache)) ver_compare(\'memcache\',$memcache->getVersion(),\'Memcache Version\',4);\r\n\r\n$qry = \"SELECT error_details,error_time,id FROM log_error\";\r\n$params = array();\r\n$result = query($qry, $params);\r\n\r\nif (count($result)>0)\r\n{\r\n	$output .= a(img(\'View error log\',\'/img/silk/error.png\'),\'toolkit_error_log\').\' \';\r\n	$output .= \'<b>Alert:</b> You have \'.count($result).\' new <a href=\"index.php?toolkit_error_log\">error(s)</a><br />\';\r\n}\r\n\r\n$qry = \"SELECT ip FROM visitor_info\";\r\n$params = array();\r\n$result = query($qry, $params);\r\n\r\nif (count($result)>0)\r\n{\r\n	$output .= a(img(\'View invalid attempts\',\'/img/silk/error.png\'),\'toolkit_query&tbl=visitor_info\').\' \';\r\n	$output .= \'<b>Alert:</b> You have \'.count($result).\' new <a href=\"index.php?toolkit_query&tbl=visitor_info\">invalid login attempt(s)</a><br />\';\r\n}\r\n$output .= \'</ul>\';\r\n$output .= \'</div>\';','2012-08-10 22:16:37',2,1,'','','',''),(316,'toolkit_bootstrap_themes','if (isset($_GET[\'pick\']) && isset($_GET[\'name\']))\r\n{\r\n	//unlink(CMS_ROOT.DIR_SEP.\'inc\'.DIR_SEP.\'bootstrap\'.DIR_SEP.\'css\'.DIR_SEP.\'bootstrap.css\');\r\n	copy($_GET[\'pick\'].DIR_SEP.\'bootstrap.css\',CMS_ROOT.DIR_SEP.\'inc\'.DIR_SEP.\'bootstrap\'.DIR_SEP.\'css\'.DIR_SEP.\'bootstrap.min.css\');\r\n	$_SESSION[\'theme\'] = strtolower(basename($_GET[\'pick\']));\r\n	msg_user(\'Theme Updated\',\'Now using the theme, \'.$_GET[\'name\'].\'!\');\r\n	return;\r\n}\r\n\r\nfunction grabTemplate($folder,$iteration)\r\n{\r\n\r\n$who = \'A preview of changes in this swatch from <a href=\"http://bootswatch.com\">Bootswatch.com</a>\';\r\n$title = ucfirst($folder);\r\nif ($folder==\'default\')\r\n{\r\n	$who = \'A preview of the default theme from <a href=\"http://bootstrap.com\">Bootstrap.com</a>\';\r\n	$title = \'Bootstrap Default\';\r\n}\r\n\r\n$template = <<< OUTPUT\r\n\r\n  <!-- Navbar\r\n    ================================================== -->\r\n\r\n    <div class=\"container-fluid\">\r\n\r\n\r\n<!-- Masthead\r\n================================================== -->\r\n<header class=\"jumbotron subhead\" id=\"overview\">\r\n  <h1>{$title}</h1>\r\n  <p class=\"lead\">{$who}.</p>\r\n  <div class=\"subnav\">\r\n    <ul class=\"nav nav-pills\">\r\n      <li><a href=\"#typography{$iteration}\">Typography</a></li>\r\n      <li><a href=\"#navbar{$iteration}\">Navbar</a></li>\r\n      <li><a href=\"#buttons{$iteration}\">Buttons</a></li>\r\n      <li><a href=\"#forms{$iteration}\">Forms</a></li>\r\n      <li><a href=\"#miscellaneous{$iteration}\">Miscellaneous</a></li>\r\n    </ul>\r\n  </div>\r\n</header>\r\n\r\n\r\n\r\n\r\n<!-- Typography\r\n================================================== -->\r\n<section id=\"typography{$iteration}\">\r\n  <div class=\"page-header\">\r\n    <h1>Typography</h1>\r\n  </div>\r\n\r\n  <!-- Headings & Paragraph Copy -->\r\n  <div class=\"row-fluid\">\r\n\r\n    <div class=\"span4\">\r\n      <div class=\"well\">\r\n        <h1>h1. Heading 1</h1>\r\n        <h2>h2. Heading 2</h2>\r\n        <h3>h3. Heading 3</h3>\r\n        <h4>h4. Heading 4</h4>\r\n        <h5>h5. Heading 5</h5>\r\n        <h6>h6. Heading 6</h6>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"span4\">\r\n      <h3>Example body text</h3>\r\n      <p>Nullam quis risus eget urna mollis ornare vel eu leo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>\r\n      <p>Vivamus sagittis lacus vel augue laoreet rutrum faucibus dolor auctor. Duis mollis, est non commodo luctus, nisi erat porttitor ligula, eget lacinia odio sem nec elit. Donec sed odio dui.</p>\r\n    </div>\r\n\r\n    <div class=\"span4\">\r\n      <h3>Example addresses</h3>\r\n      <address>\r\n        <strong>Twitter, Inc.</strong><br>\r\n        795 Folsom Ave, Suite 600<br>\r\n        San Francisco, CA 94107<br>\r\n        <abbr title=\"Phone\">P:</abbr> (123) 456-7890\r\n      </address>\r\n      <address>\r\n        <strong>Full Name</strong><br>\r\n        <a href=\"mailto:#\">first.last@gmail.com</a>\r\n      </address>\r\n    </div>\r\n\r\n  </div>\r\n\r\n</section>\r\n\r\n\r\n<!-- Navbar\r\n================================================== -->\r\n<section id=\"navbar{$iteration}\">\r\n  <div class=\"page-header\">\r\n    <h1>Navbar</h1>\r\n  </div>\r\n  <div class=\"navbar\">\r\n    <div class=\"navbar-inner\">\r\n      <div class=\"container\" style=\"width: auto;\">\r\n        <a class=\"btn btn-navbar\" data-toggle=\"collapse\" data-target=\".nav-collapse\">\r\n          <span class=\"icon-bar\"></span>\r\n          <span class=\"icon-bar\"></span>\r\n          <span class=\"icon-bar\"></span>\r\n        </a>\r\n        <a class=\"brand\" href=\"#\">Project name</a>\r\n        <div class=\"nav-collapse\">\r\n          <ul class=\"nav\">\r\n            <li class=\"active\"><a href=\"#\">Home</a></li>\r\n            <li><a href=\"#\">Link</a></li>\r\n            <li><a href=\"#\">Link</a></li>\r\n            <li><a href=\"#\">Link</a></li>\r\n            <li class=\"dropdown\">\r\n              <a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\">Dropdown <b class=\"caret\"></b></a>\r\n              <ul class=\"dropdown-menu\">\r\n                <li><a href=\"#\">Action</a></li>\r\n                <li><a href=\"#\">Another action</a></li>\r\n                <li><a href=\"#\">Something else here</a></li>\r\n                <li class=\"divider\"></li>\r\n                <li><a href=\"#\">Separated link</a></li>\r\n              </ul>\r\n            </li>\r\n          </ul>\r\n          <form class=\"navbar-search pull-left\" action=\"\">\r\n            <input type=\"text\" class=\"search-query\" placeholder=\"Search\">\r\n          </form>\r\n          <ul class=\"nav pull-right\">\r\n            <li><a href=\"#\">Link</a></li>\r\n            <li class=\"divider-vertical\"></li>\r\n            <li class=\"dropdown\">\r\n              <a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\">Dropdown <b class=\"caret\"></b></a>\r\n              <ul class=\"dropdown-menu\">\r\n                <li><a href=\"#\">Action</a></li>\r\n                <li><a href=\"#\">Another action</a></li>\r\n                <li><a href=\"#\">Something else here</a></li>\r\n                <li class=\"divider\"></li>\r\n                <li><a href=\"#\">Separated link</a></li>\r\n              </ul>\r\n            </li>\r\n          </ul>\r\n        </div><!-- /.nav-collapse -->\r\n      </div>\r\n    </div><!-- /navbar-inner -->\r\n  </div><!-- /navbar -->\r\n\r\n</section>\r\n\r\n\r\n\r\n<!-- Buttons\r\n================================================== -->\r\n<section id=\"buttons{$iteration}\">\r\n  <div class=\"page-header\">\r\n    <h1>Buttons</h1>\r\n  </div>\r\n  <table class=\"table table-bordered table-striped\">\r\n    <thead>\r\n      <tr>\r\n        <th>Button</th>\r\n        <th>Large Button</th>\r\n        <th>Small Button</th>\r\n        <th>Disabled Button</th>\r\n		<th>Button with Icon</th>\r\n		<th>Split Button</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr>\r\n        <td><a class=\"btn\" href=\"#\">Default</a></td>\r\n        <td><a class=\"btn btn-large\" href=\"#\">Default</a></td>\r\n        <td><a class=\"btn btn-small\" href=\"#\">Default</a></td>\r\n        <td><a class=\"btn disabled\" href=\"#\">Default</a></td>\r\n        <td><a class=\"btn\" href=\"#\"><i class=\"icon-cog\"></i> Default</a></td>\r\n		<td>\r\n	        <div class=\"btn-group\">\r\n	          <a class=\"btn\" href=\"#\">Default</a>\r\n	          <a class=\"btn dropdown-toggle\" data-toggle=\"dropdown\" href=\"#\"><span class=\"caret\"></span></a>\r\n	          <ul class=\"dropdown-menu\">\r\n	            <li><a href=\"#\">Action</a></li>\r\n	            <li><a href=\"#\">Another action</a></li>\r\n	            <li><a href=\"#\">Something else here</a></li>\r\n	            <li class=\"divider\"></li>\r\n	            <li><a href=\"#\">Separated link</a></li>\r\n	          </ul>\r\n	        </div><!-- /btn-group -->\r\n		</td>\r\n      </tr>\r\n      <tr>\r\n        <td><a class=\"btn btn-primary\" href=\"#\">Primary</a></td>\r\n        <td><a class=\"btn btn-primary btn-large\" href=\"#\">Primary</a></td>\r\n        <td><a class=\"btn btn-primary btn-small\" href=\"#\">Primary</a></td>\r\n        <td><a class=\"btn btn-primary disabled\" href=\"#\">Primary</a></td>\r\n        <td><a class=\"btn btn-primary\" href=\"#\"><i class=\"icon-shopping-cart icon-white\"></i> Primary</a></td>\r\n		<td>\r\n	        <div class=\"btn-group\">\r\n	          <a class=\"btn btn-primary\" href=\"#\">Primary</a>\r\n	          <a class=\"btn btn-primary dropdown-toggle\" data-toggle=\"dropdown\" href=\"#\"><span class=\"caret\"></span></a>\r\n	          <ul class=\"dropdown-menu\">\r\n	            <li><a href=\"#\">Action</a></li>\r\n	            <li><a href=\"#\">Another action</a></li>\r\n	            <li><a href=\"#\">Something else here</a></li>\r\n	            <li class=\"divider\"></li>\r\n	            <li><a href=\"#\">Separated link</a></li>\r\n	          </ul>\r\n	        </div><!-- /btn-group -->\r\n		</td>\r\n      </tr>\r\n      <tr>\r\n        <td><a class=\"btn btn-info\" href=\"#\">Info</a></td>\r\n        <td><a class=\"btn btn-info btn-large\" href=\"#\">Info</a></td>\r\n        <td><a class=\"btn btn-info btn-small\" href=\"#\">Info</a></td>\r\n        <td><a class=\"btn btn-info disabled\" href=\"#\">Info</a></td>\r\n        <td><a class=\"btn btn-info\" href=\"#\"><i class=\"icon-exclamation-sign icon-white\"></i> Info</a></td>\r\n		<td>\r\n	        <div class=\"btn-group\">\r\n	          <a class=\"btn btn-info\" href=\"#\">Info</a>\r\n	          <a class=\"btn btn-info dropdown-toggle\" data-toggle=\"dropdown\" href=\"#\"><span class=\"caret\"></span></a>\r\n	          <ul class=\"dropdown-menu\">\r\n	            <li><a href=\"#\">Action</a></li>\r\n	            <li><a href=\"#\">Another action</a></li>\r\n	            <li><a href=\"#\">Something else here</a></li>\r\n	            <li class=\"divider\"></li>\r\n	            <li><a href=\"#\">Separated link</a></li>\r\n	          </ul>\r\n	        </div><!-- /btn-group -->\r\n		</td>\r\n      </tr>\r\n      <tr>\r\n        <td><a class=\"btn btn-success\" href=\"#\">Success</a></td>\r\n        <td><a class=\"btn btn-success btn-large\" href=\"#\">Success</a></td>\r\n        <td><a class=\"btn btn-success btn-small\" href=\"#\">Success</a></td>\r\n        <td><a class=\"btn btn-success disabled\" href=\"#\">Success</a></td>\r\n        <td><a class=\"btn btn-success\" href=\"#\"><i class=\"icon-ok icon-white\"></i> Success</a></td>\r\n		<td>\r\n	        <div class=\"btn-group\">\r\n	          <a class=\"btn btn-success\" href=\"#\">Success</a>\r\n	          <a class=\"btn btn-success dropdown-toggle\" data-toggle=\"dropdown\" href=\"#\"><span class=\"caret\"></span></a>\r\n	          <ul class=\"dropdown-menu\">\r\n	            <li><a href=\"#\">Action</a></li>\r\n	            <li><a href=\"#\">Another action</a></li>\r\n	            <li><a href=\"#\">Something else here</a></li>\r\n	            <li class=\"divider\"></li>\r\n	            <li><a href=\"#\">Separated link</a></li>\r\n	          </ul>\r\n	        </div><!-- /btn-group -->\r\n		</td>\r\n      </tr>\r\n      <tr>\r\n        <td><a class=\"btn btn-warning\" href=\"#\">Warning</a></td>\r\n        <td><a class=\"btn btn-warning btn-large\" href=\"#\">Warning</a></td>\r\n        <td><a class=\"btn btn-warning btn-small\" href=\"#\">Warning</a></td>\r\n        <td><a class=\"btn btn-warning disabled\" href=\"#\">Warning</a></td>\r\n        <td><a class=\"btn btn-warning\" href=\"#\"><i class=\"icon-warning-sign icon-white\"></i> Warning</a></td>\r\n		<td>\r\n	        <div class=\"btn-group\">\r\n	          <a class=\"btn btn-warning\" href=\"#\">Warning</a>\r\n	          <a class=\"btn btn-warning dropdown-toggle\" data-toggle=\"dropdown\" href=\"#\"><span class=\"caret\"></span></a>\r\n	          <ul class=\"dropdown-menu\">\r\n	            <li><a href=\"#\">Action</a></li>\r\n	            <li><a href=\"#\">Another action</a></li>\r\n	            <li><a href=\"#\">Something else here</a></li>\r\n	            <li class=\"divider\"></li>\r\n	            <li><a href=\"#\">Separated link</a></li>\r\n	          </ul>\r\n	        </div><!-- /btn-group -->\r\n		</td>\r\n      </tr>\r\n      <tr>\r\n        <td><a class=\"btn btn-danger\" href=\"#\">Danger</a></td>\r\n        <td><a class=\"btn btn-danger btn-large\" href=\"#\">Danger</a></td>\r\n        <td><a class=\"btn btn-danger btn-small\" href=\"#\">Danger</a></td>\r\n        <td><a class=\"btn btn-danger disabled\" href=\"#\">Danger</a></td>\r\n        <td><a class=\"btn btn-danger\" href=\"#\"><i class=\"icon-remove icon-white\"></i> Danger</a></td>\r\n		<td>\r\n	        <div class=\"btn-group\">\r\n	          <a class=\"btn btn-danger\" href=\"#\">Danger</a>\r\n	          <a class=\"btn btn-danger dropdown-toggle\" data-toggle=\"dropdown\" href=\"#\"><span class=\"caret\"></span></a>\r\n	          <ul class=\"dropdown-menu\">\r\n	            <li><a href=\"#\">Action</a></li>\r\n	            <li><a href=\"#\">Another action</a></li>\r\n	            <li><a href=\"#\">Something else here</a></li>\r\n	            <li class=\"divider\"></li>\r\n	            <li><a href=\"#\">Separated link</a></li>\r\n	          </ul>\r\n	        </div><!-- /btn-group -->\r\n		</td>\r\n      </tr>\r\n      <tr>\r\n        <td><a class=\"btn btn-inverse\" href=\"#\">Inverse</a></td>\r\n        <td><a class=\"btn btn-inverse btn-large\" href=\"#\">Inverse</a></td>\r\n        <td><a class=\"btn btn-inverse btn-small\" href=\"#\">Inverse</a></td>\r\n        <td><a class=\"btn btn-inverse disabled\" href=\"#\">Inverse</a></td>\r\n        <td><a class=\"btn btn-inverse\" href=\"#\"><i class=\"icon-random icon-white\"></i> Inverse</a></td>\r\n		<td>\r\n	        <div class=\"btn-group\">\r\n	          <a class=\"btn btn-inverse\" href=\"#\">Inverse</a>\r\n	          <a class=\"btn btn-inverse dropdown-toggle\" data-toggle=\"dropdown\" href=\"#\"><span class=\"caret\"></span></a>\r\n	          <ul class=\"dropdown-menu\">\r\n	            <li><a href=\"#\">Action</a></li>\r\n	            <li><a href=\"#\">Another action</a></li>\r\n	            <li><a href=\"#\">Something else here</a></li>\r\n	            <li class=\"divider\"></li>\r\n	            <li><a href=\"#\">Separated link</a></li>\r\n	          </ul>\r\n	        </div><!-- /btn-group -->\r\n		</td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n\r\n</section>\r\n\r\n\r\n<!-- Forms\r\n================================================== -->\r\n<section id=\"forms{$iteration}\">\r\n  <div class=\"page-header\">\r\n    <h1>Forms</h1>\r\n  </div>\r\n\r\n  <div class=\"row-fluid\">\r\n    <div class=\"span7 offset1\">\r\n\r\n	    <form class=\"well form-search\">\r\n	      <input type=\"text\" class=\"input-medium search-query\">\r\n	      <button type=\"submit\" class=\"btn\">Search</button>\r\n	    </form>\r\n\r\n        <form class=\"well form-search\">\r\n          <input type=\"text\" class=\"input-small\" placeholder=\"Email\">\r\n          <input type=\"password\" class=\"input-small\" placeholder=\"Password\">\r\n          <button type=\"submit\" class=\"btn\">Go</button>\r\n        </form>\r\n\r\n\r\n      <form class=\"form-horizontal well\">\r\n        <fieldset>\r\n          <legend>Controls Bootstrap supports</legend>\r\n          <div class=\"control-group\">\r\n            <label class=\"control-label\" for=\"input01\">Text input</label>\r\n            <div class=\"controls\">\r\n              <input type=\"text\" class=\"input-xlarge\" id=\"input01\">\r\n              <p class=\"help-block\">In addition to freeform text, any HTML5 text-based input appears like so.</p>\r\n            </div>\r\n          </div>\r\n          <div class=\"control-group\">\r\n            <label class=\"control-label\" for=\"optionsCheckbox\">Checkbox</label>\r\n            <div class=\"controls\">\r\n              <label class=\"checkbox\">\r\n                <input type=\"checkbox\" id=\"optionsCheckbox\" value=\"option1\">\r\n                Option one is this and that&mdash;be sure to include why it\'s great\r\n              </label>\r\n            </div>\r\n          </div>\r\n          <div class=\"control-group\">\r\n            <label class=\"control-label\" for=\"select01\">Select list</label>\r\n            <div class=\"controls\">\r\n              <select id=\"select01\">\r\n                <option>something</option>\r\n                <option>2</option>\r\n                <option>3</option>\r\n                <option>4</option>\r\n                <option>5</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n          <div class=\"control-group\">\r\n            <label class=\"control-label\" for=\"multiSelect\">Multicon-select</label>\r\n            <div class=\"controls\">\r\n              <select multiple=\"multiple\" id=\"multiSelect\">\r\n                <option>1</option>\r\n                <option>2</option>\r\n                <option>3</option>\r\n                <option>4</option>\r\n                <option>5</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n          <div class=\"control-group\">\r\n            <label class=\"control-label\" for=\"fileInput\">File input</label>\r\n            <div class=\"controls\">\r\n              <input class=\"input-file\" id=\"fileInput\" type=\"file\">\r\n            </div>\r\n          </div>\r\n          <div class=\"control-group\">\r\n            <label class=\"control-label\" for=\"textarea\">Textarea</label>\r\n            <div class=\"controls\">\r\n              <textarea class=\"input-xlarge\" id=\"textarea\" rows=\"3\"></textarea>\r\n            </div>\r\n          </div>\r\n          <div class=\"control-group\">\r\n            <label class=\"control-label\" for=\"focusedInput\">Focused input</label>\r\n            <div class=\"controls\">\r\n              <input class=\"input-xlarge focused\" id=\"focusedInput\" type=\"text\" value=\"This is focusedâ€¦\">\r\n            </div>\r\n          </div>\r\n          <div class=\"control-group\">\r\n            <label class=\"control-label\">Uneditable input</label>\r\n            <div class=\"controls\">\r\n              <span class=\"input-xlarge uneditable-input\">Some value here</span>\r\n            </div>\r\n          </div>\r\n          <div class=\"control-group\">\r\n            <label class=\"control-label\" for=\"disabledInput\">Disabled input</label>\r\n            <div class=\"controls\">\r\n              <input class=\"input-xlarge disabled\" id=\"disabledInput\" type=\"text\" placeholder=\"Disabled input hereâ€¦\" disabled>\r\n            </div>\r\n          </div>\r\n          <div class=\"control-group\">\r\n            <label class=\"control-label\" for=\"optionsCheckbox2\">Disabled checkbox</label>\r\n            <div class=\"controls\">\r\n              <label class=\"checkbox\">\r\n                <input type=\"checkbox\" id=\"optionsCheckbox2\" value=\"option1\" disabled>\r\n                This is a disabled checkbox\r\n              </label>\r\n            </div>\r\n          </div>\r\n          <div class=\"control-group warning\">\r\n            <label class=\"control-label\" for=\"inputWarning\">Input with warning</label>\r\n            <div class=\"controls\">\r\n              <input type=\"text\" id=\"inputWarning\">\r\n              <span class=\"help-inline\">Something may have gone wrong</span>\r\n            </div>\r\n          </div>\r\n          <div class=\"control-group error\">\r\n            <label class=\"control-label\" for=\"inputError\">Input with error</label>\r\n            <div class=\"controls\">\r\n              <input type=\"text\" id=\"inputError\">\r\n              <span class=\"help-inline\">Please correct the error</span>\r\n            </div>\r\n          </div>\r\n          <div class=\"control-group success\">\r\n            <label class=\"control-label\" for=\"inputSuccess\">Input with success</label>\r\n            <div class=\"controls\">\r\n              <input type=\"text\" id=\"inputSuccess\">\r\n              <span class=\"help-inline\">Woohoo!</span>\r\n            </div>\r\n          </div>\r\n          <div class=\"control-group success\">\r\n            <label class=\"control-label\" for=\"selectError\">Select with success</label>\r\n            <div class=\"controls\">\r\n              <select id=\"selectError\">\r\n                <option>1</option>\r\n                <option>2</option>\r\n                <option>3</option>\r\n                <option>4</option>\r\n                <option>5</option>\r\n              </select>\r\n              <span class=\"help-inline\">Woohoo!</span>\r\n            </div>\r\n          </div>\r\n          <div class=\"form-actions\">\r\n            <button type=\"submit\" class=\"btn btn-primary\">Save changes</button>\r\n            <button type=\"reset\" class=\"btn\">Cancel</button>\r\n          </div>\r\n        </fieldset>\r\n      </form>\r\n    </div>\r\n  </div>\r\n\r\n</section>\r\n\r\n\r\n<!-- Miscellaneous\r\n================================================== -->\r\n<section id=\"miscellaneous{$iteration}\">\r\n  <div class=\"page-header\">\r\n    <h1>Miscellaneous</h1>\r\n  </div>\r\n\r\n  <div class=\"row-fluid\">\r\n    <div class=\"span5\">\r\n\r\n      <h3 id=\"breadcrumbs\">Breadcrumbs</h3>\r\n      <ul class=\"breadcrumb\">\r\n        <li class=\"active\">Home</li>\r\n      </ul>\r\n      <ul class=\"breadcrumb\">\r\n        <li><a href=\"#\">Home</a> <span class=\"divider\">/</span></li>\r\n        <li class=\"active\">Library</li>\r\n      </ul>\r\n      <ul class=\"breadcrumb\">\r\n        <li><a href=\"#\">Home</a> <span class=\"divider\">/</span></li>\r\n        <li><a href=\"#\">Library</a> <span class=\"divider\">/</span></li>\r\n        <li class=\"active\">Data</li>\r\n      </ul>\r\n    </div>\r\n    <div class=\"span6 offset1\">\r\n      <h3 id=\"pagination\">Pagination</h3>\r\n      <div class=\"pagination\">\r\n        <ul>\r\n          <li class=\"disabled\"><a href=\"#\">&laquo;</a></li>\r\n          <li class=\"active\"><a href=\"#\">1</a></li>\r\n          <li><a href=\"#\">2</a></li>\r\n          <li><a href=\"#\">3</a></li>\r\n          <li><a href=\"#\">4</a></li>\r\n          <li><a href=\"#\">&raquo;</a></li>\r\n        </ul>\r\n      </div>\r\n      <div class=\"pagination\">\r\n        <ul>\r\n          <li><a href=\"#\">&larr;</a></li>\r\n          <li class=\"active\"><a href=\"#\">10</a></li>\r\n          <li class=\"disabled\"><a href=\"#\">...</a></li>\r\n          <li><a href=\"#\">20</a></li>\r\n          <li><a href=\"#\">&rarr;</a></li>\r\n        </ul>\r\n      </div>\r\n      <div class=\"pagination pagination-centered\">\r\n        <ul>\r\n          <li class=\"active\"><a href=\"#\">1</a></li>\r\n          <li><a href=\"#\">2</a></li>\r\n          <li><a href=\"#\">3</a></li>\r\n          <li><a href=\"#\">4</a></li>\r\n          <li><a href=\"#\">5</a></li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n\r\n\r\n<!-- Labels\r\n================================================== -->\r\n\r\n  <div class=\"row-fluid\">\r\n    <div class=\"span12\">\r\n\r\n      <h3 id=\"labels\">Labels</h3>\r\n\r\n\r\n      <span class=\"label\">Default</span>\r\n      <span class=\"label label-success\">Success</span>\r\n	  <span class=\"label label-warning\">Warning</span>\r\n	  <span class=\"label label-important\">Important</span>\r\n	  <span class=\"label label-info\">Info</span>\r\n\r\n	</div>\r\n  </div>\r\n	<br />\r\n\r\n<!-- Progress bars\r\n================================================== -->\r\n\r\n\r\n  <h3 id=\"progressbars\">Progress bars</h3>\r\n\r\n  <div class=\"row-fluid\">\r\n    <div class=\"span4\">\r\n      <div class=\"progress\">\r\n        <div class=\"bar\" style=\"width: 60%;\"></div>\r\n      </div>\r\n    </div>\r\n    <div class=\"span4\">\r\n      <div class=\"progress progress-info progress-striped\">\r\n        <div class=\"bar\" style=\"width: 20%;\"></div>\r\n      </div>\r\n    </div>\r\n    <div class=\"span4\">\r\n      <div class=\"progress progress-danger progress-striped active\">\r\n        <div class=\"bar\" style=\"width: 45%\"></div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n	<br />\r\n\r\n\r\n<!-- Alerts & Messages\r\n================================================== -->\r\n\r\n\r\n  <h3 id=\"alerts\">Alerts</h3>\r\n\r\n  <div class=\"row-fluid\">\r\n	  <div class=\"span12\">\r\n	      <div class=\"alert alert-block\">\r\n	        <a class=\"close\">&times;</a>\r\n	        <h4 class=\"alert-heading\">Alert block</h4>\r\n	        <p>Best check yo self, you\'re not looking too good. Nulla vitae elit libero, a pharetra augue. Praesent commodo cursus magna, vel scelerisque nisl consectetur et.</p>\r\n	      </div>\r\n	  </div>\r\n  </div>\r\n  <div class=\"row-fluid\">\r\n    <div class=\"span4\">\r\n      <div class=\"alert alert-error\">\r\n        <a class=\"close\">&times;</a>\r\n        <strong>Error</strong> Change a few things up and try submitting again.\r\n      </div>\r\n    </div>\r\n    <div class=\"span4\">\r\n      <div class=\"alert alert-success\">\r\n        <a class=\"close\">&times;</a>\r\n        <strong>Success</strong> You successfully read this important alert message.\r\n      </div>\r\n    </div>\r\n    <div class=\"span4\">\r\n      <div class=\"alert alert-info\">\r\n        <a class=\"close\">&times;</a>\r\n        <strong>Information</strong> This alert needs your attention, but it\'s not super important.\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n\r\n</section>\r\n\r\n<div class=\"well\" style=\"text-align: center;\"><p>Themes and design from <a href=\"http://bootswatch.com\">Bootswatch.com</a></p></div>\r\n\r\n     <!-- Footer\r\n      ================================================== -->\r\n      <footer class=\"footer\">\r\n        <p class=\"pull-right\"><a href=\"#\">Back to top</a></p>\r\n      </footer>\r\n\r\n    </div><!-- /container -->\r\n\r\nOUTPUT;\r\n\r\nreturn $template;\r\n}\r\n\r\n$result = glob(CMS_ROOT.DIR_SEP.\'inc\'.DIR_SEP.\'bootswatch\'.DIR_SEP.\'*\',GLOB_ONLYDIR);\r\n\r\n$tab = \'\';\r\n$content = \'\';\r\n$counter = 1;\r\n\r\n$theme = \'default\';\r\nif (isset($_SESSION[\'theme\'])) $theme = $_SESSION[\'theme\'];\r\n\r\nforeach ($result as $row)\r\n{\r\n	if (basename($row)==\'img\') continue;\r\n	$name = ucfirst(basename($row));\r\n\r\n$selected = \'\';\r\nif ($theme == basename($row)) $selected = \'active\';\r\n\r\n	$tab .= \'<li class=\"\'.$selected.\'\"><a href=\"#tab\'.$counter.\'\" data-toggle=\"tab\" onclick=\"changeStylesheet(\\\'\'.strtolower($name).\'\\\')\">\'.$name.\'</a></li>\';\r\n	$content .= \'<div class=\"tab-pane fade \'.$selected.\' in\" id=\"tab\'.$counter.\'\">\';\r\n	//$content .= \'<a class=\"btn btn-primary pull-right\" href=\"/index.php?toolkit_bootstrap_themes&pick=\'.$row.\'&name=\'.$name.\'\">Edit</a>\';\r\n	$content .= \'<a class=\"btn btn-primary pull-right\" href=\"/index.php?toolkit_bootstrap_themes&pick=\'.$row.\'&name=\'.$name.\'\">Apply</a>\';\r\n	$content .= grabTemplate(strtolower($name),$counter).\'</div>\';\r\n	//$content = \'\';\r\n	$counter +=1;\r\n}\r\n\r\n$output .= <<< OUTPUT\r\n<script>\r\n$(document).ready(function() {\r\n	$(\'#main_sidebar\').css(\'display\',\'none\');$(\'#main_content\').removeClass(\'span10\');\r\n	$(\'#main_content\').addClass(\'span12\');\r\n});\r\nfunction changeStylesheet(sheetname)\r\n{\r\n	$(\".simpleswitch\").attr({href : \"/inc/bootswatch/\"+sheetname+\"/bootstrap.css?\"+Math.floor((Math.random()*10000)+1)});\r\n}\r\n</script>\r\n\r\n<div class=\"tabbable tabs-left\">\r\n	<ul class=\"nav nav-tabs\">\r\n		{$tab}\r\n	</ul>\r\n	<div class=\"tab-content\">\r\n		{$content}\r\n	</div>\r\n</div>\r\n\r\nOUTPUT;\r\n\r\n// Need this for the heredoc','2012-07-09 02:31:12',2,1,'','Theme Selector','',''),(333,'cms_database_pdo','// Why I can\'t use PDO on Linux: http://stackoverflow.com/questions/1197005/how-to-get-numeric-types-from-mysql-using-pdo\r\n// Ubuntu doesn\'t compile their version of PHP with mysqlnd which supports returning BOOT and INT as their \r\n// correct data types instead of just strings\r\n\r\n// ************************** Database Credentials **************************\r\nfunction getCMSWriter()\r\n{	\r\n	return array(\r\n	\'host\'=>DB_HOST,\r\n	\'username\'=>DB_WRITE_USERNAME,\r\n	\'password\'=>DB_WRITE_PASSWORD,\r\n	\'database\'=>DB_DATABASE,\r\n	\'port\'=>DB_PORT);\r\n}\r\n\r\nfunction getCMSReader()\r\n{		\r\n	return array(\r\n	\'host\'=>DB_HOST,\r\n	\'username\'=>DB_READ_USERNAME,\r\n	\'password\'=>DB_READ_PASSWORD,\r\n	\'database\'=>DB_DATABASE,\r\n	\'port\'=>DB_PORT);\r\n}\r\n\r\n// ************************** MySQL Functions **************************\r\nfunction query_execute($qry, $params=array(), $sqlwrite=true, $close_db=true)\r\n{\r\n	$return = query($qry, $params, $sqlwrite, $close_db, false, true);\r\n\r\n	if (isset($_SESSION[\'id\'])) $id = $_SESSION[\'id\'];\r\n	else $id = 0;\r\n\r\n	$qry_log = \"INSERT INTO log_mysql (userid,change_time,mysql_query,mysql_params,mysql_result) \r\n		VALUES(?,CURRENT_TIMESTAMP,?,?,?)\";\r\n	$params_log = array($id,$qry,print_array_mysql($params),$return);\r\n	if (constant_test(\'SETTING_LOG_DB_CHANGE\',\'enable\')) query_execute_nolog($qry_log, $params_log);\r\n\r\n	return $return;\r\n}\r\n\r\nfunction query_execute_nolog($qry, $params=array(), $sqlwrite=true, $close_db=true)\r\n{\r\n	return query($qry, $params, $sqlwrite, $close_db, false, true);\r\n}\r\n\r\nfunction query($qry, $params=array(), $sql=false, $close_db=true, $count=false, $count_rows=false, $temp_tables=false)\r\n{		\r\n	// Source: http://www.populate.it/prepared_query_to_array.html\r\n	// This function easily queries mySQL and projects against SQL injection\r\n	// All the parameters in params() are trimmed before they get to mySQL\r\n	// All the return parameters are cleaned by htmlentities()\r\n\r\n	global $sql_counter_in;\r\n	$sql_counter_in += 1;\r\n\r\n	if (isset($_SESSION[\'sqlcount\']) && constant_test(\'SETTING_PHP_VARIABLES\',\'show\')) $_SESSION[\'sqlcount\']+=1;\r\n\r\n	$protect_output = false;\r\n	\r\n	// Show the error message\r\n	$verbose = true;\r\n	\r\n	// If the settings have the mysql in readonly mode\r\n	if (constant_test(\'SETTING_DB_WRITE\',\'disable\')) $sql = false;\r\n	if (count($params) == 3 && $params[2]==\'SETTING_DB_WRITE\') $sql = true;\r\n	\r\n	try\r\n	{\r\n		// If the user did NOT pass the database credentials, use the default\r\n		if ($sql) $sql = getCMSWriter();\r\n		else $sql = getCMSReader();\r\n		\r\n		// Connect to the database\r\n		$db = new PDO(\'mysql:host=\'.((strtolower(DB_HOST)==\'localhost\') ? \'127.0.0.1\' : DB_HOST)\r\n			.\';port=\'.DB_PORT.\';dbname=\'.DB_DATABASE, DB_WRITE_USERNAME, DB_WRITE_PASSWORD, array(\r\n			PDO::ATTR_PERSISTENT => true,\r\n			PDO::ATTR_EMULATE_PREPARES => false\r\n		));\r\n		$db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\r\n		\r\n		// If database connection was unsuccessful\r\n		if (!$db)\r\n		{\r\n			// If there was a problem in the PHP code\r\n			if ($db==\'\')\r\n			{\r\n				// Get the last error in PHP\r\n				$lasterror = error_get_last();\r\n\r\n				// For the error to be thrown\r\n				throw new ErrorException($lasterror[\'message\'], $lasterror[\'type\'], 0, addslashes($lasterror[\'file\']), $lasterror[\'line\']);\r\n			}\r\n			// Else if the error was in the database, output the error information\r\n			else throw new Exception ($db->errorCode().\": \".$db->errorInfo());\r\n		}\r\n\r\n		// Create temp tables\r\n		//if ($temp_tables) mysqli_stmt_execute(mysqli_prepare($db, $temp_tables));\r\n		/*if ($temp_tables)\r\n		{\r\n			mysqli_multi_query($db, $temp_tables);\r\n			while ($db->next_result()) {;}\r\n		}*/\r\n\r\n		$stmt = $db->prepare($qry);\r\n		// If the prepared stmt does not return an error\r\n		if ($stmt)\r\n		{			\r\n			if ($params && is_array($params))\r\n			{\r\n				// Trim all the variables\r\n				//array_walk($params, create_function(\'&$val\', \'$val = trim($val);\'));\r\n			\r\n				// Bind the parameters to the ? placeholders\r\n				for($i=1;$i<=substr_count($qry,\'?\');$i++) { $stmt->bindParam($i, $params[$i-1]/*,getPDOConstantType($params[$i-1])*/); }\r\n			}\r\n			\r\n			// Execute the SQL statement\r\n			// If the statement is not valid\r\n			if (!$stmt->execute())\r\n			{\r\n				// If the statement caused an error, throw an error\r\n    				throw new Exception (\"<b>Message:</b> \".$db->errorInfo().\"<br /><b>DB Code:</b> \".$db->errorCode());\r\n			}\r\n\r\n			// Only called on Update, Insert, and delete queries\r\n			if ($count_rows) return $stmt->rowCount();\r\n\r\n			// No idea when this is called, it\'s a duplicate of the above I think\r\n			if ($count) return $stmt->rowCount();\r\n\r\n			$result = $stmt->fetchAll(PDO::FETCH_ASSOC);\r\n\r\n			// If not specified, close the database connection\r\n			//if ($close_db) mysqli_close($db);\r\n			\r\n			// Return either the array with values or the value of true\r\n			return $result;\r\n		}\r\n		// If the prepared stmt DOES return an error\r\n		else\r\n		{\r\n    			// If the statement caused an error, throw an error\r\n    			throw new Exception (\"<b>Message:</b> \".$db->errorInfo().\"<br /><b>DB Code:</b> \".$db->errorCode());\r\n		}\r\n	}\r\n	// Catch a PHP error\r\n	catch (ErrorException $e)\r\n	{			\r\n		// If the output should be verbose\r\n		if (!isset($_SESSION[\'ignore_errors\']))\r\n		{\r\n			// Suppress the output, save to a variable (must trace from here)\r\n			// Source: http://stackoverflow.com/questions/171318/how-do-i-capture-php-output-into-a-variable\r\n			ob_start();\r\n			debug_print_backtrace();\r\n			$errorout = ob_get_contents();\r\n			ob_end_clean();\r\n	\r\n			// Output the error in a fancybox\r\n			gather_error_info($e, false, $errorout);\r\n		}\r\n	}\r\n	// Catch a database error\r\n	catch (PDOException $e)\r\n	{\r\n		// If the output should be verbose\r\n		if (!isset($_SESSION[\'ignore_errors\']))\r\n		{\r\n			// Suppress the output, save to a variable (must trace from here)\r\n			// Source: http://stackoverflow.com/questions/171318/how-do-i-capture-php-output-into-a-variable\r\n			ob_start();\r\n			debug_print_backtrace();\r\n			$errorout = ob_get_contents();\r\n			ob_end_clean();\r\n	\r\n			// Output the error in a fancybox\r\n			gather_error_info($e, true, $errorout);\r\n		} \r\n	}\r\n}\r\n\r\nfunction getPDOConstantType($var)\r\n{\r\n	if (is_int($var)) return PDO::PARAM_INT;\r\n	else if (is_bool($var)) return PDO::PARAM_BOOL;\r\n	else if (is_null($var)) return PDO::PARAM_NULL;\r\n	else return PDO::PARAM_STR;\r\n}','2012-06-29 23:58:15',2,1,'','','',''),(341,'page_guide_planters','$output .= <<< OUTPUT\r\n<script>\r\n$(document).ready(function() {\r\n	$(\'#main_sidebar\').css(\'display\',\'none\');$(\'#main_content\').removeClass(\'span10\');\r\n	$(\'#main_content\').addClass(\'span12\');\r\n	$(\'#content_in_0\').remove();\r\n	$(\"[rel=tooltip]\").tooltip();\r\n});\r\n</script>\r\n<style>\r\nh1 {margin-top: 10px; margin-bottom: 10px; }\r\n</style>\r\nOUTPUT;\r\n\r\nif (isGroupMember(1)) $pencil_icon = \'<a class=\"brand\" href=\"/toolkit_smart_file?file=\'.$constant[\'CMS_FILE_SITE\'].\'\"><i class=\"icon-pencil icon-white\"></i></a>\';\r\nelse $pencil_icon = \'\';\r\n\r\n$output .= <<< OUTPUT\r\n\r\n<!-- Masthead\r\n================================================== -->\r\n<header class=\"jumbotron subhead\" id=\"overview\">\r\n  <h1>In the Sunlight: A Planter\'s Guide</h1>\r\n  <p class=\"lead\">Get your hands dirty, learn a few things, see what the <i rel=\"tooltip\" title=\"not a real product name...\">Leafy Bug</i> has to offer.</p>\r\n</header>\r\n\r\n<div class=\"row-fluid\">\r\n	<div class=\"span2\">\r\n		<ul class=\"nav nav-list\">\r\n			<li class=\"nav-header\">Overview</li>\r\n			<li class=\"active\"><a href=\"#section1\" data-toggle=\"tab\">What is a CMS?</a></li>\r\n			<li><a href=\"#section2\" data-toggle=\"tab\">How should I use it?</a></li>\r\n\r\n			<li class=\"nav-header\">Configuration</li>\r\n			<li><a href=\"#section10\" data-toggle=\"tab\">Prepare</a></li>\r\n			<li><a href=\"#section11\" data-toggle=\"tab\">Setup</a></li>\r\n			<li><a href=\"#section12\" data-toggle=\"tab\">Logged In</a></li>\r\n			<li><a href=\"#section13\" data-toggle=\"tab\">Basic Settings</a></li>\r\n\r\n			<li class=\"nav-header\">Pages</li>\r\n			<li><a href=\"#section20\" data-toggle=\"tab\">Overview</a></li>\r\n			<li><a href=\"#section21\" data-toggle=\"tab\">Static Pages</a></li>\r\n			<li><a href=\"#section22\" data-toggle=\"tab\">Dynamic Pages</a></li>\r\n\r\n			<!--<li class=\"nav-header\">Tutorials</li>\r\n			<li><a href=\"#section30\" data-toggle=\"tab\">Create a Page</a></li>-->\r\n		</ul>\r\n\r\n	</div>\r\n\r\n	<div class=\"span10\">\r\n		<div class=\"tab-content\">\r\n<!-- ************************** Section 1 ************************** -->\r\n			<div class=\"tab-pane fade active in\" id=\"section1\">\r\n				<div class=\"page-header\"><h1>What is a CMS? <small rel=\"tooltip\" title=\"not even close\">A bird that flies North for the winter.</small></h1></div>\r\n				<div class=\"row-fluid\">\r\n					<div class=\"span4\">\r\n						<h3>Definition</h3>\r\n						<p>A CMS, which is an abbreviation for <u>C</u>ontent <u>M</u>anagement <u>S</u>ystem, is simply a website which can edit itself. Scary huh? The website doesn\'t automatically edit itself <span rel=\"tooltip\" title=\"happens a lot in Tron\" class=\"label label-info\">(most of the time)</span>, it includes tools like a Code Editor or File Manager so the web designer can make changes quickly. A blog is a great example of how people can use a CMS because the built-in tools are used to publish articles.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>Old Way</h3>\r\n						<p>Websites originally started out as a collection of individual pages. The creation and modification of individual pages took a long time because much of the HTML code was duplicated on every page. When a link in the header or footer of the website changed, the web designer needed to update every page. If a website contained 100 pages, the web designer wasted much time updating the same line of code in many different places. <span class=\"label label-important\">Yuck!</span></p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>New Way</h3>\r\n						<p>Want to change your website title which is on all 100 of your pages? <span class=\"label label-warning\">Easy!</span> Change it once and it will magically change on every page. Secret? You don\'t really have 100 pages. You have 1 page. That page talks to the database and grabs everything you need including your website title. Don\'t know anything about databases? It doesn\'t matter because the website gives you pretty form:</p>\r\n					</div>\r\n				</div>\r\n				<div class=\"row-fluid\">\r\n					<div class=\"span4\">\r\n						<h3>Doesn\'t happen often</h3>\r\n<form>\r\n<textarea class=\"span12\" style=\"height: 85px; background-color: black; color: white;\">Welcome to SolarOS!\r\nroot@self:~# relocate database > \"BoraBora Island\"\r\n-bash: New location accepted, prepare for journey\r\n-bash :-)</textarea>\r\n</form>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>Boring</h3>\r\n<form>\r\n<textarea class=\"span12\" style=\"height: 85px;\"><!DOCTYPE html>\r\n<html>\r\n<head>\r\n<title>enter a page title...</title>\r\n</head>\r\n<body>\r\n<p>Hello World!</p>\r\n</body>\r\n</html></textarea>\r\n</form>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>Groovy</h3>\r\n						<p><form class=\"form-inline well\">Page Title: <input type=\"text\" placeholder=\"enter a page title...\" style=\"max-width: 150px;\" /> <a class=\"btn btn-primary\" href=\"javascript:void(0)\">Update</a></form>\r\n					</div>\r\n				</div>\r\n			</div>\r\n\r\n<!-- ************************** Section 2 ************************** -->\r\n			<div class=\"tab-pane fade\" id=\"section2\">\r\n				<div class=\"page-header\"><h1>How should I use it? <small rel=\"tooltip\" title=\"really, REALLY good\">That\'s a really good question.</small></h1></div>\r\n				<div class=\"row-fluid\">\r\n					<div class=\"span4\">\r\n						<h3>Blog</h3>\r\n						<p>Write until your digital pen runs out of battery power. Many people have blogs while a few people have many blogs. Share your experiences, knowledge, or even pictures of your kitten doing silly things. FusionLeaf makes it easy to build pages with the Dynamic Page Builder.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>Wiki</h3>\r\n						<p>Are you a book of random information? Create your own wiki and fill it to the brim with great information for people to read or edit. FusionLeaf already has access controls in place so you can create accounts and assign permissions easily.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>Social</h3>\r\n						<p>Got an idea for a great new social site? Use FusionLeaf to build the pages that pull information quickly and safely from the databases. Memcached and XCache are both supported so content can be cached for faster retrievals. It\'s also a great way to integrate with Facebook, LinkedIn, Twitter, etc.</p>\r\n					</div>\r\n				</div>\r\n				<div class=\"row-fluid\">\r\n					<div class=\"span4\">\r\n						<h3>Business</h3>\r\n						<p>New ideas are popping up everywhere. Use FusionLeaf to get a website running in no time with built-in protections for SQL injection, session hijacking, and brute-force attacks. Get instant notifications with in-depth analysis for any errors that occur on your site so you can act swiftly.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>Fun</h3>\r\n						<p>New to web design and looking for a way to wet your feet? Extremely proficient and seeking a powerful platform for a new project? Fusionleaf is licensed under the <a href=\"http://www.apache.org/licenses/LICENSE-2.0.html\">Apache License, Version 2.0</a> so you can modify, redistribution, and sell anything you create with FusionLeaf as long as you stay in compliance with the license.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>Anything</h3>\r\n						<p>FusionLeaf is for you. It\'s a collection of open-source tools that have been integrated to build something unique. If you like it, wonderful! If you hate it, wonderful! It\'s in constant development so there are always changes and new features. Who knows how it will grow!</p>\r\n					</div>\r\n				</div>\r\n			</div>\r\n\r\n\r\n<!-- ************************** Section 10 ************************** -->\r\n			<div class=\"tab-pane fade\" id=\"section10\">\r\n				<div class=\"page-header\"><h1>Prepare <small rel=\"tooltip\" title=\"no it\'s not\">The stuff you actually want to read.</small></h1></div>\r\n				<div class=\"row-fluid\">\r\n					<div class=\"span4\">\r\n						<h3>1. Pick an Environment</h3>\r\n						<p>Good news, you can choose from two! Actually, we suggest you use both: <span class=\"label label-info\">Windows</span> and <span class=\"label label-success\">Linux</span>. Windows is an extremely wonderful desktop operating system which makes it great for testing out components and fixing anything when it breaks. Windows is better documented on the internet because more people use it. Linux is a better choice for a production environment because it is extremely stable. Develop on Windows, deploy on Linux. It\'s what we do, but it\'s your choice.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>2. Prepare the Environment</h3>\r\n						<p><span class=\"label label-info\">Windows</span> If you are using Windows, it\'s quick and painless. Download FusionLeaf Stack from <a href=\"http://code.google.com/p/fusionleaf\">Google Code</a>, extract to a folder, double click FusionLeaf Studio.exe, click the Start button, then browse to <a href=\"http://localhost\">http://localhost</a> to verify all the components work.<br /><br /><span class=\"label label-success\">Linux</span> If you are on Linux, run the following command to install all the required components: <b>apt-get install dos2unix -y && wget -nc -O setup_fl.sh \"http://fusionleaf.googlecode.com/files/ubuntu_12.04.sh\" && dos2unix setup_fl.sh && bash ./setup_fl.sh</b></p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>3. Download FusionLeaf CMS</h3>\r\n						<p>Download the FusionLeaf CMS from <a href=\"http://code.google.com/p/fusionleaf\">Google Code</a>. Navigate to the <b>/webroot</b> folder in either environment.<br /><span class=\"label label-info\">Windows</span> Nothing else required for Windows at run through <a href=\"http://localhost\">http://localhost</a>. But if your website will be at www.fusionleaf.net, you need to create the folder path /<b>fusionleaf</b>/<b>net</b>/<b>www</b>. Then copy the files from <b>/localhost</b>.<br /><br /><span class=\"label label-success\">Linux</span> Modify folder structure so <b>/usr/share/nginx/webroot/fusionleaf/net/www</b> changes to <b>/usr/share/nginx/webroot/YOURDOMAIN/com/www</b>. Then restart the machine by running: <b>reboot now</b>.</p>\r\n					</div>\r\n				</div>\r\n				<div class=\"row-fluid\">\r\n					<div class=\"span4\">\r\n						<h3>Environment Note</h3>\r\n						<p>FusionLeaf.com is currently hosted on an Ubuntu server through Linode.com. Linode is one of the least expensive cloud providers and offers the Linode 512 (with 512MB RAM, 20GB storage, 200GB transfer, full SSH access) for $20 a month. If you are considering Linode, please click or use this referral code to support FusionLeaf:<br /><div class=\"well\" style=\"text-align: center;\"><a href=\"http://www.linode.com/?r=54975f4da78dda99aeb42785386fe3026a9b081a\">54975f4da78dda99aeb42785386fe3026a9b081a</a></div></p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>DNS Note</h3>\r\n						<p>The DNS for FusionLeaf.com is currently managed through <a href=\"http://www.no-ip.com/\">No-IP.com</a>. No-IP provides wildcard subdomains, port 80 redirects, and bulk change host groups for $15 a year. The wildcard subdomains coupled with the FusionLeaf Team custom Nginx configuration gives you complete control over your domain name. Take a look:</p>\r\n<div class=\"well\">\r\n<i class=\"icon-asterisk\"></i> <a href=\"http://blahblah.google.com/yippie\">http://blahblah.google.com/yippie</a> <span class=\"label label-important pull-right\">ugly</span>\r\n<br /><i class=\"icon-asterisk\"></i> <a href=\"http://blahblah.microsoft.com/yippie\">http://blahblah.microsoft.com/yippie</a> <span class=\"label label-important pull-right\">ugly</span>\r\n<br /><i class=\"icon-asterisk\"></i> <a href=\"http://blahblah.oracle.com/yippie\">http://blahblah.oracle.com/yippie</a> <span class=\"label label-important pull-right\">ugly</span>\r\n<br /><i class=\"icon-asterisk\"></i> <a href=\"http://blahblah.apple.com/yippie\">http://blahblah.apple.com/yippie</a> <span class=\"label label-important pull-right\">ugly</span>\r\n<br /><i class=\"icon-asterisk\"></i> <a href=\"http://blahblah.fusionleaf.com/yippie\">http://blahblah.fusionleaf.com/yippie</a> <span class=\"label label-success pull-right\">pretty</span>\r\n</div>\r\n\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>Nginx Note</h3>\r\n						<p>Nginx is a powerful web server used by popular sites: Wikipedia, Wordpress, SourceForge, and Github. The folder structure above works in conjunction with an Nginx dynamic configuration designed by the FusionLeaf Team. The configuration allows the creation of multiple websites and subdomains without modifying the Nginx configuration file.</p>\r\n					</div>\r\n				</div>\r\n			</div>\r\n\r\n\r\n\r\n<!-- ************************** Section 11 ************************** -->\r\n			<div class=\"tab-pane fade\" id=\"section11\">\r\n				<div class=\"page-header\"><h1>Setup <small rel=\"tooltip\" title=\"to grandmother\'s house we go\">Initial configuration of FusionLeaf CMS.</small></h1></div>\r\n				<div class=\"row-fluid\">\r\n					<div class=\"span4\">\r\n						<h3>1. Browser</h3>\r\n						<p>We recommend you use Google Chrome if you are modifying the website because there are many browsers that do not work properly with the dynamic editors in FusionLeaf CMS. Chrome is also an amazing development tool that allows you to modify CSS styles on a live page and detect Javascript/jQuery errors.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>2. Setup: Domain </h3><a class=\"btn btn-primary btn-mini\" href=\"javascript:void(0)\">Next</a>\r\n						<p>Open your browser to <a href=\"http://localhost\">http://localhost</a> or to your domain name. The browser should redirect to <a href=\"/setup.php\">/setup.php</a>. In the textbox, enter in your full domain (excluding the http://). It should either be <b>localhost</b> or <b>www.YOURDOMAIN.com</b> (DNS or hosts file modification required). You must include <b>www</b> because it is a good practice and because Nginx is set up to handle www as a subdomain.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>3. Setup: Title</h3><a class=\"btn btn-primary btn-mini\" href=\"javascript:void(0)\">Next</a>\r\n						<p>The title of your site will be displayed in the top left corner of every page. It should be similar to your URL but make sure it does not include <b>www.</b> or <b>.com</b> unless you really want it on every page.</p>\r\n					</div>\r\n				</div>\r\n				<div class=\"row-fluid\">\r\n					<div class=\"span4\">\r\n						<h3>4. Setup: Database IP Address</h3><a class=\"btn btn-primary btn-mini\" href=\"javascript:void(0)\">Next</a>\r\n						<p>If the database is running on the same machine as the web server, set the IP address to 127.0.0.1 (if you are using FusionLeaf Stack, set it to 127.0.0.1). If the database is running on a different machine, enter in the IP address or the fully qualified domain name. Don\'t use the hostname, <b>localhost</b>, use 127.0.0.1 instead.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>5. Setup: Database Port</h3><a class=\"btn btn-primary btn-mini\" href=\"javascript:void(0)\">Next</a>\r\n						<p>The default port for MySQL is 3306. If you have not changed the port of MySQL, use the default. FusionLeaf currently supports the following MySQL extensions: mysql, mysqli, and pdo_mysql. Inbound connections from any IP address that is not 127.0.0.1 are not allowed to MySQL by default so there is no chance of a brute-force attack.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>6. Setup: Database Administrator</h3><a class=\"btn btn-primary btn-mini\" href=\"javascript:void(0)\">Next</a>\r\n						<p>MySQL requires an administrator or <b>root</b> account with full access to the database. FusionLeaf needs full access to the database to create an additional <i>reader</i> and <i>writer</i> account, as well as backup the complete database from the command shell of the server.</p>\r\n					</div>\r\n				</div>\r\n				<div class=\"row-fluid\">\r\n					<div class=\"span4\">\r\n						<h3>7. Setup: Database Administrator Password</h3><a class=\"btn btn-primary btn-mini\" href=\"javascript:void(0)\">Next</a>\r\n						<p>The password should be at least 8 characters and use different types of characters (uppercase, lowercase, symbols, numbers). You can use the <a href=\"http://www.pctools.com/guides/password\">Secure Password Generator</a> by Symantec to generate a strong password. Store the password securely so you can access it in the future if needed.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>8. Setup: Finished!</h3><a class=\"btn btn-success btn-mini\" href=\"javascript:void(0)\">Go to Website</a>\r\n						<p>You must click the <b>Go to Website</b> button to finish the setup process. The process creates 2 additional MySQL accounts for reading and writing, stores all the data just entered so it can be accessed on every page load, removes the <b>setup.php</b> file to secure the server, loads the database with all the FusionLeaf pages, and redirects to the homepage.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>9. First Login</h3>\r\n						<p>FusionLeaf CMS is now setup and ready to be accessed by the administrator. <b>Change your password on first login.</b> The default credentials are:</p>\r\n						<p class=\"well\"><b>Username:</b> leafybug<br />\r\n						<b>Password:</b> changeme</p>\r\n					</div>\r\n				</div>\r\n			</div>\r\n\r\n\r\n<!-- ************************** Section 12 ************************** -->\r\n			<div class=\"tab-pane fade\" id=\"section12\">\r\n				<div class=\"page-header\"><h1>Logged In <small rel=\"tooltip\" title=\"of love\">Light the fires.</small></h1></div>\r\n				<div class=\"row-fluid\">\r\n					<div class=\"span4\">\r\n						<h3>1. Congrats!</h3>\r\n						<p><b>Change your password.</b> Click Options -> Change Password</p>\r\n						<div class=\"navbar\"><div class=\"navbar-inner\"><div class=\"container\"><ul class=\"nav pull-right\"><li class=\"dropdown\"><a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\">Options<b class=\"caret\"></b></a><ul class=\"dropdown-menu\"><li><a href=\"access_change_pass\">Change Password</a></li></ul></li></ul></div></div></div>\r\n						<p>You can use the <a href=\"http://www.pctools.com/guides/password\">Secure Password Generator</a> by Symantec to generate a strong password.</p>\r\n\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>2. Security, Security, Security</h3>\r\n						<p>There are three default security groups: <span class=\"label label-info\">Administrators</span>, <span class=\"label label-info\">Authenticated</span>, and <span class=\"label label-info\">Anonymous</span>. You cannot delete them. Administrators have full access to the website. Period. Authenticated are users that login. Anonymous are users that do not login. Users cannot be set as members of the Authenticated or Anonymous groups, only the Administrators group or groups that you create. You can only assign users to groups and you can only assign groups to pages. Access must be explicitly granted by Administrators. <span class=\"label label-warning\">Wow, dry</span></p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>3. Web Toolkit</h3>\r\n						<p>When you first login, you will see the Web Toolkit. It\'s essentially a page with tools which will assist in customizing the website to fit your needs.<br />The primary tools:</p>\r\n<ul>\r\n<li>Code Editor</li>\r\n<li>Security Controller</li>\r\n<li>File Organizer</li>\r\n<li>Database Manager</li>\r\n</ul>\r\n					</div>\r\n				</div>\r\n				<div class=\"row-fluid\">\r\n					<div class=\"span4\">\r\n						<h3>4. Code Editor</h3>\r\n						<p>To simplify website customization, the majority of code is stored in the database. The Code Editor is the easiest way to make changes to the \"Pages\" stored in the database. There is also a stripped down version of the Code Editor available in the File Organizer which allows you to make changes to files. The Code Editor includes features like syntax checking, code highlighting, indenting/outdenting, and line numbering.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>5. Security Controller</h3>\r\n						<p>In order to access a <span class=\"label label-success\">Page</span>, a security group must be granted explicit access. The Security Controller allows you to add/edit/delete users and security groups. You can add users to a security group or remove users from a security group. The Security Controller also allows you grant or revoke a security group access to a <span class=\"label label-success\">Page</span>.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>6. File Organizer</h3>\r\n						<p>The File Organizer is a FTP replacement which allows you to add/delete, edit/move/rename, upload/download, and compress/decompress files and folders with ease. It\'s all the functionality the FusionLeaf Team needed to build FusionLeaf CMS from the ground up.</p>\r\n					</div>\r\n				</div>\r\n				<div class=\"row-fluid\">\r\n					<div class=\"span4\">\r\n						<h3>7. Database Manager</h3>\r\n						<p>The FusionLeaf database is the heart of the CMS. The Database Manager is a simplified interface which allows you to easily add rows and columns the tables in the database. Every row and column features dropdown lists with options for customizing the data very quickly. You can also create, rename, and delete tables.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>Query Tester</h3>\r\n						<p>The Database Manager includes a Query Tester. The Query Tester can make complicated changes to the database or simply view the data in PHP arrays which is a visual representation of the result the query() function returns.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>Query Importance</h3>\r\n						<p>It\'s important to understand how to query the database so you can modify current queries as you customize FusionLeaf or build queries into your own <span class=\"label label-success\">Pages</span>. View the Database section to enhance your understanding.</p>\r\n					</div>\r\n				</div>\r\n			</div>\r\n\r\n<!-- ************************** Section 13 ************************** -->\r\n			<div class=\"tab-pane fade\" id=\"section13\">\r\n				<div class=\"page-header\"><h1>Basic Settings <small rel=\"tooltip\" title=\"because seeing is believing\">See the CMS as we see it</small></h1></div>\r\n				<div class=\"row-fluid\">\r\n					<div class=\"span4\">\r\n						<h3>1. System Settings</h3>\r\n						<p>After walking through the initial setup wizard, the only way to change the System Settings is to click the <i class=\"icon-pencil\"></i> icon next to the site title in the navigation bar at the top of the page. If you do not see the icon below, you need to login with a user account that is a member of the Administrators security group. You can then change the site information like the site title and the database information like the address and port.</p>\r\n						<div class=\"navbar\"><div class=\"navbar-inner\"><div class=\"container\"><a class=\"brand\" href=\"/\">{$constant[\'SITE_TITLE\']}</a>{$pencil_icon}</div></div></div>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>2. Site Settings</h3>\r\n						<p>While the System Settings are saved in a file, the Site Settings are saved in the database. You can access the Site Settings by clicking on the <a href=\"/toolkit_site_settings\"><img src=\"/img/silk/layout_content.png\"> Settings</a> item on the <strong>Sidebar</strong>. The settings include Construction/Disaster mode, site/database change logging, navigation/title location, database writablity, and PHP debugging. You can even add your own settings for further customization of FusionLeaf.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>3. Theme Selector</h3>\r\n						<p>If the default <a href=\"http://twitter.github.com/bootstrap\">Bootstrap</a> theme does not fit your personality, there are 11 other free themes provided by <a href=\"http://bootswatch.com\">Bootswatch</a> for you to choose. Click the <a href=\"/toolkit_bootstrap_themes\"><img src=\"/img/silk/palette.png\"> Themes</a> item on the <strong>Sidebar</strong> to view all the included themes in Theme Selector. To apply a theme from <a href=\"https://wrapbootstrap.com\">WrapBootstrap</a>, create a new folder with the name of the theme here: <b>/inc/bootswatch</b>. Upload the bootstrap.min.css and additional files to folder. The theme will then appear in the Theme Selector.</p>\r\n					</div>\r\n				</div>\r\n				<div class=\"row-fluid\">\r\n					<div class=\"span4\">\r\n						<h3>4. Menu Builder</h3>\r\n						<p>Now your website should looks unique. Let\'s get a little technical. Click the <a href=\"/toolkit_menu_builder\"><img src=\"/img/silk/tab.png\"> Menus</a> item on the <strong>Sidebar</strong> to view the Menu Builder. The builder allows you add/edit/delete current menu items, create/delete menus, and set/unset the menus for the security groups. The menus appear in the navigation bar at the top of every page.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>5. Database Backup</h3>\r\n						<p>One of the reasons why the database is the heart of FusionLeaf is because it is easy to backup and restore. Click the <a href=\"/toolkit_database&backup\"><img src=\"/img/silk/database_save.png\"> Backup</a> item on the <strong>Sidebar</strong>. Be sure to set the email address which will receive the database backups using the <i class=\"icon-pencil\"></i> icon. Since backups only take a second to complete, take them often!</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>6. Database Restore</h3>\r\n						<p>Mistakes are no longer a problem with FusionLeaf and the Restore feature. To make it simple, FusionLeaf will restore the newest backup from the <strong>/_hidden/mysql_backup</strong> folder or the backup with the file name that is the closest to the end of the alphabet. A good practice is to use the File Organizer to upload backups from the development environment to your production environment and then click the <a href=\"/toolkit_database&restore\"><img src=\"/img/silk/database_refresh.png\"> Restore</a> item on the <strong>Sidebar</strong>.</p>\r\n					</div>\r\n				</div>\r\n			</div>\r\n\r\n\r\n<!-- ************************** Section 20 ************************** -->\r\n			<div class=\"tab-pane fade\" id=\"section20\">\r\n				<div class=\"page-header\"><h1>Overview of Pages <small rel=\"tooltip\" title=\"aka FusionLegos\">The building blocks.</small></h1></div>\r\n				<div class=\"row-fluid\">\r\n					<div class=\"span4\">\r\n						<h3>1. What is a Page?</h3>\r\n						<p>A <span class=\"label label-success\">Page</span> is essentially a block of text stored in the database. Unlike many of the content management systems, FusionLeaf retrieves almost all of the Pages from the database instead of individual files. There are a few Pages that are stored in files like the <b>index.php</b> which is the <span rel=\"tooltip\" title=\"\" class=\"label label-info\">brain</span> of FusionLeaf.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>2. Database Benefits</h3>\r\n						<p>The storage of Pages in the database allows for easy backup, restore, search, and replace operations. Storing the Pages in the database also allows for faster page loads when coupled with caching provided by Memcache. Memcache stores the most popular Pages in RAM so the next time it is requested, it loads instantly.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>3. Web Toolkit</h3>\r\n						<p>The Code Editor allows you to edit any Page in FusionLeaf. From the <a href=\"/toolkit_index\">Web Toolkit</a> Page, you can view and edit all of Pages in FusionLeaf. The Web Toolkit makes it very easy to see everything and edit everything. Instead of navigating through folders and folders, you can scroll to the correct section and find the Page you want.</p>\r\n					</div>\r\n				</div>\r\n				<div class=\"row-fluid\">\r\n					<div class=\"span4\">\r\n						<h3>4. Page Sections</h3>\r\n						<p>There are five sections which contains Pages: External Files, Core Pages, Toolkit Pages, Additional Pages, and Trash. <b>External Files</b> include physical files which may or may not be required for FusionLeaf to function. <b>Core Pages</b> are absolutely required and any modifications could prevent FusionLeaf from working properly. <b>Toolkit Pages</b> are tools to modify and configure FusionLeaf so only Administrators should have access to them. The <b>Additional Pages</b> section is for all other pages that may or may not be accessible to users. <b>Trash</b> is used to prevent Pages from being accessible if they are old or no longer needed.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>5. Page Operations</h3>\r\n						<p>The <a href=\"/toolkit_index\">Web Toolkit</a> provides a quick way to <b>load</b> (navigate to the page), <b>preview</b> (view the code), <b>edit</b> (open in the Code Editor), or <b>trash</b> (move to the Trash section) most of the active pages. For Pages in the Trash, you can <b>preview</b> (view the code), <b>reuse</b> (move out of the Trash), <b>delete</b> (remove the Page completely), or <b>empty all trash</b> (remove all the Pages completely).</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>6. Page Names</h3>\r\n						<p>When you <a href=\"/toolkit_add_method\">create a new page</a>, you specify a Page Name. The page name needs to be only one word, contain only letters, numbers, underscores, and dashes (no spaces). Dashes are better for SEO when separating words. FusionLeaf uses prefixes to display the Pages in different sections of the <a href=\"/toolkit_index\">Web Toolkit</a>. The Core Pages use prefixes: cms_, div_, hlp_, html_, script_, style_. The Toolkit Pages use prefix: toolkit_. Any other prefix (or lack of) will appear under the Additional Pages section.</p>\r\n					</div>\r\n				</div>\r\n			</div>\r\n\r\n<!-- ************************** Section 21 ************************** -->\r\n			<div class=\"tab-pane fade\" id=\"section21\">\r\n				<div class=\"page-header\"><h1>Static Pages <small rel=\"tooltip\" title=\"aka FusionLegos\">Any type of code.</small></h1></div>\r\n				<div class=\"row-fluid\">\r\n					<div class=\"span4\">\r\n						<h3>1. Types</h3>\r\n						<p>If you edit a page, you\'ll see three radio buttons at the top: HTML, PHP, DYN. DYN is covered in the next section. The radio buttons corresponds with the way the page is parsed. If the HTML radio button is selected, the code in the textbox below will be treated as an .php file so it supports HTML, JavaScript, jQuery, CSS, and PHP. The PHP radio button ensures the CMS evaluates the code in the textbox as PHP (no PHP opening or closing tags required).</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>2. SEO</h3>\r\n						<p>SEO stands for search engine optimization. When editing a page in the Code Editor, you\'ll see a few textboxes at the top. Each textbox is critical to moving the page to the top of the major search engine results. Be sure to accurately and correctly fill out each one to reflect the content on the page. Hover over each textbox to see the best practices for entering text.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>3. Tabs</h3>\r\n						<p>Above the textboxes are seven tabs labeled: Page, Post, JavaScript, CSS Var, CSS Code, Notepad, and Help. Each one contains a different type of code or markup which may or may not affect how the current page is displayed. When you click the Save or Quick Save buttons at the button of the page, the code in all seven of the tabs is automatically updated in the database depending on whether it changed.</p>\r\n					</div>\r\n				</div>\r\n				<div class=\"row-fluid\">\r\n					<div class=\"span4\">\r\n						<h3>4. Page Tab</h3>\r\n						<p>HTML supports two major request methods: GET and POST. GET is how we view almost every page on the internet. When a page is requested in the web browser, the Page Tab contains the code which is evaluated or parsed and then displayed. The textbox at the bottom of the Page Tab can contain HTML, JavaScript, jQuery, CSS, and PHP. The code is usually called <b>client-side</b> scripting.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>5. Post Tab</h3>\r\n						<p>POST (the other major HTML request method) is how we authenticate with usernames/passwords and upload pictures/videos to a website. The Post Tab must contain PHP code which is a form of <b>server-side</b> scripting. The textbox at the bottom of the Post Tab should contain code that either modifies files or records in the database. The code is server-side so it is protected and not viewable by the user.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>6. JavaScript Tab</h3>\r\n						<p>Most web pages today use JavaScript for HTML form validation and providing dynamic content like drop down menus, notifications that appear without pressing refresh, and many others. The JavaScript Tab is the first tab of the seven that is shared among every page in FusionLeaf. If a syntax error occurs, it will cause all of the JavaScript to fail. You can detect an error using Chrome by pressing F12 and looking for a red icon in the bottom right corner.</p>\r\n					</div>\r\n				</div>\r\n				<div class=\"row-fluid\">\r\n					<div class=\"span4\">\r\n						<h3>7. CSS Var Tab</h3>\r\n						<p>CSS stands for cascading style sheets. The best way to set the colors, fonts, and styles for your website is through a style sheet. The CSS Var Tab contains PHP code that is evaluated prior to creating the style sheet. The code can be stored to PHP variables and then referenced in the CSS Code Tab so any color, border, margin, etc. can easily be changed in one location and then applied in many.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>8. CSS Code Tab</h3>\r\n						<p>The textbox at the bottom of the CSS Code Tab should written as if you are writing directly to a .css file, but there is one advantage: you can use PHP variables. If you have a variable on the CSS Var Tab (&#36;fav_color=\'blue\';), you can use it in the CSS Code Tab (background-color: &#36;fav_color;).</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>9. Notepad and Help Tabs</h3>\r\n						<p>The Notepad Tab is a place for notes. If you need to copy code between pages or just want to right a little ToDo, you can use the notepad. The Help Tab contains best practices and code samples which can be used in the other tabs. It is worth reading one time through because it lists available PHP functions that tie into the CMS.</p>\r\n					</div>\r\n				</div>\r\n			</div>\r\n\r\n\r\n<!-- ************************** Section 22 ************************** -->\r\n			<div class=\"tab-pane fade\" id=\"section22\">\r\n				<div class=\"page-header\"><h1>Dynamic Pages <small rel=\"tooltip\" title=\"\">An easier way to build.</small></h1></div>\r\n				<div class=\"row-fluid\">\r\n					<div class=\"span4\">\r\n						<h3>1. DYN</h3>\r\n						<p>At the top of the Code Editor, there is a third radio button not discussed in the previous sections. The DYN radio button is an abbreviation for <b>dynamic</b> pages. Dynamic pages use an interactive interface so no HTML coding needs to be done by hand. Although most of the code is stored in the database, the difference between the static pages (HTML,PHP) and dynamic pages (DYN) is how it is stored. Every dynamic page has its own database table where every element is a row that is linked to at least one other element.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>2. Code Editor</h3>\r\n						<p>When you select the DYN radio button, the large textbox at the bottom of the page will disappear and a new textbox for the table name will appear. The table name will be used to store all the elements for the page. To make it easy to distinguish, prefix the table with: dyn_. The table name should also be only one word and use only letters, numbers, and underscores.</p>\r\n					</div>\r\n					<div class=\"span4\">\r\n						<h3>3. Dynamic Editor</h3>\r\n						<p>Unlike the static pages, the dynamic pages are edited in the Dynamic Editor. As a member of the Administrator security group, you have the ability to edit the dynamic pages as you view them. The pages utilize drag and drop, dynamic right click menus, and a few bootstrap classes. The Dynamic Editor is great for building simple pages very quickly as well as importing existing web pages. You can even modify the code manually and then apply the changes.</p>\r\n					</div>\r\n				</div>\r\n			</div>\r\n\r\n\r\n\r\n		</div> <!-- End of tabcontent -->\r\n	</div> <!-- End of span10 -->\r\n</div>\r\n\r\nOUTPUT;\r\n\r\n// Need this for the heredoc','2012-08-10 08:00:38',2,1,'','Planter\'s Guide','',''),(342,'toolkit_smart_file','if (!isset($_GET[\'file\']))\r\n{\r\n	msg_user(\'Smart File Problem\',\'Missing the smart file\');\r\n	return;\r\n}\r\n$file = $_GET[\'file\'];\r\nif (!file_exists($file))\r\n{\r\n	$output .= \'File does not exist!\';\r\n	return;\r\n}\r\n\r\n// Decode the file into an array\r\n$arr = json_decode(file_get_contents($file),true);\r\n\r\nif ($arr==null)\r\n{\r\n	$output .= \'File is not supported!\';\r\n	return;\r\n}\r\n\r\n$output .= \'<p><strong>File:</strong> <a href=\"/index.php?toolkit_file_manager&file_edit=\'.basename($file).\'&path=\'.dirname($file).\'\">\'.$file.\'</a></p>\';\r\n\r\nforeach ($arr as $key=>$val)\r\n{\r\n	// Protect the potential \'passwords\', \'secrets\' from view\r\n	if (strripos($key,\'pass\')!=false || strripos($key,\'pw\')!=false || strripos($key,\'secret\')!=false)\r\n	{\r\n		$val = \'****************\';\r\n	}\r\n	$output .= \'<strong>\'.smartFile($key,$val,true,$file).\':</strong> \'.smartFile($key,$val,false,$file).br();\r\n}','2012-07-16 21:23:02',2,1,'','Smart File Editor','',''),(360,'toolkit_create_site','<div class=\"fluid-row\">\r\n\r\n<p>Use this tool to duplicate the current site to another location on this computer. The new site will be restored from the latest backup.</p>\r\n<form class=\"well\" onsubmit=\"return validateForm()\" method=\"post\">\r\n<label>Full Site Domain:</label><input type=\"text\" id=\"site_name\" name=\"site_name\" placeholder=\"www.domain.com\" value=\"\" />\r\n<p class=\"help-block\">Include www. and .com (if applicable).</p>\r\n<button class=\"btn\" type=\"submit\" name=\"submit\" title=\"Click once to create site\">Create</button>\r\n</form>\r\n</div>\r\n\r\n<div class=\"clear\"></div>\r\n<script>document.getElementById(\"site_name\").focus();</script>','2012-08-10 21:05:49',2,0,'function copy_dir($path, $dir_structure)\r\n{\r\n	$dir = str_replace(CMS_ROOT, $dir_structure, $path);\r\n	if (!is_dir($dir)) mkdir($dir);\r\n	foreach (glob($path.DIR_SEP.\"*\",GLOB_ONLYDIR|GLOB_NOSORT) as $filename)\r\n	{\r\n		copy_dir($filename,$dir_structure);\r\n	}\r\n	foreach (glob($path.DIR_SEP.\"*\") as $filename)\r\n	{\r\n 		if (!is_dir($filename)) copy($filename, str_replace(CMS_ROOT, $dir_structure, $filename));\r\n	}\r\n}\r\n\r\n$site = $_POST[\'site_name\'];\r\n$arr = explode(\'.\',$site);\r\n\r\nif (count($arr)==3)\r\n{\r\n	$dir_structure = FLS_ROOT.DIR_SEP.\'webroot\'.DIR_SEP.$arr[1].DIR_SEP.$arr[2].DIR_SEP.$arr[0];\r\n\r\n	if (is_dir($dir_structure))\r\n	{\r\n		msg_user(\"Site Creation\",\"The site, $site, is already set up on this server.\");\r\n		return;\r\n	}\r\n\r\n	if (!@mkdir($dir_structure, 0, true)) { msg_user(\"Site Creation\",\"The site, $site, could not be set up on this server. \r\n		Ensure you have the correct permissions.\"); return; }\r\n	\r\n	copy_dir(CMS_ROOT,$dir_structure);\r\n\r\n	$www_redirect = dirname(CMS_ROOT).DIR_SEP.\'index.php\';\r\n\r\n	if (file_exists($www_redirect))$result = copy($www_redirect, dirname($dir_structure).DIR_SEP.\'index.php\');\r\n	else $result = true;\r\n	//@unlink($dir_structure.DIR_SEP.\'_hidden\'.DIR_SEP.\'setup_win.txt\');\r\n	@unlink($dir_structure.DIR_SEP.\'_hidden\'.DIR_SEP.\'setup\');\r\n\r\n	if (!$result) { msg_user(\"Site Creation\",\"The site, $site, could not be set up on this server. \r\n		The files were not copied correctly.\"); return; }\r\n\r\n$a = \'<a href=\"http://\'.$site.\'\">\'.$site.\'</a>\';\r\n\r\nmsg_user(\"Site Creation\",\"The site, $a, is now ready!\");\r\n} else msg_user(\"Site Creation\",\"The site, $site, is not valid.\");','Create FusionLeaf Site','','');
/*!40000 ALTER TABLE `php_methods` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `php_trash`
--

DROP TABLE IF EXISTS `php_trash`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `php_trash` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(50) NOT NULL,
  `method` mediumtext NOT NULL,
  `modified` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `modifier` int(11) NOT NULL,
  `type` int(2) NOT NULL,
  `post` text NOT NULL,
  `title` varchar(70) DEFAULT NULL COMMENT 'HTML title',
  `keyword` varchar(500) DEFAULT NULL COMMENT 'HTML keywords',
  `description` varchar(160) DEFAULT NULL COMMENT 'HTML description',
  UNIQUE KEY `id` (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=364 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `php_trash`
--

LOCK TABLES `php_trash` WRITE;
/*!40000 ALTER TABLE `php_trash` DISABLE KEYS */;
/*!40000 ALTER TABLE `php_trash` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `site_color`
--

DROP TABLE IF EXISTS `site_color`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `site_color` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT 'Self-explanatory',
  `name` varchar(100) NOT NULL COMMENT 'Variable name for the color',
  `description` varchar(100) NOT NULL COMMENT 'Description of the setting',
  `color` varchar(100) NOT NULL COMMENT 'CSS valid color',
  `modified` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Date of last modification',
  `modifier` int(10) unsigned NOT NULL COMMENT 'Modifier of the setting',
  PRIMARY KEY (`id`),
  UNIQUE KEY `name` (`name`)
) ENGINE=MyISAM AUTO_INCREMENT=30 DEFAULT CHARSET=latin1 COMMENT='Users with access to login';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `site_color`
--

LOCK TABLES `site_color` WRITE;
/*!40000 ALTER TABLE `site_color` DISABLE KEYS */;
INSERT INTO `site_color` VALUES (1,'COLOR_BACKGROUND_OUTER','Background - Outer','#FFFFFF','2012-08-04 06:52:59',1),(4,'COLOR_BACKGROUND_INNER','Background - Inner','#FFFFFF','2012-08-04 06:52:59',1),(5,'COLOR_FOOTER_TEXT','Footer - Text','#333333','2012-08-04 06:52:59',1),(6,'COLOR_TITLE_TEXT','Title - Text','#333333','2012-08-04 06:52:59',1),(7,'COLOR_BORDER','Border','#C0C0C0','2012-08-04 06:52:59',1),(8,'COLOR_BODY_TEXT','Text','#000000','2012-08-04 06:52:59',1),(9,'COLOR_BODY_HYPERLINK','Hyperlink','#000000','2012-08-04 06:52:59',1),(10,'COLOR_FORM_INPUT','Form Text Area Background','#F5F5F5','2012-06-04 06:50:35',1),(11,'COLOR_TABLE_ROW_PRIMARY','Table Row - Primary','#99CC99','2012-08-04 06:52:59',1),(12,'COLOR_TABLE_ROW_SECONDARY','Table Row - Secondary','#CCFF99','2012-08-04 06:52:59',1),(13,'COLOR_MESSAGE','Message Box - Background','#F5F5F5','2012-08-04 06:52:59',1),(14,'COLOR_BUTTON','Form Button Background','#F5F5F5','2012-06-05 22:30:12',1),(15,'COLOR_TAB','Tab - Background','#F5F5F5','2012-06-05 22:30:12',1),(16,'COLOR_MENU','Menu - Background','#F5F5F5','2012-08-04 06:52:59',1),(17,'COLOR_TAB_HOVER','Tab - Background Hover','#666666','2012-08-04 06:52:59',1),(18,'COLOR_FORM_INPUT_TEXT','Form Text Area Text','#000000','2012-08-04 06:52:59',1),(19,'COLOR_MENU_HOVER','Menu - Background Hover','#333333','2012-08-04 06:38:49',1),(20,'COLOR_TAB_CURRENT','Tab - Background Current','#333333','2012-08-04 06:52:59',1),(21,'COLOR_MENU_TEXT','Menu - Text','#333333','2012-08-04 06:38:49',1),(22,'COLOR_MENU_HOVER_TEXT','Menu - Hover Text','#F5F5F5','2012-08-04 06:38:49',1),(23,'COLOR_BODY_HYPERLINK_VISIT','Hyperlink - Visited','#000000','2012-08-04 06:52:59',1),(24,'COLOR_TAB_TEXT','Tab - Text','#333333','2012-06-05 22:30:12',1),(25,'COLOR_TAB_HOVER_TEXT','Tab - Text Hover','#FFFFFF','2012-08-04 06:52:59',1),(26,'COLOR_TAB_CURRENT_TEXT','Tab - Text Current','#FFFFFF','2012-06-05 21:45:55',1),(27,'COLOR_MENU_TEXT_TOP','Menu - Text Top','#333333','2012-08-04 06:52:59',1),(28,'COLOR_MESSAGE_TEXT_TITLE','Message Box - Text Title','#000000','2012-08-04 06:38:49',1),(29,'COLOR_MESSAGE_TEXT','Message Box - Text','#000000','2012-08-04 06:38:49',1);
/*!40000 ALTER TABLE `site_color` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `site_help`
--

DROP TABLE IF EXISTS `site_help`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `site_help` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT 'Self-explanatory',
  `topic` varchar(100) NOT NULL COMMENT 'Name or title of the help entry',
  `entry` text NOT NULL COMMENT 'Code or info for the help entry',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=23 DEFAULT CHARSET=latin1 COMMENT='Users with access to login';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `site_help`
--

LOCK TABLES `site_help` WRITE;
/*!40000 ALTER TABLE `site_help` DISABLE KEYS */;
INSERT INTO `site_help` VALUES (1,'PHP Function: User Notification','// Title and Message are required, redirect page is optional\r\nmsg_user(\'Title\',\'Message\',\'redirect_page\');\r\n\r\n// Add a return if no other lines of code should execute\r\nreturn;'),(2,'PHP: Query SELECT','// MySQL query\r\n$qry = \'SELECT id, name FROM access_user WHERE last_name=? ORDER BY id\';\r\n\r\n// Pass a variable via GET or POST\r\n$params = array($_GET[\'passed_id\']);\r\n\r\n// Execute the query with the query and parameters\r\n$result = query($qry, $params);\r\n\r\n// Loop through the returned rows\r\nforeach($result as $row)\r\n{\r\n	// Output the row information\r\n	$output.=$row[\'id\'].\': \'.$row[\'name\'].br();\r\n}'),(3,'PHP: Query UPDATE','// MySQL query with LIMIT to improve performance\r\n$qry = \'DELETE FROM table_name WHERE id=? LIMIT 1\';\r\n\r\n// Pass a variable via GET or POST\r\n$params = array($_GET[\'passed_id\']);\r\n\r\n// Execute the query with the query and parameters\r\n$result = query_execute($qry, $params);\r\n\r\n// Return the number of changed rows\r\n$output .= $result.br();'),(4,'HTML: Form POST','<!-- Using the bootstrap form -->\r\n<div class=\"fluid-row\">\r\n<form class=\"well\" method=\"get\">\r\n<input type=\"hidden\" name=\"toolkit_search\" id=\"toolkit_search\" />\r\n<label>Search:</label><input class=\"span4\" type=\"text\" id=\"search\" name=\"search\" placeholder=\"Type here...\" value=\"\" />\r\n<p class=\"help-block\">Search is case-sensitive.</p>\r\n<button class=\"btn\" type=\"submit\" name=\"submit\" title=\"Click once to search\">Search</button>\r\n</form>\r\n</div>\r\n<script>document.getElementById(\"search\").focus();</script>\r\n\r\n\r\n<!-- Using the native form -->\r\n<div class=\"frm_simple\">\r\n<h3>Change Password</h3>\r\n\r\n<!-- Set the action, validation (forces all fields to be filled), and method type -->\r\n<form action=\"index.php?login_try\" onsubmit=\"return validateForm()\" method=\"post\">\r\n\r\n<!-- Add the inputs -->\r\n<p>Username:</p><input type=\"text\" id=\"user\" name=\"user\" value=\"\" />\r\n<p>Password:</p><input type=\"password\" id=\"pass\" name=\"pass\" value=\"\" />\r\n\r\n<!-- Add the submit button -->\r\n<div class=\"buttons\"><button id=\"nothing\" class=\"positive\" type=\"submit\" name=\"submit\"\r\ntitle=\"Click once to change password\">Change</button></div>\r\n\r\n<!-- Clear the left and right -->\r\n<div class=\"clear\"></div>\r\n</form>\r\n\r\n</div>\r\n<!-- Focus the first input box -->\r\n<script>document.getElementById(\"tweet\").focus();</script>'),(5,'PHP: Form Validation','// If both the user and pass inputs are not passed from the previous form, don\'t let the script run\r\nif (!isset($_POST[\'user\']) || !isset($_POST[\'pass\']))\r\n{\r\n	msg_user(\'Form Validation Problem\',\'All fields were not entered in correctly, please try again.\',\'redirect_page\');\r\n	return;\r\n}'),(6,'JavaScript: Form Validation','<script type=\"text/javascript\">\r\nfunction validateLoginForm()\r\n{\r\n	var x=document.forms[0][\"user\"].value\r\n	if (x==null || x==\"\" || x.length < 1)\r\n  	{\r\n		alert(\"Please enter in a username\");\r\n		return false;\r\n	}\r\n	\r\n	var x=document.forms[0][\"pass\"].value\r\n	if (x==null || x==\"\" || x.length < 1)\r\n  	{\r\n		alert(\"Please enter in a password\");\r\n		return false;\r\n	}\r\n}\r\n</script>'),(7,'HTML: Inline PHP','<!-- Make sure there is a space after ?php and before ?> -->\r\n<!-- Make sure single statements end with a ; -->\r\n<!-- Use echo to output a variable, don\'t use $output -->\r\n<p><?php echo \'Hello world\'; ?></p>'),(8,'PHP: Redirect','// Redirect to another page\r\nheader(\'Location: /next_page\');\r\nreturn;\r\n\r\n// Redirect to another site\r\nheader(\'Location: http://www.google.com\');\r\nreturn;'),(9,'About','// The Help sections provides code samples of commonly used snippets and best practices for strong, effective coding.'),(10,'Best Practices - PHP','Append output to the screen using PHP variable $output instead of echo\r\n** Variable $output is already declared at the beginning of the cached file, indexinc.php\r\n** Append output using .= instead of =\r\n++ Right: $output .= \'hello world\';\r\n-- Wrong: $output = \'hello world\';\r\n-- Wrong: echo \'hello world\';\r\n\r\nOnly use long PHP tags for inline PHP\r\n** FusionLeaf uses custom parsing so be sure to follow all rules for PHP within HTML\r\n** Inline PHP can also be used within Heredoc syntaxes for FusionLeaf\r\n** Leave a space after ?php\r\n** Leave a space before ?>\r\n** End all statements with a ; or }\r\n++ Right: <?php echo \'hello world\'; ?>\r\n-- Wrong: <? echo \'hello world\'; ?>\r\n++ Right: <?php if (1+1==2) {echo \'Correct\';} ?>\r\n-- Wrong: <?php if (1+1==2) echo \'Correct\' ?>\r\n-- Wrong: <?phpecho \'hello world\'; ?>\r\n-- Wrong: <?php echo \'hello world\';?>\r\n-- Wrong: <?php echo \'hello world\'?>\r\n-- Wrong: <?php echo \'hello world\' ?>\r\n\r\nUse single quotes instead of double quotes as much as possible in PHP strings\r\n** Use double quotes if string contains PHP variables\r\n** Use double quotes if string contains single quotes\r\n++ Right: $output .= \'hello world\';\r\n-- Wrong: $output .= \"hello world\";\r\n++ Right: $world = \'world\'; $output .= \"hello $world\";\r\n-- Wrong: $world = \'world\'; $output .= \'hello $world\';\r\n++ Right: $output .= \"I don\'t think the world is flat.\";\r\n-- Wrong: $output .= \'I don\'t think the world is flat.\';\r\n\r\nUse the following global variables for maximum compatibility:\r\nDIR_SEP - directory separator: set to \\ for Windows, set to / for Linux\r\nNEWLINE - new line characters: set to \\r\\n for Windows, set to \\n for Linux\r\nIS_WIN_OS - set to true for Windows, set to false for Linux\r\n\r\nUse the following functions for maximum compatibility:\r\nisGroupMember(1) - true if current user is in Administrators security group\r\nisGroupMember(2) - true if current user is in Authenticated security group\r\nisGroupMember(3) - true if current user is in Anonymous security group\r\nisGroupMember(group_id, user_id) - true if current user is in security group with matching id'),(11,'PHP: Sanitize Output','// Always sanitize all user input before displaying on the page\r\nhtmlentities($value, ENT_QUOTES, \'UTF-8\');'),(12,'Best Practices - MySQL','Use the built-in FusionLeaf MySQL functions (based on MySQLi) as much as possible because they support parameterization\r\n** query($qry,$params) should be used for SELECT, SHOW and non-changing queries and \r\n** query_execute($qry,$params) should be used for INSERT, UPDATE, and DELETE queries\r\n\r\nThings to remember:\r\n** Refrain from using variables inside $qry string (add to $params array instead)\r\n** Pass either empty array or filled array for $params\r\n** If parameterization is used correctly, it protects against SQL Injection\r\n** trim() is used on data prior to insertion in database\r\n** htmlentities is NOT used on data after retrieval from database so sanitize all output\r\n\r\nReturn values:\r\n** query($qry,$params) returns an array of matching rows (each row is an array)\r\n** query_execute($qry,$params) returns the number of affected rows\r\n\r\nSyntax for SELECT queries:\r\n$qry = \'SELECT name FROM table_name WHERE id=? LIMIT 1\'\r\n$params = array($id);\r\n$result = query($qry, $params);\r\n\r\nSyntax for INSERT queries:\r\n$qry = \'INSERT INTO table_name (name) VALUES (?)\'\r\n$params = array($name);\r\n$result = query_execute($qry, $params);\r\n\r\nSyntax for UPDATE queries:\r\n$qry = \'UPDATE table_name SET name=? WHERE id=? LIMIT 1\'\r\n$params = array($name, $id);\r\n$result = query_execute($qry, $params);\r\n\r\nSyntax for DELETE queries:\r\n$qry = \'DELETE FROM table_name WHERE id=? LIMIT 1\'\r\n$params = array($id);\r\n$result = query_execute($qry, $params);'),(13,'Best Practices - Debugging','** Use the built-in Code Editor to build and edit pages\r\n** Copy-and-paste the code samples to quickly add functionality to any page\r\n** Click the \'Quick Save\' button to save the code into the database without leaving the page\r\n** Enhance the readability of code using the \'Indent Line(s)\' and \'Outdent Line(s)\' buttons (works best in Chrome)\r\n** Click the \'Highlight\' button to see a color-coded version of the code with hyperlinks to PHP.net\r\n\r\n\'PHP Check Syntax\' button - Tips and Tricks:\r\n** Click the \'PHP Check Syntax\' button before saving to verify syntax\r\n** Click the \'Line Numbers On\' button to enhance navigation of the code\r\n** Type die($variable) to quickly see the output of $variable in a JavaScript Alert box\r\n\r\nAdditional Tips:\r\n** Use FusionLeaf Studio (FLS) for testing major code changes before making changes in production'),(14,'Comments in Code','Use the following to add comments to your code to clearly explain any complex logic.\r\n\r\n// PHP or JavaScript comment on one line\r\n\r\n# PHP comment on one line\r\n\r\n/*\r\nPHP, JavaScript, or CSS comment\r\nthat spans multiple\r\nlines.\r\n*/\r\n\r\n<!--HTML comment\r\non one line or\r\nmultiple lines-->'),(15,'PHP: Random Hash','// Generate a random integer, append an id based of the current microseconds, then create a 32 character hexadecimal number\r\nmd5(uniqid(rand(), TRUE));'),(16,'PHP: Image Output','// Use a similar syntax to display an image that is not usually web accessible\r\n// Add in code to prevent unauthorized files and users from malicious use\r\n\r\n// If the show_image parameter is in the URL\r\nif (isset($_GET[\'show_image\']))\r\n{\r\n	// Clean all the output (remove leading whitespaces, very important)\r\n	while(@ob_end_clean());\r\n\r\n	// Get the image set\r\n	$img=$_GET[\'show_image\']; \r\n\r\n	// Get the image extension\r\n	$ext = pathinfo($img, PATHINFO_EXTENSION);\r\n\r\n	// Output the image header\r\n	header(\"content-type: image/$ext\");\r\n\r\n	// Output the image\r\n	readfile($img);\r\n\r\n	// Exit so no more lines of code execute\r\n	exit();\r\n}'),(18,'PHP Class: File_Array','/* File_Array Class\r\n** Read and write to a file as if it is an array\r\n** Uses JSON to store the key and value in the file\r\n*/ The file is automatically saved in the deconstructor\r\n\r\n// Create an instance of the File_Array class\r\n$fa = new file_array($file_path);\r\n\r\n// Get the file path\r\n$fa->getfile();\r\n\r\n// Set a value\r\n$fa->add($key, $val);\r\n\r\n// Delete a value\r\n$fa->del($key);\r\n\r\n// Read a value, return FALSE if key not found\r\n$val = $fa->get($key);\r\n\r\n// Return all values in an array\r\n$arr = $fa->grab();\r\nforeach($arr as $key=>$val) { $output .= $key.\':\'.$val; }\r\n\r\n// Delete all values\r\n$fa->clean();\r\n\r\n// DEBUG: Show all the values in an array\r\n$fa->show();\r\n\r\nclass file_array\r\n{\r\n	private $file;			// File name\r\n	private $stack = array(); 	// Array\r\n\r\n	function __construct($f){ $this->setfile($f); $this->read(); }\r\n	function __destruct()	{ $this->save(); }\r\n	private function setfile($f) 	{ $this->file = $f; }\r\n	function getfile() 	{ return $this->file; }\r\n	private function save()	{ if ($this->stack) { file_put_contents($this->file,json_encode($this->stack)); }\r\n					else { if (file_exists($this->file)) { unlink($this->file); } } }\r\n	private function read()	{ if (file_exists($this->file)) $this->stack = json_decode(file_get_contents($this->file),true); }\r\n	function add($key, $val){ $this->stack[$key]=$val; }\r\n	function del($key)	{ unset($this->stack[$key]); }\r\n	function get($key)	{ if (isset($this->stack[$key])) { return $this->stack[$key]; }\r\n					else { return false; } }\r\n	function clean()	{ $this->stack=false; }\r\n	function show()		{ return print_array($this->stack); }\r\n	function grab()		{ return $this->stack; }\r\n}'),(19,'PHP Function: Constant Test','// Determine if the SETTING_PHP_VARIABLES value is a constant and equals \'show\'\r\nif (constant_test(\'SETTING_PHP_VARIABLES\',\'show\'))\r\n{\r\n	$output .= \'Setting is shown!\';\r\n}\r\nelse\r\n{\r\n	$output .= \'Setting is not shown!\';\r\n}\r\n\r\n// Test if constants are defined and equals the value\r\n// Returns FALSE if the value is not equal or is not defined\r\nfunction constant_test($constant,$value)\r\n{\r\n	if (defined($constant) && constant($constant)==$value) return true;\r\n	else return false;\r\n}'),(20,'PHP: SmartDB','// Outputs a line of text that utilizes a BootstrapX Clickover\r\n// The user can quickly edit the line of text and update the database\r\n// Send the row(array), column name, and table name\r\n// Row array MUST include the id\r\n$output.=smartDB($row,\'column\',\'table\');\r\n\r\n// Usage:\r\n// Execute the query with the query and parameters\r\n$result = query(\'SELECT address,id FROM table ORDER BY id\', array());\r\n\r\n// Loop through the returned rows\r\nforeach($result as $row)\r\n{\r\n	// Output the row information\r\n	$output.=smartDB($row,\'address\',\'table\');\r\n}'),(21,'PHP: SQL Query Count with AJAX','// If you write a page that POSTs using AJAX, add this code to the beginning of your POST page\r\nstartSQLCounter();\r\n\r\n// Then add this code to display the number of queries once the AJAX completes\r\nif (constant_test(\'SETTING_PHP_VARIABLES\',\'show\'))\r\n{\r\n	// Output the SQL count and page load time\r\n	$output .= outputSQLCounter();\r\n	if (function_exists(\'PtimerStop\')) $output .= PtimerStop();\r\n}'),(22,'Best Practices - HTML','<!-- When using anchors (links), don\'t set HREF to #, set it to: javascript:void(0) -->\r\n<!-- Using a # sign will append the character to the URL at the top -->\r\n<a class=\"btn btn-primary\" href=\"javascript:void(0)\" onclick=\"updateElement()\">Update</a>');
/*!40000 ALTER TABLE `site_help` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `site_setting`
--

DROP TABLE IF EXISTS `site_setting`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `site_setting` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT 'Self-explanatory',
  `name` varchar(100) NOT NULL COMMENT 'Name off the setting',
  `description` varchar(100) NOT NULL COMMENT 'Description of the setting',
  `current_value` varchar(200) NOT NULL COMMENT 'Value of the setting',
  `all_option` varchar(500) NOT NULL COMMENT 'Available values for the setting',
  `modified` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Date of last modification',
  `modifier` int(10) unsigned NOT NULL COMMENT 'Modifier of the setting',
  PRIMARY KEY (`id`),
  UNIQUE KEY `name` (`name`)
) ENGINE=MyISAM AUTO_INCREMENT=23 DEFAULT CHARSET=latin1 COMMENT='Users with access to login';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `site_setting`
--

LOCK TABLES `site_setting` WRITE;
/*!40000 ALTER TABLE `site_setting` DISABLE KEYS */;
INSERT INTO `site_setting` VALUES (1,'SETTING_NAV_MENU_SIDE','Navigation Menu Side','right','left,right','2012-06-19 17:33:56',1),(5,'SETTING_PAGE_TITLE','Page Title Location','left','left,center,right','2012-06-16 23:49:20',1),(7,'SETTING_THEME','Website Theme (Not functional)','1','1,2,3,4','2012-08-04 18:00:31',1),(11,'SETTING_NAV_MENU_LOCATION','Navigation Menu Location','top','top,bottom','2012-06-17 00:19:25',1),(12,'SETTING_PHP_VARIABLES','Admin: Debugging with PHP Variables, shows variables at the bottom of every page','hide','show,hide','2012-08-08 17:00:44',1),(13,'SETTING_LOG_CHANGE','Admin: Log Website Changes','disable','enable,disable','2012-07-09 05:49:39',1),(14,'SETTING_SITE_MAINTENANCE','Admin: Construction Mode, disables the website while Administrators make changes','disable','enable,disable','2012-07-09 05:51:39',1),(15,'SETTING_SITE_DISASTER','Admin: Disaster Mode, completely disables the site for even Administrators','disable','enable,disable','2012-07-09 05:50:49',1),(16,'SETTING_LOG_DB_CHANGE','Admin: Log Database Changes','disable','enable,disable','2012-07-09 05:49:46',1),(17,'SETTING_DB_WRITE','Admin: Database Writing, prevents any changes to the database','enable','enable,disable','2012-07-09 05:52:02',1),(18,'COPYRIGHT_NAME','Fixed: Copyright Name','PC Precision LLC','PC Precision LLC','2012-07-09 05:23:20',1),(19,'COPYRIGHT_DATE','Fixed: Copyright Date','2012','2012','2012-07-09 04:52:43',1),(20,'BRANDING_NAME','Fixed: Branding Name','Powered by FusionLeaf','Powered by FusionLeaf','2012-07-09 05:38:38',1),(21,'BACKUP_EMAIL','Fixed: Email Address to Receive Database Backups','please enter in an email','please enter in an email','2012-08-04 14:10:09',1),(22,'SETTING_DB_ADMIN','Admin: Use the SQL root account for all queries','disable','enable,disable','2012-08-20 03:28:36',1);
/*!40000 ALTER TABLE `site_setting` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `visitor_info`
--

DROP TABLE IF EXISTS `visitor_info`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `visitor_info` (
  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'Self-explanatory',
  `ip` varchar(15) NOT NULL,
  `attempts` int(11) NOT NULL,
  `locked` tinyint(1) NOT NULL,
  `last_attempt` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Last invalid login attempt',
  PRIMARY KEY (`id`),
  UNIQUE KEY `ip` (`ip`)
) ENGINE=MyISAM AUTO_INCREMENT=56 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `visitor_info`
--

LOCK TABLES `visitor_info` WRITE;
/*!40000 ALTER TABLE `visitor_info` DISABLE KEYS */;
/*!40000 ALTER TABLE `visitor_info` ENABLE KEYS */;
UNLOCK TABLES;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2012-08-19 23:39:03
